<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.AVL</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- AVL trees</a>
<a id="119" class="Comment">------------------------------------------------------------------------</a>

<a id="193" class="Comment">-- AVL trees are balanced binary search trees.</a>

<a id="241" class="Comment">-- The search tree invariant is specified using the technique</a>
<a id="303" class="Comment">-- described by Conor McBride in his talk &quot;Pivotal pragmatism&quot;.</a>

<a id="368" class="Keyword">open</a> <a id="373" class="Keyword">import</a> <a id="380" href="Relation.Binary.html" class="Module">Relation.Binary</a>
<a id="396" class="Keyword">open</a> <a id="401" class="Keyword">import</a> <a id="408" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="446" class="Symbol">as</a> <a id="449" class="Module">P</a> <a id="451" class="Keyword">using</a> <a id="457" class="Symbol">(</a><a id="458" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a> <a id="462" class="Symbol">;</a> <a id="464" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="468" class="Symbol">)</a>

<a id="471" class="Keyword">module</a> <a id="478" href="Data.AVL.html" class="Module">Data.AVL</a>
  <a id="489" class="Symbol">{</a><a id="490" href="Data.AVL.html#490" class="Bound">k</a> <a id="492" href="Data.AVL.html#492" class="Bound">r</a><a id="493" class="Symbol">}</a> <a id="495" class="Symbol">{</a><a id="496" href="Data.AVL.html#496" class="Bound">Key</a> <a id="500" class="Symbol">:</a> <a id="502" class="PrimitiveType">Set</a> <a id="506" href="Data.AVL.html#490" class="Bound">k</a><a id="507" class="Symbol">}</a> <a id="509" class="Symbol">{</a><a id="510" href="Data.AVL.html#510" class="Bound Operator">_&lt;_</a> <a id="514" class="Symbol">:</a> <a id="516" href="Relation.Binary.Core.html#898" class="Function">Rel</a> <a id="520" href="Data.AVL.html#496" class="Bound">Key</a> <a id="524" href="Data.AVL.html#492" class="Bound">r</a><a id="525" class="Symbol">}</a>
  <a id="529" class="Symbol">(</a><a id="530" href="Data.AVL.html#530" class="Bound">isStrictTotalOrder</a> <a id="549" class="Symbol">:</a> <a id="551" href="Relation.Binary.html#10202" class="Record">IsStrictTotalOrder</a> <a id="570" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a> <a id="574" href="Data.AVL.html#510" class="Bound Operator">_&lt;_</a><a id="577" class="Symbol">)</a>
  <a id="581" class="Keyword">where</a>

<a id="588" class="Keyword">open</a> <a id="593" class="Keyword">import</a> <a id="600" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> <a id="615" class="Keyword">using</a> <a id="621" class="Symbol">(</a><a id="622" href="Agda.Builtin.Bool.html#67" class="Datatype">Bool</a><a id="626" class="Symbol">)</a>
<a id="628" class="Keyword">import</a> <a id="635" href="Data.DifferenceList.html" class="Module">Data.DifferenceList</a> <a id="655" class="Symbol">as</a> <a id="658" class="Module">DiffList</a>
<a id="667" class="Keyword">open</a> <a id="672" class="Keyword">import</a> <a id="679" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="690" class="Keyword">open</a> <a id="695" class="Keyword">import</a> <a id="702" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="717" class="Symbol">as</a> <a id="720" class="Module">List</a> <a id="725" class="Keyword">using</a> <a id="731" class="Symbol">(</a><a id="732" href="Agda.Builtin.List.html#80" class="Datatype">List</a><a id="736" class="Symbol">)</a>
<a id="738" class="Keyword">open</a> <a id="743" class="Keyword">import</a> <a id="750" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="766" class="Keyword">hiding</a> <a id="773" class="Symbol">(</a><a id="774" href="Data.Maybe.Base.html#2071" class="Function">map</a><a id="777" class="Symbol">)</a>
<a id="779" class="Keyword">open</a> <a id="784" class="Keyword">import</a> <a id="791" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="805" class="Keyword">hiding</a> <a id="812" class="Symbol">(</a><a id="813" href="Data.Nat.Base.html#915" class="Function Operator">_&lt;_</a><a id="816" class="Symbol">;</a> <a id="818" href="Data.Nat.Base.html#2196" class="Function Operator">_⊔_</a><a id="821" class="Symbol">;</a> <a id="823" href="Data.Nat.Base.html#3507" class="Function">compare</a><a id="830" class="Symbol">)</a>
<a id="832" class="Keyword">open</a> <a id="837" class="Keyword">import</a> <a id="844" href="Data.Product.html" class="Module">Data.Product</a> <a id="857" class="Keyword">hiding</a> <a id="864" class="Symbol">(</a><a id="865" href="Data.Product.html#2154" class="Function">map</a><a id="868" class="Symbol">)</a>
<a id="870" class="Keyword">open</a> <a id="875" class="Keyword">import</a> <a id="882" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="892" class="Keyword">open</a> <a id="897" class="Keyword">import</a> <a id="904" href="Function.html" class="Module">Function</a>
<a id="913" class="Keyword">open</a> <a id="918" class="Keyword">import</a> <a id="925" href="Level.html" class="Module">Level</a> <a id="931" class="Keyword">using</a> <a id="937" class="Symbol">(</a><a id="938" href="Agda.Primitive.html#657" class="Primitive Operator">_⊔_</a><a id="941" class="Symbol">;</a> <a id="943" href="Level.html#358" class="Record">Lift</a><a id="947" class="Symbol">;</a> <a id="949" href="Level.html#415" class="InductiveConstructor">lift</a><a id="953" class="Symbol">)</a>

<a id="956" class="Keyword">open</a> <a id="961" href="Relation.Binary.html#10202" class="Module">IsStrictTotalOrder</a> <a id="980" href="Data.AVL.html#530" class="Bound">isStrictTotalOrder</a>
<a id="999" class="Keyword">import</a> <a id="1006" href="Data.AVL.Indexed.html" class="Module">Data.AVL.Indexed</a> <a id="1023" href="Data.AVL.html#496" class="Bound">Key</a> <a id="1027" href="Data.AVL.html#530" class="Bound">isStrictTotalOrder</a> <a id="1046" class="Symbol">as</a> <a id="Indexed"></a><a id="1049" href="Data.AVL.html#1049" class="Module">Indexed</a>
<a id="1057" class="Keyword">open</a> <a id="1062" href="Data.AVL.html#1049" class="Module">Indexed</a> <a id="1070" class="Keyword">using</a> <a id="1076" class="Symbol">(</a><a id="1077" href="Data.AVL.Indexed.html#806" class="Function Operator">K&amp;_</a> <a id="1081" class="Symbol">;</a> <a id="1083" href="Data.AVL.Key.html#676" class="InductiveConstructor">⊥⁺</a> <a id="1086" class="Symbol">;</a> <a id="1088" href="Data.AVL.Key.html#679" class="InductiveConstructor">⊤⁺</a><a id="1090" class="Symbol">)</a>

<a id="1093" class="Comment">------------------------------------------------------------------------</a>
<a id="1166" class="Comment">-- Types and functions with hidden indices</a>

<a id="1210" class="Keyword">data</a> <a id="Tree"></a><a id="1215" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="1220" class="Symbol">{</a><a id="1221" href="Data.AVL.html#1221" class="Bound">v</a><a id="1222" class="Symbol">}</a> <a id="1224" class="Symbol">(</a><a id="1225" href="Data.AVL.html#1225" class="Bound">V</a> <a id="1227" class="Symbol">:</a> <a id="1229" href="Data.AVL.html#496" class="Bound">Key</a> <a id="1233" class="Symbol">→</a> <a id="1235" class="PrimitiveType">Set</a> <a id="1239" href="Data.AVL.html#1221" class="Bound">v</a><a id="1240" class="Symbol">)</a> <a id="1242" class="Symbol">:</a> <a id="1244" class="PrimitiveType">Set</a> <a id="1248" class="Symbol">(</a><a id="1249" href="Data.AVL.html#490" class="Bound">k</a> <a id="1251" href="Agda.Primitive.html#657" class="Primitive Operator">⊔</a> <a id="1253" href="Data.AVL.html#1221" class="Bound">v</a> <a id="1255" href="Agda.Primitive.html#657" class="Primitive Operator">⊔</a> <a id="1257" href="Data.AVL.html#492" class="Bound">r</a><a id="1258" class="Symbol">)</a> <a id="1260" class="Keyword">where</a>
  <a id="Tree.tree"></a><a id="1268" href="Data.AVL.html#1268" class="InductiveConstructor">tree</a> <a id="1273" class="Symbol">:</a> <a id="1275" class="Symbol">∀</a> <a id="1277" class="Symbol">{</a><a id="1278" href="Data.AVL.html#1278" class="Bound">h</a><a id="1279" class="Symbol">}</a> <a id="1281" class="Symbol">→</a> <a id="1283" href="Data.AVL.Indexed.html#1036" class="Datatype">Indexed.Tree</a> <a id="1296" href="Data.AVL.html#1225" class="Bound">V</a> <a id="1298" href="Data.AVL.Key.html#676" class="InductiveConstructor">⊥⁺</a> <a id="1301" href="Data.AVL.Key.html#679" class="InductiveConstructor">⊤⁺</a> <a id="1304" href="Data.AVL.html#1278" class="Bound">h</a> <a id="1306" class="Symbol">→</a> <a id="1308" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="1313" href="Data.AVL.html#1225" class="Bound">V</a>

<a id="1316" class="Keyword">module</a> <a id="1323" href="Data.AVL.html#1323" class="Module">_</a> <a id="1325" class="Symbol">{</a><a id="1326" href="Data.AVL.html#1326" class="Bound">v</a><a id="1327" class="Symbol">}</a> <a id="1329" class="Symbol">{</a><a id="1330" href="Data.AVL.html#1330" class="Bound">V</a> <a id="1332" class="Symbol">:</a> <a id="1334" href="Data.AVL.html#496" class="Bound">Key</a> <a id="1338" class="Symbol">→</a> <a id="1340" class="PrimitiveType">Set</a> <a id="1344" href="Data.AVL.html#1326" class="Bound">v</a><a id="1345" class="Symbol">}</a> <a id="1347" class="Keyword">where</a>

  <a id="1356" href="Data.AVL.html#1356" class="Function">empty</a> <a id="1362" class="Symbol">:</a> <a id="1364" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="1369" href="Data.AVL.html#1330" class="Bound">V</a>
  <a id="1373" href="Data.AVL.html#1356" class="Function">empty</a> <a id="1379" class="Symbol">=</a> <a id="1381" href="Data.AVL.html#1268" class="InductiveConstructor">tree</a> <a id="1386" class="Symbol">(</a><a id="1387" href="Data.AVL.Indexed.html#8465" class="Function">Indexed.empty</a> <a id="1401" class="Symbol">_)</a>

  <a id="1407" href="Data.AVL.html#1407" class="Function">singleton</a> <a id="1417" class="Symbol">:</a> <a id="1419" class="Symbol">(</a><a id="1420" href="Data.AVL.html#1420" class="Bound">k</a> <a id="1422" class="Symbol">:</a> <a id="1424" href="Data.AVL.html#496" class="Bound">Key</a><a id="1427" class="Symbol">)</a> <a id="1429" class="Symbol">→</a> <a id="1431" href="Data.AVL.html#1330" class="Bound">V</a> <a id="1433" href="Data.AVL.html#1420" class="Bound">k</a> <a id="1435" class="Symbol">→</a> <a id="1437" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="1442" href="Data.AVL.html#1330" class="Bound">V</a>
  <a id="1446" href="Data.AVL.html#1407" class="Function">singleton</a> <a id="1456" href="Data.AVL.html#1456" class="Bound">k</a> <a id="1458" href="Data.AVL.html#1458" class="Bound">v</a> <a id="1460" class="Symbol">=</a> <a id="1462" href="Data.AVL.html#1268" class="InductiveConstructor">tree</a> <a id="1467" class="Symbol">(</a><a id="1468" href="Data.AVL.Indexed.html#8547" class="Function">Indexed.singleton</a> <a id="1486" href="Data.AVL.html#1456" class="Bound">k</a> <a id="1488" href="Data.AVL.html#1458" class="Bound">v</a> <a id="1490" class="Symbol">_)</a>

  <a id="1496" href="Data.AVL.html#1496" class="Function">insert</a> <a id="1503" class="Symbol">:</a> <a id="1505" class="Symbol">(</a><a id="1506" href="Data.AVL.html#1506" class="Bound">k</a> <a id="1508" class="Symbol">:</a> <a id="1510" href="Data.AVL.html#496" class="Bound">Key</a><a id="1513" class="Symbol">)</a> <a id="1515" class="Symbol">→</a> <a id="1517" href="Data.AVL.html#1330" class="Bound">V</a> <a id="1519" href="Data.AVL.html#1506" class="Bound">k</a> <a id="1521" class="Symbol">→</a> <a id="1523" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="1528" href="Data.AVL.html#1330" class="Bound">V</a> <a id="1530" class="Symbol">→</a> <a id="1532" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="1537" href="Data.AVL.html#1330" class="Bound">V</a>
  <a id="1541" href="Data.AVL.html#1496" class="Function">insert</a> <a id="1548" href="Data.AVL.html#1548" class="Bound">k</a> <a id="1550" href="Data.AVL.html#1550" class="Bound">v</a> <a id="1552" class="Symbol">(</a><a id="1553" href="Data.AVL.html#1268" class="InductiveConstructor">tree</a> <a id="1558" href="Data.AVL.html#1558" class="Bound">t</a><a id="1559" class="Symbol">)</a> <a id="1561" class="Symbol">=</a> <a id="1563" href="Data.AVL.html#1268" class="InductiveConstructor">tree</a> <a id="1568" href="Function.html#1891" class="Function Operator">$</a> <a id="1570" href="Agda.Builtin.Sigma.html#167" class="Field">proj₂</a> <a id="1576" href="Function.html#1891" class="Function Operator">$</a> <a id="1578" href="Data.AVL.Indexed.html#9652" class="Function">Indexed.insert</a> <a id="1593" href="Data.AVL.html#1548" class="Bound">k</a> <a id="1595" href="Data.AVL.html#1550" class="Bound">v</a> <a id="1597" href="Data.AVL.html#1558" class="Bound">t</a> <a id="1599" class="Symbol">_</a>

  <a id="1604" href="Data.AVL.html#1604" class="Function">insertWith</a> <a id="1615" class="Symbol">:</a> <a id="1617" class="Symbol">(</a><a id="1618" href="Data.AVL.html#1618" class="Bound">k</a> <a id="1620" class="Symbol">:</a> <a id="1622" href="Data.AVL.html#496" class="Bound">Key</a><a id="1625" class="Symbol">)</a> <a id="1627" class="Symbol">→</a> <a id="1629" href="Data.AVL.html#1330" class="Bound">V</a> <a id="1631" href="Data.AVL.html#1618" class="Bound">k</a> <a id="1633" class="Symbol">→</a> <a id="1635" class="Symbol">(</a><a id="1636" href="Data.AVL.html#1330" class="Bound">V</a> <a id="1638" href="Data.AVL.html#1618" class="Bound">k</a> <a id="1640" class="Symbol">→</a> <a id="1642" href="Data.AVL.html#1330" class="Bound">V</a> <a id="1644" href="Data.AVL.html#1618" class="Bound">k</a> <a id="1646" class="Symbol">→</a> <a id="1648" href="Data.AVL.html#1330" class="Bound">V</a> <a id="1650" href="Data.AVL.html#1618" class="Bound">k</a><a id="1651" class="Symbol">)</a> <a id="1653" class="Symbol">→</a>
               <a id="1670" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="1675" href="Data.AVL.html#1330" class="Bound">V</a> <a id="1677" class="Symbol">→</a> <a id="1679" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="1684" href="Data.AVL.html#1330" class="Bound">V</a>
  <a id="1688" href="Data.AVL.html#1604" class="Function">insertWith</a> <a id="1699" href="Data.AVL.html#1699" class="Bound">k</a> <a id="1701" href="Data.AVL.html#1701" class="Bound">v</a> <a id="1703" href="Data.AVL.html#1703" class="Bound">f</a> <a id="1705" class="Symbol">(</a><a id="1706" href="Data.AVL.html#1268" class="InductiveConstructor">tree</a> <a id="1711" href="Data.AVL.html#1711" class="Bound">t</a><a id="1712" class="Symbol">)</a> <a id="1714" class="Symbol">=</a> <a id="1716" href="Data.AVL.html#1268" class="InductiveConstructor">tree</a> <a id="1721" href="Function.html#1891" class="Function Operator">$</a> <a id="1723" href="Agda.Builtin.Sigma.html#167" class="Field">proj₂</a> <a id="1729" href="Function.html#1891" class="Function Operator">$</a> <a id="1731" href="Data.AVL.Indexed.html#8911" class="Function">Indexed.insertWith</a> <a id="1750" href="Data.AVL.html#1699" class="Bound">k</a> <a id="1752" href="Data.AVL.html#1701" class="Bound">v</a> <a id="1754" href="Data.AVL.html#1703" class="Bound">f</a> <a id="1756" href="Data.AVL.html#1711" class="Bound">t</a> <a id="1758" class="Symbol">_</a>

  <a id="1763" href="Data.AVL.html#1763" class="Function">delete</a> <a id="1770" class="Symbol">:</a> <a id="1772" href="Data.AVL.html#496" class="Bound">Key</a> <a id="1776" class="Symbol">→</a> <a id="1778" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="1783" href="Data.AVL.html#1330" class="Bound">V</a> <a id="1785" class="Symbol">→</a> <a id="1787" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="1792" href="Data.AVL.html#1330" class="Bound">V</a>
  <a id="1796" href="Data.AVL.html#1763" class="Function">delete</a> <a id="1803" href="Data.AVL.html#1803" class="Bound">k</a> <a id="1805" class="Symbol">(</a><a id="1806" href="Data.AVL.html#1268" class="InductiveConstructor">tree</a> <a id="1811" href="Data.AVL.html#1811" class="Bound">t</a><a id="1812" class="Symbol">)</a> <a id="1814" class="Symbol">=</a> <a id="1816" href="Data.AVL.html#1268" class="InductiveConstructor">tree</a> <a id="1821" href="Function.html#1891" class="Function Operator">$</a> <a id="1823" href="Agda.Builtin.Sigma.html#167" class="Field">proj₂</a> <a id="1829" href="Function.html#1891" class="Function Operator">$</a> <a id="1831" href="Data.AVL.Indexed.html#9946" class="Function">Indexed.delete</a> <a id="1846" href="Data.AVL.html#1803" class="Bound">k</a> <a id="1848" href="Data.AVL.html#1811" class="Bound">t</a>

  <a id="1853" href="Data.AVL.html#1853" class="Function">lookup</a> <a id="1860" class="Symbol">:</a> <a id="1862" class="Symbol">(</a><a id="1863" href="Data.AVL.html#1863" class="Bound">k</a> <a id="1865" class="Symbol">:</a> <a id="1867" href="Data.AVL.html#496" class="Bound">Key</a><a id="1870" class="Symbol">)</a> <a id="1872" class="Symbol">→</a> <a id="1874" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="1879" href="Data.AVL.html#1330" class="Bound">V</a> <a id="1881" class="Symbol">→</a> <a id="1883" href="Data.Maybe.Base.html#335" class="Datatype">Maybe</a> <a id="1889" class="Symbol">(</a><a id="1890" href="Data.AVL.html#1330" class="Bound">V</a> <a id="1892" href="Data.AVL.html#1863" class="Bound">k</a><a id="1893" class="Symbol">)</a>
  <a id="1897" href="Data.AVL.html#1853" class="Function">lookup</a> <a id="1904" href="Data.AVL.html#1904" class="Bound">k</a> <a id="1906" class="Symbol">(</a><a id="1907" href="Data.AVL.html#1268" class="InductiveConstructor">tree</a> <a id="1912" href="Data.AVL.html#1912" class="Bound">t</a><a id="1913" class="Symbol">)</a> <a id="1915" class="Symbol">=</a> <a id="1917" href="Data.AVL.Indexed.html#10381" class="Function">Indexed.lookup</a> <a id="1932" href="Data.AVL.html#1904" class="Bound">k</a> <a id="1934" href="Data.AVL.html#1912" class="Bound">t</a>

<a id="1937" class="Keyword">module</a> <a id="1944" href="Data.AVL.html#1944" class="Module">_</a> <a id="1946" class="Symbol">{</a><a id="1947" href="Data.AVL.html#1947" class="Bound">v</a> <a id="1949" href="Data.AVL.html#1949" class="Bound">w</a><a id="1950" class="Symbol">}</a> <a id="1952" class="Symbol">{</a><a id="1953" href="Data.AVL.html#1953" class="Bound">V</a> <a id="1955" class="Symbol">:</a> <a id="1957" href="Data.AVL.html#496" class="Bound">Key</a> <a id="1961" class="Symbol">→</a> <a id="1963" class="PrimitiveType">Set</a> <a id="1967" href="Data.AVL.html#1947" class="Bound">v</a><a id="1968" class="Symbol">}</a> <a id="1970" class="Symbol">{</a><a id="1971" href="Data.AVL.html#1971" class="Bound">W</a> <a id="1973" class="Symbol">:</a> <a id="1975" href="Data.AVL.html#496" class="Bound">Key</a> <a id="1979" class="Symbol">→</a> <a id="1981" class="PrimitiveType">Set</a> <a id="1985" href="Data.AVL.html#1949" class="Bound">w</a><a id="1986" class="Symbol">}</a> <a id="1988" class="Keyword">where</a>

  <a id="1997" href="Data.AVL.html#1997" class="Function">map</a> <a id="2001" class="Symbol">:</a> <a id="2003" class="Symbol">({</a><a id="2005" href="Data.AVL.html#2005" class="Bound">k</a> <a id="2007" class="Symbol">:</a> <a id="2009" href="Data.AVL.html#496" class="Bound">Key</a><a id="2012" class="Symbol">}</a> <a id="2014" class="Symbol">→</a> <a id="2016" href="Data.AVL.html#1953" class="Bound">V</a> <a id="2018" href="Data.AVL.html#2005" class="Bound">k</a> <a id="2020" class="Symbol">→</a> <a id="2022" href="Data.AVL.html#1971" class="Bound">W</a> <a id="2024" href="Data.AVL.html#2005" class="Bound">k</a><a id="2025" class="Symbol">)</a> <a id="2027" class="Symbol">→</a> <a id="2029" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="2034" href="Data.AVL.html#1953" class="Bound">V</a> <a id="2036" class="Symbol">→</a> <a id="2038" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="2043" href="Data.AVL.html#1971" class="Bound">W</a>
  <a id="2047" href="Data.AVL.html#1997" class="Function">map</a> <a id="2051" href="Data.AVL.html#2051" class="Bound">f</a> <a id="2053" class="Symbol">(</a><a id="2054" href="Data.AVL.html#1268" class="InductiveConstructor">tree</a> <a id="2059" href="Data.AVL.html#2059" class="Bound">t</a><a id="2060" class="Symbol">)</a> <a id="2062" class="Symbol">=</a> <a id="2064" href="Data.AVL.html#1268" class="InductiveConstructor">tree</a> <a id="2069" href="Function.html#1891" class="Function Operator">$</a> <a id="2071" href="Data.AVL.Indexed.html#11018" class="Function">Indexed.map</a> <a id="2083" href="Data.AVL.html#2051" class="Bound">f</a> <a id="2085" href="Data.AVL.html#2059" class="Bound">t</a>

<a id="2088" class="Keyword">module</a> <a id="2095" href="Data.AVL.html#2095" class="Module">_</a> <a id="2097" class="Symbol">{</a><a id="2098" href="Data.AVL.html#2098" class="Bound">v</a><a id="2099" class="Symbol">}</a> <a id="2101" class="Symbol">{</a><a id="2102" href="Data.AVL.html#2102" class="Bound">V</a> <a id="2104" class="Symbol">:</a> <a id="2106" href="Data.AVL.html#496" class="Bound">Key</a> <a id="2110" class="Symbol">→</a> <a id="2112" class="PrimitiveType">Set</a> <a id="2116" href="Data.AVL.html#2098" class="Bound">v</a><a id="2117" class="Symbol">}</a> <a id="2119" class="Keyword">where</a>

  <a id="2128" class="Keyword">infix</a> <a id="2134" class="Number">4</a> <a id="2136" href="Data.AVL.html#2144" class="Function Operator">_∈?_</a>

  <a id="2144" href="Data.AVL.html#2144" class="Function Operator">_∈?_</a> <a id="2149" class="Symbol">:</a> <a id="2151" href="Data.AVL.html#496" class="Bound">Key</a> <a id="2155" class="Symbol">→</a> <a id="2157" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="2162" href="Data.AVL.html#2102" class="Bound">V</a> <a id="2164" class="Symbol">→</a> <a id="2166" href="Agda.Builtin.Bool.html#67" class="Datatype">Bool</a>
  <a id="2173" href="Data.AVL.html#2173" class="Bound">k</a> <a id="2175" href="Data.AVL.html#2144" class="Function Operator">∈?</a> <a id="2178" href="Data.AVL.html#2178" class="Bound">t</a> <a id="2180" class="Symbol">=</a> <a id="2182" href="Data.Maybe.Base.html#1046" class="Function">is-just</a> <a id="2190" class="Symbol">(</a><a id="2191" href="Data.AVL.html#1853" class="Function">lookup</a> <a id="2198" href="Data.AVL.html#2173" class="Bound">k</a> <a id="2200" href="Data.AVL.html#2178" class="Bound">t</a><a id="2201" class="Symbol">)</a>

  <a id="2206" href="Data.AVL.html#2206" class="Function">headTail</a> <a id="2215" class="Symbol">:</a> <a id="2217" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="2222" href="Data.AVL.html#2102" class="Bound">V</a> <a id="2224" class="Symbol">→</a> <a id="2226" href="Data.Maybe.Base.html#335" class="Datatype">Maybe</a> <a id="2232" class="Symbol">((</a><a id="2234" href="Data.AVL.Indexed.html#806" class="Function Operator">K&amp;</a> <a id="2237" href="Data.AVL.html#2102" class="Bound">V</a><a id="2238" class="Symbol">)</a> <a id="2240" href="Data.Product.html#1353" class="Function Operator">×</a> <a id="2242" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="2247" href="Data.AVL.html#2102" class="Bound">V</a><a id="2248" class="Symbol">)</a>
  <a id="2252" href="Data.AVL.html#2206" class="Function">headTail</a> <a id="2261" class="Symbol">(</a><a id="2262" href="Data.AVL.html#1268" class="InductiveConstructor">tree</a> <a id="2267" class="Symbol">(</a><a id="2268" href="Data.AVL.Indexed.html#1106" class="InductiveConstructor">Indexed.leaf</a> <a id="2281" class="Symbol">_))</a> <a id="2285" class="Symbol">=</a> <a id="2287" href="Data.Maybe.Base.html#403" class="InductiveConstructor">nothing</a>
  <a id="2297" href="Data.AVL.html#2206" class="CatchallClause Function">headTail</a><a id="2305" class="CatchallClause"> </a><a id="2306" class="CatchallClause Symbol">(</a><a id="2307" href="Data.AVL.html#1268" class="CatchallClause InductiveConstructor">tree</a><a id="2311" class="CatchallClause"> </a><a id="2312" class="CatchallClause Symbol">{</a><a id="2313" class="CatchallClause Argument">h</a><a id="2314" class="CatchallClause"> </a><a id="2315" class="CatchallClause Symbol">=</a><a id="2316" class="CatchallClause"> </a><a id="2317" href="Agda.Builtin.Nat.html#128" class="CatchallClause InductiveConstructor">suc</a><a id="2320" class="CatchallClause"> </a><a id="2321" class="CatchallClause Symbol">_}</a><a id="2323" class="CatchallClause"> </a><a id="2324" href="Data.AVL.html#2324" class="CatchallClause Bound">t</a><a id="2325" class="CatchallClause Symbol">)</a>    <a id="2330" class="Keyword">with</a> <a id="2335" href="Data.AVL.Indexed.html#7042" class="Function">Indexed.headTail</a> <a id="2352" href="Data.AVL.html#2324" class="Bound">t</a>
  <a id="2356" class="Symbol">...</a> <a id="2360" class="Symbol">|</a> <a id="2362" class="Symbol">(</a><a id="2363" href="Data.AVL.html#2363" class="Bound">k</a> <a id="2365" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2367" class="Symbol">_</a> <a id="2369" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2371" class="Symbol">_</a> <a id="2373" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2375" href="Data.AVL.html#2375" class="Bound">t′</a><a id="2377" class="Symbol">)</a> <a id="2379" class="Symbol">=</a> <a id="2381" href="Data.Maybe.Base.html#373" class="InductiveConstructor">just</a> <a id="2386" class="Symbol">(</a><a id="2387" href="Data.AVL.html#2363" class="Bound">k</a> <a id="2389" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2391" href="Data.AVL.html#1268" class="InductiveConstructor">tree</a> <a id="2396" class="Symbol">(</a><a id="2397" href="Data.AVL.Indexed.html#3161" class="Function">Indexed.castˡ</a> <a id="2411" class="Symbol">_</a> <a id="2413" href="Data.AVL.html#2375" class="Bound">t′</a><a id="2415" class="Symbol">))</a>

  <a id="2421" href="Data.AVL.html#2421" class="Function">initLast</a> <a id="2430" class="Symbol">:</a> <a id="2432" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="2437" href="Data.AVL.html#2102" class="Bound">V</a> <a id="2439" class="Symbol">→</a> <a id="2441" href="Data.Maybe.Base.html#335" class="Datatype">Maybe</a> <a id="2447" class="Symbol">(</a><a id="2448" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="2453" href="Data.AVL.html#2102" class="Bound">V</a> <a id="2455" href="Data.Product.html#1353" class="Function Operator">×</a> <a id="2457" class="Symbol">(</a><a id="2458" href="Data.AVL.Indexed.html#806" class="Function Operator">K&amp;</a> <a id="2461" href="Data.AVL.html#2102" class="Bound">V</a><a id="2462" class="Symbol">))</a>
  <a id="2467" href="Data.AVL.html#2421" class="Function">initLast</a> <a id="2476" class="Symbol">(</a><a id="2477" href="Data.AVL.html#1268" class="InductiveConstructor">tree</a> <a id="2482" class="Symbol">(</a><a id="2483" href="Data.AVL.Indexed.html#1106" class="InductiveConstructor">Indexed.leaf</a> <a id="2496" class="Symbol">_))</a> <a id="2500" class="Symbol">=</a> <a id="2502" href="Data.Maybe.Base.html#403" class="InductiveConstructor">nothing</a>
  <a id="2512" href="Data.AVL.html#2421" class="CatchallClause Function">initLast</a><a id="2520" class="CatchallClause"> </a><a id="2521" class="CatchallClause Symbol">(</a><a id="2522" href="Data.AVL.html#1268" class="CatchallClause InductiveConstructor">tree</a><a id="2526" class="CatchallClause"> </a><a id="2527" class="CatchallClause Symbol">{</a><a id="2528" class="CatchallClause Argument">h</a><a id="2529" class="CatchallClause"> </a><a id="2530" class="CatchallClause Symbol">=</a><a id="2531" class="CatchallClause"> </a><a id="2532" href="Agda.Builtin.Nat.html#128" class="CatchallClause InductiveConstructor">suc</a><a id="2535" class="CatchallClause"> </a><a id="2536" class="CatchallClause Symbol">_}</a><a id="2538" class="CatchallClause"> </a><a id="2539" href="Data.AVL.html#2539" class="CatchallClause Bound">t</a><a id="2540" class="CatchallClause Symbol">)</a>    <a id="2545" class="Keyword">with</a> <a id="2550" href="Data.AVL.Indexed.html#7562" class="Function">Indexed.initLast</a> <a id="2567" href="Data.AVL.html#2539" class="Bound">t</a>
  <a id="2571" class="Symbol">...</a> <a id="2575" class="Symbol">|</a> <a id="2577" class="Symbol">(</a><a id="2578" href="Data.AVL.html#2578" class="Bound">k</a> <a id="2580" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2582" class="Symbol">_</a> <a id="2584" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2586" class="Symbol">_</a> <a id="2588" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2590" href="Data.AVL.html#2590" class="Bound">t′</a><a id="2592" class="Symbol">)</a> <a id="2594" class="Symbol">=</a> <a id="2596" href="Data.Maybe.Base.html#373" class="InductiveConstructor">just</a> <a id="2601" class="Symbol">(</a><a id="2602" href="Data.AVL.html#1268" class="InductiveConstructor">tree</a> <a id="2607" class="Symbol">(</a><a id="2608" href="Data.AVL.Indexed.html#3350" class="Function">Indexed.castʳ</a> <a id="2622" href="Data.AVL.html#2590" class="Bound">t′</a> <a id="2625" class="Symbol">_)</a> <a id="2628" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2630" href="Data.AVL.html#2578" class="Bound">k</a><a id="2631" class="Symbol">)</a>

  <a id="2636" class="Comment">-- The input does not need to be ordered.</a>

  <a id="2681" href="Data.AVL.html#2681" class="Function">fromList</a> <a id="2690" class="Symbol">:</a> <a id="2692" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="2697" class="Symbol">(</a><a id="2698" href="Data.AVL.Indexed.html#806" class="Function Operator">K&amp;</a> <a id="2701" href="Data.AVL.html#2102" class="Bound">V</a><a id="2702" class="Symbol">)</a> <a id="2704" class="Symbol">→</a> <a id="2706" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="2711" href="Data.AVL.html#2102" class="Bound">V</a>
  <a id="2715" href="Data.AVL.html#2681" class="Function">fromList</a> <a id="2724" class="Symbol">=</a> <a id="2726" href="Data.List.Base.html#2376" class="Function">List.foldr</a> <a id="2737" class="Symbol">(</a><a id="2738" href="Data.Product.html#3464" class="Function">uncurry</a> <a id="2746" href="Data.AVL.html#1496" class="Function">insert</a><a id="2752" class="Symbol">)</a> <a id="2754" href="Data.AVL.html#1356" class="Function">empty</a>

  <a id="2763" class="Comment">-- Returns an ordered list.</a>

  <a id="2794" href="Data.AVL.html#2794" class="Function">toList</a> <a id="2801" class="Symbol">:</a> <a id="2803" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="2808" href="Data.AVL.html#2102" class="Bound">V</a> <a id="2810" class="Symbol">→</a> <a id="2812" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="2817" class="Symbol">(</a><a id="2818" href="Data.AVL.Indexed.html#806" class="Function Operator">K&amp;</a> <a id="2821" href="Data.AVL.html#2102" class="Bound">V</a><a id="2822" class="Symbol">)</a>
  <a id="2826" href="Data.AVL.html#2794" class="Function">toList</a> <a id="2833" class="Symbol">(</a><a id="2834" href="Data.AVL.html#1268" class="InductiveConstructor">tree</a> <a id="2839" href="Data.AVL.html#2839" class="Bound">t</a><a id="2840" class="Symbol">)</a> <a id="2842" class="Symbol">=</a> <a id="2844" href="Data.DifferenceList.html#800" class="Function">DiffList.toList</a> <a id="2860" class="Symbol">(</a><a id="2861" href="Data.AVL.Indexed.html#10754" class="Function">Indexed.toDiffList</a> <a id="2880" href="Data.AVL.html#2839" class="Bound">t</a><a id="2881" class="Symbol">)</a>

  <a id="2886" class="Comment">-- Naive implementations of union.</a>

  <a id="2924" href="Data.AVL.html#2924" class="Function">unionWith</a> <a id="2934" class="Symbol">:</a> <a id="2936" class="Symbol">(∀</a> <a id="2939" class="Symbol">{</a><a id="2940" href="Data.AVL.html#2940" class="Bound">k</a><a id="2941" class="Symbol">}</a> <a id="2943" class="Symbol">→</a> <a id="2945" href="Data.AVL.html#2102" class="Bound">V</a> <a id="2947" href="Data.AVL.html#2940" class="Bound">k</a> <a id="2949" class="Symbol">→</a> <a id="2951" href="Data.AVL.html#2102" class="Bound">V</a> <a id="2953" href="Data.AVL.html#2940" class="Bound">k</a> <a id="2955" class="Symbol">→</a> <a id="2957" href="Data.AVL.html#2102" class="Bound">V</a> <a id="2959" href="Data.AVL.html#2940" class="Bound">k</a><a id="2960" class="Symbol">)</a> <a id="2962" class="Symbol">→</a>
              <a id="2978" class="Comment">-- Left → right → result.</a>
              <a id="3018" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="3023" href="Data.AVL.html#2102" class="Bound">V</a> <a id="3025" class="Symbol">→</a> <a id="3027" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="3032" href="Data.AVL.html#2102" class="Bound">V</a> <a id="3034" class="Symbol">→</a> <a id="3036" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="3041" href="Data.AVL.html#2102" class="Bound">V</a>
  <a id="3045" href="Data.AVL.html#2924" class="Function">unionWith</a> <a id="3055" href="Data.AVL.html#3055" class="Bound">f</a> <a id="3057" href="Data.AVL.html#3057" class="Bound">t₁</a> <a id="3060" href="Data.AVL.html#3060" class="Bound">t₂</a> <a id="3063" class="Symbol">=</a>
    <a id="3069" href="Data.List.Base.html#2376" class="Function">List.foldr</a> <a id="3080" class="Symbol">(λ</a> <a id="3083" class="Symbol">{</a> <a id="3085" class="Symbol">(</a><a id="3086" href="Data.AVL.html#3086" class="Bound">k</a> <a id="3088" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="3090" href="Data.AVL.html#3090" class="Bound">v</a><a id="3091" class="Symbol">)</a> <a id="3093" class="Symbol">→</a> <a id="3095" href="Data.AVL.html#1604" class="Function">insertWith</a> <a id="3106" href="Data.AVL.html#3086" class="Bound">k</a> <a id="3108" href="Data.AVL.html#3090" class="Bound">v</a> <a id="3110" href="Data.AVL.html#3055" class="Bound">f</a> <a id="3112" class="Symbol">})</a> <a id="3115" href="Data.AVL.html#3060" class="Bound">t₂</a> <a id="3118" class="Symbol">(</a><a id="3119" href="Data.AVL.html#2794" class="Function">toList</a> <a id="3126" href="Data.AVL.html#3057" class="Bound">t₁</a><a id="3128" class="Symbol">)</a>

  <a id="3133" class="Comment">-- Left-biased.</a>

  <a id="3152" href="Data.AVL.html#3152" class="Function">union</a> <a id="3158" class="Symbol">:</a> <a id="3160" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="3165" href="Data.AVL.html#2102" class="Bound">V</a> <a id="3167" class="Symbol">→</a> <a id="3169" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="3174" href="Data.AVL.html#2102" class="Bound">V</a> <a id="3176" class="Symbol">→</a> <a id="3178" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="3183" href="Data.AVL.html#2102" class="Bound">V</a>
  <a id="3187" href="Data.AVL.html#3152" class="Function">union</a> <a id="3193" class="Symbol">=</a> <a id="3195" href="Data.AVL.html#2924" class="Function">unionWith</a> <a id="3205" href="Function.html#1109" class="Function">const</a>

  <a id="3214" href="Data.AVL.html#3214" class="Function">unionsWith</a> <a id="3225" class="Symbol">:</a> <a id="3227" class="Symbol">(∀</a> <a id="3230" class="Symbol">{</a><a id="3231" href="Data.AVL.html#3231" class="Bound">k</a><a id="3232" class="Symbol">}</a> <a id="3234" class="Symbol">→</a> <a id="3236" href="Data.AVL.html#2102" class="Bound">V</a> <a id="3238" href="Data.AVL.html#3231" class="Bound">k</a> <a id="3240" class="Symbol">→</a> <a id="3242" href="Data.AVL.html#2102" class="Bound">V</a> <a id="3244" href="Data.AVL.html#3231" class="Bound">k</a> <a id="3246" class="Symbol">→</a> <a id="3248" href="Data.AVL.html#2102" class="Bound">V</a> <a id="3250" href="Data.AVL.html#3231" class="Bound">k</a><a id="3251" class="Symbol">)</a> <a id="3253" class="Symbol">→</a> <a id="3255" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="3260" class="Symbol">(</a><a id="3261" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="3266" href="Data.AVL.html#2102" class="Bound">V</a><a id="3267" class="Symbol">)</a> <a id="3269" class="Symbol">→</a> <a id="3271" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="3276" href="Data.AVL.html#2102" class="Bound">V</a>
  <a id="3280" href="Data.AVL.html#3214" class="Function">unionsWith</a> <a id="3291" href="Data.AVL.html#3291" class="Bound">f</a> <a id="3293" href="Data.AVL.html#3293" class="Bound">ts</a> <a id="3296" class="Symbol">=</a> <a id="3298" href="Data.List.Base.html#2376" class="Function">List.foldr</a> <a id="3309" class="Symbol">(</a><a id="3310" href="Data.AVL.html#2924" class="Function">unionWith</a> <a id="3320" href="Data.AVL.html#3291" class="Bound">f</a><a id="3321" class="Symbol">)</a> <a id="3323" href="Data.AVL.html#1356" class="Function">empty</a> <a id="3329" href="Data.AVL.html#3293" class="Bound">ts</a>

  <a id="3335" class="Comment">-- Left-biased.</a>

  <a id="3354" href="Data.AVL.html#3354" class="Function">unions</a> <a id="3361" class="Symbol">:</a> <a id="3363" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="3368" class="Symbol">(</a><a id="3369" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="3374" href="Data.AVL.html#2102" class="Bound">V</a><a id="3375" class="Symbol">)</a> <a id="3377" class="Symbol">→</a> <a id="3379" href="Data.AVL.html#1215" class="Datatype">Tree</a> <a id="3384" href="Data.AVL.html#2102" class="Bound">V</a>
  <a id="3388" href="Data.AVL.html#3354" class="Function">unions</a> <a id="3395" class="Symbol">=</a> <a id="3397" href="Data.AVL.html#3214" class="Function">unionsWith</a> <a id="3408" href="Function.html#1109" class="Function">const</a>
</pre></body></html>