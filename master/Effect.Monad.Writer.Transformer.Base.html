<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Effect.Monad.Writer.Transformer.Base</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Basic type and definition of the writer monad transformer</a>
<a id="167" class="Comment">------------------------------------------------------------------------</a>

<a id="241" class="Symbol">{-#</a> <a id="245" class="Keyword">OPTIONS</a> <a id="253" class="Pragma">--cubical-compatible</a> <a id="274" class="Pragma">--safe</a> <a id="281" class="Symbol">#-}</a>

<a id="286" class="Keyword">module</a> <a id="293" href="Effect.Monad.Writer.Transformer.Base.html" class="Module">Effect.Monad.Writer.Transformer.Base</a> <a id="330" class="Keyword">where</a>

<a id="337" class="Keyword">open</a> <a id="342" class="Keyword">import</a> <a id="349" href="Algebra.html" class="Module">Algebra</a> <a id="357" class="Keyword">using</a> <a id="363" class="Symbol">(</a><a id="364" href="Algebra.Bundles.Raw.html#1775" class="Record">RawMonoid</a><a id="373" class="Symbol">)</a>
<a id="375" class="Keyword">open</a> <a id="380" class="Keyword">import</a> <a id="387" href="Data.Product.Base.html" class="Module">Data.Product.Base</a> <a id="405" class="Keyword">using</a> <a id="411" class="Symbol">(</a><a id="412" href="Data.Product.Base.html#1618" class="Function Operator">_×_</a><a id="415" class="Symbol">;</a> <a id="417" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a><a id="420" class="Symbol">;</a> <a id="422" href="Data.Product.Base.html#636" class="Field">proj₁</a><a id="427" class="Symbol">;</a> <a id="429" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="434" class="Symbol">)</a>
<a id="436" class="Keyword">open</a> <a id="441" class="Keyword">import</a> <a id="448" href="Data.Unit.Polymorphic.html" class="Module">Data.Unit.Polymorphic</a> <a id="470" class="Keyword">using</a> <a id="476" class="Symbol">(</a><a id="477" href="Data.Unit.Polymorphic.Base.html#515" class="Function">⊤</a><a id="478" class="Symbol">;</a> <a id="480" href="Data.Unit.Polymorphic.Base.html#559" class="Function">tt</a><a id="482" class="Symbol">)</a>
<a id="484" class="Keyword">open</a> <a id="489" class="Keyword">import</a> <a id="496" href="Effect.Functor.html" class="Module">Effect.Functor</a> <a id="511" class="Keyword">using</a> <a id="517" class="Symbol">(</a><a id="518" href="Effect.Functor.html#602" class="Record">RawFunctor</a><a id="528" class="Symbol">)</a>
<a id="530" class="Keyword">open</a> <a id="535" class="Keyword">import</a> <a id="542" href="Function.Base.html" class="Module">Function.Base</a> <a id="556" class="Keyword">using</a> <a id="562" class="Symbol">(</a><a id="563" href="Function.Base.html#704" class="Function">id</a><a id="565" class="Symbol">;</a> <a id="567" href="Function.Base.html#3626" class="Function Operator">_∘′_</a><a id="571" class="Symbol">)</a>
<a id="573" class="Keyword">open</a> <a id="578" class="Keyword">import</a> <a id="585" href="Level.html" class="Module">Level</a> <a id="591" class="Keyword">using</a> <a id="597" class="Symbol">(</a><a id="598" href="Agda.Primitive.html#742" class="Postulate">Level</a><a id="603" class="Symbol">;</a> <a id="605" href="Agda.Primitive.html#931" class="Primitive">suc</a><a id="608" class="Symbol">;</a> <a id="610" href="Agda.Primitive.html#961" class="Primitive Operator">_⊔_</a><a id="613" class="Symbol">)</a>

<a id="616" class="Keyword">private</a>
  <a id="626" class="Keyword">variable</a>
    <a id="639" href="Effect.Monad.Writer.Transformer.Base.html#639" class="Generalizable">w</a> <a id="641" href="Effect.Monad.Writer.Transformer.Base.html#641" class="Generalizable">f</a> <a id="643" href="Effect.Monad.Writer.Transformer.Base.html#643" class="Generalizable">g</a> <a id="645" class="Symbol">:</a> <a id="647" href="Agda.Primitive.html#742" class="Postulate">Level</a>
    <a id="657" href="Effect.Monad.Writer.Transformer.Base.html#657" class="Generalizable">A</a> <a id="659" class="Symbol">:</a> <a id="661" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="665" href="Effect.Monad.Writer.Transformer.Base.html#643" class="Generalizable">g</a>
    <a id="671" href="Effect.Monad.Writer.Transformer.Base.html#671" class="Generalizable">M</a> <a id="673" class="Symbol">:</a> <a id="675" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="679" href="Effect.Monad.Writer.Transformer.Base.html#639" class="Generalizable">w</a> <a id="681" class="Symbol">→</a> <a id="683" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="687" href="Effect.Monad.Writer.Transformer.Base.html#643" class="Generalizable">g</a>
    <a id="693" href="Effect.Monad.Writer.Transformer.Base.html#693" class="Generalizable">𝕎</a> <a id="695" class="Symbol">:</a> <a id="697" href="Algebra.Bundles.Raw.html#1775" class="Record">RawMonoid</a> <a id="707" href="Effect.Monad.Writer.Transformer.Base.html#639" class="Generalizable">w</a> <a id="709" href="Effect.Monad.Writer.Transformer.Base.html#643" class="Generalizable">g</a>

<a id="712" class="Comment">------------------------------------------------------------------------</a>
<a id="785" class="Comment">-- Writer monad operations</a>

<a id="813" class="Keyword">record</a> <a id="RawMonadWriter"></a><a id="820" href="Effect.Monad.Writer.Transformer.Base.html#820" class="Record">RawMonadWriter</a>
       <a id="842" class="Symbol">(</a><a id="843" href="Effect.Monad.Writer.Transformer.Base.html#843" class="Bound">𝕎</a> <a id="845" class="Symbol">:</a> <a id="847" href="Algebra.Bundles.Raw.html#1775" class="Record">RawMonoid</a> <a id="857" href="Effect.Monad.Writer.Transformer.Base.html#639" class="Generalizable">w</a> <a id="859" href="Effect.Monad.Writer.Transformer.Base.html#641" class="Generalizable">f</a><a id="860" class="Symbol">)</a>
       <a id="869" class="Symbol">(</a><a id="870" href="Effect.Monad.Writer.Transformer.Base.html#870" class="Bound">M</a> <a id="872" class="Symbol">:</a> <a id="874" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="878" href="Effect.Monad.Writer.Transformer.Base.html#639" class="Generalizable">w</a> <a id="880" class="Symbol">→</a> <a id="882" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="886" href="Effect.Monad.Writer.Transformer.Base.html#643" class="Generalizable">g</a><a id="887" class="Symbol">)</a>
       <a id="896" class="Symbol">:</a> <a id="898" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="902" class="Symbol">(</a><a id="903" href="Agda.Primitive.html#931" class="Primitive">suc</a> <a id="907" href="Effect.Monad.Writer.Transformer.Base.html#857" class="Bound">w</a> <a id="909" href="Agda.Primitive.html#961" class="Primitive Operator">⊔</a> <a id="911" href="Effect.Monad.Writer.Transformer.Base.html#886" class="Bound">g</a><a id="912" class="Symbol">)</a> <a id="914" class="Keyword">where</a>
  <a id="922" class="Keyword">open</a> <a id="927" href="Algebra.Bundles.Raw.html#1775" class="Module">RawMonoid</a> <a id="937" href="Effect.Monad.Writer.Transformer.Base.html#843" class="Bound">𝕎</a> <a id="939" class="Keyword">renaming</a> <a id="948" class="Symbol">(</a><a id="949" href="Algebra.Bundles.Raw.html#1857" class="Field">Carrier</a> <a id="957" class="Symbol">to</a> <a id="960" class="Field">W</a><a id="961" class="Symbol">)</a>
  <a id="965" class="Keyword">field</a>
    <a id="RawMonadWriter.writer"></a><a id="975" href="Effect.Monad.Writer.Transformer.Base.html#975" class="Field">writer</a> <a id="982" class="Symbol">:</a> <a id="984" href="Effect.Monad.Writer.Transformer.Base.html#960" class="Function">W</a> <a id="986" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="988" href="Effect.Monad.Writer.Transformer.Base.html#657" class="Generalizable">A</a> <a id="990" class="Symbol">→</a> <a id="992" href="Effect.Monad.Writer.Transformer.Base.html#870" class="Bound">M</a> <a id="994" href="Effect.Monad.Writer.Transformer.Base.html#657" class="Generalizable">A</a>
    <a id="RawMonadWriter.listen"></a><a id="1000" href="Effect.Monad.Writer.Transformer.Base.html#1000" class="Field">listen</a> <a id="1007" class="Symbol">:</a> <a id="1009" href="Effect.Monad.Writer.Transformer.Base.html#870" class="Bound">M</a> <a id="1011" href="Effect.Monad.Writer.Transformer.Base.html#657" class="Generalizable">A</a> <a id="1013" class="Symbol">→</a> <a id="1015" href="Effect.Monad.Writer.Transformer.Base.html#870" class="Bound">M</a> <a id="1017" class="Symbol">(</a><a id="1018" href="Effect.Monad.Writer.Transformer.Base.html#960" class="Function">W</a> <a id="1020" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1022" href="Effect.Monad.Writer.Transformer.Base.html#657" class="Generalizable">A</a><a id="1023" class="Symbol">)</a>
    <a id="RawMonadWriter.pass"></a><a id="1029" href="Effect.Monad.Writer.Transformer.Base.html#1029" class="Field">pass</a>   <a id="1036" class="Symbol">:</a> <a id="1038" href="Effect.Monad.Writer.Transformer.Base.html#870" class="Bound">M</a> <a id="1040" class="Symbol">((</a><a id="1042" href="Effect.Monad.Writer.Transformer.Base.html#960" class="Function">W</a> <a id="1044" class="Symbol">→</a> <a id="1046" href="Effect.Monad.Writer.Transformer.Base.html#960" class="Function">W</a><a id="1047" class="Symbol">)</a> <a id="1049" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1051" href="Effect.Monad.Writer.Transformer.Base.html#657" class="Generalizable">A</a><a id="1052" class="Symbol">)</a> <a id="1054" class="Symbol">→</a> <a id="1056" href="Effect.Monad.Writer.Transformer.Base.html#870" class="Bound">M</a> <a id="1058" href="Effect.Monad.Writer.Transformer.Base.html#657" class="Generalizable">A</a>

  <a id="RawMonadWriter.tell"></a><a id="1063" href="Effect.Monad.Writer.Transformer.Base.html#1063" class="Function">tell</a> <a id="1068" class="Symbol">:</a> <a id="1070" href="Effect.Monad.Writer.Transformer.Base.html#960" class="Function">W</a> <a id="1072" class="Symbol">→</a> <a id="1074" href="Effect.Monad.Writer.Transformer.Base.html#870" class="Bound">M</a> <a id="1076" href="Data.Unit.Polymorphic.Base.html#515" class="Function">⊤</a>
  <a id="1080" href="Effect.Monad.Writer.Transformer.Base.html#1063" class="Function">tell</a> <a id="1085" href="Effect.Monad.Writer.Transformer.Base.html#1085" class="Bound">w</a> <a id="1087" class="Symbol">=</a> <a id="1089" href="Effect.Monad.Writer.Transformer.Base.html#975" class="Field">writer</a> <a id="1096" class="Symbol">(</a><a id="1097" href="Effect.Monad.Writer.Transformer.Base.html#1085" class="Bound">w</a> <a id="1099" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1101" href="Data.Unit.Polymorphic.Base.html#559" class="Function">tt</a><a id="1103" class="Symbol">)</a>

<a id="1106" class="Comment">------------------------------------------------------------------------</a>
<a id="1179" class="Comment">-- Writer monad transformer (CPS-encoded)</a>

<a id="1222" class="Keyword">record</a> <a id="WriterT"></a><a id="1229" href="Effect.Monad.Writer.Transformer.Base.html#1229" class="Record">WriterT</a>
       <a id="1244" class="Symbol">(</a><a id="1245" href="Effect.Monad.Writer.Transformer.Base.html#1245" class="Bound">𝕎</a> <a id="1247" class="Symbol">:</a> <a id="1249" href="Algebra.Bundles.Raw.html#1775" class="Record">RawMonoid</a> <a id="1259" href="Effect.Monad.Writer.Transformer.Base.html#639" class="Generalizable">w</a> <a id="1261" href="Effect.Monad.Writer.Transformer.Base.html#641" class="Generalizable">f</a><a id="1262" class="Symbol">)</a>
       <a id="1271" class="Symbol">(</a><a id="1272" href="Effect.Monad.Writer.Transformer.Base.html#1272" class="Bound">M</a> <a id="1274" class="Symbol">:</a> <a id="1276" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1280" href="Effect.Monad.Writer.Transformer.Base.html#639" class="Generalizable">w</a> <a id="1282" class="Symbol">→</a> <a id="1284" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1288" href="Effect.Monad.Writer.Transformer.Base.html#643" class="Generalizable">g</a><a id="1289" class="Symbol">)</a>
       <a id="1298" class="Symbol">(</a><a id="1299" href="Effect.Monad.Writer.Transformer.Base.html#1299" class="Bound">A</a> <a id="1301" class="Symbol">:</a> <a id="1303" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1307" href="Effect.Monad.Writer.Transformer.Base.html#639" class="Generalizable">w</a><a id="1308" class="Symbol">)</a>
       <a id="1317" class="Symbol">:</a> <a id="1319" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1323" class="Symbol">(</a><a id="1324" href="Effect.Monad.Writer.Transformer.Base.html#1259" class="Bound">w</a> <a id="1326" href="Agda.Primitive.html#961" class="Primitive Operator">⊔</a> <a id="1328" href="Effect.Monad.Writer.Transformer.Base.html#1288" class="Bound">g</a><a id="1329" class="Symbol">)</a> <a id="1331" class="Keyword">where</a>
  <a id="1339" class="Keyword">constructor</a> <a id="mkWriterT"></a><a id="1351" href="Effect.Monad.Writer.Transformer.Base.html#1351" class="InductiveConstructor">mkWriterT</a>
  <a id="1363" class="Keyword">open</a> <a id="1368" href="Algebra.Bundles.Raw.html#1775" class="Module">RawMonoid</a> <a id="1378" href="Effect.Monad.Writer.Transformer.Base.html#1245" class="Bound">𝕎</a> <a id="1380" class="Keyword">renaming</a> <a id="1389" class="Symbol">(</a><a id="1390" href="Algebra.Bundles.Raw.html#1857" class="Field">Carrier</a> <a id="1398" class="Symbol">to</a> <a id="1401" class="Field">W</a><a id="1402" class="Symbol">)</a>
  <a id="1406" class="Keyword">field</a> <a id="WriterT.runWriterT"></a><a id="1412" href="Effect.Monad.Writer.Transformer.Base.html#1412" class="Field">runWriterT</a> <a id="1423" class="Symbol">:</a> <a id="1425" href="Effect.Monad.Writer.Transformer.Base.html#1401" class="Function">W</a> <a id="1427" class="Symbol">→</a> <a id="1429" href="Effect.Monad.Writer.Transformer.Base.html#1272" class="Bound">M</a> <a id="1431" class="Symbol">(</a><a id="1432" href="Effect.Monad.Writer.Transformer.Base.html#1401" class="Function">W</a> <a id="1434" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1436" href="Effect.Monad.Writer.Transformer.Base.html#1299" class="Bound">A</a><a id="1437" class="Symbol">)</a>
<a id="1439" class="Keyword">open</a> <a id="1444" href="Effect.Monad.Writer.Transformer.Base.html#1229" class="Module">WriterT</a> <a id="1452" class="Keyword">public</a>

<a id="1460" class="Keyword">module</a> <a id="1467" href="Effect.Monad.Writer.Transformer.Base.html#1467" class="Module">_</a> <a id="1469" class="Symbol">{</a><a id="1470" href="Effect.Monad.Writer.Transformer.Base.html#1470" class="Bound">𝕎</a> <a id="1472" class="Symbol">:</a> <a id="1474" href="Algebra.Bundles.Raw.html#1775" class="Record">RawMonoid</a> <a id="1484" href="Effect.Monad.Writer.Transformer.Base.html#639" class="Generalizable">w</a> <a id="1486" href="Effect.Monad.Writer.Transformer.Base.html#641" class="Generalizable">f</a><a id="1487" class="Symbol">}</a> <a id="1489" class="Keyword">where</a>

  <a id="1498" class="Keyword">open</a> <a id="1503" href="Algebra.Bundles.Raw.html#1775" class="Module">RawMonoid</a> <a id="1513" href="Effect.Monad.Writer.Transformer.Base.html#1470" class="Bound">𝕎</a> <a id="1515" class="Keyword">renaming</a> <a id="1524" class="Symbol">(</a><a id="1525" href="Algebra.Bundles.Raw.html#1857" class="Field">Carrier</a> <a id="1533" class="Symbol">to</a> <a id="1536" class="Field">W</a><a id="1537" class="Symbol">)</a>

  <a id="1542" href="Effect.Monad.Writer.Transformer.Base.html#1542" class="Function">evalWriterT</a> <a id="1554" class="Symbol">:</a> <a id="1556" href="Effect.Functor.html#602" class="Record">RawFunctor</a> <a id="1567" href="Effect.Monad.Writer.Transformer.Base.html#671" class="Generalizable">M</a> <a id="1569" class="Symbol">→</a> <a id="1571" href="Effect.Monad.Writer.Transformer.Base.html#1229" class="Record">WriterT</a> <a id="1579" href="Effect.Monad.Writer.Transformer.Base.html#1470" class="Bound">𝕎</a> <a id="1581" href="Effect.Monad.Writer.Transformer.Base.html#671" class="Generalizable">M</a> <a id="1583" href="Effect.Monad.Writer.Transformer.Base.html#657" class="Generalizable">A</a> <a id="1585" class="Symbol">→</a> <a id="1587" href="Effect.Monad.Writer.Transformer.Base.html#671" class="Generalizable">M</a> <a id="1589" href="Effect.Monad.Writer.Transformer.Base.html#657" class="Generalizable">A</a>
  <a id="1593" href="Effect.Monad.Writer.Transformer.Base.html#1542" class="Function">evalWriterT</a> <a id="1605" href="Effect.Monad.Writer.Transformer.Base.html#1605" class="Bound">M</a> <a id="1607" href="Effect.Monad.Writer.Transformer.Base.html#1607" class="Bound">ma</a> <a id="1610" class="Symbol">=</a> <a id="1612" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="1618" href="Effect.Functor.html#710" class="Function Operator">&lt;$&gt;</a> <a id="1622" href="Effect.Monad.Writer.Transformer.Base.html#1412" class="Field">runWriterT</a> <a id="1633" href="Effect.Monad.Writer.Transformer.Base.html#1607" class="Bound">ma</a> <a id="1636" href="Algebra.Bundles.Raw.html#1931" class="Field">ε</a>
    <a id="1642" class="Keyword">where</a> <a id="1648" class="Keyword">open</a> <a id="1653" href="Effect.Functor.html#602" class="Module">RawFunctor</a> <a id="1664" href="Effect.Monad.Writer.Transformer.Base.html#1605" class="Bound">M</a>

  <a id="1669" href="Effect.Monad.Writer.Transformer.Base.html#1669" class="Function">execWriterT</a> <a id="1681" class="Symbol">:</a> <a id="1683" href="Effect.Functor.html#602" class="Record">RawFunctor</a> <a id="1694" href="Effect.Monad.Writer.Transformer.Base.html#671" class="Generalizable">M</a> <a id="1696" class="Symbol">→</a> <a id="1698" href="Effect.Monad.Writer.Transformer.Base.html#1229" class="Record">WriterT</a> <a id="1706" href="Effect.Monad.Writer.Transformer.Base.html#1470" class="Bound">𝕎</a> <a id="1708" href="Effect.Monad.Writer.Transformer.Base.html#671" class="Generalizable">M</a> <a id="1710" href="Effect.Monad.Writer.Transformer.Base.html#657" class="Generalizable">A</a> <a id="1712" class="Symbol">→</a> <a id="1714" href="Effect.Monad.Writer.Transformer.Base.html#671" class="Generalizable">M</a> <a id="1716" href="Effect.Monad.Writer.Transformer.Base.html#1536" class="Field">W</a>
  <a id="1720" href="Effect.Monad.Writer.Transformer.Base.html#1669" class="Function">execWriterT</a> <a id="1732" href="Effect.Monad.Writer.Transformer.Base.html#1732" class="Bound">M</a> <a id="1734" href="Effect.Monad.Writer.Transformer.Base.html#1734" class="Bound">ma</a> <a id="1737" class="Symbol">=</a> <a id="1739" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="1745" href="Effect.Functor.html#710" class="Function Operator">&lt;$&gt;</a> <a id="1749" href="Effect.Monad.Writer.Transformer.Base.html#1412" class="Field">runWriterT</a> <a id="1760" href="Effect.Monad.Writer.Transformer.Base.html#1734" class="Bound">ma</a> <a id="1763" href="Algebra.Bundles.Raw.html#1931" class="Field">ε</a>
    <a id="1769" class="Keyword">where</a> <a id="1775" class="Keyword">open</a> <a id="1780" href="Effect.Functor.html#602" class="Module">RawFunctor</a> <a id="1791" href="Effect.Monad.Writer.Transformer.Base.html#1732" class="Bound">M</a>
</pre></body></html>