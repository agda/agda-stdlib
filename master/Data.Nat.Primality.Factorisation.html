<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Nat.Primality.Factorisation</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Prime factorisation of natural numbers and its properties</a>
<a id="167" class="Comment">------------------------------------------------------------------------</a>

<a id="241" class="Symbol">{-#</a> <a id="245" class="Keyword">OPTIONS</a> <a id="253" class="Pragma">--cubical-compatible</a> <a id="274" class="Pragma">--safe</a> <a id="281" class="Symbol">#-}</a>

<a id="286" class="Keyword">module</a> <a id="293" href="Data.Nat.Primality.Factorisation.html" class="Module">Data.Nat.Primality.Factorisation</a> <a id="326" class="Keyword">where</a>

<a id="333" class="Keyword">open</a> <a id="338" class="Keyword">import</a> <a id="345" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="359" class="Keyword">open</a> <a id="364" class="Keyword">import</a> <a id="371" href="Data.Nat.Divisibility.html" class="Module">Data.Nat.Divisibility</a>
  <a id="395" class="Keyword">using</a> <a id="401" class="Symbol">(</a><a id="402" href="Data.Nat.Divisibility.html#4316" class="Function Operator">_∣?_</a><a id="406" class="Symbol">;</a> <a id="408" href="Data.Nat.Divisibility.Core.html#1215" class="Field">quotient</a><a id="416" class="Symbol">;</a> <a id="418" href="Data.Nat.Divisibility.html#1959" class="Function">quotient&gt;1</a><a id="428" class="Symbol">;</a> <a id="430" href="Data.Nat.Divisibility.html#2242" class="Function">quotient-&lt;</a><a id="440" class="Symbol">;</a> <a id="442" href="Data.Nat.Divisibility.html#1852" class="Function">quotient-∣</a><a id="452" class="Symbol">;</a> <a id="454" href="Data.Nat.Divisibility.html#1713" class="Function">m∣n⇒n≡m*quotient</a><a id="470" class="Symbol">;</a> <a id="472" href="Data.Nat.Divisibility.Core.html#1159" class="Record Operator">_∣_</a><a id="475" class="Symbol">;</a> <a id="477" href="Data.Nat.Divisibility.html#5586" class="Function">∣1⇒≡1</a><a id="482" class="Symbol">;</a>
        <a id="492" href="Data.Nat.Divisibility.Core.html#1199" class="InductiveConstructor">divides</a><a id="499" class="Symbol">)</a>
<a id="501" class="Keyword">open</a> <a id="506" class="Keyword">import</a> <a id="513" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a>
<a id="533" class="Keyword">open</a> <a id="538" class="Keyword">import</a> <a id="545" href="Data.Nat.Induction.html" class="Module">Data.Nat.Induction</a> <a id="564" class="Keyword">using</a> <a id="570" class="Symbol">(</a><a id="571" href="Data.Nat.Induction.html#2147" class="Function">&lt;-Rec</a><a id="576" class="Symbol">;</a> <a id="578" href="Data.Nat.Induction.html#3201" class="Function">&lt;-rec</a><a id="583" class="Symbol">;</a> <a id="585" href="Data.Nat.Induction.html#3157" class="Function">&lt;-recBuilder</a><a id="597" class="Symbol">)</a>
<a id="599" class="Keyword">open</a> <a id="604" class="Keyword">import</a> <a id="611" href="Data.Nat.ListAction.html" class="Module">Data.Nat.ListAction</a> <a id="631" class="Keyword">using</a> <a id="637" class="Symbol">(</a><a id="638" href="Data.Nat.ListAction.html#648" class="Function">product</a><a id="645" class="Symbol">)</a>
<a id="647" class="Keyword">open</a> <a id="652" class="Keyword">import</a> <a id="659" href="Data.Nat.ListAction.Properties.html" class="Module">Data.Nat.ListAction.Properties</a> <a id="690" class="Keyword">using</a> <a id="696" class="Symbol">(</a><a id="697" href="Data.Nat.ListAction.Properties.html#2862" class="Function">product-↭</a><a id="706" class="Symbol">)</a>
<a id="708" class="Keyword">open</a> <a id="713" class="Keyword">import</a> <a id="720" href="Data.Nat.Primality.html" class="Module">Data.Nat.Primality</a>
  <a id="741" class="Keyword">using</a> <a id="747" class="Symbol">(</a><a id="748" href="Data.Nat.Primality.html#3199" class="Record">Prime</a><a id="753" class="Symbol">;</a> <a id="755" href="Data.Nat.Primality.html#2302" class="Function Operator">_Rough_</a><a id="762" class="Symbol">;</a> <a id="764" href="Data.Nat.Primality.html#10381" class="Function">rough∧square&gt;⇒prime</a><a id="783" class="Symbol">;</a> <a id="785" href="Data.Nat.Primality.html#4409" class="Function">∤⇒rough-suc</a><a id="796" class="Symbol">;</a> <a id="798" href="Data.Nat.Primality.html#4696" class="Function">rough∧∣⇒rough</a><a id="811" class="Symbol">;</a> <a id="813" href="Data.Nat.Primality.html#10200" class="Function">rough∧∣⇒prime</a><a id="826" class="Symbol">;</a>
         <a id="837" href="Data.Nat.Primality.html#4095" class="Function">2-rough</a><a id="844" class="Symbol">;</a> <a id="846" href="Data.Nat.Primality.html#8465" class="Function">euclidsLemma</a><a id="858" class="Symbol">;</a> <a id="860" href="Data.Nat.Primality.html#13219" class="Function">prime⇒irreducible</a><a id="877" class="Symbol">;</a> <a id="879" href="Data.Nat.Primality.html#7077" class="Function">¬prime[1]</a><a id="888" class="Symbol">;</a> <a id="890" href="Data.Nat.Primality.html#11479" class="Function">productOfPrimes≥1</a><a id="907" class="Symbol">;</a> <a id="909" href="Data.Nat.Primality.html#7158" class="Function">prime⇒nonZero</a><a id="922" class="Symbol">)</a>
<a id="924" class="Keyword">open</a> <a id="929" class="Keyword">import</a> <a id="936" href="Data.Product.Base.html" class="Module">Data.Product.Base</a> <a id="954" class="Keyword">using</a> <a id="960" class="Symbol">(</a><a id="961" href="Data.Product.Base.html#1371" class="Function">∃-syntax</a><a id="969" class="Symbol">;</a> <a id="971" href="Data.Product.Base.html#1618" class="Function Operator">_×_</a><a id="974" class="Symbol">;</a> <a id="976" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a><a id="979" class="Symbol">;</a> <a id="981" href="Data.Product.Base.html#636" class="Field">proj₁</a><a id="986" class="Symbol">;</a> <a id="988" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="993" class="Symbol">)</a>
<a id="995" class="Keyword">open</a> <a id="1000" class="Keyword">import</a> <a id="1007" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="1022" class="Keyword">using</a> <a id="1028" class="Symbol">(</a><a id="1029" href="Agda.Builtin.List.html#147" class="Datatype">List</a><a id="1033" class="Symbol">;</a> <a id="1035" href="Data.List.Base.html#7301" class="InductiveConstructor">[]</a><a id="1037" class="Symbol">;</a> <a id="1039" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">_∷_</a><a id="1042" class="Symbol">;</a> <a id="1044" href="Data.List.Base.html#1712" class="Function Operator">_++_</a><a id="1048" class="Symbol">)</a>
<a id="1050" class="Keyword">open</a> <a id="1055" class="Keyword">import</a> <a id="1062" href="Data.List.Membership.Propositional.html" class="Module">Data.List.Membership.Propositional</a> <a id="1097" class="Keyword">using</a> <a id="1103" class="Symbol">(</a><a id="1104" href="Data.List.Membership.Setoid.html#925" class="Function Operator">_∈_</a><a id="1107" class="Symbol">)</a>
<a id="1109" class="Keyword">open</a> <a id="1114" class="Keyword">import</a> <a id="1121" href="Data.List.Membership.Propositional.Properties.html" class="Module">Data.List.Membership.Propositional.Properties</a> <a id="1167" class="Keyword">using</a> <a id="1173" class="Symbol">(</a><a id="1174" href="Data.List.Membership.Propositional.Properties.html#5079" class="Function">∈-∃++</a><a id="1179" class="Symbol">)</a>
<a id="1181" class="Keyword">open</a> <a id="1186" class="Keyword">import</a> <a id="1193" href="Data.List.Relation.Unary.All.html" class="Module">Data.List.Relation.Unary.All</a> <a id="1222" class="Symbol">as</a> <a id="1225" class="Module">All</a> <a id="1229" class="Keyword">using</a> <a id="1235" class="Symbol">(</a><a id="1236" href="Data.List.Relation.Unary.All.html#1644" class="Datatype">All</a><a id="1239" class="Symbol">;</a> <a id="1241" href="Data.List.Relation.Unary.All.html#1707" class="InductiveConstructor">[]</a><a id="1243" class="Symbol">;</a> <a id="1245" href="Data.List.Relation.Unary.All.html#1724" class="InductiveConstructor Operator">_∷_</a><a id="1248" class="Symbol">)</a>
<a id="1250" class="Keyword">open</a> <a id="1255" class="Keyword">import</a> <a id="1262" href="Data.List.Relation.Unary.Any.html" class="Module">Data.List.Relation.Unary.Any</a> <a id="1291" class="Keyword">using</a> <a id="1297" class="Symbol">(</a><a id="1298" href="Data.List.Relation.Unary.Any.html#1211" class="InductiveConstructor">here</a><a id="1302" class="Symbol">;</a> <a id="1304" href="Data.List.Relation.Unary.Any.html#1264" class="InductiveConstructor">there</a><a id="1309" class="Symbol">)</a>
<a id="1311" class="Keyword">open</a> <a id="1316" class="Keyword">import</a> <a id="1323" href="Data.List.Relation.Binary.Permutation.Propositional.html" class="Module">Data.List.Relation.Binary.Permutation.Propositional</a>
  <a id="1377" class="Keyword">using</a> <a id="1383" class="Symbol">(</a><a id="1384" href="Data.List.Relation.Binary.Permutation.Propositional.html#1513" class="Datatype Operator">_↭_</a><a id="1387" class="Symbol">;</a> <a id="1389" href="Data.List.Relation.Binary.Permutation.Propositional.html#1976" class="Function">↭-reflexive</a><a id="1400" class="Symbol">;</a> <a id="1402" href="Data.List.Relation.Binary.Permutation.Propositional.html#1715" class="Function">↭-refl</a><a id="1408" class="Symbol">;</a> <a id="1410" href="Data.List.Relation.Binary.Permutation.Propositional.html#2395" class="Function">↭-trans</a><a id="1417" class="Symbol">;</a> <a id="1419" class="Keyword">module</a> <a id="1426" href="Data.List.Relation.Binary.Permutation.Propositional.html#3505" class="Module">PermutationReasoning</a><a id="1446" class="Symbol">)</a>
<a id="1448" class="Keyword">open</a> <a id="1453" class="Keyword">import</a> <a id="1460" href="Data.List.Relation.Binary.Permutation.Propositional.Properties.html" class="Module">Data.List.Relation.Binary.Permutation.Propositional.Properties</a>
  <a id="1525" class="Keyword">using</a> <a id="1531" class="Symbol">(</a><a id="1532" href="Data.List.Relation.Binary.Permutation.Propositional.Properties.html#2981" class="Function">All-resp-↭</a><a id="1542" class="Symbol">;</a> <a id="1544" href="Data.List.Relation.Binary.Permutation.Propositional.Properties.html#7368" class="Function">shift</a><a id="1549" class="Symbol">)</a>
<a id="1551" class="Keyword">open</a> <a id="1556" class="Keyword">import</a> <a id="1563" href="Data.Sum.Base.html" class="Module">Data.Sum.Base</a> <a id="1577" class="Keyword">using</a> <a id="1583" class="Symbol">(</a><a id="1584" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a><a id="1588" class="Symbol">;</a> <a id="1590" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a><a id="1594" class="Symbol">)</a>
<a id="1596" class="Keyword">open</a> <a id="1601" class="Keyword">import</a> <a id="1608" href="Function.Base.html" class="Module">Function.Base</a> <a id="1622" class="Keyword">using</a> <a id="1628" class="Symbol">(</a><a id="1629" href="Function.Base.html#1974" class="Function Operator">_$_</a><a id="1632" class="Symbol">;</a> <a id="1634" href="Function.Base.html#1115" class="Function Operator">_∘_</a><a id="1637" class="Symbol">;</a> <a id="1639" href="Function.Base.html#2127" class="Function Operator">_|&gt;_</a><a id="1643" class="Symbol">;</a> <a id="1645" href="Function.Base.html#1638" class="Function">flip</a><a id="1649" class="Symbol">)</a>
<a id="1651" class="Keyword">open</a> <a id="1656" class="Keyword">import</a> <a id="1663" href="Induction.html" class="Module">Induction</a> <a id="1673" class="Keyword">using</a> <a id="1679" class="Symbol">(</a><a id="1680" href="Induction.html#1485" class="Function">build</a><a id="1685" class="Symbol">)</a>
<a id="1687" class="Keyword">open</a> <a id="1692" class="Keyword">import</a> <a id="1699" href="Induction.Lexicographic.html" class="Module">Induction.Lexicographic</a> <a id="1723" class="Keyword">using</a> <a id="1729" class="Symbol">(</a><a id="1730" href="Induction.Lexicographic.html#791" class="Function Operator">_⊗_</a><a id="1733" class="Symbol">;</a> <a id="1735" href="Induction.Lexicographic.html#1764" class="Function Operator">[_⊗_]</a><a id="1740" class="Symbol">)</a>
<a id="1742" class="Keyword">open</a> <a id="1747" class="Keyword">import</a> <a id="1754" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="1781" class="Keyword">using</a> <a id="1787" class="Symbol">(</a><a id="1788" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a><a id="1791" class="Symbol">;</a> <a id="1793" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a><a id="1795" class="Symbol">)</a>
<a id="1797" class="Keyword">open</a> <a id="1802" class="Keyword">import</a> <a id="1809" href="Relation.Nullary.Negation.html" class="Module">Relation.Nullary.Negation</a> <a id="1835" class="Keyword">using</a> <a id="1841" class="Symbol">(</a><a id="1842" href="Relation.Nullary.Negation.Core.html#1270" class="Function">contradiction</a><a id="1855" class="Symbol">)</a>
<a id="1857" class="Keyword">open</a> <a id="1862" class="Keyword">import</a> <a id="1869" href="Relation.Binary.PropositionalEquality.Core.html" class="Module">Relation.Binary.PropositionalEquality.Core</a>
  <a id="1914" class="Keyword">using</a> <a id="1920" class="Symbol">(</a><a id="1921" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="1924" class="Symbol">;</a> <a id="1926" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="1930" class="Symbol">;</a> <a id="1932" href="Relation.Binary.PropositionalEquality.Core.html#1893" class="Function">sym</a><a id="1935" class="Symbol">;</a> <a id="1937" href="Relation.Binary.PropositionalEquality.Core.html#1938" class="Function">trans</a><a id="1942" class="Symbol">;</a> <a id="1944" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a><a id="1948" class="Symbol">)</a>
<a id="1950" class="Keyword">open</a> <a id="1955" class="Keyword">import</a> <a id="1962" href="Relation.Binary.PropositionalEquality.Properties.html" class="Module">Relation.Binary.PropositionalEquality.Properties</a>
  <a id="2013" class="Keyword">using</a> <a id="2019" class="Symbol">(</a><a id="2020" class="Keyword">module</a> <a id="2027" href="Relation.Binary.PropositionalEquality.Properties.html#6731" class="Module">≡-Reasoning</a><a id="2038" class="Symbol">)</a>

<a id="2041" class="Keyword">private</a>
  <a id="2051" class="Keyword">variable</a>
    <a id="2064" href="Data.Nat.Primality.Factorisation.html#2064" class="Generalizable">n</a> <a id="2066" class="Symbol">:</a> <a id="2068" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

<a id="2071" class="Comment">------------------------------------------------------------------------</a>
<a id="2144" class="Comment">-- Core definition</a>

<a id="2164" class="Keyword">record</a> <a id="PrimeFactorisation"></a><a id="2171" href="Data.Nat.Primality.Factorisation.html#2171" class="Record">PrimeFactorisation</a> <a id="2190" class="Symbol">(</a><a id="2191" href="Data.Nat.Primality.Factorisation.html#2191" class="Bound">n</a> <a id="2193" class="Symbol">:</a> <a id="2195" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="2196" class="Symbol">)</a> <a id="2198" class="Symbol">:</a> <a id="2200" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2204" class="Keyword">where</a>
  <a id="2212" class="Keyword">field</a>
    <a id="PrimeFactorisation.factors"></a><a id="2222" href="Data.Nat.Primality.Factorisation.html#2222" class="Field">factors</a> <a id="2230" class="Symbol">:</a> <a id="2232" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2237" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
    <a id="PrimeFactorisation.isFactorisation"></a><a id="2243" href="Data.Nat.Primality.Factorisation.html#2243" class="Field">isFactorisation</a> <a id="2259" class="Symbol">:</a> <a id="2261" href="Data.Nat.Primality.Factorisation.html#2191" class="Bound">n</a> <a id="2263" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="2265" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="2273" href="Data.Nat.Primality.Factorisation.html#2222" class="Field">factors</a>
    <a id="PrimeFactorisation.factorsPrime"></a><a id="2285" href="Data.Nat.Primality.Factorisation.html#2285" class="Field">factorsPrime</a> <a id="2298" class="Symbol">:</a> <a id="2300" href="Data.List.Relation.Unary.All.html#1644" class="Datatype">All</a> <a id="2304" href="Data.Nat.Primality.html#3199" class="Record">Prime</a> <a id="2310" href="Data.Nat.Primality.Factorisation.html#2222" class="Field">factors</a>

<a id="2319" class="Keyword">open</a> <a id="2324" href="Data.Nat.Primality.Factorisation.html#2171" class="Module">PrimeFactorisation</a> <a id="2343" class="Keyword">public</a> <a id="2350" class="Keyword">using</a> <a id="2356" class="Symbol">(</a><a id="2357" href="Data.Nat.Primality.Factorisation.html#2222" class="Field">factors</a><a id="2364" class="Symbol">)</a>
<a id="2366" class="Keyword">open</a> <a id="2371" href="Data.Nat.Primality.Factorisation.html#2171" class="Module">PrimeFactorisation</a>

<a id="2391" class="Comment">------------------------------------------------------------------------</a>
<a id="2464" class="Comment">-- Finding a factorisation</a>

<a id="primeFactorisation[1]"></a><a id="2492" href="Data.Nat.Primality.Factorisation.html#2492" class="Function">primeFactorisation[1]</a> <a id="2514" class="Symbol">:</a> <a id="2516" href="Data.Nat.Primality.Factorisation.html#2171" class="Record">PrimeFactorisation</a> <a id="2535" class="Number">1</a>
<a id="2537" href="Data.Nat.Primality.Factorisation.html#2492" class="Function">primeFactorisation[1]</a> <a id="2559" class="Symbol">=</a> <a id="2561" class="Keyword">record</a>
  <a id="2570" class="Symbol">{</a> <a id="2572" href="Data.Nat.Primality.Factorisation.html#2222" class="Field">factors</a> <a id="2580" class="Symbol">=</a> <a id="2582" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
  <a id="2587" class="Symbol">;</a> <a id="2589" href="Data.Nat.Primality.Factorisation.html#2243" class="Field">isFactorisation</a> <a id="2605" class="Symbol">=</a> <a id="2607" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="2614" class="Symbol">;</a> <a id="2616" href="Data.Nat.Primality.Factorisation.html#2285" class="Field">factorsPrime</a> <a id="2629" class="Symbol">=</a> <a id="2631" href="Data.List.Relation.Unary.All.html#1707" class="InductiveConstructor">[]</a>
  <a id="2636" class="Symbol">}</a>

<a id="primeFactorisation[p]"></a><a id="2639" href="Data.Nat.Primality.Factorisation.html#2639" class="Function">primeFactorisation[p]</a> <a id="2661" class="Symbol">:</a> <a id="2663" href="Data.Nat.Primality.html#3199" class="Record">Prime</a> <a id="2669" href="Data.Nat.Primality.Factorisation.html#2064" class="Generalizable">n</a> <a id="2671" class="Symbol">→</a> <a id="2673" href="Data.Nat.Primality.Factorisation.html#2171" class="Record">PrimeFactorisation</a> <a id="2692" href="Data.Nat.Primality.Factorisation.html#2064" class="Generalizable">n</a>
<a id="2694" href="Data.Nat.Primality.Factorisation.html#2639" class="Function">primeFactorisation[p]</a> <a id="2716" class="Symbol">{</a><a id="2717" href="Data.Nat.Primality.Factorisation.html#2717" class="Bound">n</a><a id="2718" class="Symbol">}</a> <a id="2720" href="Data.Nat.Primality.Factorisation.html#2720" class="Bound">pr</a> <a id="2723" class="Symbol">=</a> <a id="2725" class="Keyword">record</a>
  <a id="2734" class="Symbol">{</a> <a id="2736" href="Data.Nat.Primality.Factorisation.html#2222" class="Field">factors</a> <a id="2744" class="Symbol">=</a> <a id="2746" href="Data.Nat.Primality.Factorisation.html#2717" class="Bound">n</a> <a id="2748" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2750" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
  <a id="2755" class="Symbol">;</a> <a id="2757" href="Data.Nat.Primality.Factorisation.html#2243" class="Field">isFactorisation</a> <a id="2773" class="Symbol">=</a> <a id="2775" href="Relation.Binary.PropositionalEquality.Core.html#1893" class="Function">sym</a> <a id="2779" class="Symbol">(</a><a id="2780" href="Data.Nat.Properties.html#21929" class="Function">*-identityʳ</a> <a id="2792" href="Data.Nat.Primality.Factorisation.html#2717" class="Bound">n</a><a id="2793" class="Symbol">)</a>
  <a id="2797" class="Symbol">;</a> <a id="2799" href="Data.Nat.Primality.Factorisation.html#2285" class="Field">factorsPrime</a> <a id="2812" class="Symbol">=</a> <a id="2814" href="Data.Nat.Primality.Factorisation.html#2720" class="Bound">pr</a> <a id="2817" href="Data.List.Relation.Unary.All.html#1724" class="InductiveConstructor Operator">∷</a> <a id="2819" href="Data.List.Relation.Unary.All.html#1707" class="InductiveConstructor">[]</a>
  <a id="2824" class="Symbol">}</a>

<a id="2827" class="Comment">-- This builds up three important things:</a>
<a id="2869" class="Comment">-- * a proof that every number we&#39;ve gotten to so far has increasingly higher</a>
<a id="2947" class="Comment">--   possible least prime factor, so we don&#39;t have to repeat smaller factors</a>
<a id="3024" class="Comment">--   over and over (this is the &quot;m&quot; and &quot;rough&quot; parameters)</a>
<a id="3084" class="Comment">-- * a witness that this limit is getting closer to the number of interest, in a</a>
<a id="3165" class="Comment">--   way that helps the termination checker (the &quot;k&quot; and &quot;eq&quot; parameters)</a>
<a id="3239" class="Comment">-- * a proof that we can factorise any smaller number, which is useful when we</a>
<a id="3318" class="Comment">--   encounter a factor, as we can then divide by that factor and continue from</a>
<a id="3398" class="Comment">--   there without termination issues</a>
<a id="factorise"></a><a id="3436" href="Data.Nat.Primality.Factorisation.html#3436" class="Function">factorise</a> <a id="3446" class="Symbol">:</a> <a id="3448" class="Symbol">∀</a> <a id="3450" href="Data.Nat.Primality.Factorisation.html#3450" class="Bound">n</a> <a id="3452" class="Symbol">→</a> <a id="3454" class="Symbol">.{{</a><a id="3457" href="Data.Nat.Base.html#3266" class="Record">NonZero</a> <a id="3465" href="Data.Nat.Primality.Factorisation.html#3450" class="Bound">n</a><a id="3466" class="Symbol">}}</a> <a id="3469" class="Symbol">→</a> <a id="3471" href="Data.Nat.Primality.Factorisation.html#2171" class="Record">PrimeFactorisation</a> <a id="3490" href="Data.Nat.Primality.Factorisation.html#3450" class="Bound">n</a>
<a id="3492" href="Data.Nat.Primality.Factorisation.html#3436" class="Function">factorise</a> <a id="3502" class="Number">1</a> <a id="3504" class="Symbol">=</a> <a id="3506" href="Data.Nat.Primality.Factorisation.html#2492" class="Function">primeFactorisation[1]</a>
<a id="3528" href="Data.Nat.Primality.Factorisation.html#3436" class="Function">factorise</a> <a id="3538" href="Data.Nat.Primality.Factorisation.html#3538" class="Bound">n₀</a><a id="3540" class="Symbol">@(</a><a id="3542" href="Data.Nat.Base.html#1101" class="InductiveConstructor">2+</a> <a id="3545" class="Symbol">_)</a> <a id="3548" class="Symbol">=</a> <a id="3550" href="Induction.html#1485" class="Function">build</a> <a id="3556" href="Induction.Lexicographic.html#1764" class="Function Operator">[</a> <a id="3558" href="Data.Nat.Induction.html#3157" class="Function">&lt;-recBuilder</a> <a id="3571" href="Induction.Lexicographic.html#1764" class="Function Operator">⊗</a> <a id="3573" href="Data.Nat.Induction.html#3157" class="Function">&lt;-recBuilder</a> <a id="3586" href="Induction.Lexicographic.html#1764" class="Function Operator">]</a> <a id="3588" href="Data.Nat.Primality.Factorisation.html#3638" class="Function">P</a> <a id="3590" href="Data.Nat.Primality.Factorisation.html#3772" class="Function">facRec</a> <a id="3597" class="Symbol">(</a><a id="3598" href="Data.Nat.Primality.Factorisation.html#3538" class="Bound">n₀</a> <a id="3601" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3603" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3607" href="Data.Nat.Primality.Factorisation.html#3538" class="Bound">n₀</a> <a id="3610" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="3612" class="Number">4</a><a id="3613" class="Symbol">)</a> <a id="3615" href="Data.Nat.Primality.html#4095" class="Function">2-rough</a> <a id="3623" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="3630" class="Keyword">where</a>
  <a id="3638" href="Data.Nat.Primality.Factorisation.html#3638" class="Function">P</a> <a id="3640" class="Symbol">:</a> <a id="3642" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3644" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3646" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3648" class="Symbol">→</a> <a id="3650" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="3656" href="Data.Nat.Primality.Factorisation.html#3638" class="Function">P</a> <a id="3658" class="Symbol">(</a><a id="3659" href="Data.Nat.Primality.Factorisation.html#3659" class="Bound">n</a> <a id="3661" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3663" href="Data.Nat.Primality.Factorisation.html#3663" class="Bound">k</a><a id="3664" class="Symbol">)</a> <a id="3666" class="Symbol">=</a> <a id="3668" class="Symbol">∀</a> <a id="3670" class="Symbol">{</a><a id="3671" href="Data.Nat.Primality.Factorisation.html#3671" class="Bound">m</a><a id="3672" class="Symbol">}</a> <a id="3674" class="Symbol">→</a> <a id="3676" class="Symbol">.{{</a><a id="3679" href="Data.Nat.Base.html#3801" class="Record">NonTrivial</a> <a id="3690" href="Data.Nat.Primality.Factorisation.html#3659" class="Bound">n</a><a id="3691" class="Symbol">}}</a> <a id="3694" class="Symbol">→</a> <a id="3696" class="Symbol">.{{</a><a id="3699" href="Data.Nat.Base.html#3801" class="Record">NonTrivial</a> <a id="3710" href="Data.Nat.Primality.Factorisation.html#3671" class="Bound">m</a><a id="3711" class="Symbol">}}</a> <a id="3714" class="Symbol">→</a> <a id="3716" href="Data.Nat.Primality.Factorisation.html#3671" class="Bound">m</a> <a id="3718" href="Data.Nat.Primality.html#2302" class="Function Operator">Rough</a> <a id="3724" href="Data.Nat.Primality.Factorisation.html#3659" class="Bound">n</a> <a id="3726" class="Symbol">→</a> <a id="3728" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3732" href="Data.Nat.Primality.Factorisation.html#3659" class="Bound">n</a> <a id="3734" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="3736" href="Data.Nat.Primality.Factorisation.html#3671" class="Bound">m</a> <a id="3738" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="3740" href="Data.Nat.Primality.Factorisation.html#3671" class="Bound">m</a> <a id="3742" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3744" href="Data.Nat.Primality.Factorisation.html#3663" class="Bound">k</a> <a id="3746" class="Symbol">→</a> <a id="3748" href="Data.Nat.Primality.Factorisation.html#2171" class="Record">PrimeFactorisation</a> <a id="3767" href="Data.Nat.Primality.Factorisation.html#3659" class="Bound">n</a>

  <a id="3772" href="Data.Nat.Primality.Factorisation.html#3772" class="Function">facRec</a> <a id="3779" class="Symbol">:</a> <a id="3781" class="Symbol">∀</a> <a id="3783" href="Data.Nat.Primality.Factorisation.html#3783" class="Bound">n×k</a> <a id="3787" class="Symbol">→</a> <a id="3789" class="Symbol">(</a><a id="3790" href="Data.Nat.Induction.html#2147" class="Function">&lt;-Rec</a> <a id="3796" href="Induction.Lexicographic.html#791" class="Function Operator">⊗</a> <a id="3798" href="Data.Nat.Induction.html#2147" class="Function">&lt;-Rec</a><a id="3803" class="Symbol">)</a> <a id="3805" href="Data.Nat.Primality.Factorisation.html#3638" class="Function">P</a> <a id="3807" href="Data.Nat.Primality.Factorisation.html#3783" class="Bound">n×k</a> <a id="3811" class="Symbol">→</a> <a id="3813" href="Data.Nat.Primality.Factorisation.html#3638" class="Function">P</a> <a id="3815" href="Data.Nat.Primality.Factorisation.html#3783" class="Bound">n×k</a>
  <a id="3821" href="Data.Nat.Primality.Factorisation.html#3772" class="Function">facRec</a> <a id="3828" class="Symbol">(</a><a id="3829" href="Data.Nat.Primality.Factorisation.html#3829" class="Bound">n</a> <a id="3831" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3833" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a><a id="3837" class="Symbol">)</a> <a id="3839" class="Symbol">_</a> <a id="3841" href="Data.Nat.Primality.Factorisation.html#3841" class="Bound">rough</a> <a id="3847" href="Data.Nat.Primality.Factorisation.html#3847" class="Bound">eq</a> <a id="3850" class="Symbol">=</a>
  <a id="3854" class="Comment">-- Case 1: m * m &gt; n, ∴ Prime n</a>
    <a id="3890" href="Data.Nat.Primality.Factorisation.html#2639" class="Function">primeFactorisation[p]</a> <a id="3912" class="Symbol">(</a><a id="3913" href="Data.Nat.Primality.html#10381" class="Function">rough∧square&gt;⇒prime</a> <a id="3933" href="Data.Nat.Primality.Factorisation.html#3841" class="Bound">rough</a> <a id="3939" class="Symbol">(</a><a id="3940" href="Data.Nat.Properties.html#49086" class="Function">m∸n≡0⇒m≤n</a> <a id="3950" href="Data.Nat.Primality.Factorisation.html#3847" class="Bound">eq</a><a id="3952" class="Symbol">))</a>
  <a id="3957" href="Data.Nat.Primality.Factorisation.html#3772" class="Function">facRec</a> <a id="3964" class="Symbol">(</a><a id="3965" href="Data.Nat.Primality.Factorisation.html#3965" class="Bound">n</a><a id="3966" class="Symbol">@(</a><a id="3968" href="Data.Nat.Base.html#1101" class="InductiveConstructor">2+</a> <a id="3971" class="Symbol">_)</a> <a id="3974" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3976" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3980" href="Data.Nat.Primality.Factorisation.html#3980" class="Bound">k</a><a id="3981" class="Symbol">)</a> <a id="3983" class="Symbol">(</a><a id="3984" href="Data.Nat.Primality.Factorisation.html#3984" class="Bound">recFactor</a> <a id="3994" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3996" href="Data.Nat.Primality.Factorisation.html#3996" class="Bound">recQuotient</a><a id="4007" class="Symbol">)</a> <a id="4009" class="Symbol">{</a><a id="4010" href="Data.Nat.Primality.Factorisation.html#4010" class="Bound">m</a><a id="4011" class="Symbol">@(</a><a id="4013" href="Data.Nat.Base.html#1101" class="InductiveConstructor">2+</a> <a id="4016" class="Symbol">_)}</a> <a id="4020" href="Data.Nat.Primality.Factorisation.html#4020" class="Bound">rough</a> <a id="4026" href="Data.Nat.Primality.Factorisation.html#4026" class="Bound">eq</a> <a id="4029" class="Keyword">with</a> <a id="4034" href="Data.Nat.Primality.Factorisation.html#4010" class="Bound">m</a> <a id="4036" href="Data.Nat.Divisibility.html#4316" class="Function Operator">∣?</a> <a id="4039" href="Data.Nat.Primality.Factorisation.html#3965" class="Bound">n</a>
  <a id="4043" class="Comment">-- Case 2: m ∤ n, try larger m, reducing k accordingly</a>
  <a id="4100" class="Symbol">...</a> <a id="4104" class="Symbol">|</a> <a id="4106" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="4109" href="Data.Nat.Primality.Factorisation.html#4109" class="Bound">m∤n</a> <a id="4113" class="Symbol">=</a> <a id="4115" class="Bound">recFactor</a> <a id="4125" class="Symbol">(</a><a id="4126" href="Data.Nat.Properties.html#10937" class="Function">≤-&lt;-trans</a> <a id="4136" class="Symbol">(</a><a id="4137" href="Data.Nat.Properties.html#46966" class="Function">m∸n≤m</a> <a id="4143" class="Bound">k</a> <a id="4145" class="Symbol">(</a><a id="4146" class="Bound">m</a> <a id="4148" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4150" class="Bound">m</a><a id="4151" class="Symbol">))</a> <a id="4154" class="Symbol">(</a><a id="4155" href="Data.Nat.Properties.html#13134" class="Function">n&lt;1+n</a> <a id="4161" class="Bound">k</a><a id="4162" class="Symbol">))</a> <a id="4165" class="Symbol">{</a><a id="4166" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4170" class="Bound">m</a><a id="4171" class="Symbol">}</a> <a id="4173" class="Symbol">(</a><a id="4174" href="Data.Nat.Primality.html#4409" class="Function">∤⇒rough-suc</a> <a id="4186" href="Data.Nat.Primality.Factorisation.html#4109" class="Bound">m∤n</a> <a id="4190" class="Bound">rough</a><a id="4195" class="Symbol">)</a> <a id="4197" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="4199" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
    <a id="4209" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4213" class="Bound">n</a> <a id="4215" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="4217" class="Symbol">(</a><a id="4218" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4222" class="Bound">m</a> <a id="4224" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4226" class="Bound">m</a> <a id="4228" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="4230" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4234" class="Bound">m</a><a id="4235" class="Symbol">)</a>   <a id="4239" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="4242" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a> <a id="4247" class="Symbol">(λ</a> <a id="4250" href="Data.Nat.Primality.Factorisation.html#4250" class="Bound">#</a> <a id="4252" class="Symbol">→</a> <a id="4254" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4258" class="Bound">n</a> <a id="4260" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="4262" class="Symbol">(</a><a id="4263" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4267" class="Bound">m</a> <a id="4269" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4271" href="Data.Nat.Primality.Factorisation.html#4250" class="Bound">#</a><a id="4272" class="Symbol">))</a> <a id="4275" class="Symbol">(</a><a id="4276" href="Data.Nat.Properties.html#21301" class="Function">*-suc</a> <a id="4282" class="Bound">m</a> <a id="4284" class="Bound">m</a><a id="4285" class="Symbol">)</a> <a id="4287" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
    <a id="4293" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4297" class="Bound">n</a> <a id="4299" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="4301" class="Symbol">(</a><a id="4302" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4306" class="Bound">m</a> <a id="4308" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4310" class="Symbol">(</a><a id="4311" class="Bound">m</a> <a id="4313" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4315" class="Bound">m</a> <a id="4317" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="4319" class="Bound">m</a><a id="4320" class="Symbol">))</a> <a id="4323" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">≡⟨</a> <a id="4326" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a> <a id="4331" class="Symbol">(</a><a id="4332" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4336" class="Bound">n</a> <a id="4338" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸_</a><a id="4340" class="Symbol">)</a> <a id="4342" class="Symbol">(</a><a id="4343" href="Data.Nat.Properties.html#15404" class="Function">+-assoc</a> <a id="4351" class="Symbol">(</a><a id="4352" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4356" class="Bound">m</a><a id="4357" class="Symbol">)</a> <a id="4359" class="Bound">m</a> <a id="4361" class="Symbol">(</a><a id="4362" class="Bound">m</a> <a id="4364" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="4366" class="Bound">m</a><a id="4367" class="Symbol">))</a> <a id="4370" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">⟨</a>
    <a id="4376" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4380" class="Bound">n</a> <a id="4382" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="4384" class="Symbol">(</a><a id="4385" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4389" class="Symbol">(</a><a id="4390" class="Bound">m</a> <a id="4392" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4394" class="Bound">m</a><a id="4395" class="Symbol">)</a> <a id="4397" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4399" class="Bound">m</a> <a id="4401" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="4403" class="Bound">m</a><a id="4404" class="Symbol">)</a> <a id="4406" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="4409" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a> <a id="4414" class="Symbol">(</a><a id="4415" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4419" class="Bound">n</a> <a id="4421" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸_</a><a id="4423" class="Symbol">)</a> <a id="4425" class="Symbol">(</a><a id="4426" href="Data.Nat.Properties.html#15737" class="Function">+-comm</a> <a id="4433" class="Symbol">(</a><a id="4434" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4438" class="Symbol">(</a><a id="4439" class="Bound">m</a> <a id="4441" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4443" class="Bound">m</a><a id="4444" class="Symbol">))</a> <a id="4447" class="Symbol">(</a><a id="4448" class="Bound">m</a> <a id="4450" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="4452" class="Bound">m</a><a id="4453" class="Symbol">))</a> <a id="4456" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
    <a id="4462" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4466" class="Bound">n</a> <a id="4468" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="4470" class="Symbol">(</a><a id="4471" class="Bound">m</a> <a id="4473" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="4475" class="Bound">m</a> <a id="4477" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4479" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4483" class="Symbol">(</a><a id="4484" class="Bound">m</a> <a id="4486" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4488" class="Bound">m</a><a id="4489" class="Symbol">))</a> <a id="4492" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">≡⟨</a> <a id="4495" href="Data.Nat.Properties.html#50077" class="Function">∸-+-assoc</a> <a id="4505" class="Symbol">(</a><a id="4506" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4510" class="Bound">n</a><a id="4511" class="Symbol">)</a> <a id="4513" class="Symbol">(</a><a id="4514" class="Bound">m</a> <a id="4516" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="4518" class="Bound">m</a><a id="4519" class="Symbol">)</a> <a id="4521" class="Symbol">(</a><a id="4522" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4526" class="Symbol">(</a><a id="4527" class="Bound">m</a> <a id="4529" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4531" class="Bound">m</a><a id="4532" class="Symbol">))</a> <a id="4535" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">⟨</a>
    <a id="4541" class="Symbol">(</a><a id="4542" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4546" class="Bound">n</a> <a id="4548" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="4550" class="Bound">m</a> <a id="4552" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="4554" class="Bound">m</a><a id="4555" class="Symbol">)</a> <a id="4557" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="4559" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4563" class="Symbol">(</a><a id="4564" class="Bound">m</a> <a id="4566" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4568" class="Bound">m</a><a id="4569" class="Symbol">)</a> <a id="4571" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="4574" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a> <a id="4579" class="Symbol">(</a><a id="4580" href="Data.Nat.Base.html#4462" class="Primitive Operator">_∸</a> <a id="4583" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4587" class="Symbol">(</a><a id="4588" class="Bound">m</a> <a id="4590" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4592" class="Bound">m</a><a id="4593" class="Symbol">))</a> <a id="4596" class="Bound">eq</a> <a id="4599" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
    <a id="4605" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4609" class="Bound">k</a> <a id="4611" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="4613" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4617" class="Symbol">(</a><a id="4618" class="Bound">m</a> <a id="4620" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4622" class="Bound">m</a><a id="4623" class="Symbol">)</a>           <a id="4635" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
    <a id="4641" class="Keyword">where</a> <a id="4647" class="Keyword">open</a> <a id="4652" href="Relation.Binary.PropositionalEquality.Properties.html#6731" class="Module">≡-Reasoning</a>
  <a id="4666" class="Comment">-- Case 3: m ∣ n, record m and recurse on the quotient</a>
  <a id="4723" class="Symbol">...</a> <a id="4727" class="Symbol">|</a> <a id="4729" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a> <a id="4733" href="Data.Nat.Primality.Factorisation.html#4733" class="Bound">m∣n</a> <a id="4737" class="Symbol">=</a> <a id="4739" class="Keyword">record</a>
    <a id="4750" class="Symbol">{</a> <a id="4752" href="Data.Nat.Primality.Factorisation.html#2222" class="Field">factors</a> <a id="4760" class="Symbol">=</a> <a id="4762" class="Bound">m</a> <a id="4764" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4766" href="Data.Nat.Primality.Factorisation.html#5378" class="Function">ps</a>
    <a id="4773" class="Symbol">;</a> <a id="4775" href="Data.Nat.Primality.Factorisation.html#2243" class="Field">isFactorisation</a> <a id="4791" class="Symbol">=</a> <a id="4793" href="Relation.Binary.PropositionalEquality.Core.html#1893" class="Function">sym</a> <a id="4797" href="Data.Nat.Primality.Factorisation.html#5461" class="Function">m*Πps≡n</a>
    <a id="4809" class="Symbol">;</a> <a id="4811" href="Data.Nat.Primality.Factorisation.html#2285" class="Field">factorsPrime</a> <a id="4824" class="Symbol">=</a> <a id="4826" href="Data.Nat.Primality.html#10200" class="Function">rough∧∣⇒prime</a> <a id="4840" class="Bound">rough</a> <a id="4846" href="Data.Nat.Primality.Factorisation.html#4733" class="Bound">m∣n</a> <a id="4850" href="Data.List.Relation.Unary.All.html#1724" class="InductiveConstructor Operator">∷</a> <a id="4852" href="Data.Nat.Primality.Factorisation.html#5415" class="Function">primes</a>
    <a id="4863" class="Symbol">}</a>
    <a id="4869" class="Keyword">where</a>
      <a id="4881" href="Data.Nat.Primality.Factorisation.html#4881" class="Function">m&lt;n</a> <a id="4885" class="Symbol">:</a> <a id="4887" class="Bound">m</a> <a id="4889" href="Data.Nat.Base.html#1807" class="Function Operator">&lt;</a> <a id="4891" class="Bound">n</a>
      <a id="4899" href="Data.Nat.Primality.Factorisation.html#4881" class="Function">m&lt;n</a> <a id="4903" class="Symbol">=</a> <a id="4905" href="Relation.Binary.Reasoning.Syntax.html#3008" class="Function Operator">begin-strict</a>
        <a id="4926" class="Bound">m</a>            <a id="4939" href="Relation.Binary.Reasoning.Syntax.html#5689" class="Function">&lt;⟨</a> <a id="4942" href="Data.Nat.Base.html#1762" class="InductiveConstructor">s≤s</a> <a id="4946" class="Symbol">(</a><a id="4947" href="Data.Nat.Properties.html#6125" class="Function">≤-trans</a> <a id="4955" class="Symbol">(</a><a id="4956" href="Data.Nat.Properties.html#19356" class="Function">m≤n+m</a> <a id="4962" class="Bound">m</a> <a id="4964" class="Symbol">_)</a> <a id="4967" class="Symbol">(</a><a id="4968" href="Data.Nat.Properties.html#19937" class="Function">+-monoʳ-≤</a> <a id="4978" class="Symbol">_</a> <a id="4980" class="Symbol">(</a><a id="4981" href="Data.Nat.Properties.html#19273" class="Function">m≤m+n</a> <a id="4987" class="Bound">m</a> <a id="4989" class="Symbol">_)))</a> <a id="4994" href="Relation.Binary.Reasoning.Syntax.html#5689" class="Function">⟩</a>
        <a id="5004" href="Data.Nat.Base.html#5272" class="Function">pred</a> <a id="5009" class="Symbol">(</a><a id="5010" class="Bound">m</a> <a id="5012" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="5014" class="Bound">m</a><a id="5015" class="Symbol">)</a> <a id="5017" href="Relation.Binary.Reasoning.Syntax.html#5689" class="Function">&lt;⟨</a> <a id="5020" href="Data.Nat.Base.html#2091" class="Function">s&lt;s⁻¹</a> <a id="5026" class="Symbol">(</a><a id="5027" href="Data.Nat.Properties.html#49440" class="Function">m∸n≢0⇒n&lt;m</a> <a id="5037" class="Symbol">λ</a> <a id="5039" href="Data.Nat.Primality.Factorisation.html#5039" class="Bound">eq′</a> <a id="5043" class="Symbol">→</a> <a id="5045" href="Data.Nat.Properties.html#4396" class="Function">0≢1+n</a> <a id="5051" class="Symbol">(</a><a id="5052" href="Relation.Binary.PropositionalEquality.Core.html#1938" class="Function">trans</a> <a id="5058" class="Symbol">(</a><a id="5059" href="Relation.Binary.PropositionalEquality.Core.html#1893" class="Function">sym</a> <a id="5063" href="Data.Nat.Primality.Factorisation.html#5039" class="Bound">eq′</a><a id="5066" class="Symbol">)</a> <a id="5068" class="Bound">eq</a><a id="5070" class="Symbol">))</a> <a id="5073" href="Relation.Binary.Reasoning.Syntax.html#5689" class="Function">⟩</a>
        <a id="5083" class="Bound">n</a>            <a id="5096" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
        <a id="5106" class="Keyword">where</a> <a id="5112" class="Keyword">open</a> <a id="5117" href="Data.Nat.Properties.html#14787" class="Module">≤-Reasoning</a>

      <a id="5136" href="Data.Nat.Primality.Factorisation.html#5136" class="Function">q</a> <a id="5138" class="Symbol">=</a> <a id="5140" href="Data.Nat.Divisibility.Core.html#1215" class="Field">quotient</a> <a id="5149" href="Data.Nat.Primality.Factorisation.html#4733" class="Bound">m∣n</a>

      <a id="5160" class="Keyword">instance</a> <a id="5169" href="Data.Nat.Primality.Factorisation.html#5169" class="Function">_</a>  <a id="5172" class="Symbol">=</a> <a id="5174" href="Data.Nat.Base.html#3968" class="Function">n&gt;1⇒nonTrivial</a> <a id="5189" class="Symbol">(</a><a id="5190" href="Data.Nat.Divisibility.html#1959" class="Function">quotient&gt;1</a> <a id="5201" href="Data.Nat.Primality.Factorisation.html#4733" class="Bound">m∣n</a> <a id="5205" href="Data.Nat.Primality.Factorisation.html#4881" class="Function">m&lt;n</a><a id="5208" class="Symbol">)</a>

      <a id="5217" href="Data.Nat.Primality.Factorisation.html#5217" class="Function">factorisation[q]</a> <a id="5234" class="Symbol">:</a> <a id="5236" href="Data.Nat.Primality.Factorisation.html#2171" class="Record">PrimeFactorisation</a> <a id="5255" href="Data.Nat.Primality.Factorisation.html#5136" class="Function">q</a>
      <a id="5263" href="Data.Nat.Primality.Factorisation.html#5217" class="Function">factorisation[q]</a> <a id="5280" class="Symbol">=</a> <a id="5282" class="Bound">recQuotient</a> <a id="5294" class="Symbol">(</a><a id="5295" href="Data.Nat.Divisibility.html#2242" class="Function">quotient-&lt;</a> <a id="5306" href="Data.Nat.Primality.Factorisation.html#4733" class="Bound">m∣n</a><a id="5309" class="Symbol">)</a> <a id="5311" class="Symbol">(</a><a id="5312" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="5316" href="Data.Nat.Primality.Factorisation.html#5136" class="Function">q</a> <a id="5318" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="5320" class="Bound">m</a> <a id="5322" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="5324" class="Bound">m</a><a id="5325" class="Symbol">)</a> <a id="5327" class="Symbol">(</a><a id="5328" href="Data.Nat.Primality.html#4696" class="Function">rough∧∣⇒rough</a> <a id="5342" class="Bound">rough</a> <a id="5348" class="Symbol">(</a><a id="5349" href="Data.Nat.Divisibility.html#1852" class="Function">quotient-∣</a> <a id="5360" href="Data.Nat.Primality.Factorisation.html#4733" class="Bound">m∣n</a><a id="5363" class="Symbol">))</a> <a id="5366" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

      <a id="5378" href="Data.Nat.Primality.Factorisation.html#5378" class="Function">ps</a> <a id="5381" class="Symbol">=</a> <a id="5383" href="Data.Nat.Primality.Factorisation.html#2222" class="Field">factors</a> <a id="5391" href="Data.Nat.Primality.Factorisation.html#5217" class="Function">factorisation[q]</a>

      <a id="5415" href="Data.Nat.Primality.Factorisation.html#5415" class="Function">primes</a> <a id="5422" class="Symbol">=</a> <a id="5424" href="Data.Nat.Primality.Factorisation.html#2285" class="Field">factorsPrime</a> <a id="5437" href="Data.Nat.Primality.Factorisation.html#5217" class="Function">factorisation[q]</a>

      <a id="5461" href="Data.Nat.Primality.Factorisation.html#5461" class="Function">m*Πps≡n</a> <a id="5469" class="Symbol">:</a> <a id="5471" class="Bound">m</a> <a id="5473" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="5475" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="5483" href="Data.Nat.Primality.Factorisation.html#5378" class="Function">ps</a> <a id="5486" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="5488" class="Bound">n</a>
      <a id="5496" href="Data.Nat.Primality.Factorisation.html#5461" class="Function">m*Πps≡n</a> <a id="5504" class="Symbol">=</a> <a id="5506" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
        <a id="5520" class="Bound">m</a> <a id="5522" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="5524" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="5532" href="Data.Nat.Primality.Factorisation.html#5378" class="Function">ps</a> <a id="5535" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">≡⟨</a> <a id="5538" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a> <a id="5543" class="Symbol">(</a><a id="5544" class="Bound">m</a> <a id="5546" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*_</a><a id="5548" class="Symbol">)</a> <a id="5550" class="Symbol">(</a><a id="5551" href="Data.Nat.Primality.Factorisation.html#2243" class="Field">isFactorisation</a> <a id="5567" href="Data.Nat.Primality.Factorisation.html#5217" class="Function">factorisation[q]</a><a id="5583" class="Symbol">)</a> <a id="5585" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">⟨</a>
        <a id="5595" class="Bound">m</a> <a id="5597" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="5599" href="Data.Nat.Primality.Factorisation.html#5136" class="Function">q</a>          <a id="5610" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">≡⟨</a> <a id="5613" href="Data.Nat.Divisibility.html#1713" class="Function">m∣n⇒n≡m*quotient</a> <a id="5630" href="Data.Nat.Primality.Factorisation.html#4733" class="Bound">m∣n</a> <a id="5634" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">⟨</a>
        <a id="5644" class="Bound">n</a>              <a id="5659" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
        <a id="5669" class="Keyword">where</a> <a id="5675" class="Keyword">open</a> <a id="5680" href="Relation.Binary.PropositionalEquality.Properties.html#6731" class="Module">≡-Reasoning</a>

<a id="5693" class="Comment">------------------------------------------------------------------------</a>
<a id="5766" class="Comment">-- Properties of a factorisation</a>

<a id="factorisationHasAllPrimeFactors"></a><a id="5800" href="Data.Nat.Primality.Factorisation.html#5800" class="Function">factorisationHasAllPrimeFactors</a> <a id="5832" class="Symbol">:</a> <a id="5834" class="Symbol">∀</a> <a id="5836" class="Symbol">{</a><a id="5837" href="Data.Nat.Primality.Factorisation.html#5837" class="Bound">as</a><a id="5839" class="Symbol">}</a> <a id="5841" class="Symbol">{</a><a id="5842" href="Data.Nat.Primality.Factorisation.html#5842" class="Bound">p</a><a id="5843" class="Symbol">}</a> <a id="5845" class="Symbol">→</a> <a id="5847" href="Data.Nat.Primality.html#3199" class="Record">Prime</a> <a id="5853" href="Data.Nat.Primality.Factorisation.html#5842" class="Bound">p</a> <a id="5855" class="Symbol">→</a> <a id="5857" href="Data.Nat.Primality.Factorisation.html#5842" class="Bound">p</a> <a id="5859" href="Data.Nat.Divisibility.Core.html#1159" class="Record Operator">∣</a> <a id="5861" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="5869" href="Data.Nat.Primality.Factorisation.html#5837" class="Bound">as</a> <a id="5872" class="Symbol">→</a> <a id="5874" href="Data.List.Relation.Unary.All.html#1644" class="Datatype">All</a> <a id="5878" href="Data.Nat.Primality.html#3199" class="Record">Prime</a> <a id="5884" href="Data.Nat.Primality.Factorisation.html#5837" class="Bound">as</a> <a id="5887" class="Symbol">→</a> <a id="5889" href="Data.Nat.Primality.Factorisation.html#5842" class="Bound">p</a> <a id="5891" href="Data.List.Membership.Setoid.html#925" class="Function Operator">∈</a> <a id="5893" href="Data.Nat.Primality.Factorisation.html#5837" class="Bound">as</a>
<a id="5896" href="Data.Nat.Primality.Factorisation.html#5800" class="Function">factorisationHasAllPrimeFactors</a> <a id="5928" class="Symbol">{</a><a id="5929" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5931" class="Symbol">}</a> <a id="5933" class="Symbol">{</a><a id="5934" href="Data.Nat.Base.html#1101" class="InductiveConstructor">2+</a> <a id="5937" href="Data.Nat.Primality.Factorisation.html#5937" class="Bound">p</a><a id="5938" class="Symbol">}</a> <a id="5940" href="Data.Nat.Primality.Factorisation.html#5940" class="Bound">pPrime</a> <a id="5947" href="Data.Nat.Primality.Factorisation.html#5947" class="Bound">p∣Πas</a> <a id="5953" href="Data.List.Relation.Unary.All.html#1707" class="InductiveConstructor">[]</a> <a id="5956" class="Symbol">=</a> <a id="5958" href="Relation.Nullary.Negation.Core.html#1270" class="Function">contradiction</a> <a id="5972" class="Symbol">(</a><a id="5973" href="Data.Nat.Divisibility.html#5586" class="Function">∣1⇒≡1</a> <a id="5979" href="Data.Nat.Primality.Factorisation.html#5947" class="Bound">p∣Πas</a><a id="5984" class="Symbol">)</a> <a id="5986" class="Symbol">λ</a> <a id="5988" class="Symbol">()</a>
<a id="5991" href="Data.Nat.Primality.Factorisation.html#5800" class="Function">factorisationHasAllPrimeFactors</a> <a id="6023" class="Symbol">{</a><a id="6024" href="Data.Nat.Primality.Factorisation.html#6024" class="Bound">a</a> <a id="6026" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6028" href="Data.Nat.Primality.Factorisation.html#6028" class="Bound">as</a><a id="6030" class="Symbol">}</a> <a id="6032" class="Symbol">{</a><a id="6033" href="Data.Nat.Primality.Factorisation.html#6033" class="Bound">p</a><a id="6034" class="Symbol">}</a> <a id="6036" href="Data.Nat.Primality.Factorisation.html#6036" class="Bound">pPrime</a> <a id="6043" href="Data.Nat.Primality.Factorisation.html#6043" class="Bound">p∣aΠas</a> <a id="6050" class="Symbol">(</a><a id="6051" href="Data.Nat.Primality.Factorisation.html#6051" class="Bound">aPrime</a> <a id="6058" href="Data.List.Relation.Unary.All.html#1724" class="InductiveConstructor Operator">∷</a> <a id="6060" href="Data.Nat.Primality.Factorisation.html#6060" class="Bound">asPrime</a><a id="6067" class="Symbol">)</a> <a id="6069" class="Keyword">with</a> <a id="6074" href="Data.Nat.Primality.html#8465" class="Function">euclidsLemma</a> <a id="6087" href="Data.Nat.Primality.Factorisation.html#6024" class="Bound">a</a> <a id="6089" class="Symbol">(</a><a id="6090" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="6098" href="Data.Nat.Primality.Factorisation.html#6028" class="Bound">as</a><a id="6100" class="Symbol">)</a> <a id="6102" href="Data.Nat.Primality.Factorisation.html#6036" class="Bound">pPrime</a> <a id="6109" href="Data.Nat.Primality.Factorisation.html#6043" class="Bound">p∣aΠas</a>
<a id="6116" class="Symbol">...</a> <a id="6120" class="Symbol">|</a> <a id="6122" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="6127" href="Data.Nat.Primality.Factorisation.html#6127" class="Bound">p∣Πas</a> <a id="6133" class="Symbol">=</a> <a id="6135" href="Data.List.Relation.Unary.Any.html#1264" class="InductiveConstructor">there</a> <a id="6141" class="Symbol">(</a><a id="6142" href="Data.Nat.Primality.Factorisation.html#5800" class="Function">factorisationHasAllPrimeFactors</a> <a id="6174" class="Bound">pPrime</a> <a id="6181" href="Data.Nat.Primality.Factorisation.html#6127" class="Bound">p∣Πas</a> <a id="6187" class="Bound">asPrime</a><a id="6194" class="Symbol">)</a>
<a id="6196" class="Symbol">...</a> <a id="6200" class="Symbol">|</a> <a id="6202" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="6207" href="Data.Nat.Primality.Factorisation.html#6207" class="Bound">p∣a</a> <a id="6211" class="Keyword">with</a> <a id="6216" href="Data.Nat.Primality.html#13219" class="Function">prime⇒irreducible</a> <a id="6234" class="Bound">aPrime</a> <a id="6241" href="Data.Nat.Primality.Factorisation.html#6207" class="Bound">p∣a</a>
<a id="6245" class="Symbol">...</a>   <a id="6251" class="Symbol">|</a> <a id="6253" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="6258" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="6263" class="Symbol">=</a> <a id="6265" href="Relation.Nullary.Negation.Core.html#1270" class="Function">contradiction</a> <a id="6279" class="Bound">pPrime</a> <a id="6286" href="Data.Nat.Primality.html#7077" class="Function">¬prime[1]</a>
<a id="6296" class="Symbol">...</a>   <a id="6302" class="Symbol">|</a> <a id="6304" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="6309" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="6314" class="Symbol">=</a> <a id="6316" href="Data.List.Relation.Unary.Any.html#1211" class="InductiveConstructor">here</a> <a id="6321" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="6327" class="Keyword">private</a>
  <a id="factorisationUnique′"></a><a id="6337" href="Data.Nat.Primality.Factorisation.html#6337" class="Function">factorisationUnique′</a> <a id="6358" class="Symbol">:</a> <a id="6360" class="Symbol">(</a><a id="6361" href="Data.Nat.Primality.Factorisation.html#6361" class="Bound">as</a> <a id="6364" href="Data.Nat.Primality.Factorisation.html#6364" class="Bound">bs</a> <a id="6367" class="Symbol">:</a> <a id="6369" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="6374" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="6375" class="Symbol">)</a> <a id="6377" class="Symbol">→</a> <a id="6379" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="6387" href="Data.Nat.Primality.Factorisation.html#6361" class="Bound">as</a> <a id="6390" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="6392" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="6400" href="Data.Nat.Primality.Factorisation.html#6364" class="Bound">bs</a> <a id="6403" class="Symbol">→</a> <a id="6405" href="Data.List.Relation.Unary.All.html#1644" class="Datatype">All</a> <a id="6409" href="Data.Nat.Primality.html#3199" class="Record">Prime</a> <a id="6415" href="Data.Nat.Primality.Factorisation.html#6361" class="Bound">as</a> <a id="6418" class="Symbol">→</a> <a id="6420" href="Data.List.Relation.Unary.All.html#1644" class="Datatype">All</a> <a id="6424" href="Data.Nat.Primality.html#3199" class="Record">Prime</a> <a id="6430" href="Data.Nat.Primality.Factorisation.html#6364" class="Bound">bs</a> <a id="6433" class="Symbol">→</a> <a id="6435" href="Data.Nat.Primality.Factorisation.html#6361" class="Bound">as</a> <a id="6438" href="Data.List.Relation.Binary.Permutation.Propositional.html#1513" class="Datatype Operator">↭</a> <a id="6440" href="Data.Nat.Primality.Factorisation.html#6364" class="Bound">bs</a>
  <a id="6445" href="Data.Nat.Primality.Factorisation.html#6337" class="Function">factorisationUnique′</a> <a id="6466" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="6469" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="6472" href="Data.Nat.Primality.Factorisation.html#6472" class="Bound">Πas≡Πbs</a> <a id="6480" href="Data.Nat.Primality.Factorisation.html#6480" class="Bound">asPrime</a> <a id="6488" href="Data.Nat.Primality.Factorisation.html#6488" class="Bound">bsPrime</a> <a id="6496" class="Symbol">=</a> <a id="6498" href="Data.List.Relation.Binary.Permutation.Propositional.html#1715" class="Function">↭-refl</a>
  <a id="6507" href="Data.Nat.Primality.Factorisation.html#6337" class="Function">factorisationUnique′</a> <a id="6528" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="6531" class="Symbol">(</a><a id="6532" href="Data.Nat.Primality.Factorisation.html#6532" class="Bound">b</a><a id="6533" class="Symbol">@(</a><a id="6535" href="Data.Nat.Base.html#1101" class="InductiveConstructor">2+</a> <a id="6538" class="Symbol">_)</a> <a id="6541" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6543" href="Data.Nat.Primality.Factorisation.html#6543" class="Bound">bs</a><a id="6545" class="Symbol">)</a> <a id="6547" href="Data.Nat.Primality.Factorisation.html#6547" class="Bound">Πas≡Πbs</a> <a id="6555" href="Data.Nat.Primality.Factorisation.html#6555" class="Bound">prime[as]</a> <a id="6565" class="Symbol">(_</a> <a id="6568" href="Data.List.Relation.Unary.All.html#1724" class="InductiveConstructor Operator">∷</a> <a id="6570" href="Data.Nat.Primality.Factorisation.html#6570" class="Bound">prime[bs]</a><a id="6579" class="Symbol">)</a> <a id="6581" class="Symbol">=</a>
    <a id="6587" href="Relation.Nullary.Negation.Core.html#1270" class="Function">contradiction</a> <a id="6601" href="Data.Nat.Primality.Factorisation.html#6547" class="Bound">Πas≡Πbs</a> <a id="6609" class="Symbol">(</a><a id="6610" href="Data.Nat.Properties.html#9386" class="Function">&lt;⇒≢</a> <a id="6614" href="Data.Nat.Primality.Factorisation.html#6639" class="Function">Πas&lt;Πbs</a><a id="6621" class="Symbol">)</a>
    <a id="6627" class="Keyword">where</a>
      <a id="6639" href="Data.Nat.Primality.Factorisation.html#6639" class="Function">Πas&lt;Πbs</a> <a id="6647" class="Symbol">:</a> <a id="6649" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="6657" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="6660" href="Data.Nat.Base.html#1807" class="Function Operator">&lt;</a> <a id="6662" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="6670" class="Symbol">(</a><a id="6671" href="Data.Nat.Primality.Factorisation.html#6532" class="Bound">b</a> <a id="6673" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6675" href="Data.Nat.Primality.Factorisation.html#6543" class="Bound">bs</a><a id="6677" class="Symbol">)</a>
      <a id="6685" href="Data.Nat.Primality.Factorisation.html#6639" class="Function">Πas&lt;Πbs</a> <a id="6693" class="Symbol">=</a> <a id="6695" href="Relation.Binary.Reasoning.Syntax.html#3008" class="Function Operator">begin-strict</a>
        <a id="6716" class="Number">1</a>                <a id="6733" href="Relation.Binary.Reasoning.Syntax.html#11079" class="Function">≡⟨⟩</a>
        <a id="6745" class="Number">1</a> <a id="6747" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="6749" class="Number">1</a>            <a id="6762" href="Relation.Binary.Reasoning.Syntax.html#5689" class="Function">&lt;⟨</a> <a id="6765" href="Data.Nat.Properties.html#28150" class="Function">*-monoˡ-&lt;</a> <a id="6775" class="Number">1</a> <a id="6777" class="Symbol">{</a><a id="6778" class="Number">1</a><a id="6779" class="Symbol">}</a> <a id="6781" class="Symbol">{</a><a id="6782" href="Data.Nat.Primality.Factorisation.html#6532" class="Bound">b</a><a id="6783" class="Symbol">}</a> <a id="6785" href="Data.Nat.Base.html#1961" class="InductiveConstructor">sz&lt;ss</a> <a id="6791" href="Relation.Binary.Reasoning.Syntax.html#5689" class="Function">⟩</a>
        <a id="6801" href="Data.Nat.Primality.Factorisation.html#6532" class="Bound">b</a> <a id="6803" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="6805" class="Number">1</a>            <a id="6818" href="Relation.Binary.Reasoning.Syntax.html#5544" class="Function">≤⟨</a> <a id="6821" href="Data.Nat.Properties.html#27897" class="Function">*-monoʳ-≤</a> <a id="6831" href="Data.Nat.Primality.Factorisation.html#6532" class="Bound">b</a> <a id="6833" class="Symbol">(</a><a id="6834" href="Data.Nat.Primality.html#11479" class="Function">productOfPrimes≥1</a> <a id="6852" href="Data.Nat.Primality.Factorisation.html#6570" class="Bound">prime[bs]</a><a id="6861" class="Symbol">)</a> <a id="6863" href="Relation.Binary.Reasoning.Syntax.html#5544" class="Function">⟩</a>
        <a id="6873" href="Data.Nat.Primality.Factorisation.html#6532" class="Bound">b</a> <a id="6875" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="6877" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="6885" href="Data.Nat.Primality.Factorisation.html#6543" class="Bound">bs</a>   <a id="6890" href="Relation.Binary.Reasoning.Syntax.html#11079" class="Function">≡⟨⟩</a>
        <a id="6902" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="6910" class="Symbol">(</a><a id="6911" href="Data.Nat.Primality.Factorisation.html#6532" class="Bound">b</a> <a id="6913" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6915" href="Data.Nat.Primality.Factorisation.html#6543" class="Bound">bs</a><a id="6917" class="Symbol">)</a> <a id="6919" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
        <a id="6929" class="Keyword">where</a> <a id="6935" class="Keyword">open</a> <a id="6940" href="Data.Nat.Properties.html#14787" class="Module">≤-Reasoning</a>

  <a id="6955" href="Data.Nat.Primality.Factorisation.html#6337" class="Function">factorisationUnique′</a> <a id="6976" class="Symbol">(</a><a id="6977" href="Data.Nat.Primality.Factorisation.html#6977" class="Bound">a</a> <a id="6979" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6981" href="Data.Nat.Primality.Factorisation.html#6981" class="Bound">as</a><a id="6983" class="Symbol">)</a> <a id="6985" href="Data.Nat.Primality.Factorisation.html#6985" class="Bound">bs</a> <a id="6988" href="Data.Nat.Primality.Factorisation.html#6988" class="Bound">Πas≡Πbs</a> <a id="6996" class="Symbol">(</a><a id="6997" href="Data.Nat.Primality.Factorisation.html#6997" class="Bound">prime[a]</a> <a id="7006" href="Data.List.Relation.Unary.All.html#1724" class="InductiveConstructor Operator">∷</a> <a id="7008" href="Data.Nat.Primality.Factorisation.html#7008" class="Bound">prime[as]</a><a id="7017" class="Symbol">)</a> <a id="7019" href="Data.Nat.Primality.Factorisation.html#7019" class="Bound">prime[bs]</a> <a id="7029" class="Symbol">=</a> <a id="7031" href="Data.Nat.Primality.Factorisation.html#7933" class="Function">a∷as↭bs</a>
    <a id="7043" class="Keyword">where</a>
      <a id="7055" href="Data.Nat.Primality.Factorisation.html#7055" class="Function">a∣Πbs</a> <a id="7061" class="Symbol">:</a> <a id="7063" href="Data.Nat.Primality.Factorisation.html#6977" class="Bound">a</a> <a id="7065" href="Data.Nat.Divisibility.Core.html#1159" class="Record Operator">∣</a> <a id="7067" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7075" href="Data.Nat.Primality.Factorisation.html#6985" class="Bound">bs</a>
      <a id="7084" href="Data.Nat.Primality.Factorisation.html#7055" class="Function">a∣Πbs</a> <a id="7090" class="Symbol">=</a> <a id="7092" href="Data.Nat.Divisibility.Core.html#1199" class="InductiveConstructor">divides</a> <a id="7100" class="Symbol">(</a><a id="7101" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7109" href="Data.Nat.Primality.Factorisation.html#6981" class="Bound">as</a><a id="7111" class="Symbol">)</a> <a id="7113" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="7115" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
        <a id="7129" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7137" href="Data.Nat.Primality.Factorisation.html#6985" class="Bound">bs</a>       <a id="7146" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">≡⟨</a> <a id="7149" href="Data.Nat.Primality.Factorisation.html#6988" class="Bound">Πas≡Πbs</a> <a id="7157" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">⟨</a>
        <a id="7167" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7175" class="Symbol">(</a><a id="7176" href="Data.Nat.Primality.Factorisation.html#6977" class="Bound">a</a> <a id="7178" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="7180" href="Data.Nat.Primality.Factorisation.html#6981" class="Bound">as</a><a id="7182" class="Symbol">)</a> <a id="7184" href="Relation.Binary.Reasoning.Syntax.html#11079" class="Function">≡⟨⟩</a>
        <a id="7196" href="Data.Nat.Primality.Factorisation.html#6977" class="Bound">a</a> <a id="7198" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="7200" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7208" href="Data.Nat.Primality.Factorisation.html#6981" class="Bound">as</a>   <a id="7213" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="7216" href="Data.Nat.Properties.html#22275" class="Function">*-comm</a> <a id="7223" href="Data.Nat.Primality.Factorisation.html#6977" class="Bound">a</a> <a id="7225" class="Symbol">(</a><a id="7226" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7234" href="Data.Nat.Primality.Factorisation.html#6981" class="Bound">as</a><a id="7236" class="Symbol">)</a> <a id="7238" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
        <a id="7248" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7256" href="Data.Nat.Primality.Factorisation.html#6981" class="Bound">as</a> <a id="7259" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="7261" href="Data.Nat.Primality.Factorisation.html#6977" class="Bound">a</a>   <a id="7265" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
        <a id="7275" class="Keyword">where</a> <a id="7281" class="Keyword">open</a> <a id="7286" href="Relation.Binary.PropositionalEquality.Properties.html#6731" class="Module">≡-Reasoning</a>

      <a id="7305" href="Data.Nat.Primality.Factorisation.html#7305" class="Function">shuffle</a> <a id="7313" class="Symbol">:</a> <a id="7315" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="7318" href="Data.Nat.Primality.Factorisation.html#7318" class="Bound">bs′</a> <a id="7322" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="7324" href="Data.Nat.Primality.Factorisation.html#6985" class="Bound">bs</a> <a id="7327" href="Data.List.Relation.Binary.Permutation.Propositional.html#1513" class="Datatype Operator">↭</a> <a id="7329" href="Data.Nat.Primality.Factorisation.html#6977" class="Bound">a</a> <a id="7331" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="7333" href="Data.Nat.Primality.Factorisation.html#7318" class="Bound">bs′</a>
      <a id="7343" href="Data.Nat.Primality.Factorisation.html#7305" class="Function">shuffle</a> <a id="7351" class="Keyword">with</a> <a id="7356" href="Data.Nat.Primality.Factorisation.html#7356" class="Bound">ys</a> <a id="7359" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7361" href="Data.Nat.Primality.Factorisation.html#7361" class="Bound">zs</a> <a id="7364" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7366" href="Data.Nat.Primality.Factorisation.html#7366" class="Bound">p</a> ← <a id="7370" href="Data.List.Membership.Propositional.Properties.html#5079" class="Function">∈-∃++</a> <a id="7376" class="Symbol">(</a><a id="7377" href="Data.Nat.Primality.Factorisation.html#5800" class="Function">factorisationHasAllPrimeFactors</a> <a id="7409" href="Data.Nat.Primality.Factorisation.html#6997" class="Bound">prime[a]</a> <a id="7418" href="Data.Nat.Primality.Factorisation.html#7055" class="Function">a∣Πbs</a> <a id="7424" href="Data.Nat.Primality.Factorisation.html#7019" class="Bound">prime[bs]</a><a id="7433" class="Symbol">)</a>
        <a id="7443" class="Symbol">=</a> <a id="7445" href="Data.Nat.Primality.Factorisation.html#7356" class="Bound">ys</a> <a id="7448" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="7451" href="Data.Nat.Primality.Factorisation.html#7361" class="Bound">zs</a> <a id="7454" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7456" href="Data.List.Relation.Binary.Permutation.Propositional.html#2395" class="Function">↭-trans</a> <a id="7464" class="Symbol">(</a><a id="7465" href="Data.List.Relation.Binary.Permutation.Propositional.html#1976" class="Function">↭-reflexive</a> <a id="7477" href="Data.Nat.Primality.Factorisation.html#7366" class="Bound">p</a><a id="7478" class="Symbol">)</a> <a id="7480" class="Symbol">(</a><a id="7481" href="Data.List.Relation.Binary.Permutation.Propositional.Properties.html#7368" class="Function">shift</a> <a id="7487" href="Data.Nat.Primality.Factorisation.html#6977" class="Bound">a</a> <a id="7489" href="Data.Nat.Primality.Factorisation.html#7356" class="Bound">ys</a> <a id="7492" href="Data.Nat.Primality.Factorisation.html#7361" class="Bound">zs</a><a id="7494" class="Symbol">)</a>

      <a id="7503" href="Data.Nat.Primality.Factorisation.html#7503" class="Function">bs′</a> <a id="7507" class="Symbol">=</a> <a id="7509" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="7515" href="Data.Nat.Primality.Factorisation.html#7305" class="Function">shuffle</a>
      <a id="7529" href="Data.Nat.Primality.Factorisation.html#7529" class="Function">bs↭a∷bs′</a> <a id="7538" class="Symbol">=</a> <a id="7540" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="7546" href="Data.Nat.Primality.Factorisation.html#7305" class="Function">shuffle</a>

      <a id="7561" href="Data.Nat.Primality.Factorisation.html#7561" class="Function">Πas≡Πbs′</a> <a id="7570" class="Symbol">:</a> <a id="7572" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7580" href="Data.Nat.Primality.Factorisation.html#6981" class="Bound">as</a> <a id="7583" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="7585" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7593" href="Data.Nat.Primality.Factorisation.html#7503" class="Function">bs′</a>
      <a id="7603" href="Data.Nat.Primality.Factorisation.html#7561" class="Function">Πas≡Πbs′</a> <a id="7612" class="Symbol">=</a> <a id="7614" href="Data.Nat.Properties.html#25648" class="Function">*-cancelˡ-≡</a> <a id="7626" class="Symbol">(</a><a id="7627" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7635" href="Data.Nat.Primality.Factorisation.html#6981" class="Bound">as</a><a id="7637" class="Symbol">)</a> <a id="7639" class="Symbol">(</a><a id="7640" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7648" href="Data.Nat.Primality.Factorisation.html#7503" class="Function">bs′</a><a id="7651" class="Symbol">)</a> <a id="7653" href="Data.Nat.Primality.Factorisation.html#6977" class="Bound">a</a> <a id="7655" class="Symbol">{{</a><a id="7657" href="Data.Nat.Primality.html#7158" class="Function">prime⇒nonZero</a> <a id="7671" href="Data.Nat.Primality.Factorisation.html#6997" class="Bound">prime[a]</a><a id="7679" class="Symbol">}}</a> <a id="7682" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="7684" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
        <a id="7698" href="Data.Nat.Primality.Factorisation.html#6977" class="Bound">a</a> <a id="7700" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="7702" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7710" href="Data.Nat.Primality.Factorisation.html#6981" class="Bound">as</a>  <a id="7714" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="7717" href="Data.Nat.Primality.Factorisation.html#6988" class="Bound">Πas≡Πbs</a> <a id="7725" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
        <a id="7735" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7743" href="Data.Nat.Primality.Factorisation.html#6985" class="Bound">bs</a>      <a id="7751" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="7754" href="Data.Nat.ListAction.Properties.html#2862" class="Function">product-↭</a> <a id="7764" href="Data.Nat.Primality.Factorisation.html#7529" class="Function">bs↭a∷bs′</a> <a id="7773" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
        <a id="7783" href="Data.Nat.Primality.Factorisation.html#6977" class="Bound">a</a> <a id="7785" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="7787" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7795" href="Data.Nat.Primality.Factorisation.html#7503" class="Function">bs′</a> <a id="7799" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
        <a id="7809" class="Keyword">where</a> <a id="7815" class="Keyword">open</a> <a id="7820" href="Relation.Binary.PropositionalEquality.Properties.html#6731" class="Module">≡-Reasoning</a>

      <a id="7839" href="Data.Nat.Primality.Factorisation.html#7839" class="Function">prime[bs&#39;]</a> <a id="7850" class="Symbol">:</a> <a id="7852" href="Data.List.Relation.Unary.All.html#1644" class="Datatype">All</a> <a id="7856" href="Data.Nat.Primality.html#3199" class="Record">Prime</a> <a id="7862" href="Data.Nat.Primality.Factorisation.html#7503" class="Function">bs′</a>
      <a id="7872" href="Data.Nat.Primality.Factorisation.html#7839" class="Function">prime[bs&#39;]</a> <a id="7883" class="Symbol">=</a> <a id="7885" href="Data.List.Relation.Unary.All.html#2600" class="Function">All.tail</a> <a id="7894" class="Symbol">(</a><a id="7895" href="Data.List.Relation.Binary.Permutation.Propositional.Properties.html#2981" class="Function">All-resp-↭</a> <a id="7906" href="Data.Nat.Primality.Factorisation.html#7529" class="Function">bs↭a∷bs′</a> <a id="7915" href="Data.Nat.Primality.Factorisation.html#7019" class="Bound">prime[bs]</a><a id="7924" class="Symbol">)</a>

      <a id="7933" href="Data.Nat.Primality.Factorisation.html#7933" class="Function">a∷as↭bs</a> <a id="7941" class="Symbol">:</a> <a id="7943" href="Data.Nat.Primality.Factorisation.html#6977" class="Bound">a</a> <a id="7945" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="7947" href="Data.Nat.Primality.Factorisation.html#6981" class="Bound">as</a> <a id="7950" href="Data.List.Relation.Binary.Permutation.Propositional.html#1513" class="Datatype Operator">↭</a> <a id="7952" href="Data.Nat.Primality.Factorisation.html#6985" class="Bound">bs</a>
      <a id="7961" href="Data.Nat.Primality.Factorisation.html#7933" class="Function">a∷as↭bs</a> <a id="7969" class="Symbol">=</a> <a id="7971" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
        <a id="7985" href="Data.Nat.Primality.Factorisation.html#6977" class="Bound">a</a> <a id="7987" href="Data.List.Relation.Binary.Permutation.Propositional.html#3882" class="Function">∷</a> <a id="7989" href="Data.Nat.Primality.Factorisation.html#6981" class="Bound">as</a>  <a id="7993" href="Data.List.Relation.Binary.Permutation.Propositional.html#3882" class="Function">&lt;⟨</a> <a id="7996" href="Data.Nat.Primality.Factorisation.html#6337" class="Function">factorisationUnique′</a> <a id="8017" href="Data.Nat.Primality.Factorisation.html#6981" class="Bound">as</a> <a id="8020" href="Data.Nat.Primality.Factorisation.html#7503" class="Function">bs′</a> <a id="8024" href="Data.Nat.Primality.Factorisation.html#7561" class="Function">Πas≡Πbs′</a> <a id="8033" href="Data.Nat.Primality.Factorisation.html#7008" class="Bound">prime[as]</a> <a id="8043" href="Data.Nat.Primality.Factorisation.html#7839" class="Function">prime[bs&#39;]</a> <a id="8054" href="Data.List.Relation.Binary.Permutation.Propositional.html#3882" class="Function">⟩</a>
        <a id="8064" href="Data.Nat.Primality.Factorisation.html#6977" class="Bound">a</a> <a id="8066" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8068" href="Data.Nat.Primality.Factorisation.html#7503" class="Function">bs′</a> <a id="8072" href="Relation.Binary.Reasoning.Syntax.html#9944" class="Function">↭⟨</a> <a id="8075" href="Data.Nat.Primality.Factorisation.html#7529" class="Function">bs↭a∷bs′</a> <a id="8084" href="Relation.Binary.Reasoning.Syntax.html#9944" class="Function">⟨</a>
        <a id="8094" href="Data.Nat.Primality.Factorisation.html#6985" class="Bound">bs</a>      <a id="8102" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
        <a id="8112" class="Keyword">where</a> <a id="8118" class="Keyword">open</a> <a id="8123" href="Data.List.Relation.Binary.Permutation.Propositional.html#3505" class="Module">PermutationReasoning</a>

<a id="factorisationUnique"></a><a id="8145" href="Data.Nat.Primality.Factorisation.html#8145" class="Function">factorisationUnique</a> <a id="8165" class="Symbol">:</a> <a id="8167" class="Symbol">(</a><a id="8168" href="Data.Nat.Primality.Factorisation.html#8168" class="Bound">f</a> <a id="8170" href="Data.Nat.Primality.Factorisation.html#8170" class="Bound">f′</a> <a id="8173" class="Symbol">:</a> <a id="8175" href="Data.Nat.Primality.Factorisation.html#2171" class="Record">PrimeFactorisation</a> <a id="8194" href="Data.Nat.Primality.Factorisation.html#2064" class="Generalizable">n</a><a id="8195" class="Symbol">)</a> <a id="8197" class="Symbol">→</a> <a id="8199" href="Data.Nat.Primality.Factorisation.html#2222" class="Field">factors</a> <a id="8207" href="Data.Nat.Primality.Factorisation.html#8168" class="Bound">f</a> <a id="8209" href="Data.List.Relation.Binary.Permutation.Propositional.html#1513" class="Datatype Operator">↭</a> <a id="8211" href="Data.Nat.Primality.Factorisation.html#2222" class="Field">factors</a> <a id="8219" href="Data.Nat.Primality.Factorisation.html#8170" class="Bound">f′</a>
<a id="8222" href="Data.Nat.Primality.Factorisation.html#8145" class="Function">factorisationUnique</a> <a id="8242" class="Symbol">{</a><a id="8243" href="Data.Nat.Primality.Factorisation.html#8243" class="Bound">n</a><a id="8244" class="Symbol">}</a> <a id="8246" href="Data.Nat.Primality.Factorisation.html#8246" class="Bound">f</a> <a id="8248" href="Data.Nat.Primality.Factorisation.html#8248" class="Bound">f′</a> <a id="8251" class="Symbol">=</a>
  <a id="8255" href="Data.Nat.Primality.Factorisation.html#6337" class="Function">factorisationUnique′</a> <a id="8276" class="Symbol">(</a><a id="8277" href="Data.Nat.Primality.Factorisation.html#2222" class="Field">factors</a> <a id="8285" href="Data.Nat.Primality.Factorisation.html#8246" class="Bound">f</a><a id="8286" class="Symbol">)</a> <a id="8288" class="Symbol">(</a><a id="8289" href="Data.Nat.Primality.Factorisation.html#2222" class="Field">factors</a> <a id="8297" href="Data.Nat.Primality.Factorisation.html#8248" class="Bound">f′</a><a id="8299" class="Symbol">)</a> <a id="8301" href="Data.Nat.Primality.Factorisation.html#8355" class="Function">Πf≡Πf′</a> <a id="8308" class="Symbol">(</a><a id="8309" href="Data.Nat.Primality.Factorisation.html#2285" class="Field">factorsPrime</a> <a id="8322" href="Data.Nat.Primality.Factorisation.html#8246" class="Bound">f</a><a id="8323" class="Symbol">)</a> <a id="8325" class="Symbol">(</a><a id="8326" href="Data.Nat.Primality.Factorisation.html#2285" class="Field">factorsPrime</a> <a id="8339" href="Data.Nat.Primality.Factorisation.html#8248" class="Bound">f′</a><a id="8341" class="Symbol">)</a>
  <a id="8345" class="Keyword">where</a>
    <a id="8355" href="Data.Nat.Primality.Factorisation.html#8355" class="Function">Πf≡Πf′</a> <a id="8362" class="Symbol">:</a> <a id="8364" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="8372" class="Symbol">(</a><a id="8373" href="Data.Nat.Primality.Factorisation.html#2222" class="Field">factors</a> <a id="8381" href="Data.Nat.Primality.Factorisation.html#8246" class="Bound">f</a><a id="8382" class="Symbol">)</a> <a id="8384" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="8386" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="8394" class="Symbol">(</a><a id="8395" href="Data.Nat.Primality.Factorisation.html#2222" class="Field">factors</a> <a id="8403" href="Data.Nat.Primality.Factorisation.html#8248" class="Bound">f′</a><a id="8405" class="Symbol">)</a>
    <a id="8411" href="Data.Nat.Primality.Factorisation.html#8355" class="Function">Πf≡Πf′</a> <a id="8418" class="Symbol">=</a> <a id="8420" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
      <a id="8432" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="8440" class="Symbol">(</a><a id="8441" href="Data.Nat.Primality.Factorisation.html#2222" class="Field">factors</a> <a id="8449" href="Data.Nat.Primality.Factorisation.html#8246" class="Bound">f</a><a id="8450" class="Symbol">)</a>  <a id="8453" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">≡⟨</a> <a id="8456" href="Data.Nat.Primality.Factorisation.html#2243" class="Field">isFactorisation</a> <a id="8472" href="Data.Nat.Primality.Factorisation.html#8246" class="Bound">f</a> <a id="8474" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">⟨</a>
      <a id="8482" href="Data.Nat.Primality.Factorisation.html#8243" class="Bound">n</a>                    <a id="8503" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="8506" href="Data.Nat.Primality.Factorisation.html#2243" class="Field">isFactorisation</a> <a id="8522" href="Data.Nat.Primality.Factorisation.html#8248" class="Bound">f′</a> <a id="8525" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
      <a id="8533" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="8541" class="Symbol">(</a><a id="8542" href="Data.Nat.Primality.Factorisation.html#2222" class="Field">factors</a> <a id="8550" href="Data.Nat.Primality.Factorisation.html#8248" class="Bound">f′</a><a id="8552" class="Symbol">)</a> <a id="8554" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
      <a id="8562" class="Keyword">where</a> <a id="8568" class="Keyword">open</a> <a id="8573" href="Relation.Binary.PropositionalEquality.Properties.html#6731" class="Module">≡-Reasoning</a>
</pre></body></html>