<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Nat.Primality.Factorisation</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Prime factorisation of natural numbers and its properties</a>
<a id="167" class="Comment">------------------------------------------------------------------------</a>

<a id="241" class="Symbol">{-#</a> <a id="245" class="Keyword">OPTIONS</a> <a id="253" class="Pragma">--cubical-compatible</a> <a id="274" class="Pragma">--safe</a> <a id="281" class="Symbol">#-}</a>

<a id="286" class="Keyword">module</a> <a id="293" href="Data.Nat.Primality.Factorisation.html" class="Module">Data.Nat.Primality.Factorisation</a> <a id="326" class="Keyword">where</a>

<a id="333" class="Keyword">open</a> <a id="338" class="Keyword">import</a> <a id="345" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="359" class="Keyword">open</a> <a id="364" class="Keyword">import</a> <a id="371" href="Data.Nat.Divisibility.html" class="Module">Data.Nat.Divisibility</a>
  <a id="395" class="Keyword">using</a> <a id="401" class="Symbol">(</a><a id="402" href="Data.Nat.Divisibility.html#4316" class="Function Operator">_∣?_</a><a id="406" class="Symbol">;</a> <a id="408" href="Data.Nat.Divisibility.Core.html#1247" class="Field">quotient</a><a id="416" class="Symbol">;</a> <a id="418" href="Data.Nat.Divisibility.html#1959" class="Function">quotient&gt;1</a><a id="428" class="Symbol">;</a> <a id="430" href="Data.Nat.Divisibility.html#2242" class="Function">quotient-&lt;</a><a id="440" class="Symbol">;</a> <a id="442" href="Data.Nat.Divisibility.html#1852" class="Function">quotient-∣</a><a id="452" class="Symbol">;</a> <a id="454" href="Data.Nat.Divisibility.html#1713" class="Function">m∣n⇒n≡m*quotient</a><a id="470" class="Symbol">;</a> <a id="472" href="Data.Nat.Divisibility.Core.html#1191" class="Record Operator">_∣_</a><a id="475" class="Symbol">;</a> <a id="477" href="Data.Nat.Divisibility.html#5586" class="Function">∣1⇒≡1</a>
        <a id="491" class="Symbol">;</a> <a id="493" href="Data.Nat.Divisibility.Core.html#1231" class="InductiveConstructor">divides</a><a id="500" class="Symbol">)</a>
<a id="502" class="Keyword">open</a> <a id="507" class="Keyword">import</a> <a id="514" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a>
<a id="534" class="Keyword">open</a> <a id="539" class="Keyword">import</a> <a id="546" href="Data.Nat.Induction.html" class="Module">Data.Nat.Induction</a> <a id="565" class="Keyword">using</a> <a id="571" class="Symbol">(</a><a id="572" href="Data.Nat.Induction.html#2209" class="Function">&lt;-Rec</a><a id="577" class="Symbol">;</a> <a id="579" href="Data.Nat.Induction.html#3263" class="Function">&lt;-rec</a><a id="584" class="Symbol">;</a> <a id="586" href="Data.Nat.Induction.html#3219" class="Function">&lt;-recBuilder</a><a id="598" class="Symbol">)</a>
<a id="600" class="Keyword">open</a> <a id="605" class="Keyword">import</a> <a id="612" href="Data.Nat.ListAction.html" class="Module">Data.Nat.ListAction</a> <a id="632" class="Keyword">using</a> <a id="638" class="Symbol">(</a><a id="639" href="Data.Nat.ListAction.html#648" class="Function">product</a><a id="646" class="Symbol">)</a>
<a id="648" class="Keyword">open</a> <a id="653" class="Keyword">import</a> <a id="660" href="Data.Nat.ListAction.Properties.html" class="Module">Data.Nat.ListAction.Properties</a> <a id="691" class="Keyword">using</a> <a id="697" class="Symbol">(</a><a id="698" href="Data.Nat.ListAction.Properties.html#2885" class="Function">product-↭</a><a id="707" class="Symbol">)</a>
<a id="709" class="Keyword">open</a> <a id="714" class="Keyword">import</a> <a id="721" href="Data.Nat.Primality.html" class="Module">Data.Nat.Primality</a>
  <a id="742" class="Keyword">using</a> <a id="748" class="Symbol">(</a><a id="749" href="Data.Nat.Primality.html#3204" class="Record">Prime</a><a id="754" class="Symbol">;</a> <a id="756" href="Data.Nat.Primality.html#2307" class="Function Operator">_Rough_</a><a id="763" class="Symbol">;</a> <a id="765" href="Data.Nat.Primality.html#10386" class="Function">rough∧square&gt;⇒prime</a><a id="784" class="Symbol">;</a> <a id="786" href="Data.Nat.Primality.html#4414" class="Function">∤⇒rough-suc</a><a id="797" class="Symbol">;</a> <a id="799" href="Data.Nat.Primality.html#4701" class="Function">rough∧∣⇒rough</a><a id="812" class="Symbol">;</a> <a id="814" href="Data.Nat.Primality.html#10205" class="Function">rough∧∣⇒prime</a>
        <a id="836" class="Symbol">;</a> <a id="838" href="Data.Nat.Primality.html#4100" class="Function">2-rough</a><a id="845" class="Symbol">;</a> <a id="847" href="Data.Nat.Primality.html#8470" class="Function">euclidsLemma</a><a id="859" class="Symbol">;</a> <a id="861" href="Data.Nat.Primality.html#13224" class="Function">prime⇒irreducible</a><a id="878" class="Symbol">;</a> <a id="880" href="Data.Nat.Primality.html#7082" class="Function">¬prime[1]</a><a id="889" class="Symbol">;</a> <a id="891" href="Data.Nat.Primality.html#11484" class="Function">productOfPrimes≥1</a><a id="908" class="Symbol">;</a> <a id="910" href="Data.Nat.Primality.html#7163" class="Function">prime⇒nonZero</a><a id="923" class="Symbol">)</a>
<a id="925" class="Keyword">open</a> <a id="930" class="Keyword">import</a> <a id="937" href="Data.Product.Base.html" class="Module">Data.Product.Base</a> <a id="955" class="Keyword">using</a> <a id="961" class="Symbol">(</a><a id="962" href="Data.Product.Base.html#1371" class="Function">∃-syntax</a><a id="970" class="Symbol">;</a> <a id="972" href="Data.Product.Base.html#1618" class="Function Operator">_×_</a><a id="975" class="Symbol">;</a> <a id="977" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a><a id="980" class="Symbol">;</a> <a id="982" href="Data.Product.Base.html#636" class="Field">proj₁</a><a id="987" class="Symbol">;</a> <a id="989" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="994" class="Symbol">)</a>
<a id="996" class="Keyword">open</a> <a id="1001" class="Keyword">import</a> <a id="1008" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="1023" class="Keyword">using</a> <a id="1029" class="Symbol">(</a><a id="1030" href="Agda.Builtin.List.html#147" class="Datatype">List</a><a id="1034" class="Symbol">;</a> <a id="1036" href="Data.List.Base.html#7301" class="InductiveConstructor">[]</a><a id="1038" class="Symbol">;</a> <a id="1040" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">_∷_</a><a id="1043" class="Symbol">;</a> <a id="1045" href="Data.List.Base.html#1712" class="Function Operator">_++_</a><a id="1049" class="Symbol">)</a>
<a id="1051" class="Keyword">open</a> <a id="1056" class="Keyword">import</a> <a id="1063" href="Data.List.Membership.Propositional.html" class="Module">Data.List.Membership.Propositional</a> <a id="1098" class="Keyword">using</a> <a id="1104" class="Symbol">(</a><a id="1105" href="Data.List.Membership.Setoid.html#925" class="Function Operator">_∈_</a><a id="1108" class="Symbol">)</a>
<a id="1110" class="Keyword">open</a> <a id="1115" class="Keyword">import</a> <a id="1122" href="Data.List.Membership.Propositional.Properties.html" class="Module">Data.List.Membership.Propositional.Properties</a> <a id="1168" class="Keyword">using</a> <a id="1174" class="Symbol">(</a><a id="1175" href="Data.List.Membership.Propositional.Properties.html#5079" class="Function">∈-∃++</a><a id="1180" class="Symbol">)</a>
<a id="1182" class="Keyword">open</a> <a id="1187" class="Keyword">import</a> <a id="1194" href="Data.List.Relation.Unary.All.html" class="Module">Data.List.Relation.Unary.All</a> <a id="1223" class="Symbol">as</a> <a id="1226" class="Module">All</a> <a id="1230" class="Keyword">using</a> <a id="1236" class="Symbol">(</a><a id="1237" href="Data.List.Relation.Unary.All.html#1638" class="Datatype">All</a><a id="1240" class="Symbol">;</a> <a id="1242" href="Data.List.Relation.Unary.All.html#1701" class="InductiveConstructor">[]</a><a id="1244" class="Symbol">;</a> <a id="1246" href="Data.List.Relation.Unary.All.html#1718" class="InductiveConstructor Operator">_∷_</a><a id="1249" class="Symbol">)</a>
<a id="1251" class="Keyword">open</a> <a id="1256" class="Keyword">import</a> <a id="1263" href="Data.List.Relation.Unary.Any.html" class="Module">Data.List.Relation.Unary.Any</a> <a id="1292" class="Keyword">using</a> <a id="1298" class="Symbol">(</a><a id="1299" href="Data.List.Relation.Unary.Any.html#1211" class="InductiveConstructor">here</a><a id="1303" class="Symbol">;</a> <a id="1305" href="Data.List.Relation.Unary.Any.html#1264" class="InductiveConstructor">there</a><a id="1310" class="Symbol">)</a>
<a id="1312" class="Keyword">open</a> <a id="1317" class="Keyword">import</a> <a id="1324" href="Data.List.Relation.Binary.Permutation.Propositional.html" class="Module">Data.List.Relation.Binary.Permutation.Propositional</a>
  <a id="1378" class="Keyword">using</a> <a id="1384" class="Symbol">(</a><a id="1385" href="Data.List.Relation.Binary.Permutation.Propositional.html#1513" class="Datatype Operator">_↭_</a><a id="1388" class="Symbol">;</a> <a id="1390" href="Data.List.Relation.Binary.Permutation.Propositional.html#1976" class="Function">↭-reflexive</a><a id="1401" class="Symbol">;</a> <a id="1403" href="Data.List.Relation.Binary.Permutation.Propositional.html#1715" class="Function">↭-refl</a><a id="1409" class="Symbol">;</a> <a id="1411" href="Data.List.Relation.Binary.Permutation.Propositional.html#2395" class="Function">↭-trans</a><a id="1418" class="Symbol">;</a> <a id="1420" class="Keyword">module</a> <a id="1427" href="Data.List.Relation.Binary.Permutation.Propositional.html#3505" class="Module">PermutationReasoning</a><a id="1447" class="Symbol">)</a>
<a id="1449" class="Keyword">open</a> <a id="1454" class="Keyword">import</a> <a id="1461" href="Data.List.Relation.Binary.Permutation.Propositional.Properties.html" class="Module">Data.List.Relation.Binary.Permutation.Propositional.Properties</a>
  <a id="1526" class="Keyword">using</a> <a id="1532" class="Symbol">(</a><a id="1533" href="Data.List.Relation.Binary.Permutation.Propositional.Properties.html#2989" class="Function">All-resp-↭</a><a id="1543" class="Symbol">;</a> <a id="1545" href="Data.List.Relation.Binary.Permutation.Propositional.Properties.html#7376" class="Function">shift</a><a id="1550" class="Symbol">)</a>
<a id="1552" class="Keyword">open</a> <a id="1557" class="Keyword">import</a> <a id="1564" href="Data.Sum.Base.html" class="Module">Data.Sum.Base</a> <a id="1578" class="Keyword">using</a> <a id="1584" class="Symbol">(</a><a id="1585" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a><a id="1589" class="Symbol">;</a> <a id="1591" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a><a id="1595" class="Symbol">)</a>
<a id="1597" class="Keyword">open</a> <a id="1602" class="Keyword">import</a> <a id="1609" href="Function.Base.html" class="Module">Function.Base</a> <a id="1623" class="Keyword">using</a> <a id="1629" class="Symbol">(</a><a id="1630" href="Function.Base.html#1974" class="Function Operator">_$_</a><a id="1633" class="Symbol">;</a> <a id="1635" href="Function.Base.html#1115" class="Function Operator">_∘_</a><a id="1638" class="Symbol">;</a> <a id="1640" href="Function.Base.html#2127" class="Function Operator">_|&gt;_</a><a id="1644" class="Symbol">;</a> <a id="1646" href="Function.Base.html#1638" class="Function">flip</a><a id="1650" class="Symbol">)</a>
<a id="1652" class="Keyword">open</a> <a id="1657" class="Keyword">import</a> <a id="1664" href="Induction.html" class="Module">Induction</a> <a id="1674" class="Keyword">using</a> <a id="1680" class="Symbol">(</a><a id="1681" href="Induction.html#1485" class="Function">build</a><a id="1686" class="Symbol">)</a>
<a id="1688" class="Keyword">open</a> <a id="1693" class="Keyword">import</a> <a id="1700" href="Induction.Lexicographic.html" class="Module">Induction.Lexicographic</a> <a id="1724" class="Keyword">using</a> <a id="1730" class="Symbol">(</a><a id="1731" href="Induction.Lexicographic.html#852" class="Function Operator">_⊗_</a><a id="1734" class="Symbol">;</a> <a id="1736" href="Induction.Lexicographic.html#1825" class="Function Operator">[_⊗_]</a><a id="1741" class="Symbol">)</a>
<a id="1743" class="Keyword">open</a> <a id="1748" class="Keyword">import</a> <a id="1755" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="1782" class="Keyword">using</a> <a id="1788" class="Symbol">(</a><a id="1789" href="Relation.Nullary.Decidable.Core.html#2046" class="InductiveConstructor">yes</a><a id="1792" class="Symbol">;</a> <a id="1794" href="Relation.Nullary.Decidable.Core.html#2083" class="InductiveConstructor">no</a><a id="1796" class="Symbol">)</a>
<a id="1798" class="Keyword">open</a> <a id="1803" class="Keyword">import</a> <a id="1810" href="Relation.Nullary.Negation.html" class="Module">Relation.Nullary.Negation</a> <a id="1836" class="Keyword">using</a> <a id="1842" class="Symbol">(</a><a id="1843" href="Relation.Nullary.Negation.Core.html#1289" class="Function">contradiction</a><a id="1856" class="Symbol">)</a>
<a id="1858" class="Keyword">open</a> <a id="1863" class="Keyword">import</a> <a id="1870" href="Relation.Binary.PropositionalEquality.Core.html" class="Module">Relation.Binary.PropositionalEquality.Core</a>
  <a id="1915" class="Keyword">using</a> <a id="1921" class="Symbol">(</a><a id="1922" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="1925" class="Symbol">;</a> <a id="1927" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="1931" class="Symbol">;</a> <a id="1933" href="Relation.Binary.PropositionalEquality.Core.html#2035" class="Function">sym</a><a id="1936" class="Symbol">;</a> <a id="1938" href="Relation.Binary.PropositionalEquality.Core.html#2080" class="Function">trans</a><a id="1943" class="Symbol">;</a> <a id="1945" href="Relation.Binary.PropositionalEquality.Core.html#1481" class="Function">cong</a><a id="1949" class="Symbol">)</a>
<a id="1951" class="Keyword">open</a> <a id="1956" class="Keyword">import</a> <a id="1963" href="Relation.Binary.PropositionalEquality.Properties.html" class="Module">Relation.Binary.PropositionalEquality.Properties</a>
  <a id="2014" class="Keyword">using</a> <a id="2020" class="Symbol">(</a><a id="2021" class="Keyword">module</a> <a id="2028" href="Relation.Binary.PropositionalEquality.Properties.html#6850" class="Module">≡-Reasoning</a><a id="2039" class="Symbol">)</a>

<a id="2042" class="Keyword">private</a>
  <a id="2052" class="Keyword">variable</a>
    <a id="2065" href="Data.Nat.Primality.Factorisation.html#2065" class="Generalizable">n</a> <a id="2067" class="Symbol">:</a> <a id="2069" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

<a id="2072" class="Comment">------------------------------------------------------------------------</a>
<a id="2145" class="Comment">-- Core definition</a>

<a id="2165" class="Keyword">record</a> <a id="PrimeFactorisation"></a><a id="2172" href="Data.Nat.Primality.Factorisation.html#2172" class="Record">PrimeFactorisation</a> <a id="2191" class="Symbol">(</a><a id="2192" href="Data.Nat.Primality.Factorisation.html#2192" class="Bound">n</a> <a id="2194" class="Symbol">:</a> <a id="2196" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="2197" class="Symbol">)</a> <a id="2199" class="Symbol">:</a> <a id="2201" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2205" class="Keyword">where</a>
  <a id="2213" class="Keyword">field</a>
    <a id="PrimeFactorisation.factors"></a><a id="2223" href="Data.Nat.Primality.Factorisation.html#2223" class="Field">factors</a> <a id="2231" class="Symbol">:</a> <a id="2233" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2238" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
    <a id="PrimeFactorisation.isFactorisation"></a><a id="2244" href="Data.Nat.Primality.Factorisation.html#2244" class="Field">isFactorisation</a> <a id="2260" class="Symbol">:</a> <a id="2262" href="Data.Nat.Primality.Factorisation.html#2192" class="Bound">n</a> <a id="2264" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="2266" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="2274" href="Data.Nat.Primality.Factorisation.html#2223" class="Field">factors</a>
    <a id="PrimeFactorisation.factorsPrime"></a><a id="2286" href="Data.Nat.Primality.Factorisation.html#2286" class="Field">factorsPrime</a> <a id="2299" class="Symbol">:</a> <a id="2301" href="Data.List.Relation.Unary.All.html#1638" class="Datatype">All</a> <a id="2305" href="Data.Nat.Primality.html#3204" class="Record">Prime</a> <a id="2311" href="Data.Nat.Primality.Factorisation.html#2223" class="Field">factors</a>

<a id="2320" class="Keyword">open</a> <a id="2325" href="Data.Nat.Primality.Factorisation.html#2172" class="Module">PrimeFactorisation</a> <a id="2344" class="Keyword">public</a> <a id="2351" class="Keyword">using</a> <a id="2357" class="Symbol">(</a><a id="2358" href="Data.Nat.Primality.Factorisation.html#2223" class="Field">factors</a><a id="2365" class="Symbol">)</a>
<a id="2367" class="Keyword">open</a> <a id="2372" href="Data.Nat.Primality.Factorisation.html#2172" class="Module">PrimeFactorisation</a>

<a id="2392" class="Comment">------------------------------------------------------------------------</a>
<a id="2465" class="Comment">-- Finding a factorisation</a>

<a id="primeFactorisation[1]"></a><a id="2493" href="Data.Nat.Primality.Factorisation.html#2493" class="Function">primeFactorisation[1]</a> <a id="2515" class="Symbol">:</a> <a id="2517" href="Data.Nat.Primality.Factorisation.html#2172" class="Record">PrimeFactorisation</a> <a id="2536" class="Number">1</a>
<a id="2538" href="Data.Nat.Primality.Factorisation.html#2493" class="Function">primeFactorisation[1]</a> <a id="2560" class="Symbol">=</a> <a id="2562" class="Keyword">record</a>
  <a id="2571" class="Symbol">{</a> <a id="2573" href="Data.Nat.Primality.Factorisation.html#2223" class="Field">factors</a> <a id="2581" class="Symbol">=</a> <a id="2583" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
  <a id="2588" class="Symbol">;</a> <a id="2590" href="Data.Nat.Primality.Factorisation.html#2244" class="Field">isFactorisation</a> <a id="2606" class="Symbol">=</a> <a id="2608" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="2615" class="Symbol">;</a> <a id="2617" href="Data.Nat.Primality.Factorisation.html#2286" class="Field">factorsPrime</a> <a id="2630" class="Symbol">=</a> <a id="2632" href="Data.List.Relation.Unary.All.html#1701" class="InductiveConstructor">[]</a>
  <a id="2637" class="Symbol">}</a>

<a id="primeFactorisation[p]"></a><a id="2640" href="Data.Nat.Primality.Factorisation.html#2640" class="Function">primeFactorisation[p]</a> <a id="2662" class="Symbol">:</a> <a id="2664" href="Data.Nat.Primality.html#3204" class="Record">Prime</a> <a id="2670" href="Data.Nat.Primality.Factorisation.html#2065" class="Generalizable">n</a> <a id="2672" class="Symbol">→</a> <a id="2674" href="Data.Nat.Primality.Factorisation.html#2172" class="Record">PrimeFactorisation</a> <a id="2693" href="Data.Nat.Primality.Factorisation.html#2065" class="Generalizable">n</a>
<a id="2695" href="Data.Nat.Primality.Factorisation.html#2640" class="Function">primeFactorisation[p]</a> <a id="2717" class="Symbol">{</a><a id="2718" href="Data.Nat.Primality.Factorisation.html#2718" class="Bound">n</a><a id="2719" class="Symbol">}</a> <a id="2721" href="Data.Nat.Primality.Factorisation.html#2721" class="Bound">pr</a> <a id="2724" class="Symbol">=</a> <a id="2726" class="Keyword">record</a>
  <a id="2735" class="Symbol">{</a> <a id="2737" href="Data.Nat.Primality.Factorisation.html#2223" class="Field">factors</a> <a id="2745" class="Symbol">=</a> <a id="2747" href="Data.Nat.Primality.Factorisation.html#2718" class="Bound">n</a> <a id="2749" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2751" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
  <a id="2756" class="Symbol">;</a> <a id="2758" href="Data.Nat.Primality.Factorisation.html#2244" class="Field">isFactorisation</a> <a id="2774" class="Symbol">=</a> <a id="2776" href="Relation.Binary.PropositionalEquality.Core.html#2035" class="Function">sym</a> <a id="2780" class="Symbol">(</a><a id="2781" href="Data.Nat.Properties.html#21987" class="Function">*-identityʳ</a> <a id="2793" href="Data.Nat.Primality.Factorisation.html#2718" class="Bound">n</a><a id="2794" class="Symbol">)</a>
  <a id="2798" class="Symbol">;</a> <a id="2800" href="Data.Nat.Primality.Factorisation.html#2286" class="Field">factorsPrime</a> <a id="2813" class="Symbol">=</a> <a id="2815" href="Data.Nat.Primality.Factorisation.html#2721" class="Bound">pr</a> <a id="2818" href="Data.List.Relation.Unary.All.html#1718" class="InductiveConstructor Operator">∷</a> <a id="2820" href="Data.List.Relation.Unary.All.html#1701" class="InductiveConstructor">[]</a>
  <a id="2825" class="Symbol">}</a>

<a id="2828" class="Comment">-- This builds up three important things:</a>
<a id="2870" class="Comment">-- * a proof that every number we&#39;ve gotten to so far has increasingly higher</a>
<a id="2948" class="Comment">--   possible least prime factor, so we don&#39;t have to repeat smaller factors</a>
<a id="3025" class="Comment">--   over and over (this is the &quot;m&quot; and &quot;rough&quot; parameters)</a>
<a id="3085" class="Comment">-- * a witness that this limit is getting closer to the number of interest, in a</a>
<a id="3166" class="Comment">--   way that helps the termination checker (the &quot;k&quot; and &quot;eq&quot; parameters)</a>
<a id="3240" class="Comment">-- * a proof that we can factorise any smaller number, which is useful when we</a>
<a id="3319" class="Comment">--   encounter a factor, as we can then divide by that factor and continue from</a>
<a id="3399" class="Comment">--   there without termination issues</a>
<a id="factorise"></a><a id="3437" href="Data.Nat.Primality.Factorisation.html#3437" class="Function">factorise</a> <a id="3447" class="Symbol">:</a> <a id="3449" class="Symbol">∀</a> <a id="3451" href="Data.Nat.Primality.Factorisation.html#3451" class="Bound">n</a> <a id="3453" class="Symbol">→</a> <a id="3455" class="Symbol">.{{</a><a id="3458" href="Data.Nat.Base.html#3266" class="Record">NonZero</a> <a id="3466" href="Data.Nat.Primality.Factorisation.html#3451" class="Bound">n</a><a id="3467" class="Symbol">}}</a> <a id="3470" class="Symbol">→</a> <a id="3472" href="Data.Nat.Primality.Factorisation.html#2172" class="Record">PrimeFactorisation</a> <a id="3491" href="Data.Nat.Primality.Factorisation.html#3451" class="Bound">n</a>
<a id="3493" href="Data.Nat.Primality.Factorisation.html#3437" class="Function">factorise</a> <a id="3503" class="Number">1</a> <a id="3505" class="Symbol">=</a> <a id="3507" href="Data.Nat.Primality.Factorisation.html#2493" class="Function">primeFactorisation[1]</a>
<a id="3529" href="Data.Nat.Primality.Factorisation.html#3437" class="Function">factorise</a> <a id="3539" href="Data.Nat.Primality.Factorisation.html#3539" class="Bound">n₀</a><a id="3541" class="Symbol">@(</a><a id="3543" href="Data.Nat.Base.html#1101" class="InductiveConstructor">2+</a> <a id="3546" class="Symbol">_)</a> <a id="3549" class="Symbol">=</a> <a id="3551" href="Induction.html#1485" class="Function">build</a> <a id="3557" href="Induction.Lexicographic.html#1825" class="Function Operator">[</a> <a id="3559" href="Data.Nat.Induction.html#3219" class="Function">&lt;-recBuilder</a> <a id="3572" href="Induction.Lexicographic.html#1825" class="Function Operator">⊗</a> <a id="3574" href="Data.Nat.Induction.html#3219" class="Function">&lt;-recBuilder</a> <a id="3587" href="Induction.Lexicographic.html#1825" class="Function Operator">]</a> <a id="3589" href="Data.Nat.Primality.Factorisation.html#3639" class="Function">P</a> <a id="3591" href="Data.Nat.Primality.Factorisation.html#3773" class="Function">facRec</a> <a id="3598" class="Symbol">(</a><a id="3599" href="Data.Nat.Primality.Factorisation.html#3539" class="Bound">n₀</a> <a id="3602" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3604" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3608" href="Data.Nat.Primality.Factorisation.html#3539" class="Bound">n₀</a> <a id="3611" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="3613" class="Number">4</a><a id="3614" class="Symbol">)</a> <a id="3616" href="Data.Nat.Primality.html#4100" class="Function">2-rough</a> <a id="3624" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="3631" class="Keyword">where</a>
  <a id="3639" href="Data.Nat.Primality.Factorisation.html#3639" class="Function">P</a> <a id="3641" class="Symbol">:</a> <a id="3643" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3645" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3647" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3649" class="Symbol">→</a> <a id="3651" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="3657" href="Data.Nat.Primality.Factorisation.html#3639" class="Function">P</a> <a id="3659" class="Symbol">(</a><a id="3660" href="Data.Nat.Primality.Factorisation.html#3660" class="Bound">n</a> <a id="3662" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3664" href="Data.Nat.Primality.Factorisation.html#3664" class="Bound">k</a><a id="3665" class="Symbol">)</a> <a id="3667" class="Symbol">=</a> <a id="3669" class="Symbol">∀</a> <a id="3671" class="Symbol">{</a><a id="3672" href="Data.Nat.Primality.Factorisation.html#3672" class="Bound">m</a><a id="3673" class="Symbol">}</a> <a id="3675" class="Symbol">→</a> <a id="3677" class="Symbol">.{{</a><a id="3680" href="Data.Nat.Base.html#3801" class="Record">NonTrivial</a> <a id="3691" href="Data.Nat.Primality.Factorisation.html#3660" class="Bound">n</a><a id="3692" class="Symbol">}}</a> <a id="3695" class="Symbol">→</a> <a id="3697" class="Symbol">.{{</a><a id="3700" href="Data.Nat.Base.html#3801" class="Record">NonTrivial</a> <a id="3711" href="Data.Nat.Primality.Factorisation.html#3672" class="Bound">m</a><a id="3712" class="Symbol">}}</a> <a id="3715" class="Symbol">→</a> <a id="3717" href="Data.Nat.Primality.Factorisation.html#3672" class="Bound">m</a> <a id="3719" href="Data.Nat.Primality.html#2307" class="Function Operator">Rough</a> <a id="3725" href="Data.Nat.Primality.Factorisation.html#3660" class="Bound">n</a> <a id="3727" class="Symbol">→</a> <a id="3729" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3733" href="Data.Nat.Primality.Factorisation.html#3660" class="Bound">n</a> <a id="3735" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="3737" href="Data.Nat.Primality.Factorisation.html#3672" class="Bound">m</a> <a id="3739" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="3741" href="Data.Nat.Primality.Factorisation.html#3672" class="Bound">m</a> <a id="3743" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3745" href="Data.Nat.Primality.Factorisation.html#3664" class="Bound">k</a> <a id="3747" class="Symbol">→</a> <a id="3749" href="Data.Nat.Primality.Factorisation.html#2172" class="Record">PrimeFactorisation</a> <a id="3768" href="Data.Nat.Primality.Factorisation.html#3660" class="Bound">n</a>

  <a id="3773" href="Data.Nat.Primality.Factorisation.html#3773" class="Function">facRec</a> <a id="3780" class="Symbol">:</a> <a id="3782" class="Symbol">∀</a> <a id="3784" href="Data.Nat.Primality.Factorisation.html#3784" class="Bound">n×k</a> <a id="3788" class="Symbol">→</a> <a id="3790" class="Symbol">(</a><a id="3791" href="Data.Nat.Induction.html#2209" class="Function">&lt;-Rec</a> <a id="3797" href="Induction.Lexicographic.html#852" class="Function Operator">⊗</a> <a id="3799" href="Data.Nat.Induction.html#2209" class="Function">&lt;-Rec</a><a id="3804" class="Symbol">)</a> <a id="3806" href="Data.Nat.Primality.Factorisation.html#3639" class="Function">P</a> <a id="3808" href="Data.Nat.Primality.Factorisation.html#3784" class="Bound">n×k</a> <a id="3812" class="Symbol">→</a> <a id="3814" href="Data.Nat.Primality.Factorisation.html#3639" class="Function">P</a> <a id="3816" href="Data.Nat.Primality.Factorisation.html#3784" class="Bound">n×k</a>
  <a id="3822" href="Data.Nat.Primality.Factorisation.html#3773" class="Function">facRec</a> <a id="3829" class="Symbol">(</a><a id="3830" href="Data.Nat.Primality.Factorisation.html#3830" class="Bound">n</a> <a id="3832" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3834" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a><a id="3838" class="Symbol">)</a> <a id="3840" class="Symbol">_</a> <a id="3842" href="Data.Nat.Primality.Factorisation.html#3842" class="Bound">rough</a> <a id="3848" href="Data.Nat.Primality.Factorisation.html#3848" class="Bound">eq</a> <a id="3851" class="Symbol">=</a>
  <a id="3855" class="Comment">-- Case 1: m * m &gt; n, ∴ Prime n</a>
    <a id="3891" href="Data.Nat.Primality.Factorisation.html#2640" class="Function">primeFactorisation[p]</a> <a id="3913" class="Symbol">(</a><a id="3914" href="Data.Nat.Primality.html#10386" class="Function">rough∧square&gt;⇒prime</a> <a id="3934" href="Data.Nat.Primality.Factorisation.html#3842" class="Bound">rough</a> <a id="3940" class="Symbol">(</a><a id="3941" href="Data.Nat.Properties.html#49144" class="Function">m∸n≡0⇒m≤n</a> <a id="3951" href="Data.Nat.Primality.Factorisation.html#3848" class="Bound">eq</a><a id="3953" class="Symbol">))</a>
  <a id="3958" href="Data.Nat.Primality.Factorisation.html#3773" class="Function">facRec</a> <a id="3965" class="Symbol">(</a><a id="3966" href="Data.Nat.Primality.Factorisation.html#3966" class="Bound">n</a><a id="3967" class="Symbol">@(</a><a id="3969" href="Data.Nat.Base.html#1101" class="InductiveConstructor">2+</a> <a id="3972" class="Symbol">_)</a> <a id="3975" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3977" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3981" href="Data.Nat.Primality.Factorisation.html#3981" class="Bound">k</a><a id="3982" class="Symbol">)</a> <a id="3984" class="Symbol">(</a><a id="3985" href="Data.Nat.Primality.Factorisation.html#3985" class="Bound">recFactor</a> <a id="3995" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3997" href="Data.Nat.Primality.Factorisation.html#3997" class="Bound">recQuotient</a><a id="4008" class="Symbol">)</a> <a id="4010" class="Symbol">{</a><a id="4011" href="Data.Nat.Primality.Factorisation.html#4011" class="Bound">m</a><a id="4012" class="Symbol">@(</a><a id="4014" href="Data.Nat.Base.html#1101" class="InductiveConstructor">2+</a> <a id="4017" class="Symbol">_)}</a> <a id="4021" href="Data.Nat.Primality.Factorisation.html#4021" class="Bound">rough</a> <a id="4027" href="Data.Nat.Primality.Factorisation.html#4027" class="Bound">eq</a> <a id="4030" class="Keyword">with</a> <a id="4035" href="Data.Nat.Primality.Factorisation.html#4011" class="Bound">m</a> <a id="4037" href="Data.Nat.Divisibility.html#4316" class="Function Operator">∣?</a> <a id="4040" href="Data.Nat.Primality.Factorisation.html#3966" class="Bound">n</a>
  <a id="4044" class="Comment">-- Case 2: m ∤ n, try larger m, reducing k accordingly</a>
  <a id="4101" class="Symbol">...</a> <a id="4105" class="Symbol">|</a> <a id="4107" href="Relation.Nullary.Decidable.Core.html#2083" class="InductiveConstructor">no</a> <a id="4110" href="Data.Nat.Primality.Factorisation.html#4110" class="Bound">m∤n</a> <a id="4114" class="Symbol">=</a> <a id="4116" class="Bound">recFactor</a> <a id="4126" class="Symbol">(</a><a id="4127" href="Data.Nat.Properties.html#10995" class="Function">≤-&lt;-trans</a> <a id="4137" class="Symbol">(</a><a id="4138" href="Data.Nat.Properties.html#47024" class="Function">m∸n≤m</a> <a id="4144" class="Bound">k</a> <a id="4146" class="Symbol">(</a><a id="4147" class="Bound">m</a> <a id="4149" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4151" class="Bound">m</a><a id="4152" class="Symbol">))</a> <a id="4155" class="Symbol">(</a><a id="4156" href="Data.Nat.Properties.html#13192" class="Function">n&lt;1+n</a> <a id="4162" class="Bound">k</a><a id="4163" class="Symbol">))</a> <a id="4166" class="Symbol">{</a><a id="4167" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4171" class="Bound">m</a><a id="4172" class="Symbol">}</a> <a id="4174" class="Symbol">(</a><a id="4175" href="Data.Nat.Primality.html#4414" class="Function">∤⇒rough-suc</a> <a id="4187" href="Data.Nat.Primality.Factorisation.html#4110" class="Bound">m∤n</a> <a id="4191" class="Bound">rough</a><a id="4196" class="Symbol">)</a> <a id="4198" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="4200" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
    <a id="4210" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4214" class="Bound">n</a> <a id="4216" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="4218" class="Symbol">(</a><a id="4219" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4223" class="Bound">m</a> <a id="4225" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4227" class="Bound">m</a> <a id="4229" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="4231" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4235" class="Bound">m</a><a id="4236" class="Symbol">)</a>   <a id="4240" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="4243" href="Relation.Binary.PropositionalEquality.Core.html#1481" class="Function">cong</a> <a id="4248" class="Symbol">(λ</a> <a id="4251" href="Data.Nat.Primality.Factorisation.html#4251" class="Bound">#</a> <a id="4253" class="Symbol">→</a> <a id="4255" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4259" class="Bound">n</a> <a id="4261" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="4263" class="Symbol">(</a><a id="4264" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4268" class="Bound">m</a> <a id="4270" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4272" href="Data.Nat.Primality.Factorisation.html#4251" class="Bound">#</a><a id="4273" class="Symbol">))</a> <a id="4276" class="Symbol">(</a><a id="4277" href="Data.Nat.Properties.html#21359" class="Function">*-suc</a> <a id="4283" class="Bound">m</a> <a id="4285" class="Bound">m</a><a id="4286" class="Symbol">)</a> <a id="4288" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
    <a id="4294" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4298" class="Bound">n</a> <a id="4300" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="4302" class="Symbol">(</a><a id="4303" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4307" class="Bound">m</a> <a id="4309" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4311" class="Symbol">(</a><a id="4312" class="Bound">m</a> <a id="4314" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4316" class="Bound">m</a> <a id="4318" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="4320" class="Bound">m</a><a id="4321" class="Symbol">))</a> <a id="4324" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">≡⟨</a> <a id="4327" href="Relation.Binary.PropositionalEquality.Core.html#1481" class="Function">cong</a> <a id="4332" class="Symbol">(</a><a id="4333" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4337" class="Bound">n</a> <a id="4339" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸_</a><a id="4341" class="Symbol">)</a> <a id="4343" class="Symbol">(</a><a id="4344" href="Data.Nat.Properties.html#15462" class="Function">+-assoc</a> <a id="4352" class="Symbol">(</a><a id="4353" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4357" class="Bound">m</a><a id="4358" class="Symbol">)</a> <a id="4360" class="Bound">m</a> <a id="4362" class="Symbol">(</a><a id="4363" class="Bound">m</a> <a id="4365" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="4367" class="Bound">m</a><a id="4368" class="Symbol">))</a> <a id="4371" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">⟨</a>
    <a id="4377" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4381" class="Bound">n</a> <a id="4383" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="4385" class="Symbol">(</a><a id="4386" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4390" class="Symbol">(</a><a id="4391" class="Bound">m</a> <a id="4393" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4395" class="Bound">m</a><a id="4396" class="Symbol">)</a> <a id="4398" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4400" class="Bound">m</a> <a id="4402" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="4404" class="Bound">m</a><a id="4405" class="Symbol">)</a> <a id="4407" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="4410" href="Relation.Binary.PropositionalEquality.Core.html#1481" class="Function">cong</a> <a id="4415" class="Symbol">(</a><a id="4416" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4420" class="Bound">n</a> <a id="4422" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸_</a><a id="4424" class="Symbol">)</a> <a id="4426" class="Symbol">(</a><a id="4427" href="Data.Nat.Properties.html#15795" class="Function">+-comm</a> <a id="4434" class="Symbol">(</a><a id="4435" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4439" class="Symbol">(</a><a id="4440" class="Bound">m</a> <a id="4442" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4444" class="Bound">m</a><a id="4445" class="Symbol">))</a> <a id="4448" class="Symbol">(</a><a id="4449" class="Bound">m</a> <a id="4451" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="4453" class="Bound">m</a><a id="4454" class="Symbol">))</a> <a id="4457" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
    <a id="4463" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4467" class="Bound">n</a> <a id="4469" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="4471" class="Symbol">(</a><a id="4472" class="Bound">m</a> <a id="4474" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="4476" class="Bound">m</a> <a id="4478" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4480" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4484" class="Symbol">(</a><a id="4485" class="Bound">m</a> <a id="4487" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4489" class="Bound">m</a><a id="4490" class="Symbol">))</a> <a id="4493" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">≡⟨</a> <a id="4496" href="Data.Nat.Properties.html#50135" class="Function">∸-+-assoc</a> <a id="4506" class="Symbol">(</a><a id="4507" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4511" class="Bound">n</a><a id="4512" class="Symbol">)</a> <a id="4514" class="Symbol">(</a><a id="4515" class="Bound">m</a> <a id="4517" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="4519" class="Bound">m</a><a id="4520" class="Symbol">)</a> <a id="4522" class="Symbol">(</a><a id="4523" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4527" class="Symbol">(</a><a id="4528" class="Bound">m</a> <a id="4530" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4532" class="Bound">m</a><a id="4533" class="Symbol">))</a> <a id="4536" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">⟨</a>
    <a id="4542" class="Symbol">(</a><a id="4543" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4547" class="Bound">n</a> <a id="4549" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="4551" class="Bound">m</a> <a id="4553" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="4555" class="Bound">m</a><a id="4556" class="Symbol">)</a> <a id="4558" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="4560" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4564" class="Symbol">(</a><a id="4565" class="Bound">m</a> <a id="4567" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4569" class="Bound">m</a><a id="4570" class="Symbol">)</a> <a id="4572" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="4575" href="Relation.Binary.PropositionalEquality.Core.html#1481" class="Function">cong</a> <a id="4580" class="Symbol">(</a><a id="4581" href="Data.Nat.Base.html#4462" class="Primitive Operator">_∸</a> <a id="4584" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4588" class="Symbol">(</a><a id="4589" class="Bound">m</a> <a id="4591" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4593" class="Bound">m</a><a id="4594" class="Symbol">))</a> <a id="4597" class="Bound">eq</a> <a id="4600" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
    <a id="4606" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4610" class="Bound">k</a> <a id="4612" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="4614" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4618" class="Symbol">(</a><a id="4619" class="Bound">m</a> <a id="4621" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4623" class="Bound">m</a><a id="4624" class="Symbol">)</a>           <a id="4636" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
    <a id="4642" class="Keyword">where</a> <a id="4648" class="Keyword">open</a> <a id="4653" href="Relation.Binary.PropositionalEquality.Properties.html#6850" class="Module">≡-Reasoning</a>
  <a id="4667" class="Comment">-- Case 3: m ∣ n, record m and recurse on the quotient</a>
  <a id="4724" class="Symbol">...</a> <a id="4728" class="Symbol">|</a> <a id="4730" href="Relation.Nullary.Decidable.Core.html#2046" class="InductiveConstructor">yes</a> <a id="4734" href="Data.Nat.Primality.Factorisation.html#4734" class="Bound">m∣n</a> <a id="4738" class="Symbol">=</a> <a id="4740" class="Keyword">record</a>
    <a id="4751" class="Symbol">{</a> <a id="4753" href="Data.Nat.Primality.Factorisation.html#2223" class="Field">factors</a> <a id="4761" class="Symbol">=</a> <a id="4763" class="Bound">m</a> <a id="4765" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4767" href="Data.Nat.Primality.Factorisation.html#5379" class="Function">ps</a>
    <a id="4774" class="Symbol">;</a> <a id="4776" href="Data.Nat.Primality.Factorisation.html#2244" class="Field">isFactorisation</a> <a id="4792" class="Symbol">=</a> <a id="4794" href="Relation.Binary.PropositionalEquality.Core.html#2035" class="Function">sym</a> <a id="4798" href="Data.Nat.Primality.Factorisation.html#5462" class="Function">m*Πps≡n</a>
    <a id="4810" class="Symbol">;</a> <a id="4812" href="Data.Nat.Primality.Factorisation.html#2286" class="Field">factorsPrime</a> <a id="4825" class="Symbol">=</a> <a id="4827" href="Data.Nat.Primality.html#10205" class="Function">rough∧∣⇒prime</a> <a id="4841" class="Bound">rough</a> <a id="4847" href="Data.Nat.Primality.Factorisation.html#4734" class="Bound">m∣n</a> <a id="4851" href="Data.List.Relation.Unary.All.html#1718" class="InductiveConstructor Operator">∷</a> <a id="4853" href="Data.Nat.Primality.Factorisation.html#5416" class="Function">primes</a>
    <a id="4864" class="Symbol">}</a>
    <a id="4870" class="Keyword">where</a>
      <a id="4882" href="Data.Nat.Primality.Factorisation.html#4882" class="Function">m&lt;n</a> <a id="4886" class="Symbol">:</a> <a id="4888" class="Bound">m</a> <a id="4890" href="Data.Nat.Base.html#1807" class="Function Operator">&lt;</a> <a id="4892" class="Bound">n</a>
      <a id="4900" href="Data.Nat.Primality.Factorisation.html#4882" class="Function">m&lt;n</a> <a id="4904" class="Symbol">=</a> <a id="4906" href="Relation.Binary.Reasoning.Syntax.html#3008" class="Function Operator">begin-strict</a>
        <a id="4927" class="Bound">m</a>            <a id="4940" href="Relation.Binary.Reasoning.Syntax.html#5689" class="Function">&lt;⟨</a> <a id="4943" href="Data.Nat.Base.html#1762" class="InductiveConstructor">s≤s</a> <a id="4947" class="Symbol">(</a><a id="4948" href="Data.Nat.Properties.html#6183" class="Function">≤-trans</a> <a id="4956" class="Symbol">(</a><a id="4957" href="Data.Nat.Properties.html#19414" class="Function">m≤n+m</a> <a id="4963" class="Bound">m</a> <a id="4965" class="Symbol">_)</a> <a id="4968" class="Symbol">(</a><a id="4969" href="Data.Nat.Properties.html#19995" class="Function">+-monoʳ-≤</a> <a id="4979" class="Symbol">_</a> <a id="4981" class="Symbol">(</a><a id="4982" href="Data.Nat.Properties.html#19331" class="Function">m≤m+n</a> <a id="4988" class="Bound">m</a> <a id="4990" class="Symbol">_)))</a> <a id="4995" href="Relation.Binary.Reasoning.Syntax.html#5689" class="Function">⟩</a>
        <a id="5005" href="Data.Nat.Base.html#5272" class="Function">pred</a> <a id="5010" class="Symbol">(</a><a id="5011" class="Bound">m</a> <a id="5013" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="5015" class="Bound">m</a><a id="5016" class="Symbol">)</a> <a id="5018" href="Relation.Binary.Reasoning.Syntax.html#5689" class="Function">&lt;⟨</a> <a id="5021" href="Data.Nat.Base.html#2091" class="Function">s&lt;s⁻¹</a> <a id="5027" class="Symbol">(</a><a id="5028" href="Data.Nat.Properties.html#49498" class="Function">m∸n≢0⇒n&lt;m</a> <a id="5038" class="Symbol">λ</a> <a id="5040" href="Data.Nat.Primality.Factorisation.html#5040" class="Bound">eq′</a> <a id="5044" class="Symbol">→</a> <a id="5046" href="Data.Nat.Properties.html#4454" class="Function">0≢1+n</a> <a id="5052" class="Symbol">(</a><a id="5053" href="Relation.Binary.PropositionalEquality.Core.html#2080" class="Function">trans</a> <a id="5059" class="Symbol">(</a><a id="5060" href="Relation.Binary.PropositionalEquality.Core.html#2035" class="Function">sym</a> <a id="5064" href="Data.Nat.Primality.Factorisation.html#5040" class="Bound">eq′</a><a id="5067" class="Symbol">)</a> <a id="5069" class="Bound">eq</a><a id="5071" class="Symbol">))</a> <a id="5074" href="Relation.Binary.Reasoning.Syntax.html#5689" class="Function">⟩</a>
        <a id="5084" class="Bound">n</a>            <a id="5097" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
        <a id="5107" class="Keyword">where</a> <a id="5113" class="Keyword">open</a> <a id="5118" href="Data.Nat.Properties.html#14845" class="Module">≤-Reasoning</a>

      <a id="5137" href="Data.Nat.Primality.Factorisation.html#5137" class="Function">q</a> <a id="5139" class="Symbol">=</a> <a id="5141" href="Data.Nat.Divisibility.Core.html#1247" class="Field">quotient</a> <a id="5150" href="Data.Nat.Primality.Factorisation.html#4734" class="Bound">m∣n</a>

      <a id="5161" class="Keyword">instance</a> <a id="5170" href="Data.Nat.Primality.Factorisation.html#5170" class="Function">_</a>  <a id="5173" class="Symbol">=</a> <a id="5175" href="Data.Nat.Base.html#3968" class="Function">n&gt;1⇒nonTrivial</a> <a id="5190" class="Symbol">(</a><a id="5191" href="Data.Nat.Divisibility.html#1959" class="Function">quotient&gt;1</a> <a id="5202" href="Data.Nat.Primality.Factorisation.html#4734" class="Bound">m∣n</a> <a id="5206" href="Data.Nat.Primality.Factorisation.html#4882" class="Function">m&lt;n</a><a id="5209" class="Symbol">)</a>

      <a id="5218" href="Data.Nat.Primality.Factorisation.html#5218" class="Function">factorisation[q]</a> <a id="5235" class="Symbol">:</a> <a id="5237" href="Data.Nat.Primality.Factorisation.html#2172" class="Record">PrimeFactorisation</a> <a id="5256" href="Data.Nat.Primality.Factorisation.html#5137" class="Function">q</a>
      <a id="5264" href="Data.Nat.Primality.Factorisation.html#5218" class="Function">factorisation[q]</a> <a id="5281" class="Symbol">=</a> <a id="5283" class="Bound">recQuotient</a> <a id="5295" class="Symbol">(</a><a id="5296" href="Data.Nat.Divisibility.html#2242" class="Function">quotient-&lt;</a> <a id="5307" href="Data.Nat.Primality.Factorisation.html#4734" class="Bound">m∣n</a><a id="5310" class="Symbol">)</a> <a id="5312" class="Symbol">(</a><a id="5313" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="5317" href="Data.Nat.Primality.Factorisation.html#5137" class="Function">q</a> <a id="5319" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="5321" class="Bound">m</a> <a id="5323" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="5325" class="Bound">m</a><a id="5326" class="Symbol">)</a> <a id="5328" class="Symbol">(</a><a id="5329" href="Data.Nat.Primality.html#4701" class="Function">rough∧∣⇒rough</a> <a id="5343" class="Bound">rough</a> <a id="5349" class="Symbol">(</a><a id="5350" href="Data.Nat.Divisibility.html#1852" class="Function">quotient-∣</a> <a id="5361" href="Data.Nat.Primality.Factorisation.html#4734" class="Bound">m∣n</a><a id="5364" class="Symbol">))</a> <a id="5367" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

      <a id="5379" href="Data.Nat.Primality.Factorisation.html#5379" class="Function">ps</a> <a id="5382" class="Symbol">=</a> <a id="5384" href="Data.Nat.Primality.Factorisation.html#2223" class="Field">factors</a> <a id="5392" href="Data.Nat.Primality.Factorisation.html#5218" class="Function">factorisation[q]</a>

      <a id="5416" href="Data.Nat.Primality.Factorisation.html#5416" class="Function">primes</a> <a id="5423" class="Symbol">=</a> <a id="5425" href="Data.Nat.Primality.Factorisation.html#2286" class="Field">factorsPrime</a> <a id="5438" href="Data.Nat.Primality.Factorisation.html#5218" class="Function">factorisation[q]</a>

      <a id="5462" href="Data.Nat.Primality.Factorisation.html#5462" class="Function">m*Πps≡n</a> <a id="5470" class="Symbol">:</a> <a id="5472" class="Bound">m</a> <a id="5474" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="5476" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="5484" href="Data.Nat.Primality.Factorisation.html#5379" class="Function">ps</a> <a id="5487" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="5489" class="Bound">n</a>
      <a id="5497" href="Data.Nat.Primality.Factorisation.html#5462" class="Function">m*Πps≡n</a> <a id="5505" class="Symbol">=</a> <a id="5507" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
        <a id="5521" class="Bound">m</a> <a id="5523" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="5525" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="5533" href="Data.Nat.Primality.Factorisation.html#5379" class="Function">ps</a> <a id="5536" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">≡⟨</a> <a id="5539" href="Relation.Binary.PropositionalEquality.Core.html#1481" class="Function">cong</a> <a id="5544" class="Symbol">(</a><a id="5545" class="Bound">m</a> <a id="5547" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*_</a><a id="5549" class="Symbol">)</a> <a id="5551" class="Symbol">(</a><a id="5552" href="Data.Nat.Primality.Factorisation.html#2244" class="Field">isFactorisation</a> <a id="5568" href="Data.Nat.Primality.Factorisation.html#5218" class="Function">factorisation[q]</a><a id="5584" class="Symbol">)</a> <a id="5586" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">⟨</a>
        <a id="5596" class="Bound">m</a> <a id="5598" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="5600" href="Data.Nat.Primality.Factorisation.html#5137" class="Function">q</a>          <a id="5611" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">≡⟨</a> <a id="5614" href="Data.Nat.Divisibility.html#1713" class="Function">m∣n⇒n≡m*quotient</a> <a id="5631" href="Data.Nat.Primality.Factorisation.html#4734" class="Bound">m∣n</a> <a id="5635" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">⟨</a>
        <a id="5645" class="Bound">n</a>              <a id="5660" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
        <a id="5670" class="Keyword">where</a> <a id="5676" class="Keyword">open</a> <a id="5681" href="Relation.Binary.PropositionalEquality.Properties.html#6850" class="Module">≡-Reasoning</a>

<a id="5694" class="Comment">------------------------------------------------------------------------</a>
<a id="5767" class="Comment">-- Properties of a factorisation</a>

<a id="factorisationHasAllPrimeFactors"></a><a id="5801" href="Data.Nat.Primality.Factorisation.html#5801" class="Function">factorisationHasAllPrimeFactors</a> <a id="5833" class="Symbol">:</a> <a id="5835" class="Symbol">∀</a> <a id="5837" class="Symbol">{</a><a id="5838" href="Data.Nat.Primality.Factorisation.html#5838" class="Bound">as</a><a id="5840" class="Symbol">}</a> <a id="5842" class="Symbol">{</a><a id="5843" href="Data.Nat.Primality.Factorisation.html#5843" class="Bound">p</a><a id="5844" class="Symbol">}</a> <a id="5846" class="Symbol">→</a> <a id="5848" href="Data.Nat.Primality.html#3204" class="Record">Prime</a> <a id="5854" href="Data.Nat.Primality.Factorisation.html#5843" class="Bound">p</a> <a id="5856" class="Symbol">→</a> <a id="5858" href="Data.Nat.Primality.Factorisation.html#5843" class="Bound">p</a> <a id="5860" href="Data.Nat.Divisibility.Core.html#1191" class="Record Operator">∣</a> <a id="5862" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="5870" href="Data.Nat.Primality.Factorisation.html#5838" class="Bound">as</a> <a id="5873" class="Symbol">→</a> <a id="5875" href="Data.List.Relation.Unary.All.html#1638" class="Datatype">All</a> <a id="5879" href="Data.Nat.Primality.html#3204" class="Record">Prime</a> <a id="5885" href="Data.Nat.Primality.Factorisation.html#5838" class="Bound">as</a> <a id="5888" class="Symbol">→</a> <a id="5890" href="Data.Nat.Primality.Factorisation.html#5843" class="Bound">p</a> <a id="5892" href="Data.List.Membership.Setoid.html#925" class="Function Operator">∈</a> <a id="5894" href="Data.Nat.Primality.Factorisation.html#5838" class="Bound">as</a>
<a id="5897" href="Data.Nat.Primality.Factorisation.html#5801" class="Function">factorisationHasAllPrimeFactors</a> <a id="5929" class="Symbol">{</a><a id="5930" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5932" class="Symbol">}</a> <a id="5934" class="Symbol">{</a><a id="5935" href="Data.Nat.Base.html#1101" class="InductiveConstructor">2+</a> <a id="5938" href="Data.Nat.Primality.Factorisation.html#5938" class="Bound">p</a><a id="5939" class="Symbol">}</a> <a id="5941" href="Data.Nat.Primality.Factorisation.html#5941" class="Bound">pPrime</a> <a id="5948" href="Data.Nat.Primality.Factorisation.html#5948" class="Bound">p∣Πas</a> <a id="5954" href="Data.List.Relation.Unary.All.html#1701" class="InductiveConstructor">[]</a> <a id="5957" class="Symbol">=</a> <a id="5959" href="Relation.Nullary.Negation.Core.html#1289" class="Function">contradiction</a> <a id="5973" class="Symbol">(</a><a id="5974" href="Data.Nat.Divisibility.html#5586" class="Function">∣1⇒≡1</a> <a id="5980" href="Data.Nat.Primality.Factorisation.html#5948" class="Bound">p∣Πas</a><a id="5985" class="Symbol">)</a> <a id="5987" class="Symbol">λ</a> <a id="5989" class="Symbol">()</a>
<a id="5992" href="Data.Nat.Primality.Factorisation.html#5801" class="Function">factorisationHasAllPrimeFactors</a> <a id="6024" class="Symbol">{</a><a id="6025" href="Data.Nat.Primality.Factorisation.html#6025" class="Bound">a</a> <a id="6027" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6029" href="Data.Nat.Primality.Factorisation.html#6029" class="Bound">as</a><a id="6031" class="Symbol">}</a> <a id="6033" class="Symbol">{</a><a id="6034" href="Data.Nat.Primality.Factorisation.html#6034" class="Bound">p</a><a id="6035" class="Symbol">}</a> <a id="6037" href="Data.Nat.Primality.Factorisation.html#6037" class="Bound">pPrime</a> <a id="6044" href="Data.Nat.Primality.Factorisation.html#6044" class="Bound">p∣aΠas</a> <a id="6051" class="Symbol">(</a><a id="6052" href="Data.Nat.Primality.Factorisation.html#6052" class="Bound">aPrime</a> <a id="6059" href="Data.List.Relation.Unary.All.html#1718" class="InductiveConstructor Operator">∷</a> <a id="6061" href="Data.Nat.Primality.Factorisation.html#6061" class="Bound">asPrime</a><a id="6068" class="Symbol">)</a> <a id="6070" class="Keyword">with</a> <a id="6075" href="Data.Nat.Primality.html#8470" class="Function">euclidsLemma</a> <a id="6088" href="Data.Nat.Primality.Factorisation.html#6025" class="Bound">a</a> <a id="6090" class="Symbol">(</a><a id="6091" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="6099" href="Data.Nat.Primality.Factorisation.html#6029" class="Bound">as</a><a id="6101" class="Symbol">)</a> <a id="6103" href="Data.Nat.Primality.Factorisation.html#6037" class="Bound">pPrime</a> <a id="6110" href="Data.Nat.Primality.Factorisation.html#6044" class="Bound">p∣aΠas</a>
<a id="6117" class="Symbol">...</a> <a id="6121" class="Symbol">|</a> <a id="6123" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="6128" href="Data.Nat.Primality.Factorisation.html#6128" class="Bound">p∣Πas</a> <a id="6134" class="Symbol">=</a> <a id="6136" href="Data.List.Relation.Unary.Any.html#1264" class="InductiveConstructor">there</a> <a id="6142" class="Symbol">(</a><a id="6143" href="Data.Nat.Primality.Factorisation.html#5801" class="Function">factorisationHasAllPrimeFactors</a> <a id="6175" class="Bound">pPrime</a> <a id="6182" href="Data.Nat.Primality.Factorisation.html#6128" class="Bound">p∣Πas</a> <a id="6188" class="Bound">asPrime</a><a id="6195" class="Symbol">)</a>
<a id="6197" class="Symbol">...</a> <a id="6201" class="Symbol">|</a> <a id="6203" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="6208" href="Data.Nat.Primality.Factorisation.html#6208" class="Bound">p∣a</a> <a id="6212" class="Keyword">with</a> <a id="6217" href="Data.Nat.Primality.html#13224" class="Function">prime⇒irreducible</a> <a id="6235" class="Bound">aPrime</a> <a id="6242" href="Data.Nat.Primality.Factorisation.html#6208" class="Bound">p∣a</a>
<a id="6246" class="Symbol">...</a>   <a id="6252" class="Symbol">|</a> <a id="6254" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="6259" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="6264" class="Symbol">=</a> <a id="6266" href="Relation.Nullary.Negation.Core.html#1289" class="Function">contradiction</a> <a id="6280" class="Bound">pPrime</a> <a id="6287" href="Data.Nat.Primality.html#7082" class="Function">¬prime[1]</a>
<a id="6297" class="Symbol">...</a>   <a id="6303" class="Symbol">|</a> <a id="6305" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="6310" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="6315" class="Symbol">=</a> <a id="6317" href="Data.List.Relation.Unary.Any.html#1211" class="InductiveConstructor">here</a> <a id="6322" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="6328" class="Keyword">private</a>
  <a id="factorisationUnique′"></a><a id="6338" href="Data.Nat.Primality.Factorisation.html#6338" class="Function">factorisationUnique′</a> <a id="6359" class="Symbol">:</a> <a id="6361" class="Symbol">(</a><a id="6362" href="Data.Nat.Primality.Factorisation.html#6362" class="Bound">as</a> <a id="6365" href="Data.Nat.Primality.Factorisation.html#6365" class="Bound">bs</a> <a id="6368" class="Symbol">:</a> <a id="6370" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="6375" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="6376" class="Symbol">)</a> <a id="6378" class="Symbol">→</a> <a id="6380" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="6388" href="Data.Nat.Primality.Factorisation.html#6362" class="Bound">as</a> <a id="6391" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="6393" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="6401" href="Data.Nat.Primality.Factorisation.html#6365" class="Bound">bs</a> <a id="6404" class="Symbol">→</a> <a id="6406" href="Data.List.Relation.Unary.All.html#1638" class="Datatype">All</a> <a id="6410" href="Data.Nat.Primality.html#3204" class="Record">Prime</a> <a id="6416" href="Data.Nat.Primality.Factorisation.html#6362" class="Bound">as</a> <a id="6419" class="Symbol">→</a> <a id="6421" href="Data.List.Relation.Unary.All.html#1638" class="Datatype">All</a> <a id="6425" href="Data.Nat.Primality.html#3204" class="Record">Prime</a> <a id="6431" href="Data.Nat.Primality.Factorisation.html#6365" class="Bound">bs</a> <a id="6434" class="Symbol">→</a> <a id="6436" href="Data.Nat.Primality.Factorisation.html#6362" class="Bound">as</a> <a id="6439" href="Data.List.Relation.Binary.Permutation.Propositional.html#1513" class="Datatype Operator">↭</a> <a id="6441" href="Data.Nat.Primality.Factorisation.html#6365" class="Bound">bs</a>
  <a id="6446" href="Data.Nat.Primality.Factorisation.html#6338" class="Function">factorisationUnique′</a> <a id="6467" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="6470" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="6473" href="Data.Nat.Primality.Factorisation.html#6473" class="Bound">Πas≡Πbs</a> <a id="6481" href="Data.Nat.Primality.Factorisation.html#6481" class="Bound">asPrime</a> <a id="6489" href="Data.Nat.Primality.Factorisation.html#6489" class="Bound">bsPrime</a> <a id="6497" class="Symbol">=</a> <a id="6499" href="Data.List.Relation.Binary.Permutation.Propositional.html#1715" class="Function">↭-refl</a>
  <a id="6508" href="Data.Nat.Primality.Factorisation.html#6338" class="Function">factorisationUnique′</a> <a id="6529" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="6532" class="Symbol">(</a><a id="6533" href="Data.Nat.Primality.Factorisation.html#6533" class="Bound">b</a><a id="6534" class="Symbol">@(</a><a id="6536" href="Data.Nat.Base.html#1101" class="InductiveConstructor">2+</a> <a id="6539" class="Symbol">_)</a> <a id="6542" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6544" href="Data.Nat.Primality.Factorisation.html#6544" class="Bound">bs</a><a id="6546" class="Symbol">)</a> <a id="6548" href="Data.Nat.Primality.Factorisation.html#6548" class="Bound">Πas≡Πbs</a> <a id="6556" href="Data.Nat.Primality.Factorisation.html#6556" class="Bound">prime[as]</a> <a id="6566" class="Symbol">(_</a> <a id="6569" href="Data.List.Relation.Unary.All.html#1718" class="InductiveConstructor Operator">∷</a> <a id="6571" href="Data.Nat.Primality.Factorisation.html#6571" class="Bound">prime[bs]</a><a id="6580" class="Symbol">)</a> <a id="6582" class="Symbol">=</a>
    <a id="6588" href="Relation.Nullary.Negation.Core.html#1289" class="Function">contradiction</a> <a id="6602" href="Data.Nat.Primality.Factorisation.html#6548" class="Bound">Πas≡Πbs</a> <a id="6610" class="Symbol">(</a><a id="6611" href="Data.Nat.Properties.html#9444" class="Function">&lt;⇒≢</a> <a id="6615" href="Data.Nat.Primality.Factorisation.html#6640" class="Function">Πas&lt;Πbs</a><a id="6622" class="Symbol">)</a>
    <a id="6628" class="Keyword">where</a>
      <a id="6640" href="Data.Nat.Primality.Factorisation.html#6640" class="Function">Πas&lt;Πbs</a> <a id="6648" class="Symbol">:</a> <a id="6650" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="6658" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="6661" href="Data.Nat.Base.html#1807" class="Function Operator">&lt;</a> <a id="6663" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="6671" class="Symbol">(</a><a id="6672" href="Data.Nat.Primality.Factorisation.html#6533" class="Bound">b</a> <a id="6674" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6676" href="Data.Nat.Primality.Factorisation.html#6544" class="Bound">bs</a><a id="6678" class="Symbol">)</a>
      <a id="6686" href="Data.Nat.Primality.Factorisation.html#6640" class="Function">Πas&lt;Πbs</a> <a id="6694" class="Symbol">=</a> <a id="6696" href="Relation.Binary.Reasoning.Syntax.html#3008" class="Function Operator">begin-strict</a>
        <a id="6717" class="Number">1</a>                <a id="6734" href="Relation.Binary.Reasoning.Syntax.html#11079" class="Function">≡⟨⟩</a>
        <a id="6746" class="Number">1</a> <a id="6748" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="6750" class="Number">1</a>            <a id="6763" href="Relation.Binary.Reasoning.Syntax.html#5689" class="Function">&lt;⟨</a> <a id="6766" href="Data.Nat.Properties.html#28208" class="Function">*-monoˡ-&lt;</a> <a id="6776" class="Number">1</a> <a id="6778" class="Symbol">{</a><a id="6779" class="Number">1</a><a id="6780" class="Symbol">}</a> <a id="6782" class="Symbol">{</a><a id="6783" href="Data.Nat.Primality.Factorisation.html#6533" class="Bound">b</a><a id="6784" class="Symbol">}</a> <a id="6786" href="Data.Nat.Base.html#1961" class="InductiveConstructor">sz&lt;ss</a> <a id="6792" href="Relation.Binary.Reasoning.Syntax.html#5689" class="Function">⟩</a>
        <a id="6802" href="Data.Nat.Primality.Factorisation.html#6533" class="Bound">b</a> <a id="6804" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="6806" class="Number">1</a>            <a id="6819" href="Relation.Binary.Reasoning.Syntax.html#5544" class="Function">≤⟨</a> <a id="6822" href="Data.Nat.Properties.html#27955" class="Function">*-monoʳ-≤</a> <a id="6832" href="Data.Nat.Primality.Factorisation.html#6533" class="Bound">b</a> <a id="6834" class="Symbol">(</a><a id="6835" href="Data.Nat.Primality.html#11484" class="Function">productOfPrimes≥1</a> <a id="6853" href="Data.Nat.Primality.Factorisation.html#6571" class="Bound">prime[bs]</a><a id="6862" class="Symbol">)</a> <a id="6864" href="Relation.Binary.Reasoning.Syntax.html#5544" class="Function">⟩</a>
        <a id="6874" href="Data.Nat.Primality.Factorisation.html#6533" class="Bound">b</a> <a id="6876" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="6878" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="6886" href="Data.Nat.Primality.Factorisation.html#6544" class="Bound">bs</a>   <a id="6891" href="Relation.Binary.Reasoning.Syntax.html#11079" class="Function">≡⟨⟩</a>
        <a id="6903" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="6911" class="Symbol">(</a><a id="6912" href="Data.Nat.Primality.Factorisation.html#6533" class="Bound">b</a> <a id="6914" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6916" href="Data.Nat.Primality.Factorisation.html#6544" class="Bound">bs</a><a id="6918" class="Symbol">)</a> <a id="6920" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
        <a id="6930" class="Keyword">where</a> <a id="6936" class="Keyword">open</a> <a id="6941" href="Data.Nat.Properties.html#14845" class="Module">≤-Reasoning</a>

  <a id="6956" href="Data.Nat.Primality.Factorisation.html#6338" class="Function">factorisationUnique′</a> <a id="6977" class="Symbol">(</a><a id="6978" href="Data.Nat.Primality.Factorisation.html#6978" class="Bound">a</a> <a id="6980" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6982" href="Data.Nat.Primality.Factorisation.html#6982" class="Bound">as</a><a id="6984" class="Symbol">)</a> <a id="6986" href="Data.Nat.Primality.Factorisation.html#6986" class="Bound">bs</a> <a id="6989" href="Data.Nat.Primality.Factorisation.html#6989" class="Bound">Πas≡Πbs</a> <a id="6997" class="Symbol">(</a><a id="6998" href="Data.Nat.Primality.Factorisation.html#6998" class="Bound">prime[a]</a> <a id="7007" href="Data.List.Relation.Unary.All.html#1718" class="InductiveConstructor Operator">∷</a> <a id="7009" href="Data.Nat.Primality.Factorisation.html#7009" class="Bound">prime[as]</a><a id="7018" class="Symbol">)</a> <a id="7020" href="Data.Nat.Primality.Factorisation.html#7020" class="Bound">prime[bs]</a> <a id="7030" class="Symbol">=</a> <a id="7032" href="Data.Nat.Primality.Factorisation.html#7934" class="Function">a∷as↭bs</a>
    <a id="7044" class="Keyword">where</a>
      <a id="7056" href="Data.Nat.Primality.Factorisation.html#7056" class="Function">a∣Πbs</a> <a id="7062" class="Symbol">:</a> <a id="7064" href="Data.Nat.Primality.Factorisation.html#6978" class="Bound">a</a> <a id="7066" href="Data.Nat.Divisibility.Core.html#1191" class="Record Operator">∣</a> <a id="7068" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7076" href="Data.Nat.Primality.Factorisation.html#6986" class="Bound">bs</a>
      <a id="7085" href="Data.Nat.Primality.Factorisation.html#7056" class="Function">a∣Πbs</a> <a id="7091" class="Symbol">=</a> <a id="7093" href="Data.Nat.Divisibility.Core.html#1231" class="InductiveConstructor">divides</a> <a id="7101" class="Symbol">(</a><a id="7102" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7110" href="Data.Nat.Primality.Factorisation.html#6982" class="Bound">as</a><a id="7112" class="Symbol">)</a> <a id="7114" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="7116" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
        <a id="7130" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7138" href="Data.Nat.Primality.Factorisation.html#6986" class="Bound">bs</a>       <a id="7147" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">≡⟨</a> <a id="7150" href="Data.Nat.Primality.Factorisation.html#6989" class="Bound">Πas≡Πbs</a> <a id="7158" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">⟨</a>
        <a id="7168" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7176" class="Symbol">(</a><a id="7177" href="Data.Nat.Primality.Factorisation.html#6978" class="Bound">a</a> <a id="7179" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="7181" href="Data.Nat.Primality.Factorisation.html#6982" class="Bound">as</a><a id="7183" class="Symbol">)</a> <a id="7185" href="Relation.Binary.Reasoning.Syntax.html#11079" class="Function">≡⟨⟩</a>
        <a id="7197" href="Data.Nat.Primality.Factorisation.html#6978" class="Bound">a</a> <a id="7199" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="7201" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7209" href="Data.Nat.Primality.Factorisation.html#6982" class="Bound">as</a>   <a id="7214" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="7217" href="Data.Nat.Properties.html#22333" class="Function">*-comm</a> <a id="7224" href="Data.Nat.Primality.Factorisation.html#6978" class="Bound">a</a> <a id="7226" class="Symbol">(</a><a id="7227" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7235" href="Data.Nat.Primality.Factorisation.html#6982" class="Bound">as</a><a id="7237" class="Symbol">)</a> <a id="7239" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
        <a id="7249" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7257" href="Data.Nat.Primality.Factorisation.html#6982" class="Bound">as</a> <a id="7260" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="7262" href="Data.Nat.Primality.Factorisation.html#6978" class="Bound">a</a>   <a id="7266" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
        <a id="7276" class="Keyword">where</a> <a id="7282" class="Keyword">open</a> <a id="7287" href="Relation.Binary.PropositionalEquality.Properties.html#6850" class="Module">≡-Reasoning</a>

      <a id="7306" href="Data.Nat.Primality.Factorisation.html#7306" class="Function">shuffle</a> <a id="7314" class="Symbol">:</a> <a id="7316" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="7319" href="Data.Nat.Primality.Factorisation.html#7319" class="Bound">bs′</a> <a id="7323" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="7325" href="Data.Nat.Primality.Factorisation.html#6986" class="Bound">bs</a> <a id="7328" href="Data.List.Relation.Binary.Permutation.Propositional.html#1513" class="Datatype Operator">↭</a> <a id="7330" href="Data.Nat.Primality.Factorisation.html#6978" class="Bound">a</a> <a id="7332" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="7334" href="Data.Nat.Primality.Factorisation.html#7319" class="Bound">bs′</a>
      <a id="7344" href="Data.Nat.Primality.Factorisation.html#7306" class="Function">shuffle</a> <a id="7352" class="Keyword">with</a> <a id="7357" href="Data.Nat.Primality.Factorisation.html#7357" class="Bound">ys</a> <a id="7360" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7362" href="Data.Nat.Primality.Factorisation.html#7362" class="Bound">zs</a> <a id="7365" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7367" href="Data.Nat.Primality.Factorisation.html#7367" class="Bound">p</a> ← <a id="7371" href="Data.List.Membership.Propositional.Properties.html#5079" class="Function">∈-∃++</a> <a id="7377" class="Symbol">(</a><a id="7378" href="Data.Nat.Primality.Factorisation.html#5801" class="Function">factorisationHasAllPrimeFactors</a> <a id="7410" href="Data.Nat.Primality.Factorisation.html#6998" class="Bound">prime[a]</a> <a id="7419" href="Data.Nat.Primality.Factorisation.html#7056" class="Function">a∣Πbs</a> <a id="7425" href="Data.Nat.Primality.Factorisation.html#7020" class="Bound">prime[bs]</a><a id="7434" class="Symbol">)</a>
        <a id="7444" class="Symbol">=</a> <a id="7446" href="Data.Nat.Primality.Factorisation.html#7357" class="Bound">ys</a> <a id="7449" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="7452" href="Data.Nat.Primality.Factorisation.html#7362" class="Bound">zs</a> <a id="7455" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7457" href="Data.List.Relation.Binary.Permutation.Propositional.html#2395" class="Function">↭-trans</a> <a id="7465" class="Symbol">(</a><a id="7466" href="Data.List.Relation.Binary.Permutation.Propositional.html#1976" class="Function">↭-reflexive</a> <a id="7478" href="Data.Nat.Primality.Factorisation.html#7367" class="Bound">p</a><a id="7479" class="Symbol">)</a> <a id="7481" class="Symbol">(</a><a id="7482" href="Data.List.Relation.Binary.Permutation.Propositional.Properties.html#7376" class="Function">shift</a> <a id="7488" href="Data.Nat.Primality.Factorisation.html#6978" class="Bound">a</a> <a id="7490" href="Data.Nat.Primality.Factorisation.html#7357" class="Bound">ys</a> <a id="7493" href="Data.Nat.Primality.Factorisation.html#7362" class="Bound">zs</a><a id="7495" class="Symbol">)</a>

      <a id="7504" href="Data.Nat.Primality.Factorisation.html#7504" class="Function">bs′</a> <a id="7508" class="Symbol">=</a> <a id="7510" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="7516" href="Data.Nat.Primality.Factorisation.html#7306" class="Function">shuffle</a>
      <a id="7530" href="Data.Nat.Primality.Factorisation.html#7530" class="Function">bs↭a∷bs′</a> <a id="7539" class="Symbol">=</a> <a id="7541" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="7547" href="Data.Nat.Primality.Factorisation.html#7306" class="Function">shuffle</a>

      <a id="7562" href="Data.Nat.Primality.Factorisation.html#7562" class="Function">Πas≡Πbs′</a> <a id="7571" class="Symbol">:</a> <a id="7573" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7581" href="Data.Nat.Primality.Factorisation.html#6982" class="Bound">as</a> <a id="7584" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="7586" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7594" href="Data.Nat.Primality.Factorisation.html#7504" class="Function">bs′</a>
      <a id="7604" href="Data.Nat.Primality.Factorisation.html#7562" class="Function">Πas≡Πbs′</a> <a id="7613" class="Symbol">=</a> <a id="7615" href="Data.Nat.Properties.html#25706" class="Function">*-cancelˡ-≡</a> <a id="7627" class="Symbol">(</a><a id="7628" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7636" href="Data.Nat.Primality.Factorisation.html#6982" class="Bound">as</a><a id="7638" class="Symbol">)</a> <a id="7640" class="Symbol">(</a><a id="7641" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7649" href="Data.Nat.Primality.Factorisation.html#7504" class="Function">bs′</a><a id="7652" class="Symbol">)</a> <a id="7654" href="Data.Nat.Primality.Factorisation.html#6978" class="Bound">a</a> <a id="7656" class="Symbol">{{</a><a id="7658" href="Data.Nat.Primality.html#7163" class="Function">prime⇒nonZero</a> <a id="7672" href="Data.Nat.Primality.Factorisation.html#6998" class="Bound">prime[a]</a><a id="7680" class="Symbol">}}</a> <a id="7683" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="7685" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
        <a id="7699" href="Data.Nat.Primality.Factorisation.html#6978" class="Bound">a</a> <a id="7701" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="7703" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7711" href="Data.Nat.Primality.Factorisation.html#6982" class="Bound">as</a>  <a id="7715" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="7718" href="Data.Nat.Primality.Factorisation.html#6989" class="Bound">Πas≡Πbs</a> <a id="7726" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
        <a id="7736" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7744" href="Data.Nat.Primality.Factorisation.html#6986" class="Bound">bs</a>      <a id="7752" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="7755" href="Data.Nat.ListAction.Properties.html#2885" class="Function">product-↭</a> <a id="7765" href="Data.Nat.Primality.Factorisation.html#7530" class="Function">bs↭a∷bs′</a> <a id="7774" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
        <a id="7784" href="Data.Nat.Primality.Factorisation.html#6978" class="Bound">a</a> <a id="7786" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="7788" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="7796" href="Data.Nat.Primality.Factorisation.html#7504" class="Function">bs′</a> <a id="7800" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
        <a id="7810" class="Keyword">where</a> <a id="7816" class="Keyword">open</a> <a id="7821" href="Relation.Binary.PropositionalEquality.Properties.html#6850" class="Module">≡-Reasoning</a>

      <a id="7840" href="Data.Nat.Primality.Factorisation.html#7840" class="Function">prime[bs&#39;]</a> <a id="7851" class="Symbol">:</a> <a id="7853" href="Data.List.Relation.Unary.All.html#1638" class="Datatype">All</a> <a id="7857" href="Data.Nat.Primality.html#3204" class="Record">Prime</a> <a id="7863" href="Data.Nat.Primality.Factorisation.html#7504" class="Function">bs′</a>
      <a id="7873" href="Data.Nat.Primality.Factorisation.html#7840" class="Function">prime[bs&#39;]</a> <a id="7884" class="Symbol">=</a> <a id="7886" href="Data.List.Relation.Unary.All.html#2594" class="Function">All.tail</a> <a id="7895" class="Symbol">(</a><a id="7896" href="Data.List.Relation.Binary.Permutation.Propositional.Properties.html#2989" class="Function">All-resp-↭</a> <a id="7907" href="Data.Nat.Primality.Factorisation.html#7530" class="Function">bs↭a∷bs′</a> <a id="7916" href="Data.Nat.Primality.Factorisation.html#7020" class="Bound">prime[bs]</a><a id="7925" class="Symbol">)</a>

      <a id="7934" href="Data.Nat.Primality.Factorisation.html#7934" class="Function">a∷as↭bs</a> <a id="7942" class="Symbol">:</a> <a id="7944" href="Data.Nat.Primality.Factorisation.html#6978" class="Bound">a</a> <a id="7946" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="7948" href="Data.Nat.Primality.Factorisation.html#6982" class="Bound">as</a> <a id="7951" href="Data.List.Relation.Binary.Permutation.Propositional.html#1513" class="Datatype Operator">↭</a> <a id="7953" href="Data.Nat.Primality.Factorisation.html#6986" class="Bound">bs</a>
      <a id="7962" href="Data.Nat.Primality.Factorisation.html#7934" class="Function">a∷as↭bs</a> <a id="7970" class="Symbol">=</a> <a id="7972" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
        <a id="7986" href="Data.Nat.Primality.Factorisation.html#6978" class="Bound">a</a> <a id="7988" href="Data.List.Relation.Binary.Permutation.Propositional.html#3882" class="Function">∷</a> <a id="7990" href="Data.Nat.Primality.Factorisation.html#6982" class="Bound">as</a>  <a id="7994" href="Data.List.Relation.Binary.Permutation.Propositional.html#3882" class="Function">&lt;⟨</a> <a id="7997" href="Data.Nat.Primality.Factorisation.html#6338" class="Function">factorisationUnique′</a> <a id="8018" href="Data.Nat.Primality.Factorisation.html#6982" class="Bound">as</a> <a id="8021" href="Data.Nat.Primality.Factorisation.html#7504" class="Function">bs′</a> <a id="8025" href="Data.Nat.Primality.Factorisation.html#7562" class="Function">Πas≡Πbs′</a> <a id="8034" href="Data.Nat.Primality.Factorisation.html#7009" class="Bound">prime[as]</a> <a id="8044" href="Data.Nat.Primality.Factorisation.html#7840" class="Function">prime[bs&#39;]</a> <a id="8055" href="Data.List.Relation.Binary.Permutation.Propositional.html#3882" class="Function">⟩</a>
        <a id="8065" href="Data.Nat.Primality.Factorisation.html#6978" class="Bound">a</a> <a id="8067" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8069" href="Data.Nat.Primality.Factorisation.html#7504" class="Function">bs′</a> <a id="8073" href="Relation.Binary.Reasoning.Syntax.html#9944" class="Function">↭⟨</a> <a id="8076" href="Data.Nat.Primality.Factorisation.html#7530" class="Function">bs↭a∷bs′</a> <a id="8085" href="Relation.Binary.Reasoning.Syntax.html#9944" class="Function">⟨</a>
        <a id="8095" href="Data.Nat.Primality.Factorisation.html#6986" class="Bound">bs</a>      <a id="8103" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
        <a id="8113" class="Keyword">where</a> <a id="8119" class="Keyword">open</a> <a id="8124" href="Data.List.Relation.Binary.Permutation.Propositional.html#3505" class="Module">PermutationReasoning</a>

<a id="factorisationUnique"></a><a id="8146" href="Data.Nat.Primality.Factorisation.html#8146" class="Function">factorisationUnique</a> <a id="8166" class="Symbol">:</a> <a id="8168" class="Symbol">(</a><a id="8169" href="Data.Nat.Primality.Factorisation.html#8169" class="Bound">f</a> <a id="8171" href="Data.Nat.Primality.Factorisation.html#8171" class="Bound">f′</a> <a id="8174" class="Symbol">:</a> <a id="8176" href="Data.Nat.Primality.Factorisation.html#2172" class="Record">PrimeFactorisation</a> <a id="8195" href="Data.Nat.Primality.Factorisation.html#2065" class="Generalizable">n</a><a id="8196" class="Symbol">)</a> <a id="8198" class="Symbol">→</a> <a id="8200" href="Data.Nat.Primality.Factorisation.html#2223" class="Field">factors</a> <a id="8208" href="Data.Nat.Primality.Factorisation.html#8169" class="Bound">f</a> <a id="8210" href="Data.List.Relation.Binary.Permutation.Propositional.html#1513" class="Datatype Operator">↭</a> <a id="8212" href="Data.Nat.Primality.Factorisation.html#2223" class="Field">factors</a> <a id="8220" href="Data.Nat.Primality.Factorisation.html#8171" class="Bound">f′</a>
<a id="8223" href="Data.Nat.Primality.Factorisation.html#8146" class="Function">factorisationUnique</a> <a id="8243" class="Symbol">{</a><a id="8244" href="Data.Nat.Primality.Factorisation.html#8244" class="Bound">n</a><a id="8245" class="Symbol">}</a> <a id="8247" href="Data.Nat.Primality.Factorisation.html#8247" class="Bound">f</a> <a id="8249" href="Data.Nat.Primality.Factorisation.html#8249" class="Bound">f′</a> <a id="8252" class="Symbol">=</a>
  <a id="8256" href="Data.Nat.Primality.Factorisation.html#6338" class="Function">factorisationUnique′</a> <a id="8277" class="Symbol">(</a><a id="8278" href="Data.Nat.Primality.Factorisation.html#2223" class="Field">factors</a> <a id="8286" href="Data.Nat.Primality.Factorisation.html#8247" class="Bound">f</a><a id="8287" class="Symbol">)</a> <a id="8289" class="Symbol">(</a><a id="8290" href="Data.Nat.Primality.Factorisation.html#2223" class="Field">factors</a> <a id="8298" href="Data.Nat.Primality.Factorisation.html#8249" class="Bound">f′</a><a id="8300" class="Symbol">)</a> <a id="8302" href="Data.Nat.Primality.Factorisation.html#8356" class="Function">Πf≡Πf′</a> <a id="8309" class="Symbol">(</a><a id="8310" href="Data.Nat.Primality.Factorisation.html#2286" class="Field">factorsPrime</a> <a id="8323" href="Data.Nat.Primality.Factorisation.html#8247" class="Bound">f</a><a id="8324" class="Symbol">)</a> <a id="8326" class="Symbol">(</a><a id="8327" href="Data.Nat.Primality.Factorisation.html#2286" class="Field">factorsPrime</a> <a id="8340" href="Data.Nat.Primality.Factorisation.html#8249" class="Bound">f′</a><a id="8342" class="Symbol">)</a>
  <a id="8346" class="Keyword">where</a>
    <a id="8356" href="Data.Nat.Primality.Factorisation.html#8356" class="Function">Πf≡Πf′</a> <a id="8363" class="Symbol">:</a> <a id="8365" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="8373" class="Symbol">(</a><a id="8374" href="Data.Nat.Primality.Factorisation.html#2223" class="Field">factors</a> <a id="8382" href="Data.Nat.Primality.Factorisation.html#8247" class="Bound">f</a><a id="8383" class="Symbol">)</a> <a id="8385" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="8387" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="8395" class="Symbol">(</a><a id="8396" href="Data.Nat.Primality.Factorisation.html#2223" class="Field">factors</a> <a id="8404" href="Data.Nat.Primality.Factorisation.html#8249" class="Bound">f′</a><a id="8406" class="Symbol">)</a>
    <a id="8412" href="Data.Nat.Primality.Factorisation.html#8356" class="Function">Πf≡Πf′</a> <a id="8419" class="Symbol">=</a> <a id="8421" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
      <a id="8433" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="8441" class="Symbol">(</a><a id="8442" href="Data.Nat.Primality.Factorisation.html#2223" class="Field">factors</a> <a id="8450" href="Data.Nat.Primality.Factorisation.html#8247" class="Bound">f</a><a id="8451" class="Symbol">)</a>  <a id="8454" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">≡⟨</a> <a id="8457" href="Data.Nat.Primality.Factorisation.html#2244" class="Field">isFactorisation</a> <a id="8473" href="Data.Nat.Primality.Factorisation.html#8247" class="Bound">f</a> <a id="8475" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">⟨</a>
      <a id="8483" href="Data.Nat.Primality.Factorisation.html#8244" class="Bound">n</a>                    <a id="8504" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="8507" href="Data.Nat.Primality.Factorisation.html#2244" class="Field">isFactorisation</a> <a id="8523" href="Data.Nat.Primality.Factorisation.html#8249" class="Bound">f′</a> <a id="8526" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
      <a id="8534" href="Data.Nat.ListAction.html#648" class="Function">product</a> <a id="8542" class="Symbol">(</a><a id="8543" href="Data.Nat.Primality.Factorisation.html#2223" class="Field">factors</a> <a id="8551" href="Data.Nat.Primality.Factorisation.html#8249" class="Bound">f′</a><a id="8553" class="Symbol">)</a> <a id="8555" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
      <a id="8563" class="Keyword">where</a> <a id="8569" class="Keyword">open</a> <a id="8574" href="Relation.Binary.PropositionalEquality.Properties.html#6850" class="Module">≡-Reasoning</a>
</pre></body></html>