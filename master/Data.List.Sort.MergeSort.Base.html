<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.List.Sort.MergeSort.Base</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- An implementation of merge sort</a>
<a id="141" class="Comment">------------------------------------------------------------------------</a>

<a id="215" class="Comment">-- Unless you are need a particular property of MergeSort, you should</a>
<a id="285" class="Comment">-- import and use the sorting algorithm from `Data.List.Sort` instead</a>
<a id="355" class="Comment">-- of this file.</a>

<a id="373" class="Symbol">{-#</a> <a id="377" class="Keyword">OPTIONS</a> <a id="385" class="Pragma">--cubical-compatible</a> <a id="406" class="Pragma">--safe</a> <a id="413" class="Symbol">#-}</a>

<a id="418" class="Keyword">open</a> <a id="423" class="Keyword">import</a> <a id="430" href="Relation.Binary.Bundles.html" class="Module">Relation.Binary.Bundles</a> <a id="454" class="Keyword">using</a> <a id="460" class="Symbol">(</a><a id="461" href="Relation.Binary.Bundles.html#8160" class="Record">DecTotalOrder</a><a id="474" class="Symbol">)</a>

<a id="477" class="Keyword">module</a> <a id="484" href="Data.List.Sort.MergeSort.Base.html" class="Module">Data.List.Sort.MergeSort.Base</a>
  <a id="516" class="Symbol">{</a><a id="517" href="Data.List.Sort.MergeSort.Base.html#517" class="Bound">a</a> <a id="519" href="Data.List.Sort.MergeSort.Base.html#519" class="Bound">ℓ₁</a> <a id="522" href="Data.List.Sort.MergeSort.Base.html#522" class="Bound">ℓ₂</a><a id="524" class="Symbol">}</a> <a id="526" class="Symbol">(</a><a id="527" href="Data.List.Sort.MergeSort.Base.html#527" class="Bound">O</a> <a id="529" class="Symbol">:</a> <a id="531" href="Relation.Binary.Bundles.html#8160" class="Record">DecTotalOrder</a> <a id="545" href="Data.List.Sort.MergeSort.Base.html#517" class="Bound">a</a> <a id="547" href="Data.List.Sort.MergeSort.Base.html#519" class="Bound">ℓ₁</a> <a id="550" href="Data.List.Sort.MergeSort.Base.html#522" class="Bound">ℓ₂</a><a id="552" class="Symbol">)</a> <a id="554" class="Keyword">where</a>

<a id="561" class="Keyword">open</a> <a id="566" class="Keyword">import</a> <a id="573" href="Data.List.Base.html" class="Module">Data.List.Base</a>
  <a id="590" class="Keyword">using</a> <a id="596" class="Symbol">(</a><a id="597" href="Agda.Builtin.List.html#147" class="Datatype">List</a><a id="601" class="Symbol">;</a> <a id="603" href="Data.List.Base.html#7301" class="InductiveConstructor">[]</a><a id="605" class="Symbol">;</a> <a id="607" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">_∷_</a><a id="610" class="Symbol">;</a> <a id="612" href="Data.List.Base.html#3759" class="Function">merge</a><a id="617" class="Symbol">;</a> <a id="619" href="Data.List.Base.html#4746" class="Function">length</a><a id="625" class="Symbol">;</a> <a id="627" href="Data.List.Base.html#1612" class="Function">map</a><a id="630" class="Symbol">;</a> <a id="632" href="Data.List.Base.html#4907" class="Function Operator">[_]</a><a id="635" class="Symbol">)</a>

<a id="638" class="Keyword">open</a> <a id="643" class="Keyword">import</a> <a id="650" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="664" class="Keyword">using</a> <a id="670" class="Symbol">(</a><a id="671" href="Data.Nat.Base.html#1807" class="Function Operator">_&lt;_</a><a id="674" class="Symbol">;</a> <a id="676" href="Data.Nat.Base.html#2295" class="Function Operator">_&gt;_</a><a id="679" class="Symbol">;</a> <a id="681" href="Data.Nat.Base.html#1879" class="InductiveConstructor">z&lt;s</a><a id="684" class="Symbol">;</a> <a id="686" href="Data.Nat.Base.html#1919" class="InductiveConstructor">s&lt;s</a><a id="689" class="Symbol">)</a>
<a id="691" class="Keyword">open</a> <a id="696" class="Keyword">import</a> <a id="703" href="Data.Nat.Induction.html" class="Module">Data.Nat.Induction</a>
<a id="722" class="Keyword">open</a> <a id="727" class="Keyword">import</a> <a id="734" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="754" class="Keyword">using</a> <a id="760" class="Symbol">(</a><a id="761" href="Data.Nat.Properties.html#13186" class="Function">m&lt;n⇒m&lt;1+n</a><a id="770" class="Symbol">)</a>

<a id="773" class="Keyword">open</a> <a id="778" href="Relation.Binary.Bundles.html#8160" class="Module">DecTotalOrder</a> <a id="792" href="Data.List.Sort.MergeSort.Base.html#527" class="Bound">O</a> <a id="794" class="Keyword">renaming</a> <a id="803" class="Symbol">(</a><a id="804" href="Relation.Binary.Bundles.html#8244" class="Field">Carrier</a> <a id="812" class="Symbol">to</a> <a id="815" class="Field">A</a><a id="816" class="Symbol">)</a>

<a id="819" class="Comment">------------------------------------------------------------------------</a>
<a id="892" class="Comment">-- Definition</a>

<a id="mergePairs"></a><a id="907" href="Data.List.Sort.MergeSort.Base.html#907" class="Function">mergePairs</a> <a id="918" class="Symbol">:</a> <a id="920" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="925" class="Symbol">(</a><a id="926" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="931" href="Data.List.Sort.MergeSort.Base.html#815" class="Field">A</a><a id="932" class="Symbol">)</a> <a id="934" class="Symbol">→</a> <a id="936" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="941" class="Symbol">(</a><a id="942" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="947" href="Data.List.Sort.MergeSort.Base.html#815" class="Field">A</a><a id="948" class="Symbol">)</a>
<a id="950" href="Data.List.Sort.MergeSort.Base.html#907" class="Function">mergePairs</a> <a id="961" class="Symbol">(</a><a id="962" href="Data.List.Sort.MergeSort.Base.html#962" class="Bound">xs</a> <a id="965" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="967" href="Data.List.Sort.MergeSort.Base.html#967" class="Bound">ys</a> <a id="970" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="972" href="Data.List.Sort.MergeSort.Base.html#972" class="Bound">yss</a><a id="975" class="Symbol">)</a> <a id="977" class="Symbol">=</a> <a id="979" href="Data.List.Base.html#3759" class="Function">merge</a> <a id="985" href="Relation.Binary.Structures.html#6452" class="Function Operator">_≤?_</a> <a id="990" href="Data.List.Sort.MergeSort.Base.html#962" class="Bound">xs</a> <a id="993" href="Data.List.Sort.MergeSort.Base.html#967" class="Bound">ys</a> <a id="996" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="998" href="Data.List.Sort.MergeSort.Base.html#907" class="Function">mergePairs</a> <a id="1009" href="Data.List.Sort.MergeSort.Base.html#972" class="Bound">yss</a>
<a id="1013" href="Data.List.Sort.MergeSort.Base.html#907" class="CatchallClause Function">mergePairs</a><a id="1023" class="CatchallClause"> </a><a id="1024" href="Data.List.Sort.MergeSort.Base.html#1024" class="CatchallClause Bound">xss</a>             <a id="1040" class="Symbol">=</a> <a id="1042" href="Data.List.Sort.MergeSort.Base.html#1024" class="Bound">xss</a>

<a id="1047" class="Keyword">private</a>
  <a id="length-mergePairs"></a><a id="1057" href="Data.List.Sort.MergeSort.Base.html#1057" class="Function">length-mergePairs</a> <a id="1075" class="Symbol">:</a> <a id="1077" class="Symbol">∀</a> <a id="1079" href="Data.List.Sort.MergeSort.Base.html#1079" class="Bound">xs</a> <a id="1082" href="Data.List.Sort.MergeSort.Base.html#1082" class="Bound">ys</a> <a id="1085" href="Data.List.Sort.MergeSort.Base.html#1085" class="Bound">yss</a> <a id="1089" class="Symbol">→</a> <a id="1091" class="Keyword">let</a> <a id="1095" href="Data.List.Sort.MergeSort.Base.html#1095" class="Bound">zss</a> <a id="1099" class="Symbol">=</a> <a id="1101" href="Data.List.Sort.MergeSort.Base.html#1079" class="Bound">xs</a> <a id="1104" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1106" href="Data.List.Sort.MergeSort.Base.html#1082" class="Bound">ys</a> <a id="1109" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1111" href="Data.List.Sort.MergeSort.Base.html#1085" class="Bound">yss</a> <a id="1115" class="Keyword">in</a>
                      <a id="1140" href="Data.List.Base.html#4746" class="Function">length</a> <a id="1147" class="Symbol">(</a><a id="1148" href="Data.List.Sort.MergeSort.Base.html#907" class="Function">mergePairs</a> <a id="1159" href="Data.List.Sort.MergeSort.Base.html#1095" class="Bound">zss</a><a id="1162" class="Symbol">)</a> <a id="1164" href="Data.Nat.Base.html#1807" class="Function Operator">&lt;</a> <a id="1166" href="Data.List.Base.html#4746" class="Function">length</a> <a id="1173" href="Data.List.Sort.MergeSort.Base.html#1095" class="Bound">zss</a>
  <a id="1179" href="Data.List.Sort.MergeSort.Base.html#1057" class="Function">length-mergePairs</a> <a id="1197" class="Symbol">_</a> <a id="1199" class="Symbol">_</a> <a id="1201" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>              <a id="1217" class="Symbol">=</a> <a id="1219" href="Data.Nat.Base.html#1919" class="InductiveConstructor">s&lt;s</a> <a id="1223" href="Data.Nat.Base.html#1879" class="InductiveConstructor">z&lt;s</a>
  <a id="1229" href="Data.List.Sort.MergeSort.Base.html#1057" class="Function">length-mergePairs</a> <a id="1247" class="Symbol">_</a> <a id="1249" class="Symbol">_</a> <a id="1251" class="Symbol">(</a><a id="1252" href="Data.List.Sort.MergeSort.Base.html#1252" class="Bound">xs</a> <a id="1255" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1257" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="1259" class="Symbol">)</a>       <a id="1267" class="Symbol">=</a> <a id="1269" href="Data.Nat.Base.html#1919" class="InductiveConstructor">s&lt;s</a> <a id="1273" class="Symbol">(</a><a id="1274" href="Data.Nat.Base.html#1919" class="InductiveConstructor">s&lt;s</a> <a id="1278" href="Data.Nat.Base.html#1879" class="InductiveConstructor">z&lt;s</a><a id="1281" class="Symbol">)</a>
  <a id="1285" href="Data.List.Sort.MergeSort.Base.html#1057" class="Function">length-mergePairs</a> <a id="1303" class="Symbol">_</a> <a id="1305" class="Symbol">_</a> <a id="1307" class="Symbol">(</a><a id="1308" href="Data.List.Sort.MergeSort.Base.html#1308" class="Bound">xs</a> <a id="1311" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1313" href="Data.List.Sort.MergeSort.Base.html#1313" class="Bound">ys</a> <a id="1316" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1318" href="Data.List.Sort.MergeSort.Base.html#1318" class="Bound">yss</a><a id="1321" class="Symbol">)</a> <a id="1323" class="Symbol">=</a> <a id="1325" href="Data.Nat.Base.html#1919" class="InductiveConstructor">s&lt;s</a> <a id="1329" class="Symbol">(</a><a id="1330" href="Data.Nat.Properties.html#13186" class="Function">m&lt;n⇒m&lt;1+n</a> <a id="1340" class="Symbol">(</a><a id="1341" href="Data.List.Sort.MergeSort.Base.html#1057" class="Function">length-mergePairs</a> <a id="1359" href="Data.List.Sort.MergeSort.Base.html#1308" class="Bound">xs</a> <a id="1362" href="Data.List.Sort.MergeSort.Base.html#1313" class="Bound">ys</a> <a id="1365" href="Data.List.Sort.MergeSort.Base.html#1318" class="Bound">yss</a><a id="1368" class="Symbol">))</a>

<a id="mergeAll"></a><a id="1372" href="Data.List.Sort.MergeSort.Base.html#1372" class="Function">mergeAll</a> <a id="1381" class="Symbol">:</a> <a id="1383" class="Symbol">(</a><a id="1384" href="Data.List.Sort.MergeSort.Base.html#1384" class="Bound">xss</a> <a id="1388" class="Symbol">:</a> <a id="1390" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1395" class="Symbol">(</a><a id="1396" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1401" href="Data.List.Sort.MergeSort.Base.html#815" class="Field">A</a><a id="1402" class="Symbol">))</a> <a id="1405" class="Symbol">→</a> <a id="1407" href="Induction.WellFounded.html#1545" class="Datatype">Acc</a> <a id="1411" href="Data.Nat.Base.html#1807" class="Function Operator">_&lt;_</a> <a id="1415" class="Symbol">(</a><a id="1416" href="Data.List.Base.html#4746" class="Function">length</a> <a id="1423" href="Data.List.Sort.MergeSort.Base.html#1384" class="Bound">xss</a><a id="1426" class="Symbol">)</a> <a id="1428" class="Symbol">→</a> <a id="1430" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1435" href="Data.List.Sort.MergeSort.Base.html#815" class="Field">A</a>
<a id="1437" href="Data.List.Sort.MergeSort.Base.html#1372" class="Function">mergeAll</a> <a id="1446" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>        <a id="1456" class="Symbol">_</a>               <a id="1472" class="Symbol">=</a> <a id="1474" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="1477" href="Data.List.Sort.MergeSort.Base.html#1372" class="Function">mergeAll</a> <a id="1486" class="Symbol">(</a><a id="1487" href="Data.List.Sort.MergeSort.Base.html#1487" class="Bound">xs</a> <a id="1490" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1492" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="1494" class="Symbol">)</a> <a id="1496" class="Symbol">_</a>               <a id="1512" class="Symbol">=</a> <a id="1514" href="Data.List.Sort.MergeSort.Base.html#1487" class="Bound">xs</a>
<a id="1517" href="Data.List.Sort.MergeSort.Base.html#1372" class="Function">mergeAll</a> <a id="1526" href="Data.List.Sort.MergeSort.Base.html#1526" class="Bound">xss</a><a id="1529" class="Symbol">@(</a><a id="1531" href="Data.List.Sort.MergeSort.Base.html#1531" class="Bound">xs</a> <a id="1534" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1536" href="Data.List.Sort.MergeSort.Base.html#1536" class="Bound">ys</a> <a id="1539" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1541" href="Data.List.Sort.MergeSort.Base.html#1541" class="Bound">yss</a><a id="1544" class="Symbol">)</a> <a id="1546" class="Symbol">(</a><a id="1547" href="Induction.WellFounded.html#1607" class="InductiveConstructor">acc</a> <a id="1551" href="Data.List.Sort.MergeSort.Base.html#1551" class="Bound">rec</a><a id="1554" class="Symbol">)</a> <a id="1556" class="Symbol">=</a> <a id="1558" href="Data.List.Sort.MergeSort.Base.html#1372" class="Function">mergeAll</a>
  <a id="1569" class="Symbol">(</a><a id="1570" href="Data.List.Sort.MergeSort.Base.html#907" class="Function">mergePairs</a> <a id="1581" href="Data.List.Sort.MergeSort.Base.html#1526" class="Bound">xss</a><a id="1584" class="Symbol">)</a> <a id="1586" class="Symbol">(</a><a id="1587" href="Data.List.Sort.MergeSort.Base.html#1551" class="Bound">rec</a> <a id="1591" class="Symbol">(</a><a id="1592" href="Data.List.Sort.MergeSort.Base.html#1057" class="Function">length-mergePairs</a> <a id="1610" href="Data.List.Sort.MergeSort.Base.html#1531" class="Bound">xs</a> <a id="1613" href="Data.List.Sort.MergeSort.Base.html#1536" class="Bound">ys</a> <a id="1616" href="Data.List.Sort.MergeSort.Base.html#1541" class="Bound">yss</a><a id="1619" class="Symbol">))</a>

<a id="sort"></a><a id="1623" href="Data.List.Sort.MergeSort.Base.html#1623" class="Function">sort</a> <a id="1628" class="Symbol">:</a> <a id="1630" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1635" href="Data.List.Sort.MergeSort.Base.html#815" class="Field">A</a> <a id="1637" class="Symbol">→</a> <a id="1639" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1644" href="Data.List.Sort.MergeSort.Base.html#815" class="Field">A</a>
<a id="1646" href="Data.List.Sort.MergeSort.Base.html#1623" class="Function">sort</a> <a id="1651" href="Data.List.Sort.MergeSort.Base.html#1651" class="Bound">xs</a> <a id="1654" class="Symbol">=</a> <a id="1656" href="Data.List.Sort.MergeSort.Base.html#1372" class="Function">mergeAll</a> <a id="1665" class="Symbol">(</a><a id="1666" href="Data.List.Base.html#1612" class="Function">map</a> <a id="1670" href="Data.List.Base.html#4907" class="Function Operator">[_]</a> <a id="1674" href="Data.List.Sort.MergeSort.Base.html#1651" class="Bound">xs</a><a id="1676" class="Symbol">)</a> <a id="1678" class="Symbol">(</a><a id="1679" href="Data.Nat.Induction.html#2790" class="Function">&lt;-wellFounded-fast</a> <a id="1698" class="Symbol">_)</a>
</pre></body></html>