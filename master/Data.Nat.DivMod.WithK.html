<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Nat.DivMod.WithK</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- More efficient mod and divMod operations (require the K axiom)</a>
<a id="172" class="Comment">------------------------------------------------------------------------</a>

<a id="246" class="Symbol">{-#</a> <a id="250" class="Keyword">OPTIONS</a> <a id="258" class="Pragma">--with-K</a> <a id="267" class="Pragma">--safe</a> <a id="274" class="Symbol">#-}</a>

<a id="279" class="Keyword">module</a> <a id="286" href="Data.Nat.DivMod.WithK.html" class="Module">Data.Nat.DivMod.WithK</a> <a id="308" class="Keyword">where</a>

<a id="315" class="Keyword">open</a> <a id="320" class="Keyword">import</a> <a id="327" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="341" class="Keyword">using</a> <a id="347" class="Symbol">(</a><a id="348" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="349" class="Symbol">;</a> <a id="351" href="Data.Nat.Base.html#3266" class="Record">NonZero</a><a id="358" class="Symbol">;</a> <a id="360" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">_+_</a><a id="363" class="Symbol">;</a> <a id="365" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">_*_</a><a id="368" class="Symbol">)</a>
<a id="370" class="Keyword">open</a> <a id="375" class="Keyword">import</a> <a id="382" href="Data.Nat.DivMod.html" class="Module">Data.Nat.DivMod</a> <a id="398" class="Keyword">hiding</a> <a id="405" class="Symbol">(</a><a id="406" href="Data.Nat.DivMod.html#19085" class="Function Operator">_mod_</a><a id="411" class="Symbol">;</a> <a id="413" href="Data.Nat.DivMod.html#19185" class="Function Operator">_divMod_</a><a id="421" class="Symbol">)</a>
<a id="423" class="Keyword">open</a> <a id="428" class="Keyword">import</a> <a id="435" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="455" class="Keyword">using</a> <a id="461" class="Symbol">(</a><a id="462" href="Data.Nat.Properties.html#66300" class="Function">≤⇒≤″</a><a id="466" class="Symbol">)</a>
<a id="468" class="Keyword">open</a> <a id="473" class="Keyword">import</a> <a id="480" href="Data.Nat.WithK.html" class="Module">Data.Nat.WithK</a> <a id="495" class="Keyword">using</a> <a id="501" class="Symbol">(</a><a id="502" href="Data.Nat.WithK.html#440" class="Function">≤″-erase</a><a id="510" class="Symbol">)</a>
<a id="512" class="Keyword">open</a> <a id="517" class="Keyword">import</a> <a id="524" href="Data.Fin.Base.html" class="Module">Data.Fin.Base</a> <a id="538" class="Keyword">using</a> <a id="544" class="Symbol">(</a><a id="545" href="Data.Fin.Base.html#1159" class="Datatype">Fin</a><a id="548" class="Symbol">;</a> <a id="550" href="Data.Fin.Base.html#1267" class="Function">toℕ</a><a id="553" class="Symbol">;</a> <a id="555" href="Data.Fin.Base.html#2100" class="Function">fromℕ&lt;″</a><a id="562" class="Symbol">)</a>
<a id="564" class="Keyword">open</a> <a id="569" class="Keyword">import</a> <a id="576" href="Data.Fin.Properties.html" class="Module">Data.Fin.Properties</a> <a id="596" class="Keyword">using</a> <a id="602" class="Symbol">(</a><a id="603" href="Data.Fin.Properties.html#9182" class="Function">toℕ-fromℕ&lt;″</a><a id="614" class="Symbol">)</a>
<a id="616" class="Keyword">open</a> <a id="621" class="Keyword">import</a> <a id="628" href="Function.Base.html" class="Module">Function.Base</a> <a id="642" class="Keyword">using</a> <a id="648" class="Symbol">(</a><a id="649" href="Function.Base.html#1974" class="Function Operator">_$_</a><a id="652" class="Symbol">)</a>
<a id="654" class="Keyword">open</a> <a id="659" class="Keyword">import</a> <a id="666" href="Relation.Binary.PropositionalEquality.Core.html" class="Module">Relation.Binary.PropositionalEquality.Core</a> <a id="709" class="Keyword">using</a> <a id="715" class="Symbol">(</a><a id="716" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a><a id="720" class="Symbol">)</a>
<a id="722" class="Keyword">open</a> <a id="727" class="Keyword">import</a> <a id="734" href="Relation.Binary.PropositionalEquality.Properties.html" class="Module">Relation.Binary.PropositionalEquality.Properties</a>
  <a id="785" class="Keyword">using</a> <a id="791" class="Symbol">(</a><a id="792" class="Keyword">module</a> <a id="799" href="Relation.Binary.PropositionalEquality.Properties.html#6731" class="Module">≡-Reasoning</a><a id="810" class="Symbol">)</a>
<a id="812" class="Keyword">open</a> <a id="817" class="Keyword">import</a> <a id="824" href="Relation.Binary.PropositionalEquality.WithK.html" class="Module">Relation.Binary.PropositionalEquality.WithK</a> <a id="868" class="Keyword">using</a> <a id="874" class="Symbol">(</a><a id="875" href="Relation.Binary.PropositionalEquality.WithK.html#896" class="Primitive">≡-erase</a><a id="882" class="Symbol">)</a>

<a id="885" class="Keyword">open</a> <a id="890" href="Relation.Binary.PropositionalEquality.Properties.html#6731" class="Module">≡-Reasoning</a>

<a id="903" class="Keyword">infixl</a> <a id="910" class="Number">7</a> <a id="912" href="Data.Nat.DivMod.WithK.html#1023" class="Function Operator">_mod_</a> <a id="918" href="Data.Nat.DivMod.WithK.html#1290" class="Function Operator">_divMod_</a>

<a id="928" class="Comment">------------------------------------------------------------------------</a>
<a id="1001" class="Comment">-- Certified modulus</a>

<a id="_mod_"></a><a id="1023" href="Data.Nat.DivMod.WithK.html#1023" class="Function Operator">_mod_</a> <a id="1029" class="Symbol">:</a> <a id="1031" class="Symbol">(</a><a id="1032" href="Data.Nat.DivMod.WithK.html#1032" class="Bound">dividend</a> <a id="1041" href="Data.Nat.DivMod.WithK.html#1041" class="Bound">divisor</a> <a id="1049" class="Symbol">:</a> <a id="1051" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1052" class="Symbol">)</a> <a id="1054" class="Symbol">→</a> <a id="1056" class="Symbol">.{{</a> <a id="1060" href="Data.Nat.DivMod.WithK.html#1060" class="Bound">_</a> <a id="1062" class="Symbol">:</a> <a id="1064" href="Data.Nat.Base.html#3266" class="Record">NonZero</a> <a id="1072" href="Data.Nat.DivMod.WithK.html#1041" class="Bound">divisor</a> <a id="1080" class="Symbol">}}</a> <a id="1083" class="Symbol">→</a> <a id="1085" href="Data.Fin.Base.html#1159" class="Datatype">Fin</a> <a id="1089" href="Data.Nat.DivMod.WithK.html#1041" class="Bound">divisor</a>
<a id="1097" href="Data.Nat.DivMod.WithK.html#1097" class="Bound">m</a> <a id="1099" href="Data.Nat.DivMod.WithK.html#1023" class="Function Operator">mod</a> <a id="1103" href="Data.Nat.DivMod.WithK.html#1103" class="Bound">n</a> <a id="1105" class="Symbol">=</a> <a id="1107" href="Data.Fin.Base.html#2100" class="Function">fromℕ&lt;″</a> <a id="1115" class="Symbol">(</a><a id="1116" href="Data.Nat.DivMod.WithK.html#1097" class="Bound">m</a> <a id="1118" href="Data.Nat.Base.html#7285" class="Function Operator">%</a> <a id="1120" href="Data.Nat.DivMod.WithK.html#1103" class="Bound">n</a><a id="1121" class="Symbol">)</a> <a id="1123" class="Symbol">(</a><a id="1124" href="Data.Nat.WithK.html#440" class="Function">≤″-erase</a> <a id="1133" class="Symbol">(</a><a id="1134" href="Data.Nat.Properties.html#66300" class="Function">≤⇒≤″</a> <a id="1139" class="Symbol">(</a><a id="1140" href="Data.Nat.DivMod.html#3227" class="Function">m%n&lt;n</a> <a id="1146" href="Data.Nat.DivMod.WithK.html#1097" class="Bound">m</a> <a id="1148" href="Data.Nat.DivMod.WithK.html#1103" class="Bound">n</a><a id="1149" class="Symbol">)))</a>

<a id="1154" class="Comment">------------------------------------------------------------------------</a>
<a id="1227" class="Comment">-- Returns modulus and division result with correctness proof</a>

<a id="_divMod_"></a><a id="1290" href="Data.Nat.DivMod.WithK.html#1290" class="Function Operator">_divMod_</a> <a id="1299" class="Symbol">:</a> <a id="1301" class="Symbol">(</a><a id="1302" href="Data.Nat.DivMod.WithK.html#1302" class="Bound">dividend</a> <a id="1311" href="Data.Nat.DivMod.WithK.html#1311" class="Bound">divisor</a> <a id="1319" class="Symbol">:</a> <a id="1321" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1322" class="Symbol">)</a> <a id="1324" class="Symbol">→</a> <a id="1326" class="Symbol">.{{</a> <a id="1330" href="Data.Nat.Base.html#3266" class="Record">NonZero</a> <a id="1338" href="Data.Nat.DivMod.WithK.html#1311" class="Bound">divisor</a> <a id="1346" class="Symbol">}}</a> <a id="1349" class="Symbol">→</a>
           <a id="1362" href="Data.Nat.DivMod.html#18722" class="Record">DivMod</a> <a id="1369" href="Data.Nat.DivMod.WithK.html#1302" class="Bound">dividend</a> <a id="1378" href="Data.Nat.DivMod.WithK.html#1311" class="Bound">divisor</a>
<a id="1386" href="Data.Nat.DivMod.WithK.html#1386" class="Bound">m</a> <a id="1388" href="Data.Nat.DivMod.WithK.html#1290" class="Function Operator">divMod</a> <a id="1395" href="Data.Nat.DivMod.WithK.html#1395" class="Bound">n</a> <a id="1397" class="Symbol">=</a> <a id="1399" href="Data.Nat.DivMod.html#18778" class="InductiveConstructor">result</a> <a id="1406" class="Symbol">(</a><a id="1407" href="Data.Nat.DivMod.WithK.html#1386" class="Bound">m</a> <a id="1409" href="Data.Nat.Base.html#7102" class="Function Operator">/</a> <a id="1411" href="Data.Nat.DivMod.WithK.html#1395" class="Bound">n</a><a id="1412" class="Symbol">)</a> <a id="1414" class="Symbol">(</a><a id="1415" href="Data.Nat.DivMod.WithK.html#1386" class="Bound">m</a> <a id="1417" href="Data.Nat.DivMod.WithK.html#1023" class="Function Operator">mod</a> <a id="1421" href="Data.Nat.DivMod.WithK.html#1395" class="Bound">n</a><a id="1422" class="Symbol">)</a> <a id="1424" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="1426" href="Relation.Binary.PropositionalEquality.WithK.html#896" class="Primitive">≡-erase</a> <a id="1434" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="1436" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
  <a id="1444" href="Data.Nat.DivMod.WithK.html#1386" class="Bound">m</a>                                 <a id="1478" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="1481" href="Data.Nat.DivMod.html#1222" class="Function">m≡m%n+[m/n]*n</a> <a id="1495" href="Data.Nat.DivMod.WithK.html#1386" class="Bound">m</a> <a id="1497" href="Data.Nat.DivMod.WithK.html#1395" class="Bound">n</a> <a id="1499" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
  <a id="1503" href="Data.Nat.DivMod.WithK.html#1386" class="Bound">m</a> <a id="1505" href="Data.Nat.Base.html#7285" class="Function Operator">%</a> <a id="1507" href="Data.Nat.DivMod.WithK.html#1395" class="Bound">n</a>                  <a id="1526" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="1528" href="Data.Nat.DivMod.WithK.html#1627" class="Function">[m/n]*n</a>  <a id="1537" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">≡⟨</a> <a id="1540" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a> <a id="1545" class="Symbol">(</a><a id="1546" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">_+</a> <a id="1549" href="Data.Nat.DivMod.WithK.html#1627" class="Function">[m/n]*n</a><a id="1556" class="Symbol">)</a> <a id="1558" class="Symbol">(</a><a id="1559" href="Data.Fin.Properties.html#9182" class="Function">toℕ-fromℕ&lt;″</a> <a id="1571" href="Data.Nat.DivMod.WithK.html#1649" class="Function">lemma″</a><a id="1577" class="Symbol">)</a> <a id="1579" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">⟨</a>
  <a id="1583" href="Data.Fin.Base.html#1267" class="Function">toℕ</a> <a id="1587" class="Symbol">(</a><a id="1588" href="Data.Fin.Base.html#2100" class="Function">fromℕ&lt;″</a> <a id="1596" class="Symbol">_</a> <a id="1598" href="Data.Nat.DivMod.WithK.html#1649" class="Function">lemma″</a><a id="1604" class="Symbol">)</a> <a id="1606" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="1608" href="Data.Nat.DivMod.WithK.html#1627" class="Function">[m/n]*n</a>  <a id="1617" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
  <a id="1621" class="Keyword">where</a> <a id="1627" href="Data.Nat.DivMod.WithK.html#1627" class="Function">[m/n]*n</a> <a id="1635" class="Symbol">=</a> <a id="1637" href="Data.Nat.DivMod.WithK.html#1386" class="Bound">m</a> <a id="1639" href="Data.Nat.Base.html#7102" class="Function Operator">/</a> <a id="1641" href="Data.Nat.DivMod.WithK.html#1395" class="Bound">n</a> <a id="1643" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="1645" href="Data.Nat.DivMod.WithK.html#1395" class="Bound">n</a> <a id="1647" class="Symbol">;</a> <a id="1649" href="Data.Nat.DivMod.WithK.html#1649" class="Function">lemma″</a> <a id="1656" class="Symbol">=</a> <a id="1658" href="Data.Nat.WithK.html#440" class="Function">≤″-erase</a> <a id="1667" class="Symbol">(</a><a id="1668" href="Data.Nat.Properties.html#66300" class="Function">≤⇒≤″</a> <a id="1673" class="Symbol">(</a><a id="1674" href="Data.Nat.DivMod.html#3227" class="Function">m%n&lt;n</a> <a id="1680" href="Data.Nat.DivMod.WithK.html#1386" class="Bound">m</a> <a id="1682" href="Data.Nat.DivMod.WithK.html#1395" class="Bound">n</a><a id="1683" class="Symbol">))</a>
</pre></body></html>