<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Algebra.Solver.Monoid</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- A solver for equations over monoids</a>
<a id="145" class="Comment">------------------------------------------------------------------------</a>

<a id="219" class="Symbol">{-#</a> <a id="223" class="Keyword">OPTIONS</a> <a id="231" class="Pragma">--cubical-compatible</a> <a id="252" class="Pragma">--safe</a> <a id="259" class="Symbol">#-}</a>

<a id="264" class="Keyword">open</a> <a id="269" class="Keyword">import</a> <a id="276" href="Algebra.html" class="Module">Algebra</a>

<a id="285" class="Keyword">module</a> <a id="292" href="Algebra.Solver.Monoid.html" class="Module">Algebra.Solver.Monoid</a> <a id="314" class="Symbol">{</a><a id="315" href="Algebra.Solver.Monoid.html#315" class="Bound">m₁</a> <a id="318" href="Algebra.Solver.Monoid.html#318" class="Bound">m₂</a><a id="320" class="Symbol">}</a> <a id="322" class="Symbol">(</a><a id="323" href="Algebra.Solver.Monoid.html#323" class="Bound">M</a> <a id="325" class="Symbol">:</a> <a id="327" href="Algebra.Bundles.html#6668" class="Record">Monoid</a> <a id="334" href="Algebra.Solver.Monoid.html#315" class="Bound">m₁</a> <a id="337" href="Algebra.Solver.Monoid.html#318" class="Bound">m₂</a><a id="339" class="Symbol">)</a> <a id="341" class="Keyword">where</a>

<a id="348" class="Keyword">open</a> <a id="353" class="Keyword">import</a> <a id="360" href="Data.Fin.Base.html" class="Module">Data.Fin.Base</a> <a id="374" class="Symbol">as</a> <a id="377" class="Module">Fin</a>
<a id="381" class="Keyword">import</a> <a id="388" href="Data.Fin.Properties.html" class="Module">Data.Fin.Properties</a> <a id="408" class="Symbol">as</a> <a id="411" class="Module">Fin</a>
<a id="415" class="Keyword">open</a> <a id="420" class="Keyword">import</a> <a id="427" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="442" class="Keyword">hiding</a> <a id="449" class="Symbol">(</a><a id="450" href="Data.List.Base.html#6747" class="Function">lookup</a><a id="456" class="Symbol">)</a>
<a id="458" class="Keyword">import</a> <a id="465" href="Data.List.Relation.Binary.Equality.DecPropositional.html" class="Module">Data.List.Relation.Binary.Equality.DecPropositional</a> <a id="517" class="Symbol">as</a> <a id="520" class="Module">ListEq</a>
<a id="527" class="Keyword">open</a> <a id="532" class="Keyword">import</a> <a id="539" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="555" class="Symbol">as</a> <a id="558" class="Module">Maybe</a>
  <a id="566" class="Keyword">using</a> <a id="572" class="Symbol">(</a><a id="573" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a><a id="578" class="Symbol">;</a> <a id="580" href="Data.Maybe.Base.html#1302" class="Function">decToMaybe</a><a id="590" class="Symbol">;</a> <a id="592" href="Data.Maybe.Base.html#1908" class="Function">From-just</a><a id="601" class="Symbol">;</a> <a id="603" href="Data.Maybe.Base.html#1996" class="Function">from-just</a><a id="612" class="Symbol">)</a>
<a id="614" class="Keyword">open</a> <a id="619" class="Keyword">import</a> <a id="626" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="640" class="Keyword">using</a> <a id="646" class="Symbol">(</a><a id="647" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="648" class="Symbol">)</a>
<a id="650" class="Keyword">open</a> <a id="655" class="Keyword">import</a> <a id="662" href="Data.Product.Base.html" class="Module">Data.Product.Base</a> <a id="680" class="Keyword">using</a> <a id="686" class="Symbol">(</a><a id="687" href="Data.Product.Base.html#1618" class="Function Operator">_×_</a><a id="690" class="Symbol">;</a> <a id="692" href="Data.Product.Base.html#3109" class="Function">uncurry</a><a id="699" class="Symbol">)</a>
<a id="701" class="Keyword">open</a> <a id="706" class="Keyword">import</a> <a id="713" href="Data.Vec.Base.html" class="Module">Data.Vec.Base</a> <a id="727" class="Keyword">using</a> <a id="733" class="Symbol">(</a><a id="734" href="Data.Vec.Base.html#1114" class="Datatype">Vec</a><a id="737" class="Symbol">;</a> <a id="739" href="Data.Vec.Base.html#1671" class="Function">lookup</a><a id="745" class="Symbol">)</a>
<a id="747" class="Keyword">open</a> <a id="752" class="Keyword">import</a> <a id="759" href="Function.Base.html" class="Module">Function.Base</a> <a id="773" class="Keyword">using</a> <a id="779" class="Symbol">(</a><a id="780" href="Function.Base.html#1115" class="Function Operator">_∘_</a><a id="783" class="Symbol">;</a> <a id="785" href="Function.Base.html#1974" class="Function Operator">_$_</a><a id="788" class="Symbol">)</a>
<a id="790" class="Keyword">open</a> <a id="795" class="Keyword">import</a> <a id="802" href="Relation.Binary.Definitions.html" class="Module">Relation.Binary.Definitions</a> <a id="830" class="Keyword">using</a> <a id="836" class="Symbol">(</a><a id="837" href="Relation.Binary.Definitions.html#6909" class="Function">DecidableEquality</a><a id="854" class="Symbol">)</a>

<a id="857" class="Keyword">open</a> <a id="862" class="Keyword">import</a> <a id="869" href="Relation.Binary.PropositionalEquality.Core.html" class="Module">Relation.Binary.PropositionalEquality.Core</a> <a id="912" class="Keyword">using</a> <a id="918" class="Symbol">(</a><a id="919" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="922" class="Symbol">;</a> <a id="924" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a><a id="928" class="Symbol">)</a>
<a id="930" class="Keyword">import</a> <a id="937" href="Relation.Binary.Reflection.html" class="Module">Relation.Binary.Reflection</a>
<a id="964" class="Keyword">open</a> <a id="969" class="Keyword">import</a> <a id="976" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>
<a id="993" class="Keyword">import</a> <a id="1000" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="1027" class="Symbol">as</a> <a id="1030" class="Module">Dec</a>

<a id="1035" class="Keyword">open</a> <a id="1040" href="Algebra.Bundles.html#6668" class="Module">Monoid</a> <a id="1047" href="Algebra.Solver.Monoid.html#323" class="Bound">M</a>
<a id="1049" class="Keyword">open</a> <a id="1054" class="Keyword">import</a> <a id="1061" href="Relation.Binary.Reasoning.Setoid.html" class="Module">Relation.Binary.Reasoning.Setoid</a> <a id="1094" href="Algebra.Structures.html#1873" class="Function">setoid</a>

<a id="1102" class="Comment">------------------------------------------------------------------------</a>
<a id="1175" class="Comment">-- Monoid expressions</a>

<a id="1198" class="Comment">-- There is one constructor for every operation, plus one for</a>
<a id="1260" class="Comment">-- variables; there may be at most n variables.</a>

<a id="1309" class="Keyword">infixr</a> <a id="1316" class="Number">5</a> <a id="1318" href="Algebra.Solver.Monoid.html#1393" class="InductiveConstructor Operator">_⊕_</a>

<a id="1323" class="Keyword">data</a> <a id="Expr"></a><a id="1328" href="Algebra.Solver.Monoid.html#1328" class="Datatype">Expr</a> <a id="1333" class="Symbol">(</a><a id="1334" href="Algebra.Solver.Monoid.html#1334" class="Bound">n</a> <a id="1336" class="Symbol">:</a> <a id="1338" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1339" class="Symbol">)</a> <a id="1341" class="Symbol">:</a> <a id="1343" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1347" class="Keyword">where</a>
  <a id="Expr.var"></a><a id="1355" href="Algebra.Solver.Monoid.html#1355" class="InductiveConstructor">var</a> <a id="1359" class="Symbol">:</a> <a id="1361" href="Data.Fin.Base.html#1154" class="Datatype">Fin</a> <a id="1365" href="Algebra.Solver.Monoid.html#1334" class="Bound">n</a> <a id="1367" class="Symbol">→</a> <a id="1369" href="Algebra.Solver.Monoid.html#1328" class="Datatype">Expr</a> <a id="1374" href="Algebra.Solver.Monoid.html#1334" class="Bound">n</a>
  <a id="Expr.id"></a><a id="1378" href="Algebra.Solver.Monoid.html#1378" class="InductiveConstructor">id</a>  <a id="1382" class="Symbol">:</a> <a id="1384" href="Algebra.Solver.Monoid.html#1328" class="Datatype">Expr</a> <a id="1389" href="Algebra.Solver.Monoid.html#1334" class="Bound">n</a>
  <a id="Expr._⊕_"></a><a id="1393" href="Algebra.Solver.Monoid.html#1393" class="InductiveConstructor Operator">_⊕_</a> <a id="1397" class="Symbol">:</a> <a id="1399" href="Algebra.Solver.Monoid.html#1328" class="Datatype">Expr</a> <a id="1404" href="Algebra.Solver.Monoid.html#1334" class="Bound">n</a> <a id="1406" class="Symbol">→</a> <a id="1408" href="Algebra.Solver.Monoid.html#1328" class="Datatype">Expr</a> <a id="1413" href="Algebra.Solver.Monoid.html#1334" class="Bound">n</a> <a id="1415" class="Symbol">→</a> <a id="1417" href="Algebra.Solver.Monoid.html#1328" class="Datatype">Expr</a> <a id="1422" href="Algebra.Solver.Monoid.html#1334" class="Bound">n</a>

<a id="1425" class="Comment">-- An environment contains one value for every variable.</a>

<a id="Env"></a><a id="1483" href="Algebra.Solver.Monoid.html#1483" class="Function">Env</a> <a id="1487" class="Symbol">:</a> <a id="1489" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1491" class="Symbol">→</a> <a id="1493" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1497" class="Symbol">_</a>
<a id="1499" href="Algebra.Solver.Monoid.html#1483" class="Function">Env</a> <a id="1503" href="Algebra.Solver.Monoid.html#1503" class="Bound">n</a> <a id="1505" class="Symbol">=</a> <a id="1507" href="Data.Vec.Base.html#1114" class="Datatype">Vec</a> <a id="1511" href="Algebra.Bundles.html#6747" class="Field">Carrier</a> <a id="1519" href="Algebra.Solver.Monoid.html#1503" class="Bound">n</a>

<a id="1522" class="Comment">-- The semantics of an expression is a function from an environment to</a>
<a id="1593" class="Comment">-- a value.</a>

<a id="⟦_⟧"></a><a id="1606" href="Algebra.Solver.Monoid.html#1606" class="Function Operator">⟦_⟧</a> <a id="1610" class="Symbol">:</a> <a id="1612" class="Symbol">∀</a> <a id="1614" class="Symbol">{</a><a id="1615" href="Algebra.Solver.Monoid.html#1615" class="Bound">n</a><a id="1616" class="Symbol">}</a> <a id="1618" class="Symbol">→</a> <a id="1620" href="Algebra.Solver.Monoid.html#1328" class="Datatype">Expr</a> <a id="1625" href="Algebra.Solver.Monoid.html#1615" class="Bound">n</a> <a id="1627" class="Symbol">→</a> <a id="1629" href="Algebra.Solver.Monoid.html#1483" class="Function">Env</a> <a id="1633" href="Algebra.Solver.Monoid.html#1615" class="Bound">n</a> <a id="1635" class="Symbol">→</a> <a id="1637" href="Algebra.Bundles.html#6747" class="Field">Carrier</a>
<a id="1645" href="Algebra.Solver.Monoid.html#1606" class="Function Operator">⟦</a> <a id="1647" href="Algebra.Solver.Monoid.html#1355" class="InductiveConstructor">var</a> <a id="1651" href="Algebra.Solver.Monoid.html#1651" class="Bound">x</a>   <a id="1655" href="Algebra.Solver.Monoid.html#1606" class="Function Operator">⟧</a> <a id="1657" href="Algebra.Solver.Monoid.html#1657" class="Bound">ρ</a> <a id="1659" class="Symbol">=</a> <a id="1661" href="Data.Vec.Base.html#1671" class="Function">lookup</a> <a id="1668" href="Algebra.Solver.Monoid.html#1657" class="Bound">ρ</a> <a id="1670" href="Algebra.Solver.Monoid.html#1651" class="Bound">x</a>
<a id="1672" href="Algebra.Solver.Monoid.html#1606" class="Function Operator">⟦</a> <a id="1674" href="Algebra.Solver.Monoid.html#1378" class="InductiveConstructor">id</a>      <a id="1682" href="Algebra.Solver.Monoid.html#1606" class="Function Operator">⟧</a> <a id="1684" href="Algebra.Solver.Monoid.html#1684" class="Bound">ρ</a> <a id="1686" class="Symbol">=</a> <a id="1688" href="Algebra.Bundles.html#6824" class="Field">ε</a>
<a id="1690" href="Algebra.Solver.Monoid.html#1606" class="Function Operator">⟦</a> <a id="1692" href="Algebra.Solver.Monoid.html#1692" class="Bound">e₁</a> <a id="1695" href="Algebra.Solver.Monoid.html#1393" class="InductiveConstructor Operator">⊕</a> <a id="1697" href="Algebra.Solver.Monoid.html#1697" class="Bound">e₂</a> <a id="1700" href="Algebra.Solver.Monoid.html#1606" class="Function Operator">⟧</a> <a id="1702" href="Algebra.Solver.Monoid.html#1702" class="Bound">ρ</a> <a id="1704" class="Symbol">=</a> <a id="1706" href="Algebra.Solver.Monoid.html#1606" class="Function Operator">⟦</a> <a id="1708" href="Algebra.Solver.Monoid.html#1692" class="Bound">e₁</a> <a id="1711" href="Algebra.Solver.Monoid.html#1606" class="Function Operator">⟧</a> <a id="1713" href="Algebra.Solver.Monoid.html#1702" class="Bound">ρ</a> <a id="1715" href="Algebra.Bundles.html#6797" class="Field Operator">∙</a> <a id="1717" href="Algebra.Solver.Monoid.html#1606" class="Function Operator">⟦</a> <a id="1719" href="Algebra.Solver.Monoid.html#1697" class="Bound">e₂</a> <a id="1722" href="Algebra.Solver.Monoid.html#1606" class="Function Operator">⟧</a> <a id="1724" href="Algebra.Solver.Monoid.html#1702" class="Bound">ρ</a>

<a id="1727" class="Comment">------------------------------------------------------------------------</a>
<a id="1800" class="Comment">-- Normal forms</a>

<a id="1817" class="Comment">-- A normal form is a list of variables.</a>

<a id="Normal"></a><a id="1859" href="Algebra.Solver.Monoid.html#1859" class="Function">Normal</a> <a id="1866" class="Symbol">:</a> <a id="1868" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1870" class="Symbol">→</a> <a id="1872" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="1876" href="Algebra.Solver.Monoid.html#1859" class="Function">Normal</a> <a id="1883" href="Algebra.Solver.Monoid.html#1883" class="Bound">n</a> <a id="1885" class="Symbol">=</a> <a id="1887" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1892" class="Symbol">(</a><a id="1893" href="Data.Fin.Base.html#1154" class="Datatype">Fin</a> <a id="1897" href="Algebra.Solver.Monoid.html#1883" class="Bound">n</a><a id="1898" class="Symbol">)</a>

<a id="1901" class="Comment">-- The semantics of a normal form.</a>

<a id="⟦_⟧⇓"></a><a id="1937" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟦_⟧⇓</a> <a id="1942" class="Symbol">:</a> <a id="1944" class="Symbol">∀</a> <a id="1946" class="Symbol">{</a><a id="1947" href="Algebra.Solver.Monoid.html#1947" class="Bound">n</a><a id="1948" class="Symbol">}</a> <a id="1950" class="Symbol">→</a> <a id="1952" href="Algebra.Solver.Monoid.html#1859" class="Function">Normal</a> <a id="1959" href="Algebra.Solver.Monoid.html#1947" class="Bound">n</a> <a id="1961" class="Symbol">→</a> <a id="1963" href="Algebra.Solver.Monoid.html#1483" class="Function">Env</a> <a id="1967" href="Algebra.Solver.Monoid.html#1947" class="Bound">n</a> <a id="1969" class="Symbol">→</a> <a id="1971" href="Algebra.Bundles.html#6747" class="Field">Carrier</a>
<a id="1979" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟦</a> <a id="1981" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>     <a id="1988" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟧⇓</a> <a id="1991" href="Algebra.Solver.Monoid.html#1991" class="Bound">ρ</a> <a id="1993" class="Symbol">=</a> <a id="1995" href="Algebra.Bundles.html#6824" class="Field">ε</a>
<a id="1997" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟦</a> <a id="1999" href="Algebra.Solver.Monoid.html#1999" class="Bound">x</a> <a id="2001" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2003" href="Algebra.Solver.Monoid.html#2003" class="Bound">nf</a> <a id="2006" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟧⇓</a> <a id="2009" href="Algebra.Solver.Monoid.html#2009" class="Bound">ρ</a> <a id="2011" class="Symbol">=</a> <a id="2013" href="Data.Vec.Base.html#1671" class="Function">lookup</a> <a id="2020" href="Algebra.Solver.Monoid.html#2009" class="Bound">ρ</a> <a id="2022" href="Algebra.Solver.Monoid.html#1999" class="Bound">x</a> <a id="2024" href="Algebra.Bundles.html#6797" class="Field Operator">∙</a> <a id="2026" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟦</a> <a id="2028" href="Algebra.Solver.Monoid.html#2003" class="Bound">nf</a> <a id="2031" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟧⇓</a> <a id="2034" href="Algebra.Solver.Monoid.html#2009" class="Bound">ρ</a>

<a id="2037" class="Comment">-- A normaliser.</a>

<a id="normalise"></a><a id="2055" href="Algebra.Solver.Monoid.html#2055" class="Function">normalise</a> <a id="2065" class="Symbol">:</a> <a id="2067" class="Symbol">∀</a> <a id="2069" class="Symbol">{</a><a id="2070" href="Algebra.Solver.Monoid.html#2070" class="Bound">n</a><a id="2071" class="Symbol">}</a> <a id="2073" class="Symbol">→</a> <a id="2075" href="Algebra.Solver.Monoid.html#1328" class="Datatype">Expr</a> <a id="2080" href="Algebra.Solver.Monoid.html#2070" class="Bound">n</a> <a id="2082" class="Symbol">→</a> <a id="2084" href="Algebra.Solver.Monoid.html#1859" class="Function">Normal</a> <a id="2091" href="Algebra.Solver.Monoid.html#2070" class="Bound">n</a>
<a id="2093" href="Algebra.Solver.Monoid.html#2055" class="Function">normalise</a> <a id="2103" class="Symbol">(</a><a id="2104" href="Algebra.Solver.Monoid.html#1355" class="InductiveConstructor">var</a> <a id="2108" href="Algebra.Solver.Monoid.html#2108" class="Bound">x</a><a id="2109" class="Symbol">)</a>   <a id="2113" class="Symbol">=</a> <a id="2115" href="Algebra.Solver.Monoid.html#2108" class="Bound">x</a> <a id="2117" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2119" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="2122" href="Algebra.Solver.Monoid.html#2055" class="Function">normalise</a> <a id="2132" href="Algebra.Solver.Monoid.html#1378" class="InductiveConstructor">id</a>        <a id="2142" class="Symbol">=</a> <a id="2144" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="2147" href="Algebra.Solver.Monoid.html#2055" class="Function">normalise</a> <a id="2157" class="Symbol">(</a><a id="2158" href="Algebra.Solver.Monoid.html#2158" class="Bound">e₁</a> <a id="2161" href="Algebra.Solver.Monoid.html#1393" class="InductiveConstructor Operator">⊕</a> <a id="2163" href="Algebra.Solver.Monoid.html#2163" class="Bound">e₂</a><a id="2165" class="Symbol">)</a> <a id="2167" class="Symbol">=</a> <a id="2169" href="Algebra.Solver.Monoid.html#2055" class="Function">normalise</a> <a id="2179" href="Algebra.Solver.Monoid.html#2158" class="Bound">e₁</a> <a id="2182" href="Data.List.Base.html#1957" class="Function Operator">++</a> <a id="2185" href="Algebra.Solver.Monoid.html#2055" class="Function">normalise</a> <a id="2195" href="Algebra.Solver.Monoid.html#2163" class="Bound">e₂</a>

<a id="2199" class="Comment">-- The normaliser is homomorphic with respect to _++_/_∙_.</a>

<a id="homomorphic"></a><a id="2259" href="Algebra.Solver.Monoid.html#2259" class="Function">homomorphic</a> <a id="2271" class="Symbol">:</a> <a id="2273" class="Symbol">∀</a> <a id="2275" class="Symbol">{</a><a id="2276" href="Algebra.Solver.Monoid.html#2276" class="Bound">n</a><a id="2277" class="Symbol">}</a> <a id="2279" class="Symbol">(</a><a id="2280" href="Algebra.Solver.Monoid.html#2280" class="Bound">nf₁</a> <a id="2284" href="Algebra.Solver.Monoid.html#2284" class="Bound">nf₂</a> <a id="2288" class="Symbol">:</a> <a id="2290" href="Algebra.Solver.Monoid.html#1859" class="Function">Normal</a> <a id="2297" href="Algebra.Solver.Monoid.html#2276" class="Bound">n</a><a id="2298" class="Symbol">)</a> <a id="2300" class="Symbol">(</a><a id="2301" href="Algebra.Solver.Monoid.html#2301" class="Bound">ρ</a> <a id="2303" class="Symbol">:</a> <a id="2305" href="Algebra.Solver.Monoid.html#1483" class="Function">Env</a> <a id="2309" href="Algebra.Solver.Monoid.html#2276" class="Bound">n</a><a id="2310" class="Symbol">)</a> <a id="2312" class="Symbol">→</a>
              <a id="2328" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟦</a> <a id="2330" href="Algebra.Solver.Monoid.html#2280" class="Bound">nf₁</a> <a id="2334" href="Data.List.Base.html#1957" class="Function Operator">++</a> <a id="2337" href="Algebra.Solver.Monoid.html#2284" class="Bound">nf₂</a> <a id="2341" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟧⇓</a> <a id="2344" href="Algebra.Solver.Monoid.html#2301" class="Bound">ρ</a> <a id="2346" href="Algebra.Bundles.html#6768" class="Field Operator">≈</a> <a id="2348" class="Symbol">(</a><a id="2349" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟦</a> <a id="2351" href="Algebra.Solver.Monoid.html#2280" class="Bound">nf₁</a> <a id="2355" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟧⇓</a> <a id="2358" href="Algebra.Solver.Monoid.html#2301" class="Bound">ρ</a> <a id="2360" href="Algebra.Bundles.html#6797" class="Field Operator">∙</a> <a id="2362" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟦</a> <a id="2364" href="Algebra.Solver.Monoid.html#2284" class="Bound">nf₂</a> <a id="2368" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟧⇓</a> <a id="2371" href="Algebra.Solver.Monoid.html#2301" class="Bound">ρ</a><a id="2372" class="Symbol">)</a>
<a id="2374" href="Algebra.Solver.Monoid.html#2259" class="Function">homomorphic</a> <a id="2386" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2389" href="Algebra.Solver.Monoid.html#2389" class="Bound">nf₂</a> <a id="2393" href="Algebra.Solver.Monoid.html#2393" class="Bound">ρ</a> <a id="2395" class="Symbol">=</a> <a id="2397" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
  <a id="2405" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟦</a> <a id="2407" href="Algebra.Solver.Monoid.html#2389" class="Bound">nf₂</a> <a id="2411" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟧⇓</a> <a id="2414" href="Algebra.Solver.Monoid.html#2393" class="Bound">ρ</a>      <a id="2421" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">≈⟨</a> <a id="2424" href="Relation.Binary.Structures.html#1622" class="Function">sym</a> <a id="2428" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="2430" href="Algebra.Structures.html#4619" class="Function">identityˡ</a> <a id="2440" class="Symbol">_</a> <a id="2442" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">⟩</a>
  <a id="2446" href="Algebra.Bundles.html#6824" class="Field">ε</a> <a id="2448" href="Algebra.Bundles.html#6797" class="Field Operator">∙</a> <a id="2450" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟦</a> <a id="2452" href="Algebra.Solver.Monoid.html#2389" class="Bound">nf₂</a> <a id="2456" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟧⇓</a> <a id="2459" href="Algebra.Solver.Monoid.html#2393" class="Bound">ρ</a>  <a id="2462" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
<a id="2464" href="Algebra.Solver.Monoid.html#2259" class="Function">homomorphic</a> <a id="2476" class="Symbol">(</a><a id="2477" href="Algebra.Solver.Monoid.html#2477" class="Bound">x</a> <a id="2479" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2481" href="Algebra.Solver.Monoid.html#2481" class="Bound">nf₁</a><a id="2484" class="Symbol">)</a> <a id="2486" href="Algebra.Solver.Monoid.html#2486" class="Bound">nf₂</a> <a id="2490" href="Algebra.Solver.Monoid.html#2490" class="Bound">ρ</a> <a id="2492" class="Symbol">=</a> <a id="2494" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
  <a id="2502" href="Data.Vec.Base.html#1671" class="Function">lookup</a> <a id="2509" href="Algebra.Solver.Monoid.html#2490" class="Bound">ρ</a> <a id="2511" href="Algebra.Solver.Monoid.html#2477" class="Bound">x</a> <a id="2513" href="Algebra.Bundles.html#6797" class="Field Operator">∙</a> <a id="2515" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟦</a> <a id="2517" href="Algebra.Solver.Monoid.html#2481" class="Bound">nf₁</a> <a id="2521" href="Data.List.Base.html#1957" class="Function Operator">++</a> <a id="2524" href="Algebra.Solver.Monoid.html#2486" class="Bound">nf₂</a> <a id="2528" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟧⇓</a> <a id="2531" href="Algebra.Solver.Monoid.html#2490" class="Bound">ρ</a>          <a id="2542" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">≈⟨</a> <a id="2545" href="Algebra.Structures.html#1948" class="Function">∙-congˡ</a> <a id="2553" class="Symbol">(</a><a id="2554" href="Algebra.Solver.Monoid.html#2259" class="Function">homomorphic</a> <a id="2566" href="Algebra.Solver.Monoid.html#2481" class="Bound">nf₁</a> <a id="2570" href="Algebra.Solver.Monoid.html#2486" class="Bound">nf₂</a> <a id="2574" href="Algebra.Solver.Monoid.html#2490" class="Bound">ρ</a><a id="2575" class="Symbol">)</a> <a id="2577" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">⟩</a>
  <a id="2581" href="Data.Vec.Base.html#1671" class="Function">lookup</a> <a id="2588" href="Algebra.Solver.Monoid.html#2490" class="Bound">ρ</a> <a id="2590" href="Algebra.Solver.Monoid.html#2477" class="Bound">x</a> <a id="2592" href="Algebra.Bundles.html#6797" class="Field Operator">∙</a> <a id="2594" class="Symbol">(</a><a id="2595" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟦</a> <a id="2597" href="Algebra.Solver.Monoid.html#2481" class="Bound">nf₁</a> <a id="2601" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟧⇓</a> <a id="2604" href="Algebra.Solver.Monoid.html#2490" class="Bound">ρ</a> <a id="2606" href="Algebra.Bundles.html#6797" class="Field Operator">∙</a> <a id="2608" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟦</a> <a id="2610" href="Algebra.Solver.Monoid.html#2486" class="Bound">nf₂</a> <a id="2614" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟧⇓</a> <a id="2617" href="Algebra.Solver.Monoid.html#2490" class="Bound">ρ</a><a id="2618" class="Symbol">)</a>  <a id="2621" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">≈⟨</a> <a id="2624" href="Relation.Binary.Structures.html#1622" class="Function">sym</a> <a id="2628" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="2630" href="Algebra.Structures.html#3460" class="Function">assoc</a> <a id="2636" class="Symbol">_</a> <a id="2638" class="Symbol">_</a> <a id="2640" class="Symbol">_</a> <a id="2642" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">⟩</a>
  <a id="2646" href="Data.Vec.Base.html#1671" class="Function">lookup</a> <a id="2653" href="Algebra.Solver.Monoid.html#2490" class="Bound">ρ</a> <a id="2655" href="Algebra.Solver.Monoid.html#2477" class="Bound">x</a> <a id="2657" href="Algebra.Bundles.html#6797" class="Field Operator">∙</a> <a id="2659" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟦</a> <a id="2661" href="Algebra.Solver.Monoid.html#2481" class="Bound">nf₁</a> <a id="2665" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟧⇓</a> <a id="2668" href="Algebra.Solver.Monoid.html#2490" class="Bound">ρ</a> <a id="2670" href="Algebra.Bundles.html#6797" class="Field Operator">∙</a> <a id="2672" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟦</a> <a id="2674" href="Algebra.Solver.Monoid.html#2486" class="Bound">nf₂</a> <a id="2678" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟧⇓</a> <a id="2681" href="Algebra.Solver.Monoid.html#2490" class="Bound">ρ</a>    <a id="2686" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>

<a id="2689" class="Comment">-- The normaliser preserves the semantics of the expression.</a>

<a id="normalise-correct"></a><a id="2751" href="Algebra.Solver.Monoid.html#2751" class="Function">normalise-correct</a> <a id="2769" class="Symbol">:</a>
  <a id="2773" class="Symbol">∀</a> <a id="2775" class="Symbol">{</a><a id="2776" href="Algebra.Solver.Monoid.html#2776" class="Bound">n</a><a id="2777" class="Symbol">}</a> <a id="2779" class="Symbol">(</a><a id="2780" href="Algebra.Solver.Monoid.html#2780" class="Bound">e</a> <a id="2782" class="Symbol">:</a> <a id="2784" href="Algebra.Solver.Monoid.html#1328" class="Datatype">Expr</a> <a id="2789" href="Algebra.Solver.Monoid.html#2776" class="Bound">n</a><a id="2790" class="Symbol">)</a> <a id="2792" class="Symbol">(</a><a id="2793" href="Algebra.Solver.Monoid.html#2793" class="Bound">ρ</a> <a id="2795" class="Symbol">:</a> <a id="2797" href="Algebra.Solver.Monoid.html#1483" class="Function">Env</a> <a id="2801" href="Algebra.Solver.Monoid.html#2776" class="Bound">n</a><a id="2802" class="Symbol">)</a> <a id="2804" class="Symbol">→</a> <a id="2806" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟦</a> <a id="2808" href="Algebra.Solver.Monoid.html#2055" class="Function">normalise</a> <a id="2818" href="Algebra.Solver.Monoid.html#2780" class="Bound">e</a> <a id="2820" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟧⇓</a> <a id="2823" href="Algebra.Solver.Monoid.html#2793" class="Bound">ρ</a> <a id="2825" href="Algebra.Bundles.html#6768" class="Field Operator">≈</a> <a id="2827" href="Algebra.Solver.Monoid.html#1606" class="Function Operator">⟦</a> <a id="2829" href="Algebra.Solver.Monoid.html#2780" class="Bound">e</a> <a id="2831" href="Algebra.Solver.Monoid.html#1606" class="Function Operator">⟧</a> <a id="2833" href="Algebra.Solver.Monoid.html#2793" class="Bound">ρ</a>
<a id="2835" href="Algebra.Solver.Monoid.html#2751" class="Function">normalise-correct</a> <a id="2853" class="Symbol">(</a><a id="2854" href="Algebra.Solver.Monoid.html#1355" class="InductiveConstructor">var</a> <a id="2858" href="Algebra.Solver.Monoid.html#2858" class="Bound">x</a><a id="2859" class="Symbol">)</a> <a id="2861" href="Algebra.Solver.Monoid.html#2861" class="Bound">ρ</a> <a id="2863" class="Symbol">=</a> <a id="2865" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
  <a id="2873" href="Data.Vec.Base.html#1671" class="Function">lookup</a> <a id="2880" href="Algebra.Solver.Monoid.html#2861" class="Bound">ρ</a> <a id="2882" href="Algebra.Solver.Monoid.html#2858" class="Bound">x</a> <a id="2884" href="Algebra.Bundles.html#6797" class="Field Operator">∙</a> <a id="2886" href="Algebra.Bundles.html#6824" class="Field">ε</a>  <a id="2889" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">≈⟨</a> <a id="2892" href="Algebra.Structures.html#4680" class="Function">identityʳ</a> <a id="2902" class="Symbol">_</a> <a id="2904" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">⟩</a>
  <a id="2908" href="Data.Vec.Base.html#1671" class="Function">lookup</a> <a id="2915" href="Algebra.Solver.Monoid.html#2861" class="Bound">ρ</a> <a id="2917" href="Algebra.Solver.Monoid.html#2858" class="Bound">x</a>      <a id="2924" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
<a id="2926" href="Algebra.Solver.Monoid.html#2751" class="Function">normalise-correct</a> <a id="2944" href="Algebra.Solver.Monoid.html#1378" class="InductiveConstructor">id</a> <a id="2947" href="Algebra.Solver.Monoid.html#2947" class="Bound">ρ</a> <a id="2949" class="Symbol">=</a> <a id="2951" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
  <a id="2959" href="Algebra.Bundles.html#6824" class="Field">ε</a>  <a id="2962" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
<a id="2964" href="Algebra.Solver.Monoid.html#2751" class="Function">normalise-correct</a> <a id="2982" class="Symbol">(</a><a id="2983" href="Algebra.Solver.Monoid.html#2983" class="Bound">e₁</a> <a id="2986" href="Algebra.Solver.Monoid.html#1393" class="InductiveConstructor Operator">⊕</a> <a id="2988" href="Algebra.Solver.Monoid.html#2988" class="Bound">e₂</a><a id="2990" class="Symbol">)</a> <a id="2992" href="Algebra.Solver.Monoid.html#2992" class="Bound">ρ</a> <a id="2994" class="Symbol">=</a> <a id="2996" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
  <a id="3004" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟦</a> <a id="3006" href="Algebra.Solver.Monoid.html#2055" class="Function">normalise</a> <a id="3016" href="Algebra.Solver.Monoid.html#2983" class="Bound">e₁</a> <a id="3019" href="Data.List.Base.html#1957" class="Function Operator">++</a> <a id="3022" href="Algebra.Solver.Monoid.html#2055" class="Function">normalise</a> <a id="3032" href="Algebra.Solver.Monoid.html#2988" class="Bound">e₂</a> <a id="3035" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟧⇓</a> <a id="3038" href="Algebra.Solver.Monoid.html#2992" class="Bound">ρ</a>        <a id="3047" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">≈⟨</a> <a id="3050" href="Algebra.Solver.Monoid.html#2259" class="Function">homomorphic</a> <a id="3062" class="Symbol">(</a><a id="3063" href="Algebra.Solver.Monoid.html#2055" class="Function">normalise</a> <a id="3073" href="Algebra.Solver.Monoid.html#2983" class="Bound">e₁</a><a id="3075" class="Symbol">)</a> <a id="3077" class="Symbol">(</a><a id="3078" href="Algebra.Solver.Monoid.html#2055" class="Function">normalise</a> <a id="3088" href="Algebra.Solver.Monoid.html#2988" class="Bound">e₂</a><a id="3090" class="Symbol">)</a> <a id="3092" href="Algebra.Solver.Monoid.html#2992" class="Bound">ρ</a> <a id="3094" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">⟩</a>
  <a id="3098" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟦</a> <a id="3100" href="Algebra.Solver.Monoid.html#2055" class="Function">normalise</a> <a id="3110" href="Algebra.Solver.Monoid.html#2983" class="Bound">e₁</a> <a id="3113" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟧⇓</a> <a id="3116" href="Algebra.Solver.Monoid.html#2992" class="Bound">ρ</a> <a id="3118" href="Algebra.Bundles.html#6797" class="Field Operator">∙</a> <a id="3120" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟦</a> <a id="3122" href="Algebra.Solver.Monoid.html#2055" class="Function">normalise</a> <a id="3132" href="Algebra.Solver.Monoid.html#2988" class="Bound">e₂</a> <a id="3135" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟧⇓</a> <a id="3138" href="Algebra.Solver.Monoid.html#2992" class="Bound">ρ</a>  <a id="3141" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">≈⟨</a> <a id="3144" href="Algebra.Structures.html#1798" class="Function">∙-cong</a> <a id="3151" class="Symbol">(</a><a id="3152" href="Algebra.Solver.Monoid.html#2751" class="Function">normalise-correct</a> <a id="3170" href="Algebra.Solver.Monoid.html#2983" class="Bound">e₁</a> <a id="3173" href="Algebra.Solver.Monoid.html#2992" class="Bound">ρ</a><a id="3174" class="Symbol">)</a> <a id="3176" class="Symbol">(</a><a id="3177" href="Algebra.Solver.Monoid.html#2751" class="Function">normalise-correct</a> <a id="3195" href="Algebra.Solver.Monoid.html#2988" class="Bound">e₂</a> <a id="3198" href="Algebra.Solver.Monoid.html#2992" class="Bound">ρ</a><a id="3199" class="Symbol">)</a> <a id="3201" href="Relation.Binary.Reasoning.Syntax.html#7111" class="Function">⟩</a>
  <a id="3205" href="Algebra.Solver.Monoid.html#1606" class="Function Operator">⟦</a> <a id="3207" href="Algebra.Solver.Monoid.html#2983" class="Bound">e₁</a> <a id="3210" href="Algebra.Solver.Monoid.html#1606" class="Function Operator">⟧</a> <a id="3212" href="Algebra.Solver.Monoid.html#2992" class="Bound">ρ</a> <a id="3214" href="Algebra.Bundles.html#6797" class="Field Operator">∙</a> <a id="3216" href="Algebra.Solver.Monoid.html#1606" class="Function Operator">⟦</a> <a id="3218" href="Algebra.Solver.Monoid.html#2988" class="Bound">e₂</a> <a id="3221" href="Algebra.Solver.Monoid.html#1606" class="Function Operator">⟧</a> <a id="3223" href="Algebra.Solver.Monoid.html#2992" class="Bound">ρ</a>                        <a id="3248" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>

<a id="3251" class="Comment">------------------------------------------------------------------------</a>
<a id="3324" class="Comment">-- &quot;Tactic.</a>

<a id="3337" class="Keyword">open</a> <a id="3342" class="Keyword">module</a> <a id="R"></a><a id="3349" href="Algebra.Solver.Monoid.html#3349" class="Module">R</a> <a id="3351" class="Symbol">=</a> <a id="3353" href="Relation.Binary.Reflection.html" class="Module">Relation.Binary.Reflection</a>
                  <a id="3398" href="Algebra.Structures.html#1873" class="Function">setoid</a> <a id="3405" href="Algebra.Solver.Monoid.html#1355" class="InductiveConstructor">var</a> <a id="3409" href="Algebra.Solver.Monoid.html#1606" class="Function Operator">⟦_⟧</a> <a id="3413" class="Symbol">(</a><a id="3414" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟦_⟧⇓</a> <a id="3419" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3421" href="Algebra.Solver.Monoid.html#2055" class="Function">normalise</a><a id="3430" class="Symbol">)</a> <a id="3432" href="Algebra.Solver.Monoid.html#2751" class="Function">normalise-correct</a>
  <a id="3452" class="Keyword">public</a> <a id="3459" class="Keyword">using</a> <a id="3465" class="Symbol">(</a><a id="3466" href="Relation.Binary.Reflection.html#2560" class="Function">solve</a><a id="3471" class="Symbol">;</a> <a id="3473" href="Relation.Binary.Reflection.html#3665" class="Function Operator">_⊜_</a><a id="3476" class="Symbol">)</a>

<a id="3479" class="Comment">-- We can decide if two normal forms are /syntactically/ equal.</a>

<a id="3544" class="Keyword">infix</a> <a id="3550" class="Number">5</a> <a id="3552" href="Algebra.Solver.Monoid.html#3557" class="Function Operator">_≟_</a>

<a id="_≟_"></a><a id="3557" href="Algebra.Solver.Monoid.html#3557" class="Function Operator">_≟_</a> <a id="3561" class="Symbol">:</a> <a id="3563" class="Symbol">∀</a> <a id="3565" class="Symbol">{</a><a id="3566" href="Algebra.Solver.Monoid.html#3566" class="Bound">n</a><a id="3567" class="Symbol">}</a> <a id="3569" class="Symbol">→</a> <a id="3571" href="Relation.Binary.Definitions.html#6909" class="Function">DecidableEquality</a> <a id="3589" class="Symbol">(</a><a id="3590" href="Algebra.Solver.Monoid.html#1859" class="Function">Normal</a> <a id="3597" href="Algebra.Solver.Monoid.html#3566" class="Bound">n</a><a id="3598" class="Symbol">)</a>
<a id="3600" href="Algebra.Solver.Monoid.html#3600" class="Bound">nf₁</a> <a id="3604" href="Algebra.Solver.Monoid.html#3557" class="Function Operator">≟</a> <a id="3606" href="Algebra.Solver.Monoid.html#3606" class="Bound">nf₂</a> <a id="3610" class="Symbol">=</a> <a id="3612" href="Relation.Nullary.Decidable.Core.html#4934" class="Function">Dec.map′</a> <a id="3621" href="Data.List.Relation.Binary.Equality.Propositional.html#1047" class="Function">≋⇒≡</a> <a id="3625" href="Data.List.Relation.Binary.Equality.Propositional.html#1135" class="Function">≡⇒≋</a> <a id="3629" class="Symbol">(</a><a id="3630" href="Algebra.Solver.Monoid.html#3600" class="Bound">nf₁</a> <a id="3634" href="Data.List.Relation.Binary.Equality.DecSetoid.html#1047" class="Function Operator">≋?</a> <a id="3637" href="Algebra.Solver.Monoid.html#3606" class="Bound">nf₂</a><a id="3640" class="Symbol">)</a>
  <a id="3644" class="Keyword">where</a> <a id="3650" class="Keyword">open</a> <a id="3655" href="Data.List.Relation.Binary.Equality.DecPropositional.html" class="Module">ListEq</a> <a id="3662" href="Data.Fin.Properties.html#3673" class="Function Operator">Fin._≟_</a>

<a id="3671" class="Comment">-- We can also give a sound, but not necessarily complete, procedure</a>
<a id="3740" class="Comment">-- for determining if two expressions have the same semantics.</a>

<a id="prove′"></a><a id="3804" href="Algebra.Solver.Monoid.html#3804" class="Function">prove′</a> <a id="3811" class="Symbol">:</a> <a id="3813" class="Symbol">∀</a> <a id="3815" class="Symbol">{</a><a id="3816" href="Algebra.Solver.Monoid.html#3816" class="Bound">n</a><a id="3817" class="Symbol">}</a> <a id="3819" class="Symbol">(</a><a id="3820" href="Algebra.Solver.Monoid.html#3820" class="Bound">e₁</a> <a id="3823" href="Algebra.Solver.Monoid.html#3823" class="Bound">e₂</a> <a id="3826" class="Symbol">:</a> <a id="3828" href="Algebra.Solver.Monoid.html#1328" class="Datatype">Expr</a> <a id="3833" href="Algebra.Solver.Monoid.html#3816" class="Bound">n</a><a id="3834" class="Symbol">)</a> <a id="3836" class="Symbol">→</a> <a id="3838" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3844" class="Symbol">(∀</a> <a id="3847" href="Algebra.Solver.Monoid.html#3847" class="Bound">ρ</a> <a id="3849" class="Symbol">→</a> <a id="3851" href="Algebra.Solver.Monoid.html#1606" class="Function Operator">⟦</a> <a id="3853" href="Algebra.Solver.Monoid.html#3820" class="Bound">e₁</a> <a id="3856" href="Algebra.Solver.Monoid.html#1606" class="Function Operator">⟧</a> <a id="3858" href="Algebra.Solver.Monoid.html#3847" class="Bound">ρ</a> <a id="3860" href="Algebra.Bundles.html#6768" class="Field Operator">≈</a> <a id="3862" href="Algebra.Solver.Monoid.html#1606" class="Function Operator">⟦</a> <a id="3864" href="Algebra.Solver.Monoid.html#3823" class="Bound">e₂</a> <a id="3867" href="Algebra.Solver.Monoid.html#1606" class="Function Operator">⟧</a> <a id="3869" href="Algebra.Solver.Monoid.html#3847" class="Bound">ρ</a><a id="3870" class="Symbol">)</a>
<a id="3872" href="Algebra.Solver.Monoid.html#3804" class="Function">prove′</a> <a id="3879" href="Algebra.Solver.Monoid.html#3879" class="Bound">e₁</a> <a id="3882" href="Algebra.Solver.Monoid.html#3882" class="Bound">e₂</a> <a id="3885" class="Symbol">=</a>
  <a id="3889" href="Data.Maybe.Base.html#2110" class="Function">Maybe.map</a> <a id="3899" href="Algebra.Solver.Monoid.html#3958" class="Function">lemma</a> <a id="3905" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="3907" href="Data.Maybe.Base.html#1302" class="Function">decToMaybe</a> <a id="3918" class="Symbol">(</a><a id="3919" href="Algebra.Solver.Monoid.html#2055" class="Function">normalise</a> <a id="3929" href="Algebra.Solver.Monoid.html#3879" class="Bound">e₁</a> <a id="3932" href="Algebra.Solver.Monoid.html#3557" class="Function Operator">≟</a> <a id="3934" href="Algebra.Solver.Monoid.html#2055" class="Function">normalise</a> <a id="3944" href="Algebra.Solver.Monoid.html#3882" class="Bound">e₂</a><a id="3946" class="Symbol">)</a>
  <a id="3950" class="Keyword">where</a>
  <a id="3958" href="Algebra.Solver.Monoid.html#3958" class="Function">lemma</a> <a id="3964" class="Symbol">:</a> <a id="3966" href="Algebra.Solver.Monoid.html#2055" class="Function">normalise</a> <a id="3976" href="Algebra.Solver.Monoid.html#3879" class="Bound">e₁</a> <a id="3979" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3981" href="Algebra.Solver.Monoid.html#2055" class="Function">normalise</a> <a id="3991" href="Algebra.Solver.Monoid.html#3882" class="Bound">e₂</a> <a id="3994" class="Symbol">→</a> <a id="3996" class="Symbol">∀</a> <a id="3998" href="Algebra.Solver.Monoid.html#3998" class="Bound">ρ</a> <a id="4000" class="Symbol">→</a> <a id="4002" href="Algebra.Solver.Monoid.html#1606" class="Function Operator">⟦</a> <a id="4004" href="Algebra.Solver.Monoid.html#3879" class="Bound">e₁</a> <a id="4007" href="Algebra.Solver.Monoid.html#1606" class="Function Operator">⟧</a> <a id="4009" href="Algebra.Solver.Monoid.html#3998" class="Bound">ρ</a> <a id="4011" href="Algebra.Bundles.html#6768" class="Field Operator">≈</a> <a id="4013" href="Algebra.Solver.Monoid.html#1606" class="Function Operator">⟦</a> <a id="4015" href="Algebra.Solver.Monoid.html#3882" class="Bound">e₂</a> <a id="4018" href="Algebra.Solver.Monoid.html#1606" class="Function Operator">⟧</a> <a id="4020" href="Algebra.Solver.Monoid.html#3998" class="Bound">ρ</a>
  <a id="4024" href="Algebra.Solver.Monoid.html#3958" class="Function">lemma</a> <a id="4030" href="Algebra.Solver.Monoid.html#4030" class="Bound">eq</a> <a id="4033" href="Algebra.Solver.Monoid.html#4033" class="Bound">ρ</a> <a id="4035" class="Symbol">=</a>
    <a id="4041" href="Relation.Binary.Reflection.html#1874" class="Function">R.prove</a> <a id="4049" href="Algebra.Solver.Monoid.html#4033" class="Bound">ρ</a> <a id="4051" href="Algebra.Solver.Monoid.html#3879" class="Bound">e₁</a> <a id="4054" href="Algebra.Solver.Monoid.html#3882" class="Bound">e₂</a> <a id="4057" class="Symbol">(</a><a id="4058" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
      <a id="4070" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟦</a> <a id="4072" href="Algebra.Solver.Monoid.html#2055" class="Function">normalise</a> <a id="4082" href="Algebra.Solver.Monoid.html#3879" class="Bound">e₁</a> <a id="4085" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟧⇓</a> <a id="4088" href="Algebra.Solver.Monoid.html#4033" class="Bound">ρ</a>  <a id="4091" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="4094" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a> <a id="4099" class="Symbol">(λ</a> <a id="4102" href="Algebra.Solver.Monoid.html#4102" class="Bound">e</a> <a id="4104" class="Symbol">→</a> <a id="4106" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟦</a> <a id="4108" href="Algebra.Solver.Monoid.html#4102" class="Bound">e</a> <a id="4110" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟧⇓</a> <a id="4113" href="Algebra.Solver.Monoid.html#4033" class="Bound">ρ</a><a id="4114" class="Symbol">)</a> <a id="4116" href="Algebra.Solver.Monoid.html#4030" class="Bound">eq</a> <a id="4119" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
      <a id="4127" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟦</a> <a id="4129" href="Algebra.Solver.Monoid.html#2055" class="Function">normalise</a> <a id="4139" href="Algebra.Solver.Monoid.html#3882" class="Bound">e₂</a> <a id="4142" href="Algebra.Solver.Monoid.html#1937" class="Function Operator">⟧⇓</a> <a id="4145" href="Algebra.Solver.Monoid.html#4033" class="Bound">ρ</a>  <a id="4148" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a><a id="4149" class="Symbol">)</a>

<a id="4152" class="Comment">-- This procedure can be combined with from-just.</a>

<a id="prove"></a><a id="4203" href="Algebra.Solver.Monoid.html#4203" class="Function">prove</a> <a id="4209" class="Symbol">:</a> <a id="4211" class="Symbol">∀</a> <a id="4213" href="Algebra.Solver.Monoid.html#4213" class="Bound">n</a> <a id="4215" class="Symbol">(</a><a id="4216" href="Algebra.Solver.Monoid.html#4216" class="Bound">es</a> <a id="4219" class="Symbol">:</a> <a id="4221" href="Algebra.Solver.Monoid.html#1328" class="Datatype">Expr</a> <a id="4226" href="Algebra.Solver.Monoid.html#4213" class="Bound">n</a> <a id="4228" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4230" href="Algebra.Solver.Monoid.html#1328" class="Datatype">Expr</a> <a id="4235" href="Algebra.Solver.Monoid.html#4213" class="Bound">n</a><a id="4236" class="Symbol">)</a> <a id="4238" class="Symbol">→</a>
        <a id="4248" href="Data.Maybe.Base.html#1908" class="Function">From-just</a> <a id="4258" class="Symbol">(</a><a id="4259" href="Data.Product.Base.html#3109" class="Function">uncurry</a> <a id="4267" href="Algebra.Solver.Monoid.html#3804" class="Function">prove′</a> <a id="4274" href="Algebra.Solver.Monoid.html#4216" class="Bound">es</a><a id="4276" class="Symbol">)</a>
<a id="4278" href="Algebra.Solver.Monoid.html#4203" class="Function">prove</a> <a id="4284" class="Symbol">_</a> <a id="4286" class="Symbol">=</a> <a id="4288" href="Data.Maybe.Base.html#1996" class="Function">from-just</a> <a id="4298" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="4300" href="Data.Product.Base.html#3109" class="Function">uncurry</a> <a id="4308" href="Algebra.Solver.Monoid.html#3804" class="Function">prove′</a>
</pre></body></html>