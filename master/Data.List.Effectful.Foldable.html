<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.List.Effectful.Foldable</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- List is Foldable</a>
<a id="126" class="Comment">------------------------------------------------------------------------</a>

<a id="200" class="Symbol">{-#</a> <a id="204" class="Keyword">OPTIONS</a> <a id="212" class="Pragma">--cubical-compatible</a> <a id="233" class="Pragma">--safe</a> <a id="240" class="Symbol">#-}</a>

<a id="245" class="Keyword">module</a> <a id="252" href="Data.List.Effectful.Foldable.html" class="Module">Data.List.Effectful.Foldable</a> <a id="281" class="Keyword">where</a>

<a id="288" class="Keyword">open</a> <a id="293" class="Keyword">import</a> <a id="300" href="Algebra.Bundles.html" class="Module">Algebra.Bundles</a> <a id="316" class="Keyword">using</a> <a id="322" class="Symbol">(</a><a id="323" href="Algebra.Bundles.html#7315" class="Record">Monoid</a><a id="329" class="Symbol">)</a>
<a id="331" class="Keyword">open</a> <a id="336" class="Keyword">import</a> <a id="343" href="Algebra.Bundles.Raw.html" class="Module">Algebra.Bundles.Raw</a> <a id="363" class="Keyword">using</a> <a id="369" class="Symbol">(</a><a id="370" href="Algebra.Bundles.Raw.html#1534" class="Record">RawMonoid</a><a id="379" class="Symbol">)</a>
<a id="381" class="Keyword">open</a> <a id="386" class="Keyword">import</a> <a id="393" href="Algebra.Morphism.Structures.html" class="Module">Algebra.Morphism.Structures</a> <a id="421" class="Keyword">using</a> <a id="427" class="Symbol">(</a><a id="428" href="Algebra.Morphism.Structures.html#4393" class="Record">IsMonoidHomomorphism</a><a id="448" class="Symbol">)</a>
<a id="450" class="Keyword">open</a> <a id="455" class="Keyword">import</a> <a id="462" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="477" class="Symbol">as</a> <a id="480" class="Module">List</a> <a id="485" class="Keyword">using</a> <a id="491" class="Symbol">(</a><a id="492" href="Agda.Builtin.List.html#147" class="Datatype">List</a><a id="496" class="Symbol">;</a> <a id="498" href="Data.List.Base.html#7599" class="InductiveConstructor">[]</a><a id="500" class="Symbol">;</a> <a id="502" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">_∷_</a><a id="505" class="Symbol">;</a> <a id="507" href="Data.List.Base.html#1734" class="Function Operator">_++_</a><a id="511" class="Symbol">)</a>
<a id="513" class="Keyword">open</a> <a id="518" class="Keyword">import</a> <a id="525" href="Effect.Foldable.html" class="Module">Effect.Foldable</a> <a id="541" class="Keyword">using</a> <a id="547" class="Symbol">(</a><a id="548" href="Effect.Foldable.html#1539" class="Record">RawFoldableWithDefaults</a><a id="571" class="Symbol">;</a> <a id="573" href="Effect.Foldable.html#1016" class="Record">RawFoldable</a><a id="584" class="Symbol">)</a>
<a id="586" class="Keyword">open</a> <a id="591" class="Keyword">import</a> <a id="598" href="Function.Base.html" class="Module">Function.Base</a> <a id="612" class="Keyword">using</a> <a id="618" class="Symbol">(</a><a id="619" href="Function.Base.html#1115" class="Function Operator">_∘_</a><a id="622" class="Symbol">;</a> <a id="624" href="Function.Base.html#704" class="Function">id</a><a id="626" class="Symbol">)</a>
<a id="628" class="Keyword">open</a> <a id="633" class="Keyword">import</a> <a id="640" href="Level.html" class="Module">Level</a> <a id="646" class="Keyword">using</a> <a id="652" class="Symbol">(</a><a id="653" href="Agda.Primitive.html#742" class="Postulate">Level</a><a id="658" class="Symbol">)</a>
<a id="660" class="Keyword">import</a> <a id="667" href="Relation.Binary.PropositionalEquality.Core.html" class="Module">Relation.Binary.PropositionalEquality.Core</a> <a id="710" class="Symbol">as</a> <a id="713" class="Module">≡</a>

<a id="716" class="Keyword">private</a>
  <a id="726" class="Keyword">variable</a>
    <a id="739" href="Data.List.Effectful.Foldable.html#739" class="Generalizable">a</a> <a id="741" href="Data.List.Effectful.Foldable.html#741" class="Generalizable">c</a> <a id="743" href="Data.List.Effectful.Foldable.html#743" class="Generalizable">ℓ</a> <a id="745" class="Symbol">:</a> <a id="747" href="Agda.Primitive.html#742" class="Postulate">Level</a>
    <a id="757" href="Data.List.Effectful.Foldable.html#757" class="Generalizable">A</a> <a id="759" class="Symbol">:</a> <a id="761" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="765" href="Data.List.Effectful.Foldable.html#739" class="Generalizable">a</a>

<a id="768" class="Comment">------------------------------------------------------------------------</a>
<a id="841" class="Comment">-- Root implementation</a>

<a id="865" class="Keyword">module</a> <a id="872" href="Data.List.Effectful.Foldable.html#872" class="Module">_</a> <a id="874" class="Symbol">(</a><a id="875" href="Data.List.Effectful.Foldable.html#875" class="Bound">M</a> <a id="877" class="Symbol">:</a> <a id="879" href="Algebra.Bundles.Raw.html#1534" class="Record">RawMonoid</a> <a id="889" href="Data.List.Effectful.Foldable.html#741" class="Generalizable">c</a> <a id="891" href="Data.List.Effectful.Foldable.html#743" class="Generalizable">ℓ</a><a id="892" class="Symbol">)</a> <a id="894" class="Keyword">where</a>

  <a id="903" class="Keyword">open</a> <a id="908" href="Algebra.Bundles.Raw.html#1534" class="Module">RawMonoid</a> <a id="918" href="Data.List.Effectful.Foldable.html#875" class="Bound">M</a>

  <a id="923" href="Data.List.Effectful.Foldable.html#923" class="Function">foldMap</a> <a id="931" class="Symbol">:</a> <a id="933" class="Symbol">(</a><a id="934" href="Data.List.Effectful.Foldable.html#757" class="Generalizable">A</a> <a id="936" class="Symbol">→</a> <a id="938" href="Algebra.Bundles.Raw.html#1616" class="Field">Carrier</a><a id="945" class="Symbol">)</a> <a id="947" class="Symbol">→</a> <a id="949" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="954" href="Data.List.Effectful.Foldable.html#757" class="Generalizable">A</a> <a id="956" class="Symbol">→</a> <a id="958" href="Algebra.Bundles.Raw.html#1616" class="Field">Carrier</a>
  <a id="968" href="Data.List.Effectful.Foldable.html#923" class="Function">foldMap</a> <a id="976" href="Data.List.Effectful.Foldable.html#976" class="Bound">f</a> <a id="978" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>       <a id="987" class="Symbol">=</a> <a id="989" href="Algebra.Bundles.Raw.html#1690" class="Field">ε</a>
  <a id="993" href="Data.List.Effectful.Foldable.html#923" class="Function">foldMap</a> <a id="1001" href="Data.List.Effectful.Foldable.html#1001" class="Bound">f</a> <a id="1003" class="Symbol">(</a><a id="1004" href="Data.List.Effectful.Foldable.html#1004" class="Bound">x</a> <a id="1006" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1008" href="Data.List.Effectful.Foldable.html#1008" class="Bound">xs</a><a id="1010" class="Symbol">)</a> <a id="1012" class="Symbol">=</a> <a id="1014" href="Data.List.Effectful.Foldable.html#1001" class="Bound">f</a> <a id="1016" href="Data.List.Effectful.Foldable.html#1004" class="Bound">x</a> <a id="1018" href="Algebra.Bundles.Raw.html#1664" class="Field Operator">∙</a> <a id="1020" href="Data.List.Effectful.Foldable.html#923" class="Function">foldMap</a> <a id="1028" href="Data.List.Effectful.Foldable.html#1001" class="Bound">f</a> <a id="1030" href="Data.List.Effectful.Foldable.html#1008" class="Bound">xs</a>

<a id="1034" class="Comment">------------------------------------------------------------------------</a>
<a id="1107" class="Comment">-- Basic implementation using supplied defaults</a>

<a id="foldableWithDefaults"></a><a id="1156" href="Data.List.Effectful.Foldable.html#1156" class="Function">foldableWithDefaults</a> <a id="1177" class="Symbol">:</a> <a id="1179" href="Effect.Foldable.html#1539" class="Record">RawFoldableWithDefaults</a> <a id="1203" class="Symbol">(</a><a id="1204" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1209" class="Symbol">{</a><a id="1210" href="Data.List.Effectful.Foldable.html#739" class="Generalizable">a</a><a id="1211" class="Symbol">})</a>
<a id="1214" href="Data.List.Effectful.Foldable.html#1156" class="Function">foldableWithDefaults</a> <a id="1235" class="Symbol">=</a> <a id="1237" class="Keyword">record</a> <a id="1244" class="Symbol">{</a> <a id="1246" href="Effect.Foldable.html#1608" class="Field">foldMap</a> <a id="1254" class="Symbol">=</a> <a id="1256" class="Symbol">λ</a> <a id="1258" href="Data.List.Effectful.Foldable.html#1258" class="Bound">M</a> <a id="1260" class="Symbol">→</a> <a id="1262" href="Data.List.Effectful.Foldable.html#923" class="Function">foldMap</a> <a id="1270" href="Data.List.Effectful.Foldable.html#1258" class="Bound">M</a> <a id="1272" class="Symbol">}</a>

<a id="1275" class="Comment">------------------------------------------------------------------------</a>
<a id="1348" class="Comment">-- Specialised version using optimised implementations</a>

<a id="foldable"></a><a id="1404" href="Data.List.Effectful.Foldable.html#1404" class="Function">foldable</a> <a id="1413" class="Symbol">:</a> <a id="1415" href="Effect.Foldable.html#1016" class="Record">RawFoldable</a> <a id="1427" class="Symbol">(</a><a id="1428" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1433" class="Symbol">{</a><a id="1434" href="Data.List.Effectful.Foldable.html#739" class="Generalizable">a</a><a id="1435" class="Symbol">})</a>
<a id="1438" href="Data.List.Effectful.Foldable.html#1404" class="Function">foldable</a> <a id="1447" class="Symbol">=</a> <a id="1449" class="Keyword">record</a>
  <a id="1458" class="Symbol">{</a> <a id="1460" href="Effect.Foldable.html#1073" class="Field">foldMap</a> <a id="1468" class="Symbol">=</a> <a id="1470" class="Symbol">λ</a> <a id="1472" href="Data.List.Effectful.Foldable.html#1472" class="Bound">M</a> <a id="1474" class="Symbol">→</a> <a id="1476" href="Data.List.Effectful.Foldable.html#923" class="Function">foldMap</a> <a id="1484" href="Data.List.Effectful.Foldable.html#1472" class="Bound">M</a>
  <a id="1488" class="Symbol">;</a> <a id="1490" href="Effect.Foldable.html#1276" class="Field">foldr</a> <a id="1496" class="Symbol">=</a> <a id="1498" href="Data.List.Base.html#4148" class="Function">List.foldr</a>
  <a id="1511" class="Symbol">;</a> <a id="1513" href="Effect.Foldable.html#1319" class="Field">foldl</a> <a id="1519" class="Symbol">=</a> <a id="1521" href="Data.List.Base.html#4249" class="Function">List.foldl</a>
  <a id="1534" class="Symbol">;</a> <a id="1536" href="Effect.Foldable.html#1362" class="Field">toList</a> <a id="1543" class="Symbol">=</a> <a id="1545" href="Function.Base.html#704" class="Function">id</a>
  <a id="1550" class="Symbol">}</a>

<a id="1553" class="Comment">------------------------------------------------------------------------</a>
<a id="1626" class="Comment">-- Properties</a>

<a id="1641" class="Keyword">module</a> <a id="1648" href="Data.List.Effectful.Foldable.html#1648" class="Module">_</a> <a id="1650" class="Symbol">(</a><a id="1651" href="Data.List.Effectful.Foldable.html#1651" class="Bound">M</a> <a id="1653" class="Symbol">:</a> <a id="1655" href="Algebra.Bundles.html#7315" class="Record">Monoid</a> <a id="1662" href="Data.List.Effectful.Foldable.html#741" class="Generalizable">c</a> <a id="1664" href="Data.List.Effectful.Foldable.html#743" class="Generalizable">ℓ</a><a id="1665" class="Symbol">)</a> <a id="1667" class="Symbol">(</a><a id="1668" href="Data.List.Effectful.Foldable.html#1668" class="Bound">f</a> <a id="1670" class="Symbol">:</a> <a id="1672" href="Data.List.Effectful.Foldable.html#757" class="Generalizable">A</a> <a id="1674" class="Symbol">→</a> <a id="1676" href="Algebra.Bundles.html#7394" class="Field">Monoid.Carrier</a> <a id="1691" href="Data.List.Effectful.Foldable.html#1651" class="Bound">M</a><a id="1692" class="Symbol">)</a> <a id="1694" class="Keyword">where</a>

  <a id="1703" class="Keyword">open</a> <a id="1708" href="Algebra.Bundles.html#7315" class="Module">Monoid</a> <a id="1715" href="Data.List.Effectful.Foldable.html#1651" class="Bound">M</a>

  <a id="1720" class="Keyword">private</a>
    <a id="1732" href="Data.List.Effectful.Foldable.html#1732" class="Function">h</a> <a id="1734" class="Symbol">=</a> <a id="1736" href="Data.List.Effectful.Foldable.html#923" class="Function">foldMap</a> <a id="1744" href="Algebra.Bundles.html#7708" class="Function">rawMonoid</a> <a id="1754" href="Data.List.Effectful.Foldable.html#1668" class="Bound">f</a>

  <a id="1759" href="Data.List.Effectful.Foldable.html#1759" class="Function">[]-homo</a> <a id="1767" class="Symbol">:</a> <a id="1769" href="Data.List.Effectful.Foldable.html#1732" class="Function">h</a> <a id="1771" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="1774" href="Algebra.Bundles.html#7415" class="Function Operator">≈</a> <a id="1776" href="Algebra.Bundles.html#7471" class="Function">ε</a>
  <a id="1780" href="Data.List.Effectful.Foldable.html#1759" class="Function">[]-homo</a> <a id="1788" class="Symbol">=</a> <a id="1790" href="Relation.Binary.Structures.html#1596" class="Function">refl</a>

  <a id="1798" href="Data.List.Effectful.Foldable.html#1798" class="Function">++-homo</a> <a id="1806" class="Symbol">:</a> <a id="1808" class="Symbol">∀</a> <a id="1810" href="Data.List.Effectful.Foldable.html#1810" class="Bound">xs</a> <a id="1813" class="Symbol">{</a><a id="1814" href="Data.List.Effectful.Foldable.html#1814" class="Bound">ys</a><a id="1816" class="Symbol">}</a> <a id="1818" class="Symbol">→</a> <a id="1820" href="Data.List.Effectful.Foldable.html#1732" class="Function">h</a> <a id="1822" class="Symbol">(</a><a id="1823" href="Data.List.Effectful.Foldable.html#1810" class="Bound">xs</a> <a id="1826" href="Data.List.Base.html#1734" class="Function Operator">++</a> <a id="1829" href="Data.List.Effectful.Foldable.html#1814" class="Bound">ys</a><a id="1831" class="Symbol">)</a> <a id="1833" href="Algebra.Bundles.html#7415" class="Function Operator">≈</a> <a id="1835" href="Data.List.Effectful.Foldable.html#1732" class="Function">h</a> <a id="1837" href="Data.List.Effectful.Foldable.html#1810" class="Bound">xs</a> <a id="1840" href="Algebra.Bundles.html#7444" class="Function Operator">∙</a> <a id="1842" href="Data.List.Effectful.Foldable.html#1732" class="Function">h</a> <a id="1844" href="Data.List.Effectful.Foldable.html#1814" class="Bound">ys</a>
  <a id="1849" href="Data.List.Effectful.Foldable.html#1798" class="Function">++-homo</a> <a id="1857" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>       <a id="1866" class="Symbol">=</a> <a id="1868" href="Relation.Binary.Structures.html#1622" class="Function">sym</a> <a id="1872" class="Symbol">(</a><a id="1873" href="Algebra.Structures.html#4987" class="Function">identityˡ</a> <a id="1883" class="Symbol">_)</a>
  <a id="1888" href="Data.List.Effectful.Foldable.html#1798" class="Function">++-homo</a> <a id="1896" class="Symbol">(</a><a id="1897" href="Data.List.Effectful.Foldable.html#1897" class="Bound">x</a> <a id="1899" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1901" href="Data.List.Effectful.Foldable.html#1901" class="Bound">xs</a><a id="1903" class="Symbol">)</a> <a id="1905" class="Symbol">=</a> <a id="1907" href="Relation.Binary.Structures.html#1648" class="Function">trans</a> <a id="1913" class="Symbol">(</a><a id="1914" href="Algebra.Structures.html#1948" class="Function">∙-congˡ</a> <a id="1922" class="Symbol">(</a><a id="1923" href="Data.List.Effectful.Foldable.html#1798" class="Function">++-homo</a> <a id="1931" href="Data.List.Effectful.Foldable.html#1901" class="Bound">xs</a><a id="1933" class="Symbol">))</a> <a id="1936" class="Symbol">(</a><a id="1937" href="Relation.Binary.Structures.html#1622" class="Function">sym</a> <a id="1941" class="Symbol">(</a><a id="1942" href="Algebra.Structures.html#3460" class="Function">assoc</a> <a id="1948" class="Symbol">_</a> <a id="1950" class="Symbol">_</a> <a id="1952" class="Symbol">_))</a>

  <a id="1959" href="Data.List.Effectful.Foldable.html#1959" class="Function">foldMap-morphism</a> <a id="1976" class="Symbol">:</a> <a id="1978" href="Algebra.Morphism.Structures.html#4393" class="Record">IsMonoidHomomorphism</a> <a id="1999" class="Symbol">(</a><a id="2000" href="Data.List.Base.html#15579" class="Function">List.++-[]-rawMonoid</a> <a id="2021" href="Data.List.Effectful.Foldable.html#1672" class="Bound">A</a><a id="2022" class="Symbol">)</a> <a id="2024" href="Algebra.Bundles.html#7708" class="Function">rawMonoid</a> <a id="2034" href="Data.List.Effectful.Foldable.html#1732" class="Function">h</a>
  <a id="2038" href="Data.List.Effectful.Foldable.html#1959" class="Function">foldMap-morphism</a> <a id="2055" class="Symbol">=</a> <a id="2057" class="Keyword">record</a>
    <a id="2068" class="Symbol">{</a> <a id="2070" href="Algebra.Morphism.Structures.html#4470" class="Field">isMagmaHomomorphism</a> <a id="2090" class="Symbol">=</a> <a id="2092" class="Keyword">record</a>
      <a id="2105" class="Symbol">{</a> <a id="2107" href="Algebra.Morphism.Structures.html#2833" class="Field">isRelHomomorphism</a> <a id="2125" class="Symbol">=</a> <a id="2127" class="Keyword">record</a>
        <a id="2142" class="Symbol">{</a> <a id="2144" href="Relation.Binary.Morphism.Structures.html#882" class="Field">cong</a> <a id="2149" class="Symbol">=</a> <a id="2151" href="Relation.Binary.Structures.html#1674" class="Function">reflexive</a> <a id="2161" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2163" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">≡.cong</a> <a id="2170" href="Data.List.Effectful.Foldable.html#1732" class="Function">h</a> <a id="2172" class="Symbol">}</a>
      <a id="2180" class="Symbol">;</a> <a id="2182" href="Algebra.Morphism.Structures.html#2891" class="Field">homo</a> <a id="2187" class="Symbol">=</a> <a id="2189" class="Symbol">λ</a> <a id="2191" href="Data.List.Effectful.Foldable.html#2191" class="Bound">xs</a> <a id="2194" href="Data.List.Effectful.Foldable.html#2194" class="Bound">_</a> <a id="2196" class="Symbol">→</a> <a id="2198" href="Data.List.Effectful.Foldable.html#1798" class="Function">++-homo</a> <a id="2206" href="Data.List.Effectful.Foldable.html#2191" class="Bound">xs</a>
      <a id="2215" class="Symbol">}</a>
    <a id="2221" class="Symbol">;</a> <a id="2223" href="Algebra.Morphism.Structures.html#4522" class="Field">ε-homo</a> <a id="2230" class="Symbol">=</a> <a id="2232" href="Data.List.Effectful.Foldable.html#1759" class="Function">[]-homo</a>
    <a id="2244" class="Symbol">}</a>
</pre></body></html>