<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Algebra.Solver.Monoid.Solver</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- A solver for equations over monoids</a>
<a id="145" class="Comment">------------------------------------------------------------------------</a>

<a id="219" class="Symbol">{-#</a> <a id="223" class="Keyword">OPTIONS</a> <a id="231" class="Pragma">--cubical-compatible</a> <a id="252" class="Pragma">--safe</a> <a id="259" class="Symbol">#-}</a>

<a id="264" class="Keyword">open</a> <a id="269" class="Keyword">import</a> <a id="276" href="Algebra.Bundles.html" class="Module">Algebra.Bundles</a> <a id="292" class="Keyword">using</a> <a id="298" class="Symbol">(</a><a id="299" href="Algebra.Bundles.html#7315" class="Record">Monoid</a><a id="305" class="Symbol">)</a>
<a id="307" class="Keyword">import</a> <a id="314" href="Algebra.Solver.Monoid.Expression.html" class="Module">Algebra.Solver.Monoid.Expression</a> <a id="347" class="Symbol">as</a> <a id="350" class="Module">Expression</a>

<a id="362" class="Keyword">module</a> <a id="369" href="Algebra.Solver.Monoid.Solver.html" class="Module">Algebra.Solver.Monoid.Solver</a> <a id="398" class="Symbol">{</a><a id="399" href="Algebra.Solver.Monoid.Solver.html#399" class="Bound">a</a> <a id="401" href="Algebra.Solver.Monoid.Solver.html#401" class="Bound">c</a> <a id="403" href="Algebra.Solver.Monoid.Solver.html#403" class="Bound">ℓ</a><a id="404" class="Symbol">}</a> <a id="406" class="Symbol">(</a><a id="407" href="Algebra.Solver.Monoid.Solver.html#407" class="Bound">M</a> <a id="409" class="Symbol">:</a> <a id="411" href="Algebra.Bundles.html#7315" class="Record">Monoid</a> <a id="418" href="Algebra.Solver.Monoid.Solver.html#401" class="Bound">c</a> <a id="420" href="Algebra.Solver.Monoid.Solver.html#403" class="Bound">ℓ</a><a id="421" class="Symbol">)</a>
  <a id="425" class="Symbol">(</a><a id="426" class="Keyword">open</a> <a id="431" href="Algebra.Bundles.html#7315" class="Module">Monoid</a> <a id="438" href="Algebra.Solver.Monoid.Solver.html#407" class="Bound">M</a> <a id="440" class="Keyword">using</a> <a id="446" class="Symbol">(</a><a id="447" href="Algebra.Bundles.html#7708" class="Function">rawMonoid</a><a id="456" class="Symbol">;</a> <a id="458" href="Algebra.Structures.html#1873" class="Function">setoid</a><a id="464" class="Symbol">;</a> <a id="466" href="Algebra.Bundles.html#7415" class="Field Operator">_≈_</a><a id="469" class="Symbol">))</a>
  <a id="474" class="Symbol">(</a><a id="475" class="Keyword">open</a> <a id="480" href="Algebra.Solver.Monoid.Expression.html" class="Module">Expression</a> <a id="491" href="Algebra.Bundles.html#7708" class="Function">rawMonoid</a> <a id="501" class="Keyword">using</a> <a id="507" class="Symbol">(</a><a id="508" href="Algebra.Solver.Monoid.Expression.html#884" class="Datatype">Expr</a><a id="512" class="Symbol">;</a> <a id="514" href="Algebra.Solver.Monoid.Expression.html#1039" class="Function">Env</a><a id="517" class="Symbol">;</a> <a id="519" href="Algebra.Solver.Monoid.Expression.html#911" class="InductiveConstructor">var</a><a id="522" class="Symbol">;</a> <a id="524" href="Algebra.Solver.Monoid.Expression.html#1162" class="Function Operator">⟦_⟧</a><a id="527" class="Symbol">;</a> <a id="529" href="Algebra.Solver.Monoid.Expression.html#1386" class="Record">NormalAPI</a><a id="538" class="Symbol">))</a>
  <a id="543" class="Symbol">(</a><a id="544" href="Algebra.Solver.Monoid.Solver.html#544" class="Bound">N</a> <a id="546" class="Symbol">:</a> <a id="548" href="Algebra.Solver.Monoid.Expression.html#1386" class="Record">NormalAPI</a> <a id="558" href="Algebra.Solver.Monoid.Solver.html#399" class="Bound">a</a><a id="559" class="Symbol">)</a> <a id="561" class="Keyword">where</a>

<a id="568" class="Keyword">open</a> <a id="573" class="Keyword">import</a> <a id="580" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="596" class="Symbol">as</a> <a id="599" class="Module">Maybe</a>
  <a id="607" class="Keyword">using</a> <a id="613" class="Symbol">(</a><a id="614" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a><a id="619" class="Symbol">;</a> <a id="621" href="Data.Maybe.Base.html#1732" class="Function">From-just</a><a id="630" class="Symbol">;</a> <a id="632" href="Data.Maybe.Base.html#1820" class="Function">from-just</a><a id="641" class="Symbol">)</a>
<a id="643" class="Keyword">open</a> <a id="648" class="Keyword">import</a> <a id="655" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="669" class="Keyword">using</a> <a id="675" class="Symbol">(</a><a id="676" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="677" class="Symbol">)</a>
<a id="679" class="Keyword">open</a> <a id="684" class="Keyword">import</a> <a id="691" href="Function.Base.html" class="Module">Function.Base</a> <a id="705" class="Keyword">using</a> <a id="711" class="Symbol">(</a><a id="712" href="Function.Base.html#1115" class="Function Operator">_∘_</a><a id="715" class="Symbol">;</a> <a id="717" href="Function.Base.html#1974" class="Function Operator">_$_</a><a id="720" class="Symbol">)</a>
<a id="722" class="Keyword">open</a> <a id="727" class="Keyword">import</a> <a id="734" href="Relation.Binary.Consequences.html" class="Module">Relation.Binary.Consequences</a> <a id="763" class="Keyword">using</a> <a id="769" class="Symbol">(</a><a id="770" href="Relation.Binary.Consequences.html#6921" class="Function">dec⇒weaklyDec</a><a id="783" class="Symbol">)</a>
<a id="785" class="Keyword">open</a> <a id="790" class="Keyword">import</a> <a id="797" href="Relation.Binary.PropositionalEquality.Core.html" class="Module">Relation.Binary.PropositionalEquality.Core</a> <a id="840" class="Keyword">using</a> <a id="846" class="Symbol">(</a><a id="847" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="850" class="Symbol">;</a> <a id="852" href="Relation.Binary.PropositionalEquality.Core.html#1481" class="Function">cong</a><a id="856" class="Symbol">)</a>
<a id="858" class="Keyword">import</a> <a id="865" href="Relation.Binary.Reflection.html" class="Module">Relation.Binary.Reflection</a> <a id="892" class="Symbol">as</a> <a id="895" class="Module">Reflection</a>

<a id="907" class="Keyword">open</a> <a id="912" href="Algebra.Solver.Monoid.Expression.html#1386" class="Module">NormalAPI</a> <a id="922" href="Algebra.Solver.Monoid.Solver.html#544" class="Bound">N</a>

<a id="925" class="Keyword">private</a>
  <a id="935" class="Keyword">variable</a>
    <a id="948" href="Algebra.Solver.Monoid.Solver.html#948" class="Generalizable">n</a> <a id="950" class="Symbol">:</a> <a id="952" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
  <a id="956" class="Keyword">module</a>
    <a id="R"></a><a id="967" href="Algebra.Solver.Monoid.Solver.html#967" class="Module">R</a> <a id="969" class="Symbol">=</a> <a id="971" href="Relation.Binary.Reflection.html" class="Module">Reflection</a> <a id="982" href="Algebra.Structures.html#1873" class="Function">setoid</a> <a id="989" href="Algebra.Solver.Monoid.Expression.html#911" class="InductiveConstructor">var</a> <a id="993" href="Algebra.Solver.Monoid.Expression.html#1162" class="Function Operator">⟦_⟧</a> <a id="997" class="Symbol">(</a><a id="998" href="Algebra.Solver.Monoid.Expression.html#1704" class="Field Operator">⟦_⟧⇓</a> <a id="1003" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1005" href="Algebra.Solver.Monoid.Expression.html#1635" class="Field">normalise</a><a id="1014" class="Symbol">)</a> <a id="1016" href="Algebra.Solver.Monoid.Expression.html#1808" class="Field">correct</a>


<a id="1026" class="Comment">------------------------------------------------------------------------</a>
<a id="1099" class="Comment">-- Proof procedures</a>

<a id="1120" class="Comment">-- Re-export the existing solver machinery from `Reflection`</a>

<a id="1182" class="Keyword">open</a> <a id="1187" href="Algebra.Solver.Monoid.Solver.html#967" class="Module">R</a> <a id="1189" class="Keyword">public</a>
  <a id="1198" class="Keyword">using</a> <a id="1204" class="Symbol">(</a><a id="1205" href="Relation.Binary.Reflection.html#2522" class="Function">solve</a><a id="1210" class="Symbol">;</a> <a id="1212" href="Relation.Binary.Reflection.html#3627" class="Function Operator">_⊜_</a><a id="1215" class="Symbol">)</a>

<a id="1218" class="Comment">-- We can also give a sound, but not necessarily complete, procedure</a>
<a id="1287" class="Comment">-- for determining if two expressions have the same semantics.</a>

<a id="prove′"></a><a id="1351" href="Algebra.Solver.Monoid.Solver.html#1351" class="Function">prove′</a> <a id="1358" class="Symbol">:</a> <a id="1360" class="Symbol">∀</a> <a id="1362" href="Algebra.Solver.Monoid.Solver.html#1362" class="Bound">e₁</a> <a id="1365" href="Algebra.Solver.Monoid.Solver.html#1365" class="Bound">e₂</a> <a id="1368" class="Symbol">→</a> <a id="1370" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1376" class="Symbol">((</a><a id="1378" href="Algebra.Solver.Monoid.Solver.html#1378" class="Bound">ρ</a> <a id="1380" class="Symbol">:</a> <a id="1382" href="Algebra.Solver.Monoid.Expression.html#1039" class="Function">Env</a> <a id="1386" href="Algebra.Solver.Monoid.Solver.html#948" class="Generalizable">n</a><a id="1387" class="Symbol">)</a> <a id="1389" class="Symbol">→</a> <a id="1391" href="Algebra.Solver.Monoid.Expression.html#1162" class="Function Operator">⟦</a> <a id="1393" href="Algebra.Solver.Monoid.Solver.html#1362" class="Bound">e₁</a> <a id="1396" href="Algebra.Solver.Monoid.Expression.html#1162" class="Function Operator">⟧</a> <a id="1398" href="Algebra.Solver.Monoid.Solver.html#1378" class="Bound">ρ</a> <a id="1400" href="Algebra.Bundles.html#7415" class="Field Operator">≈</a> <a id="1402" href="Algebra.Solver.Monoid.Expression.html#1162" class="Function Operator">⟦</a> <a id="1404" href="Algebra.Solver.Monoid.Solver.html#1365" class="Bound">e₂</a> <a id="1407" href="Algebra.Solver.Monoid.Expression.html#1162" class="Function Operator">⟧</a> <a id="1409" href="Algebra.Solver.Monoid.Solver.html#1378" class="Bound">ρ</a><a id="1410" class="Symbol">)</a>
<a id="1412" href="Algebra.Solver.Monoid.Solver.html#1351" class="Function">prove′</a> <a id="1419" href="Algebra.Solver.Monoid.Solver.html#1419" class="Bound">e₁</a> <a id="1422" href="Algebra.Solver.Monoid.Solver.html#1422" class="Bound">e₂</a> <a id="1425" class="Symbol">=</a> <a id="1427" href="Data.Maybe.Base.html#1934" class="Function">Maybe.map</a> <a id="1437" href="Algebra.Solver.Monoid.Solver.html#1557" class="Function">lemma</a> <a id="1443" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="1445" href="Relation.Binary.Consequences.html#6921" class="Function">dec⇒weaklyDec</a> <a id="1459" href="Algebra.Solver.Monoid.Expression.html#1573" class="Field Operator">_≟_</a> <a id="1463" class="Symbol">(</a><a id="1464" href="Algebra.Solver.Monoid.Expression.html#1635" class="Field">normalise</a> <a id="1474" href="Algebra.Solver.Monoid.Solver.html#1419" class="Bound">e₁</a><a id="1476" class="Symbol">)</a> <a id="1478" class="Symbol">(</a><a id="1479" href="Algebra.Solver.Monoid.Expression.html#1635" class="Field">normalise</a> <a id="1489" href="Algebra.Solver.Monoid.Solver.html#1422" class="Bound">e₂</a><a id="1491" class="Symbol">)</a>
  <a id="1495" class="Keyword">where</a>
  <a id="1503" class="Keyword">open</a> <a id="1508" class="Keyword">import</a> <a id="1515" href="Relation.Binary.Reasoning.Setoid.html" class="Module">Relation.Binary.Reasoning.Setoid</a> <a id="1548" href="Algebra.Structures.html#1873" class="Function">setoid</a>
  <a id="1557" href="Algebra.Solver.Monoid.Solver.html#1557" class="Function">lemma</a> <a id="1563" class="Symbol">:</a> <a id="1565" href="Algebra.Solver.Monoid.Expression.html#1635" class="Field">normalise</a> <a id="1575" href="Algebra.Solver.Monoid.Solver.html#1419" class="Bound">e₁</a> <a id="1578" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1580" href="Algebra.Solver.Monoid.Expression.html#1635" class="Field">normalise</a> <a id="1590" href="Algebra.Solver.Monoid.Solver.html#1422" class="Bound">e₂</a> <a id="1593" class="Symbol">→</a> <a id="1595" class="Symbol">∀</a> <a id="1597" href="Algebra.Solver.Monoid.Solver.html#1597" class="Bound">ρ</a> <a id="1599" class="Symbol">→</a> <a id="1601" href="Algebra.Solver.Monoid.Expression.html#1162" class="Function Operator">⟦</a> <a id="1603" href="Algebra.Solver.Monoid.Solver.html#1419" class="Bound">e₁</a> <a id="1606" href="Algebra.Solver.Monoid.Expression.html#1162" class="Function Operator">⟧</a> <a id="1608" href="Algebra.Solver.Monoid.Solver.html#1597" class="Bound">ρ</a> <a id="1610" href="Algebra.Bundles.html#7415" class="Field Operator">≈</a> <a id="1612" href="Algebra.Solver.Monoid.Expression.html#1162" class="Function Operator">⟦</a> <a id="1614" href="Algebra.Solver.Monoid.Solver.html#1422" class="Bound">e₂</a> <a id="1617" href="Algebra.Solver.Monoid.Expression.html#1162" class="Function Operator">⟧</a> <a id="1619" href="Algebra.Solver.Monoid.Solver.html#1597" class="Bound">ρ</a>
  <a id="1623" href="Algebra.Solver.Monoid.Solver.html#1557" class="Function">lemma</a> <a id="1629" href="Algebra.Solver.Monoid.Solver.html#1629" class="Bound">eq</a> <a id="1632" href="Algebra.Solver.Monoid.Solver.html#1632" class="Bound">ρ</a> <a id="1634" class="Symbol">=</a> <a id="1636" href="Relation.Binary.Reflection.html#1842" class="Function">R.prove</a> <a id="1644" href="Algebra.Solver.Monoid.Solver.html#1632" class="Bound">ρ</a> <a id="1646" href="Algebra.Solver.Monoid.Solver.html#1419" class="Bound">e₁</a> <a id="1649" href="Algebra.Solver.Monoid.Solver.html#1422" class="Bound">e₂</a> <a id="1652" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="1654" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
    <a id="1664" href="Algebra.Solver.Monoid.Expression.html#1704" class="Field Operator">⟦</a> <a id="1666" href="Algebra.Solver.Monoid.Expression.html#1635" class="Field">normalise</a> <a id="1676" href="Algebra.Solver.Monoid.Solver.html#1419" class="Bound">e₁</a> <a id="1679" href="Algebra.Solver.Monoid.Expression.html#1704" class="Field Operator">⟧⇓</a> <a id="1682" href="Algebra.Solver.Monoid.Solver.html#1632" class="Bound">ρ</a>  <a id="1685" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="1688" href="Relation.Binary.PropositionalEquality.Core.html#1481" class="Function">cong</a> <a id="1693" class="Symbol">(λ</a> <a id="1696" href="Algebra.Solver.Monoid.Solver.html#1696" class="Bound">e</a> <a id="1698" class="Symbol">→</a> <a id="1700" href="Algebra.Solver.Monoid.Expression.html#1704" class="Field Operator">⟦</a> <a id="1702" href="Algebra.Solver.Monoid.Solver.html#1696" class="Bound">e</a> <a id="1704" href="Algebra.Solver.Monoid.Expression.html#1704" class="Field Operator">⟧⇓</a> <a id="1707" href="Algebra.Solver.Monoid.Solver.html#1632" class="Bound">ρ</a><a id="1708" class="Symbol">)</a> <a id="1710" href="Algebra.Solver.Monoid.Solver.html#1629" class="Bound">eq</a> <a id="1713" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
    <a id="1719" href="Algebra.Solver.Monoid.Expression.html#1704" class="Field Operator">⟦</a> <a id="1721" href="Algebra.Solver.Monoid.Expression.html#1635" class="Field">normalise</a> <a id="1731" href="Algebra.Solver.Monoid.Solver.html#1422" class="Bound">e₂</a> <a id="1734" href="Algebra.Solver.Monoid.Expression.html#1704" class="Field Operator">⟧⇓</a> <a id="1737" href="Algebra.Solver.Monoid.Solver.html#1632" class="Bound">ρ</a>  <a id="1740" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>

<a id="1743" class="Comment">-- This procedure can then be combined with from-just.</a>

<a id="prove"></a><a id="1799" href="Algebra.Solver.Monoid.Solver.html#1799" class="Function">prove</a> <a id="1805" class="Symbol">:</a> <a id="1807" class="Symbol">∀</a> <a id="1809" href="Algebra.Solver.Monoid.Solver.html#1809" class="Bound">n</a> <a id="1811" class="Symbol">(</a><a id="1812" href="Algebra.Solver.Monoid.Solver.html#1812" class="Bound">e₁</a> <a id="1815" href="Algebra.Solver.Monoid.Solver.html#1815" class="Bound">e₂</a> <a id="1818" class="Symbol">:</a> <a id="1820" href="Algebra.Solver.Monoid.Expression.html#884" class="Datatype">Expr</a> <a id="1825" href="Algebra.Solver.Monoid.Solver.html#1809" class="Bound">n</a><a id="1826" class="Symbol">)</a> <a id="1828" class="Symbol">→</a> <a id="1830" href="Data.Maybe.Base.html#1732" class="Function">From-just</a> <a id="1840" class="Symbol">(</a><a id="1841" href="Algebra.Solver.Monoid.Solver.html#1351" class="Function">prove′</a> <a id="1848" href="Algebra.Solver.Monoid.Solver.html#1812" class="Bound">e₁</a> <a id="1851" href="Algebra.Solver.Monoid.Solver.html#1815" class="Bound">e₂</a><a id="1853" class="Symbol">)</a>
<a id="1855" href="Algebra.Solver.Monoid.Solver.html#1799" class="Function">prove</a> <a id="1861" class="Symbol">_</a> <a id="1863" href="Algebra.Solver.Monoid.Solver.html#1863" class="Bound">e₁</a> <a id="1866" href="Algebra.Solver.Monoid.Solver.html#1866" class="Bound">e₂</a> <a id="1869" class="Symbol">=</a> <a id="1871" href="Data.Maybe.Base.html#1820" class="Function">from-just</a> <a id="1881" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="1883" href="Algebra.Solver.Monoid.Solver.html#1351" class="Function">prove′</a> <a id="1890" href="Algebra.Solver.Monoid.Solver.html#1863" class="Bound">e₁</a> <a id="1893" href="Algebra.Solver.Monoid.Solver.html#1866" class="Bound">e₂</a>
</pre></body></html>