<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.RingSolver.Core.Expression</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- A type for expressions over a raw ring.</a>
<a id="149" class="Comment">------------------------------------------------------------------------</a>

<a id="223" class="Symbol">{-#</a> <a id="227" class="Keyword">OPTIONS</a> <a id="235" class="Pragma">--cubical-compatible</a> <a id="256" class="Pragma">--safe</a> <a id="263" class="Symbol">#-}</a>

<a id="268" class="Keyword">module</a> <a id="275" href="Tactic.RingSolver.Core.Expression.html" class="Module">Tactic.RingSolver.Core.Expression</a> <a id="309" class="Keyword">where</a>

<a id="316" class="Keyword">open</a> <a id="321" class="Keyword">import</a> <a id="328" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="342" class="Keyword">using</a> <a id="348" class="Symbol">(</a><a id="349" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="350" class="Symbol">)</a>
<a id="352" class="Keyword">open</a> <a id="357" class="Keyword">import</a> <a id="364" href="Data.Fin.Base.html" class="Module">Data.Fin.Base</a> <a id="378" class="Keyword">using</a> <a id="384" class="Symbol">(</a><a id="385" href="Data.Fin.Base.html#1154" class="Datatype">Fin</a><a id="388" class="Symbol">)</a>
<a id="390" class="Keyword">open</a> <a id="395" class="Keyword">import</a> <a id="402" href="Data.Vec.Base.html" class="Module">Data.Vec.Base</a> <a id="416" class="Symbol">as</a> <a id="419" class="Module">Vec</a> <a id="423" class="Keyword">using</a> <a id="429" class="Symbol">(</a><a id="430" href="Data.Vec.Base.html#1114" class="Datatype">Vec</a><a id="433" class="Symbol">)</a>

<a id="436" class="Keyword">open</a> <a id="441" class="Keyword">import</a> <a id="448" href="Algebra.html" class="Module">Algebra</a>

<a id="457" class="Keyword">infixl</a> <a id="464" class="Number">6</a> <a id="466" href="Tactic.RingSolver.Core.Expression.html#660" class="InductiveConstructor Operator">_⊕_</a>
<a id="470" class="Keyword">infixl</a> <a id="477" class="Number">7</a> <a id="479" href="Tactic.RingSolver.Core.Expression.html#711" class="InductiveConstructor Operator">_⊗_</a>
<a id="483" class="Keyword">infixr</a> <a id="490" class="Number">8</a> <a id="492" href="Tactic.RingSolver.Core.Expression.html#768" class="InductiveConstructor Operator">_⊛_</a>
<a id="496" class="Keyword">infix</a> <a id="502" class="Number">8</a> <a id="504" href="Tactic.RingSolver.Core.Expression.html#825" class="InductiveConstructor Operator">⊝_</a>

<a id="508" class="Keyword">data</a> <a id="Expr"></a><a id="513" href="Tactic.RingSolver.Core.Expression.html#513" class="Datatype">Expr</a> <a id="518" class="Symbol">{</a><a id="519" href="Tactic.RingSolver.Core.Expression.html#519" class="Bound">a</a><a id="520" class="Symbol">}</a> <a id="522" class="Symbol">(</a><a id="523" href="Tactic.RingSolver.Core.Expression.html#523" class="Bound">A</a> <a id="525" class="Symbol">:</a> <a id="527" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="531" href="Tactic.RingSolver.Core.Expression.html#519" class="Bound">a</a><a id="532" class="Symbol">)</a> <a id="534" class="Symbol">(</a><a id="535" href="Tactic.RingSolver.Core.Expression.html#535" class="Bound">n</a> <a id="537" class="Symbol">:</a> <a id="539" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="540" class="Symbol">)</a> <a id="542" class="Symbol">:</a> <a id="544" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="548" href="Tactic.RingSolver.Core.Expression.html#519" class="Bound">a</a> <a id="550" class="Keyword">where</a>
  <a id="Expr.Κ"></a><a id="558" href="Tactic.RingSolver.Core.Expression.html#558" class="InductiveConstructor">Κ</a>   <a id="562" class="Symbol">:</a> <a id="564" href="Tactic.RingSolver.Core.Expression.html#523" class="Bound">A</a> <a id="566" class="Symbol">→</a> <a id="568" href="Tactic.RingSolver.Core.Expression.html#513" class="Datatype">Expr</a> <a id="573" href="Tactic.RingSolver.Core.Expression.html#523" class="Bound">A</a> <a id="575" href="Tactic.RingSolver.Core.Expression.html#535" class="Bound">n</a>                   <a id="595" class="Comment">-- Constant</a>
  <a id="Expr.Ι"></a><a id="609" href="Tactic.RingSolver.Core.Expression.html#609" class="InductiveConstructor">Ι</a>   <a id="613" class="Symbol">:</a> <a id="615" href="Data.Fin.Base.html#1154" class="Datatype">Fin</a> <a id="619" href="Tactic.RingSolver.Core.Expression.html#535" class="Bound">n</a> <a id="621" class="Symbol">→</a> <a id="623" href="Tactic.RingSolver.Core.Expression.html#513" class="Datatype">Expr</a> <a id="628" href="Tactic.RingSolver.Core.Expression.html#523" class="Bound">A</a> <a id="630" href="Tactic.RingSolver.Core.Expression.html#535" class="Bound">n</a>               <a id="646" class="Comment">-- Variable</a>
  <a id="Expr._⊕_"></a><a id="660" href="Tactic.RingSolver.Core.Expression.html#660" class="InductiveConstructor Operator">_⊕_</a> <a id="664" class="Symbol">:</a> <a id="666" href="Tactic.RingSolver.Core.Expression.html#513" class="Datatype">Expr</a> <a id="671" href="Tactic.RingSolver.Core.Expression.html#523" class="Bound">A</a> <a id="673" href="Tactic.RingSolver.Core.Expression.html#535" class="Bound">n</a> <a id="675" class="Symbol">→</a> <a id="677" href="Tactic.RingSolver.Core.Expression.html#513" class="Datatype">Expr</a> <a id="682" href="Tactic.RingSolver.Core.Expression.html#523" class="Bound">A</a> <a id="684" href="Tactic.RingSolver.Core.Expression.html#535" class="Bound">n</a> <a id="686" class="Symbol">→</a> <a id="688" href="Tactic.RingSolver.Core.Expression.html#513" class="Datatype">Expr</a> <a id="693" href="Tactic.RingSolver.Core.Expression.html#523" class="Bound">A</a> <a id="695" href="Tactic.RingSolver.Core.Expression.html#535" class="Bound">n</a> <a id="697" class="Comment">-- Addition</a>
  <a id="Expr._⊗_"></a><a id="711" href="Tactic.RingSolver.Core.Expression.html#711" class="InductiveConstructor Operator">_⊗_</a> <a id="715" class="Symbol">:</a> <a id="717" href="Tactic.RingSolver.Core.Expression.html#513" class="Datatype">Expr</a> <a id="722" href="Tactic.RingSolver.Core.Expression.html#523" class="Bound">A</a> <a id="724" href="Tactic.RingSolver.Core.Expression.html#535" class="Bound">n</a> <a id="726" class="Symbol">→</a> <a id="728" href="Tactic.RingSolver.Core.Expression.html#513" class="Datatype">Expr</a> <a id="733" href="Tactic.RingSolver.Core.Expression.html#523" class="Bound">A</a> <a id="735" href="Tactic.RingSolver.Core.Expression.html#535" class="Bound">n</a> <a id="737" class="Symbol">→</a> <a id="739" href="Tactic.RingSolver.Core.Expression.html#513" class="Datatype">Expr</a> <a id="744" href="Tactic.RingSolver.Core.Expression.html#523" class="Bound">A</a> <a id="746" href="Tactic.RingSolver.Core.Expression.html#535" class="Bound">n</a> <a id="748" class="Comment">-- Multiplication</a>
  <a id="Expr._⊛_"></a><a id="768" href="Tactic.RingSolver.Core.Expression.html#768" class="InductiveConstructor Operator">_⊛_</a> <a id="772" class="Symbol">:</a> <a id="774" href="Tactic.RingSolver.Core.Expression.html#513" class="Datatype">Expr</a> <a id="779" href="Tactic.RingSolver.Core.Expression.html#523" class="Bound">A</a> <a id="781" href="Tactic.RingSolver.Core.Expression.html#535" class="Bound">n</a> <a id="783" class="Symbol">→</a> <a id="785" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="787" class="Symbol">→</a> <a id="789" href="Tactic.RingSolver.Core.Expression.html#513" class="Datatype">Expr</a> <a id="794" href="Tactic.RingSolver.Core.Expression.html#523" class="Bound">A</a> <a id="796" href="Tactic.RingSolver.Core.Expression.html#535" class="Bound">n</a>        <a id="805" class="Comment">-- Exponentiation</a>
  <a id="Expr.⊝_"></a><a id="825" href="Tactic.RingSolver.Core.Expression.html#825" class="InductiveConstructor Operator">⊝_</a>  <a id="829" class="Symbol">:</a> <a id="831" href="Tactic.RingSolver.Core.Expression.html#513" class="Datatype">Expr</a> <a id="836" href="Tactic.RingSolver.Core.Expression.html#523" class="Bound">A</a> <a id="838" href="Tactic.RingSolver.Core.Expression.html#535" class="Bound">n</a> <a id="840" class="Symbol">→</a> <a id="842" href="Tactic.RingSolver.Core.Expression.html#513" class="Datatype">Expr</a> <a id="847" href="Tactic.RingSolver.Core.Expression.html#523" class="Bound">A</a> <a id="849" href="Tactic.RingSolver.Core.Expression.html#535" class="Bound">n</a>            <a id="862" class="Comment">-- Negation</a>


<a id="876" class="Keyword">module</a> <a id="883" href="Tactic.RingSolver.Core.Expression.html#883" class="Module">Eval</a>
  <a id="890" class="Symbol">{</a><a id="891" href="Tactic.RingSolver.Core.Expression.html#891" class="Bound">ℓ₁</a> <a id="894" href="Tactic.RingSolver.Core.Expression.html#894" class="Bound">ℓ₂</a><a id="896" class="Symbol">}</a> <a id="898" class="Symbol">(</a><a id="899" href="Tactic.RingSolver.Core.Expression.html#899" class="Bound">rawRing</a> <a id="907" class="Symbol">:</a> <a id="909" href="Algebra.Bundles.Raw.html#5024" class="Record">RawRing</a> <a id="917" href="Tactic.RingSolver.Core.Expression.html#891" class="Bound">ℓ₁</a> <a id="920" href="Tactic.RingSolver.Core.Expression.html#894" class="Bound">ℓ₂</a><a id="922" class="Symbol">)</a>
  <a id="926" class="Symbol">(</a><a id="927" class="Keyword">open</a> <a id="932" href="Algebra.Bundles.Raw.html#5024" class="Module">RawRing</a> <a id="940" href="Tactic.RingSolver.Core.Expression.html#899" class="Bound">rawRing</a><a id="947" class="Symbol">)</a>
  <a id="951" class="Symbol">{</a><a id="952" href="Tactic.RingSolver.Core.Expression.html#952" class="Bound">a</a><a id="953" class="Symbol">}</a> <a id="955" class="Symbol">{</a><a id="956" href="Tactic.RingSolver.Core.Expression.html#956" class="Bound">A</a> <a id="958" class="Symbol">:</a> <a id="960" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="964" href="Tactic.RingSolver.Core.Expression.html#952" class="Bound">a</a><a id="965" class="Symbol">}</a> <a id="967" class="Symbol">(</a><a id="968" href="Tactic.RingSolver.Core.Expression.html#968" class="Bound Operator">⟦_⟧ᵣ</a> <a id="973" class="Symbol">:</a> <a id="975" href="Tactic.RingSolver.Core.Expression.html#956" class="Bound">A</a> <a id="977" class="Symbol">→</a> <a id="979" href="Algebra.Bundles.Raw.html#5133" class="Field">Carrier</a><a id="986" class="Symbol">)</a> <a id="988" class="Keyword">where</a>

  <a id="997" class="Keyword">open</a> <a id="1002" class="Keyword">import</a> <a id="1009" href="Algebra.Definitions.RawSemiring.html" class="Module">Algebra.Definitions.RawSemiring</a> <a id="1041" href="Algebra.Bundles.Raw.html#5302" class="Function">rawSemiring</a>
    <a id="1057" class="Keyword">using</a> <a id="1063" class="Symbol">(</a><a id="1064" href="Algebra.Definitions.RawSemiring.html#1349" class="Function Operator">_^′_</a><a id="1068" class="Symbol">)</a>

  <a id="1073" href="Tactic.RingSolver.Core.Expression.html#1073" class="Function Operator">⟦_⟧</a> <a id="1077" class="Symbol">:</a> <a id="1079" class="Symbol">∀</a> <a id="1081" class="Symbol">{</a><a id="1082" href="Tactic.RingSolver.Core.Expression.html#1082" class="Bound">n</a><a id="1083" class="Symbol">}</a> <a id="1085" class="Symbol">→</a> <a id="1087" href="Tactic.RingSolver.Core.Expression.html#513" class="Datatype">Expr</a> <a id="1092" href="Tactic.RingSolver.Core.Expression.html#956" class="Bound">A</a> <a id="1094" href="Tactic.RingSolver.Core.Expression.html#1082" class="Bound">n</a> <a id="1096" class="Symbol">→</a> <a id="1098" href="Data.Vec.Base.html#1114" class="Datatype">Vec</a> <a id="1102" href="Algebra.Bundles.Raw.html#5133" class="Field">Carrier</a> <a id="1110" href="Tactic.RingSolver.Core.Expression.html#1082" class="Bound">n</a> <a id="1112" class="Symbol">→</a> <a id="1114" href="Algebra.Bundles.Raw.html#5133" class="Field">Carrier</a>
  <a id="1124" href="Tactic.RingSolver.Core.Expression.html#1073" class="Function Operator">⟦</a> <a id="1126" href="Tactic.RingSolver.Core.Expression.html#558" class="InductiveConstructor">Κ</a> <a id="1128" href="Tactic.RingSolver.Core.Expression.html#1128" class="Bound">x</a>   <a id="1132" href="Tactic.RingSolver.Core.Expression.html#1073" class="Function Operator">⟧</a> <a id="1134" href="Tactic.RingSolver.Core.Expression.html#1134" class="Bound">ρ</a> <a id="1136" class="Symbol">=</a> <a id="1138" href="Tactic.RingSolver.Core.Expression.html#968" class="Bound Operator">⟦</a> <a id="1140" href="Tactic.RingSolver.Core.Expression.html#1128" class="Bound">x</a> <a id="1142" href="Tactic.RingSolver.Core.Expression.html#968" class="Bound Operator">⟧ᵣ</a>
  <a id="1147" href="Tactic.RingSolver.Core.Expression.html#1073" class="Function Operator">⟦</a> <a id="1149" href="Tactic.RingSolver.Core.Expression.html#609" class="InductiveConstructor">Ι</a> <a id="1151" href="Tactic.RingSolver.Core.Expression.html#1151" class="Bound">x</a>   <a id="1155" href="Tactic.RingSolver.Core.Expression.html#1073" class="Function Operator">⟧</a> <a id="1157" href="Tactic.RingSolver.Core.Expression.html#1157" class="Bound">ρ</a> <a id="1159" class="Symbol">=</a> <a id="1161" href="Data.Vec.Base.html#1671" class="Function">Vec.lookup</a> <a id="1172" href="Tactic.RingSolver.Core.Expression.html#1157" class="Bound">ρ</a> <a id="1174" href="Tactic.RingSolver.Core.Expression.html#1151" class="Bound">x</a>
  <a id="1178" href="Tactic.RingSolver.Core.Expression.html#1073" class="Function Operator">⟦</a> <a id="1180" href="Tactic.RingSolver.Core.Expression.html#1180" class="Bound">x</a> <a id="1182" href="Tactic.RingSolver.Core.Expression.html#660" class="InductiveConstructor Operator">⊕</a> <a id="1184" href="Tactic.RingSolver.Core.Expression.html#1184" class="Bound">y</a> <a id="1186" href="Tactic.RingSolver.Core.Expression.html#1073" class="Function Operator">⟧</a> <a id="1188" href="Tactic.RingSolver.Core.Expression.html#1188" class="Bound">ρ</a> <a id="1190" class="Symbol">=</a> <a id="1192" href="Tactic.RingSolver.Core.Expression.html#1073" class="Function Operator">⟦</a> <a id="1194" href="Tactic.RingSolver.Core.Expression.html#1180" class="Bound">x</a> <a id="1196" href="Tactic.RingSolver.Core.Expression.html#1073" class="Function Operator">⟧</a> <a id="1198" href="Tactic.RingSolver.Core.Expression.html#1188" class="Bound">ρ</a> <a id="1200" href="Algebra.Bundles.Raw.html#5181" class="Field Operator">+</a> <a id="1202" href="Tactic.RingSolver.Core.Expression.html#1073" class="Function Operator">⟦</a> <a id="1204" href="Tactic.RingSolver.Core.Expression.html#1184" class="Bound">y</a> <a id="1206" href="Tactic.RingSolver.Core.Expression.html#1073" class="Function Operator">⟧</a> <a id="1208" href="Tactic.RingSolver.Core.Expression.html#1188" class="Bound">ρ</a>
  <a id="1212" href="Tactic.RingSolver.Core.Expression.html#1073" class="Function Operator">⟦</a> <a id="1214" href="Tactic.RingSolver.Core.Expression.html#1214" class="Bound">x</a> <a id="1216" href="Tactic.RingSolver.Core.Expression.html#711" class="InductiveConstructor Operator">⊗</a> <a id="1218" href="Tactic.RingSolver.Core.Expression.html#1218" class="Bound">y</a> <a id="1220" href="Tactic.RingSolver.Core.Expression.html#1073" class="Function Operator">⟧</a> <a id="1222" href="Tactic.RingSolver.Core.Expression.html#1222" class="Bound">ρ</a> <a id="1224" class="Symbol">=</a> <a id="1226" href="Tactic.RingSolver.Core.Expression.html#1073" class="Function Operator">⟦</a> <a id="1228" href="Tactic.RingSolver.Core.Expression.html#1214" class="Bound">x</a> <a id="1230" href="Tactic.RingSolver.Core.Expression.html#1073" class="Function Operator">⟧</a> <a id="1232" href="Tactic.RingSolver.Core.Expression.html#1222" class="Bound">ρ</a> <a id="1234" href="Algebra.Bundles.Raw.html#5207" class="Field Operator">*</a> <a id="1236" href="Tactic.RingSolver.Core.Expression.html#1073" class="Function Operator">⟦</a> <a id="1238" href="Tactic.RingSolver.Core.Expression.html#1218" class="Bound">y</a> <a id="1240" href="Tactic.RingSolver.Core.Expression.html#1073" class="Function Operator">⟧</a> <a id="1242" href="Tactic.RingSolver.Core.Expression.html#1222" class="Bound">ρ</a>
  <a id="1246" href="Tactic.RingSolver.Core.Expression.html#1073" class="Function Operator">⟦</a>   <a id="1250" href="Tactic.RingSolver.Core.Expression.html#825" class="InductiveConstructor Operator">⊝</a> <a id="1252" href="Tactic.RingSolver.Core.Expression.html#1252" class="Bound">x</a> <a id="1254" href="Tactic.RingSolver.Core.Expression.html#1073" class="Function Operator">⟧</a> <a id="1256" href="Tactic.RingSolver.Core.Expression.html#1256" class="Bound">ρ</a> <a id="1258" class="Symbol">=</a> <a id="1260" href="Algebra.Bundles.Raw.html#5233" class="Field Operator">-</a> <a id="1262" href="Tactic.RingSolver.Core.Expression.html#1073" class="Function Operator">⟦</a> <a id="1264" href="Tactic.RingSolver.Core.Expression.html#1252" class="Bound">x</a> <a id="1266" href="Tactic.RingSolver.Core.Expression.html#1073" class="Function Operator">⟧</a> <a id="1268" href="Tactic.RingSolver.Core.Expression.html#1256" class="Bound">ρ</a>
  <a id="1272" href="Tactic.RingSolver.Core.Expression.html#1073" class="Function Operator">⟦</a> <a id="1274" href="Tactic.RingSolver.Core.Expression.html#1274" class="Bound">x</a> <a id="1276" href="Tactic.RingSolver.Core.Expression.html#768" class="InductiveConstructor Operator">⊛</a> <a id="1278" href="Tactic.RingSolver.Core.Expression.html#1278" class="Bound">i</a> <a id="1280" href="Tactic.RingSolver.Core.Expression.html#1073" class="Function Operator">⟧</a> <a id="1282" href="Tactic.RingSolver.Core.Expression.html#1282" class="Bound">ρ</a> <a id="1284" class="Symbol">=</a> <a id="1286" href="Tactic.RingSolver.Core.Expression.html#1073" class="Function Operator">⟦</a> <a id="1288" href="Tactic.RingSolver.Core.Expression.html#1274" class="Bound">x</a> <a id="1290" href="Tactic.RingSolver.Core.Expression.html#1073" class="Function Operator">⟧</a> <a id="1292" href="Tactic.RingSolver.Core.Expression.html#1282" class="Bound">ρ</a> <a id="1294" href="Algebra.Definitions.RawSemiring.html#1349" class="Function Operator">^′</a> <a id="1297" href="Tactic.RingSolver.Core.Expression.html#1278" class="Bound">i</a>
</pre></body></html>