<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>IO.Primitive.Finite</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Primitive IO: simple bindings to Haskell types and functions</a>
<a id="170" class="Comment">-- Everything is assumed to be finite</a>
<a id="208" class="Comment">------------------------------------------------------------------------</a>

<a id="282" class="Symbol">{-#</a> <a id="286" class="Keyword">OPTIONS</a> <a id="294" class="Pragma">--cubical-compatible</a> <a id="315" class="Symbol">#-}</a>

<a id="320" class="Keyword">module</a> <a id="327" href="IO.Primitive.Finite.html" class="Module">IO.Primitive.Finite</a> <a id="347" class="Keyword">where</a>

<a id="354" class="Comment">-- NOTE: the contents of this module should be accessed via `IO` or</a>
<a id="422" class="Comment">-- `IO.Finite`.</a>

<a id="439" class="Keyword">open</a> <a id="444" class="Keyword">import</a> <a id="451" href="Agda.Builtin.IO.html" class="Module">Agda.Builtin.IO</a> <a id="467" class="Keyword">using</a> <a id="473" class="Symbol">(</a><a id="474" href="Agda.Builtin.IO.html#137" class="Postulate">IO</a><a id="476" class="Symbol">)</a>
<a id="478" class="Keyword">open</a> <a id="483" class="Keyword">import</a> <a id="490" href="Agda.Builtin.String.html" class="Module">Agda.Builtin.String</a> <a id="510" class="Keyword">using</a> <a id="516" class="Symbol">(</a><a id="517" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="523" class="Symbol">)</a>
<a id="525" class="Keyword">open</a> <a id="530" class="Keyword">import</a> <a id="537" href="Agda.Builtin.Unit.html" class="Module">Agda.Builtin.Unit</a> <a id="555" class="Keyword">using</a> <a id="561" class="Symbol">()</a> <a id="564" class="Keyword">renaming</a> <a id="573" class="Symbol">(</a><a id="574" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="576" class="Symbol">to</a> <a id="579" class="Record">Unit</a><a id="583" class="Symbol">)</a>

<a id="586" class="Comment">------------------------------------------------------------------------</a>
<a id="659" class="Comment">-- Simple lazy IO</a>

<a id="678" class="Comment">-- Note that the functions below produce commands which, when</a>
<a id="740" class="Comment">-- executed, may raise exceptions.</a>

<a id="776" class="Comment">-- Note also that the semantics of these functions depends on the</a>
<a id="842" class="Comment">-- version of the Haskell base library. If the version is 4.2.0.0 (or</a>
<a id="912" class="Comment">-- later?), then the functions use the character encoding specified by</a>
<a id="983" class="Comment">-- the locale. For older versions of the library (going back to at</a>
<a id="1050" class="Comment">-- least version 3) the functions use ISO-8859-1.</a>

<a id="1101" class="Keyword">postulate</a>
  <a id="getLine"></a><a id="1113" href="IO.Primitive.Finite.html#1113" class="Postulate">getLine</a>     <a id="1125" class="Symbol">:</a> <a id="1127" href="Agda.Builtin.IO.html#137" class="Postulate">IO</a> <a id="1130" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="readFile"></a><a id="1139" href="IO.Primitive.Finite.html#1139" class="Postulate">readFile</a>    <a id="1151" class="Symbol">:</a> <a id="1153" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1160" class="Symbol">→</a> <a id="1162" href="Agda.Builtin.IO.html#137" class="Postulate">IO</a> <a id="1165" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="writeFile"></a><a id="1174" href="IO.Primitive.Finite.html#1174" class="Postulate">writeFile</a>   <a id="1186" class="Symbol">:</a> <a id="1188" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1195" class="Symbol">→</a> <a id="1197" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1204" class="Symbol">→</a> <a id="1206" href="Agda.Builtin.IO.html#137" class="Postulate">IO</a> <a id="1209" href="IO.Primitive.Finite.html#579" class="Record">Unit</a>
  <a id="appendFile"></a><a id="1216" href="IO.Primitive.Finite.html#1216" class="Postulate">appendFile</a>  <a id="1228" class="Symbol">:</a> <a id="1230" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1237" class="Symbol">→</a> <a id="1239" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1246" class="Symbol">→</a> <a id="1248" href="Agda.Builtin.IO.html#137" class="Postulate">IO</a> <a id="1251" href="IO.Primitive.Finite.html#579" class="Record">Unit</a>
  <a id="putStr"></a><a id="1258" href="IO.Primitive.Finite.html#1258" class="Postulate">putStr</a>      <a id="1270" class="Symbol">:</a> <a id="1272" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1279" class="Symbol">→</a> <a id="1281" href="Agda.Builtin.IO.html#137" class="Postulate">IO</a> <a id="1284" href="IO.Primitive.Finite.html#579" class="Record">Unit</a>
  <a id="putStrLn"></a><a id="1291" href="IO.Primitive.Finite.html#1291" class="Postulate">putStrLn</a>    <a id="1303" class="Symbol">:</a> <a id="1305" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1312" class="Symbol">→</a> <a id="1314" href="Agda.Builtin.IO.html#137" class="Postulate">IO</a> <a id="1317" href="IO.Primitive.Finite.html#579" class="Record">Unit</a>

<a id="1323" class="Symbol">{-#</a> <a id="1327" class="Keyword">FOREIGN</a> <a id="1335" class="Pragma">GHC</a> <a id="1339" class="Pragma">import</a> <a id="1346" class="Pragma">qualified</a> <a id="1356" class="Pragma">Data.Text</a>    <a id="1369" class="Pragma">as</a> <a id="1372" class="Pragma">T</a>   <a id="1376" class="Symbol">#-}</a>
<a id="1380" class="Symbol">{-#</a> <a id="1384" class="Keyword">FOREIGN</a> <a id="1392" class="Pragma">GHC</a> <a id="1396" class="Pragma">import</a> <a id="1403" class="Pragma">qualified</a> <a id="1413" class="Pragma">Data.Text.IO</a> <a id="1426" class="Pragma">as</a> <a id="1429" class="Pragma">TIO</a> <a id="1433" class="Symbol">#-}</a>
<a id="1437" class="Symbol">{-#</a> <a id="1441" class="Keyword">FOREIGN</a> <a id="1449" class="Pragma">GHC</a> <a id="1453" class="Pragma">import</a> <a id="1460" class="Pragma">qualified</a> <a id="1470" class="Pragma">System.IO</a>           <a id="1490" class="Symbol">#-}</a>
<a id="1494" class="Symbol">{-#</a> <a id="1498" class="Keyword">FOREIGN</a> <a id="1506" class="Pragma">GHC</a> <a id="1510" class="Pragma">import</a> <a id="1517" class="Pragma">qualified</a> <a id="1527" class="Pragma">Control.Exception</a>   <a id="1547" class="Symbol">#-}</a>

<a id="1552" class="Symbol">{-#</a> <a id="1556" class="Keyword">FOREIGN</a> <a id="1564" class="Pragma">GHC</a>

  <a id="1571" class="Pragma">--</a> <a id="1574" class="Pragma">Reads</a> <a id="1580" class="Pragma">a</a> <a id="1582" class="Pragma">finite</a> <a id="1589" class="Pragma">file.</a> <a id="1595" class="Pragma">Raises</a> <a id="1602" class="Pragma">an</a> <a id="1605" class="Pragma">exception</a> <a id="1615" class="Pragma">if</a> <a id="1618" class="Pragma">the</a> <a id="1622" class="Pragma">file</a> <a id="1627" class="Pragma">path</a> <a id="1632" class="Pragma">refers</a>
  <a id="1641" class="Pragma">--</a> <a id="1644" class="Pragma">to</a> <a id="1647" class="Pragma">a</a> <a id="1649" class="Pragma">non-physical</a> <a id="1662" class="Pragma">file</a> <a id="1667" class="Pragma">(like</a> <a id="1673" class="Pragma">&quot;/dev/zero&quot;).</a>
  <a id="1689" class="Pragma">readFiniteFile</a> <a id="1704" class="Pragma">::</a> <a id="1707" class="Pragma">T.Text</a> <a id="1714" class="Pragma">-&gt;</a> <a id="1717" class="Pragma">IO</a> <a id="1720" class="Pragma">T.Text</a>
  <a id="1729" class="Pragma">readFiniteFile</a> <a id="1744" class="Pragma">f</a> <a id="1746" class="Pragma">=</a> <a id="1748" class="Pragma">do</a>
    <a id="1755" class="Pragma">h</a> <a id="1757" class="Pragma">&lt;-</a> <a id="1760" class="Pragma">System.IO.openFile</a> <a id="1779" class="Pragma">(T.unpack</a> <a id="1789" class="Pragma">f)</a> <a id="1792" class="Pragma">System.IO.ReadMode</a>
    <a id="1815" class="Pragma">Control.Exception.bracketOnError</a> <a id="1848" class="Pragma">(return</a> <a id="1856" class="Pragma">())</a> <a id="1860" class="Pragma">(\_</a> <a id="1864" class="Pragma">-&gt;</a> <a id="1867" class="Pragma">System.IO.hClose</a> <a id="1884" class="Pragma">h)</a>
                                                 <a id="1936" class="Pragma">(\_</a> <a id="1940" class="Pragma">-&gt;</a> <a id="1943" class="Pragma">System.IO.hFileSize</a> <a id="1963" class="Pragma">h)</a>
    <a id="1970" class="Pragma">TIO.hGetContents</a> <a id="1987" class="Pragma">h</a>

<a id="1990" class="Symbol">#-}</a>

<a id="1995" class="Symbol">{-#</a> <a id="1999" class="Keyword">COMPILE</a> <a id="2007" class="Keyword">GHC</a> <a id="2011" href="IO.Primitive.Finite.html#1113" class="Postulate">getLine</a>    <a id="2022" class="Pragma">=</a> <a id="2024" class="Pragma">TIO.getLine</a>               <a id="2050" class="Symbol">#-}</a>
<a id="2054" class="Symbol">{-#</a> <a id="2058" class="Keyword">COMPILE</a> <a id="2066" class="Keyword">GHC</a> <a id="2070" href="IO.Primitive.Finite.html#1139" class="Postulate">readFile</a>   <a id="2081" class="Pragma">=</a> <a id="2083" class="Pragma">readFiniteFile</a>            <a id="2109" class="Symbol">#-}</a>
<a id="2113" class="Symbol">{-#</a> <a id="2117" class="Keyword">COMPILE</a> <a id="2125" class="Keyword">GHC</a> <a id="2129" href="IO.Primitive.Finite.html#1174" class="Postulate">writeFile</a>  <a id="2140" class="Pragma">=</a> <a id="2142" class="Pragma">TIO.writeFile</a> <a id="2156" class="Pragma">.</a> <a id="2158" class="Pragma">T.unpack</a>  <a id="2168" class="Symbol">#-}</a>
<a id="2172" class="Symbol">{-#</a> <a id="2176" class="Keyword">COMPILE</a> <a id="2184" class="Keyword">GHC</a> <a id="2188" href="IO.Primitive.Finite.html#1216" class="Postulate">appendFile</a> <a id="2199" class="Pragma">=</a> <a id="2201" class="Pragma">TIO.appendFile</a> <a id="2216" class="Pragma">.</a> <a id="2218" class="Pragma">T.unpack</a> <a id="2227" class="Symbol">#-}</a>
<a id="2231" class="Symbol">{-#</a> <a id="2235" class="Keyword">COMPILE</a> <a id="2243" class="Keyword">GHC</a> <a id="2247" href="IO.Primitive.Finite.html#1258" class="Postulate">putStr</a>     <a id="2258" class="Pragma">=</a> <a id="2260" class="Pragma">TIO.putStr</a>                <a id="2286" class="Symbol">#-}</a>
<a id="2290" class="Symbol">{-#</a> <a id="2294" class="Keyword">COMPILE</a> <a id="2302" class="Keyword">GHC</a> <a id="2306" href="IO.Primitive.Finite.html#1291" class="Postulate">putStrLn</a>   <a id="2317" class="Pragma">=</a> <a id="2319" class="Pragma">TIO.putStrLn</a>              <a id="2345" class="Symbol">#-}</a>

<a id="2350" class="Symbol">{-#</a> <a id="2354" class="Keyword">COMPILE</a> <a id="2362" class="Keyword">UHC</a> <a id="2366" href="IO.Primitive.Finite.html#1139" class="Postulate">readFile</a> <a id="2375" class="Pragma">=</a> <a id="2377" class="Pragma">UHC.Agda.Builtins.primReadFiniteFile</a>  <a id="2415" class="Symbol">#-}</a>
</pre></body></html>