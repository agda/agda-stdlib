<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Reflection.AST.Abstraction</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Abstractions used in the reflection machinery</a>
<a id="155" class="Comment">------------------------------------------------------------------------</a>

<a id="229" class="Symbol">{-#</a> <a id="233" class="Keyword">OPTIONS</a> <a id="241" class="Pragma">--cubical-compatible</a> <a id="262" class="Pragma">--safe</a> <a id="269" class="Symbol">#-}</a>

<a id="274" class="Keyword">module</a> <a id="281" href="Reflection.AST.Abstraction.html" class="Module">Reflection.AST.Abstraction</a> <a id="308" class="Keyword">where</a>

<a id="315" class="Keyword">open</a> <a id="320" class="Keyword">import</a> <a id="327" href="Data.String.Base.html" class="Module">Data.String.Base</a> <a id="344" class="Symbol">as</a> <a id="347" class="Module">String</a> <a id="354" class="Keyword">using</a> <a id="360" class="Symbol">(</a><a id="361" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="367" class="Symbol">)</a>
<a id="369" class="Keyword">open</a> <a id="374" class="Keyword">import</a> <a id="381" href="Data.String.Properties.html" class="Module">Data.String.Properties</a> <a id="404" class="Symbol">as</a> <a id="407" class="Module">String</a> <a id="414" class="Keyword">using</a> <a id="420" class="Symbol">(</a><a id="421" href="Data.String.Properties.html#2741" class="Function Operator">_≟_</a><a id="424" class="Symbol">)</a>
<a id="426" class="Keyword">open</a> <a id="431" class="Keyword">import</a> <a id="438" href="Data.Product.Base.html" class="Module">Data.Product.Base</a> <a id="456" class="Keyword">using</a> <a id="462" class="Symbol">(</a><a id="463" href="Data.Product.Base.html#1618" class="Function Operator">_×_</a><a id="466" class="Symbol">;</a> <a id="468" href="Data.Product.Base.html#2000" class="Function Operator">&lt;_,_&gt;</a><a id="473" class="Symbol">;</a> <a id="475" href="Data.Product.Base.html#3109" class="Function">uncurry</a><a id="482" class="Symbol">)</a>
<a id="484" class="Keyword">open</a> <a id="489" class="Keyword">import</a> <a id="496" href="Level.html" class="Module">Level</a> <a id="502" class="Keyword">using</a> <a id="508" class="Symbol">(</a><a id="509" href="Agda.Primitive.html#742" class="Postulate">Level</a><a id="514" class="Symbol">)</a>
<a id="516" class="Keyword">open</a> <a id="521" class="Keyword">import</a> <a id="528" href="Relation.Nullary.Decidable.Core.html" class="Module">Relation.Nullary.Decidable.Core</a> <a id="560" class="Keyword">using</a> <a id="566" class="Symbol">(</a><a id="567" href="Relation.Nullary.Decidable.Core.html#1909" class="Record">Dec</a><a id="570" class="Symbol">;</a> <a id="572" href="Relation.Nullary.Decidable.Core.html#6091" class="Function">map′</a><a id="576" class="Symbol">;</a> <a id="578" href="Relation.Nullary.Decidable.Core.html#3214" class="Function Operator">_×-dec_</a><a id="585" class="Symbol">)</a>
<a id="587" class="Keyword">open</a> <a id="592" class="Keyword">import</a> <a id="599" href="Relation.Binary.Definitions.html" class="Module">Relation.Binary.Definitions</a> <a id="627" class="Keyword">using</a> <a id="633" class="Symbol">(</a><a id="634" href="Relation.Binary.Definitions.html#6857" class="Function">DecidableEquality</a><a id="651" class="Symbol">)</a>
<a id="653" class="Keyword">open</a> <a id="658" class="Keyword">import</a> <a id="665" href="Relation.Binary.PropositionalEquality.Core.html" class="Module">Relation.Binary.PropositionalEquality.Core</a> <a id="708" class="Keyword">using</a> <a id="714" class="Symbol">(</a><a id="715" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="718" class="Symbol">;</a> <a id="720" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="724" class="Symbol">;</a> <a id="726" href="Relation.Binary.PropositionalEquality.Core.html#1718" class="Function">cong₂</a><a id="731" class="Symbol">)</a>

<a id="734" class="Keyword">private</a>
  <a id="744" class="Keyword">variable</a>
    <a id="757" href="Reflection.AST.Abstraction.html#757" class="Generalizable">a</a> <a id="759" href="Reflection.AST.Abstraction.html#759" class="Generalizable">b</a> <a id="761" class="Symbol">:</a> <a id="763" href="Agda.Primitive.html#742" class="Postulate">Level</a>
    <a id="773" href="Reflection.AST.Abstraction.html#773" class="Generalizable">A</a> <a id="775" href="Reflection.AST.Abstraction.html#775" class="Generalizable">B</a> <a id="777" class="Symbol">:</a> <a id="779" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="783" href="Reflection.AST.Abstraction.html#757" class="Generalizable">a</a>
    <a id="789" href="Reflection.AST.Abstraction.html#789" class="Generalizable">s</a> <a id="791" href="Reflection.AST.Abstraction.html#791" class="Generalizable">t</a> <a id="793" class="Symbol">:</a> <a id="795" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
    <a id="806" href="Reflection.AST.Abstraction.html#806" class="Generalizable">x</a> <a id="808" href="Reflection.AST.Abstraction.html#808" class="Generalizable">y</a> <a id="810" class="Symbol">:</a> <a id="812" href="Reflection.AST.Abstraction.html#773" class="Generalizable">A</a>

<a id="815" class="Comment">------------------------------------------------------------------------</a>
<a id="888" class="Comment">-- Re-exporting the builtins publicly</a>

<a id="927" class="Keyword">open</a> <a id="932" class="Keyword">import</a> <a id="939" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a> <a id="963" class="Keyword">public</a>
  <a id="972" class="Keyword">using</a> <a id="978" class="Symbol">(</a><a id="979" href="Agda.Builtin.Reflection.html#4249" class="Datatype">Abs</a><a id="982" class="Symbol">)</a>

<a id="985" class="Keyword">open</a> <a id="990" href="Agda.Builtin.Reflection.html#4249" class="Module">Abs</a> <a id="994" class="Keyword">public</a>

<a id="1002" class="Comment">------------------------------------------------------------------------</a>
<a id="1075" class="Comment">-- Operations</a>

<a id="map"></a><a id="1090" href="Reflection.AST.Abstraction.html#1090" class="Function">map</a> <a id="1094" class="Symbol">:</a> <a id="1096" class="Symbol">(</a><a id="1097" href="Reflection.AST.Abstraction.html#773" class="Generalizable">A</a> <a id="1099" class="Symbol">→</a> <a id="1101" href="Reflection.AST.Abstraction.html#775" class="Generalizable">B</a><a id="1102" class="Symbol">)</a> <a id="1104" class="Symbol">→</a> <a id="1106" href="Agda.Builtin.Reflection.html#4249" class="Datatype">Abs</a> <a id="1110" href="Reflection.AST.Abstraction.html#773" class="Generalizable">A</a> <a id="1112" class="Symbol">→</a> <a id="1114" href="Agda.Builtin.Reflection.html#4249" class="Datatype">Abs</a> <a id="1118" href="Reflection.AST.Abstraction.html#775" class="Generalizable">B</a>
<a id="1120" href="Reflection.AST.Abstraction.html#1090" class="Function">map</a> <a id="1124" href="Reflection.AST.Abstraction.html#1124" class="Bound">f</a> <a id="1126" class="Symbol">(</a><a id="1127" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="1131" href="Reflection.AST.Abstraction.html#1131" class="Bound">s</a> <a id="1133" href="Reflection.AST.Abstraction.html#1133" class="Bound">x</a><a id="1134" class="Symbol">)</a> <a id="1136" class="Symbol">=</a> <a id="1138" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="1142" href="Reflection.AST.Abstraction.html#1131" class="Bound">s</a> <a id="1144" class="Symbol">(</a><a id="1145" href="Reflection.AST.Abstraction.html#1124" class="Bound">f</a> <a id="1147" href="Reflection.AST.Abstraction.html#1133" class="Bound">x</a><a id="1148" class="Symbol">)</a>

<a id="1151" class="Comment">------------------------------------------------------------------------</a>
<a id="1224" class="Comment">-- Decidable equality</a>

<a id="abs-injective₁"></a><a id="1247" href="Reflection.AST.Abstraction.html#1247" class="Function">abs-injective₁</a> <a id="1262" class="Symbol">:</a> <a id="1264" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="1268" href="Reflection.AST.Abstraction.html#789" class="Generalizable">s</a> <a id="1270" href="Reflection.AST.Abstraction.html#806" class="Generalizable">x</a> <a id="1272" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1274" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="1278" href="Reflection.AST.Abstraction.html#791" class="Generalizable">t</a> <a id="1280" href="Reflection.AST.Abstraction.html#808" class="Generalizable">y</a> <a id="1282" class="Symbol">→</a> <a id="1284" href="Reflection.AST.Abstraction.html#789" class="Generalizable">s</a> <a id="1286" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1288" href="Reflection.AST.Abstraction.html#791" class="Generalizable">t</a>
<a id="1290" href="Reflection.AST.Abstraction.html#1247" class="Function">abs-injective₁</a> <a id="1305" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="1310" class="Symbol">=</a> <a id="1312" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="abs-injective₂"></a><a id="1318" href="Reflection.AST.Abstraction.html#1318" class="Function">abs-injective₂</a> <a id="1333" class="Symbol">:</a> <a id="1335" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="1339" href="Reflection.AST.Abstraction.html#789" class="Generalizable">s</a> <a id="1341" href="Reflection.AST.Abstraction.html#806" class="Generalizable">x</a> <a id="1343" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1345" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="1349" href="Reflection.AST.Abstraction.html#791" class="Generalizable">t</a> <a id="1351" href="Reflection.AST.Abstraction.html#808" class="Generalizable">y</a> <a id="1353" class="Symbol">→</a> <a id="1355" href="Reflection.AST.Abstraction.html#806" class="Generalizable">x</a> <a id="1357" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1359" href="Reflection.AST.Abstraction.html#808" class="Generalizable">y</a>
<a id="1361" href="Reflection.AST.Abstraction.html#1318" class="Function">abs-injective₂</a> <a id="1376" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="1381" class="Symbol">=</a> <a id="1383" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="abs-injective"></a><a id="1389" href="Reflection.AST.Abstraction.html#1389" class="Function">abs-injective</a> <a id="1403" class="Symbol">:</a> <a id="1405" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="1409" href="Reflection.AST.Abstraction.html#789" class="Generalizable">s</a> <a id="1411" href="Reflection.AST.Abstraction.html#806" class="Generalizable">x</a> <a id="1413" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1415" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="1419" href="Reflection.AST.Abstraction.html#791" class="Generalizable">t</a> <a id="1421" href="Reflection.AST.Abstraction.html#808" class="Generalizable">y</a> <a id="1423" class="Symbol">→</a> <a id="1425" href="Reflection.AST.Abstraction.html#789" class="Generalizable">s</a> <a id="1427" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1429" href="Reflection.AST.Abstraction.html#791" class="Generalizable">t</a> <a id="1431" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1433" href="Reflection.AST.Abstraction.html#806" class="Generalizable">x</a> <a id="1435" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1437" href="Reflection.AST.Abstraction.html#808" class="Generalizable">y</a>
<a id="1439" href="Reflection.AST.Abstraction.html#1389" class="Function">abs-injective</a> <a id="1453" class="Symbol">=</a> <a id="1455" href="Data.Product.Base.html#2000" class="Function Operator">&lt;</a> <a id="1457" href="Reflection.AST.Abstraction.html#1247" class="Function">abs-injective₁</a> <a id="1472" href="Data.Product.Base.html#2000" class="Function Operator">,</a> <a id="1474" href="Reflection.AST.Abstraction.html#1318" class="Function">abs-injective₂</a> <a id="1489" href="Data.Product.Base.html#2000" class="Function Operator">&gt;</a>

<a id="1492" class="Comment">-- We often need decidability of equality for Abs A when implementing it</a>
<a id="1565" class="Comment">-- for A. Unfortunately ≡-dec makes the termination checker unhappy.</a>
<a id="1634" class="Comment">-- Instead, we can match on both Abs A and use unAbs-dec for an</a>
<a id="1698" class="Comment">-- obviously decreasing recursive call.</a>

<a id="unAbs"></a><a id="1739" href="Reflection.AST.Abstraction.html#1739" class="Function">unAbs</a> <a id="1745" class="Symbol">:</a> <a id="1747" href="Agda.Builtin.Reflection.html#4249" class="Datatype">Abs</a> <a id="1751" href="Reflection.AST.Abstraction.html#773" class="Generalizable">A</a> <a id="1753" class="Symbol">→</a> <a id="1755" href="Reflection.AST.Abstraction.html#773" class="Generalizable">A</a>
<a id="1757" href="Reflection.AST.Abstraction.html#1739" class="Function">unAbs</a> <a id="1763" class="Symbol">(</a><a id="1764" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="1768" href="Reflection.AST.Abstraction.html#1768" class="Bound">s</a> <a id="1770" href="Reflection.AST.Abstraction.html#1770" class="Bound">a</a><a id="1771" class="Symbol">)</a> <a id="1773" class="Symbol">=</a> <a id="1775" href="Reflection.AST.Abstraction.html#1770" class="Bound">a</a>

<a id="unAbs-dec"></a><a id="1778" href="Reflection.AST.Abstraction.html#1778" class="Function">unAbs-dec</a> <a id="1788" class="Symbol">:</a> <a id="1790" class="Symbol">{</a><a id="1791" href="Reflection.AST.Abstraction.html#1791" class="Bound">abs1</a> <a id="1796" href="Reflection.AST.Abstraction.html#1796" class="Bound">abs2</a> <a id="1801" class="Symbol">:</a> <a id="1803" href="Agda.Builtin.Reflection.html#4249" class="Datatype">Abs</a> <a id="1807" href="Reflection.AST.Abstraction.html#773" class="Generalizable">A</a><a id="1808" class="Symbol">}</a> <a id="1810" class="Symbol">→</a> <a id="1812" href="Relation.Nullary.Decidable.Core.html#1909" class="Record">Dec</a> <a id="1816" class="Symbol">(</a><a id="1817" href="Reflection.AST.Abstraction.html#1739" class="Function">unAbs</a> <a id="1823" href="Reflection.AST.Abstraction.html#1791" class="Bound">abs1</a> <a id="1828" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1830" href="Reflection.AST.Abstraction.html#1739" class="Function">unAbs</a> <a id="1836" href="Reflection.AST.Abstraction.html#1796" class="Bound">abs2</a><a id="1840" class="Symbol">)</a> <a id="1842" class="Symbol">→</a> <a id="1844" href="Relation.Nullary.Decidable.Core.html#1909" class="Record">Dec</a> <a id="1848" class="Symbol">(</a><a id="1849" href="Reflection.AST.Abstraction.html#1791" class="Bound">abs1</a> <a id="1854" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1856" href="Reflection.AST.Abstraction.html#1796" class="Bound">abs2</a><a id="1860" class="Symbol">)</a>
<a id="1862" href="Reflection.AST.Abstraction.html#1778" class="Function">unAbs-dec</a> <a id="1872" class="Symbol">{</a><a id="1873" class="Argument">abs1</a> <a id="1878" class="Symbol">=</a> <a id="1880" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="1884" href="Reflection.AST.Abstraction.html#1884" class="Bound">s</a> <a id="1886" href="Reflection.AST.Abstraction.html#1886" class="Bound">a</a><a id="1887" class="Symbol">}</a> <a id="1889" class="Symbol">{</a><a id="1890" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="1894" href="Reflection.AST.Abstraction.html#1894" class="Bound">t</a> <a id="1896" href="Reflection.AST.Abstraction.html#1896" class="Bound">a′</a><a id="1898" class="Symbol">}</a> <a id="1900" href="Reflection.AST.Abstraction.html#1900" class="Bound">a≟a′</a> <a id="1905" class="Symbol">=</a>
  <a id="1909" href="Relation.Nullary.Decidable.Core.html#6091" class="Function">map′</a> <a id="1914" class="Symbol">(</a><a id="1915" href="Data.Product.Base.html#3109" class="Function">uncurry</a> <a id="1923" class="Symbol">(</a><a id="1924" href="Relation.Binary.PropositionalEquality.Core.html#1718" class="Function">cong₂</a> <a id="1930" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a><a id="1933" class="Symbol">))</a> <a id="1936" href="Reflection.AST.Abstraction.html#1389" class="Function">abs-injective</a> <a id="1950" class="Symbol">(</a><a id="1951" href="Reflection.AST.Abstraction.html#1884" class="Bound">s</a> <a id="1953" href="Data.String.Properties.html#2741" class="Function Operator">String.≟</a> <a id="1962" href="Reflection.AST.Abstraction.html#1894" class="Bound">t</a> <a id="1964" href="Relation.Nullary.Decidable.Core.html#3214" class="Function Operator">×-dec</a> <a id="1970" href="Reflection.AST.Abstraction.html#1900" class="Bound">a≟a′</a><a id="1974" class="Symbol">)</a>

<a id="≡-dec"></a><a id="1977" href="Reflection.AST.Abstraction.html#1977" class="Function">≡-dec</a> <a id="1983" class="Symbol">:</a> <a id="1985" href="Relation.Binary.Definitions.html#6857" class="Function">DecidableEquality</a> <a id="2003" href="Reflection.AST.Abstraction.html#773" class="Generalizable">A</a> <a id="2005" class="Symbol">→</a> <a id="2007" href="Relation.Binary.Definitions.html#6857" class="Function">DecidableEquality</a> <a id="2025" class="Symbol">(</a><a id="2026" href="Agda.Builtin.Reflection.html#4249" class="Datatype">Abs</a> <a id="2030" href="Reflection.AST.Abstraction.html#773" class="Generalizable">A</a><a id="2031" class="Symbol">)</a>
<a id="2033" href="Reflection.AST.Abstraction.html#1977" class="Function">≡-dec</a> <a id="2039" href="Reflection.AST.Abstraction.html#2039" class="Bound Operator">_≟_</a> <a id="2043" href="Reflection.AST.Abstraction.html#2043" class="Bound">x</a> <a id="2045" href="Reflection.AST.Abstraction.html#2045" class="Bound">y</a> <a id="2047" class="Symbol">=</a> <a id="2049" href="Reflection.AST.Abstraction.html#1778" class="Function">unAbs-dec</a> <a id="2059" class="Symbol">(</a><a id="2060" href="Reflection.AST.Abstraction.html#1739" class="Function">unAbs</a> <a id="2066" href="Reflection.AST.Abstraction.html#2043" class="Bound">x</a> <a id="2068" href="Reflection.AST.Abstraction.html#2039" class="Bound Operator">≟</a> <a id="2070" href="Reflection.AST.Abstraction.html#1739" class="Function">unAbs</a> <a id="2076" href="Reflection.AST.Abstraction.html#2045" class="Bound">y</a><a id="2077" class="Symbol">)</a>
</pre></body></html>