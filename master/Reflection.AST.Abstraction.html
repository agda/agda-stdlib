<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Reflection.AST.Abstraction</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Abstractions used in the reflection machinery</a>
<a id="155" class="Comment">------------------------------------------------------------------------</a>

<a id="229" class="Symbol">{-#</a> <a id="233" class="Keyword">OPTIONS</a> <a id="241" class="Pragma">--cubical-compatible</a> <a id="262" class="Pragma">--safe</a> <a id="269" class="Symbol">#-}</a>

<a id="274" class="Keyword">module</a> <a id="281" href="Reflection.AST.Abstraction.html" class="Module">Reflection.AST.Abstraction</a> <a id="308" class="Keyword">where</a>

<a id="315" class="Keyword">open</a> <a id="320" class="Keyword">import</a> <a id="327" href="Data.String.Base.html" class="Module">Data.String.Base</a> <a id="344" class="Symbol">as</a> <a id="347" class="Module">String</a> <a id="354" class="Keyword">using</a> <a id="360" class="Symbol">(</a><a id="361" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="367" class="Symbol">)</a>
<a id="369" class="Keyword">open</a> <a id="374" class="Keyword">import</a> <a id="381" href="Data.String.Properties.html" class="Module">Data.String.Properties</a> <a id="404" class="Symbol">as</a> <a id="407" class="Module">String</a> <a id="414" class="Keyword">using</a> <a id="420" class="Symbol">(</a><a id="421" href="Data.String.Properties.html#2741" class="Function Operator">_≟_</a><a id="424" class="Symbol">)</a>
<a id="426" class="Keyword">open</a> <a id="431" class="Keyword">import</a> <a id="438" href="Data.Product.Base.html" class="Module">Data.Product.Base</a> <a id="456" class="Keyword">using</a> <a id="462" class="Symbol">(</a><a id="463" href="Data.Product.Base.html#1618" class="Function Operator">_×_</a><a id="466" class="Symbol">;</a> <a id="468" href="Data.Product.Base.html#2000" class="Function Operator">&lt;_,_&gt;</a><a id="473" class="Symbol">;</a> <a id="475" href="Data.Product.Base.html#3109" class="Function">uncurry</a><a id="482" class="Symbol">)</a>
<a id="484" class="Keyword">open</a> <a id="489" class="Keyword">import</a> <a id="496" href="Level.html" class="Module">Level</a> <a id="502" class="Keyword">using</a> <a id="508" class="Symbol">(</a><a id="509" href="Agda.Primitive.html#742" class="Postulate">Level</a><a id="514" class="Symbol">)</a>
<a id="516" class="Keyword">open</a> <a id="521" class="Keyword">import</a> <a id="528" href="Relation.Nullary.Decidable.Core.html" class="Module">Relation.Nullary.Decidable.Core</a> <a id="560" class="Keyword">using</a> <a id="566" class="Symbol">(</a><a id="567" href="Relation.Nullary.Decidable.Core.html#1972" class="Record">Dec</a><a id="570" class="Symbol">;</a> <a id="572" href="Relation.Nullary.Decidable.Core.html#6261" class="Function">map′</a><a id="576" class="Symbol">;</a> <a id="578" href="Relation.Nullary.Decidable.Core.html#3420" class="Function Operator">_×?_</a><a id="582" class="Symbol">)</a>
<a id="584" class="Keyword">open</a> <a id="589" class="Keyword">import</a> <a id="596" href="Relation.Binary.Definitions.html" class="Module">Relation.Binary.Definitions</a> <a id="624" class="Keyword">using</a> <a id="630" class="Symbol">(</a><a id="631" href="Relation.Binary.Definitions.html#7028" class="Function">DecidableEquality</a><a id="648" class="Symbol">)</a>
<a id="650" class="Keyword">open</a> <a id="655" class="Keyword">import</a> <a id="662" href="Relation.Binary.PropositionalEquality.Core.html" class="Module">Relation.Binary.PropositionalEquality.Core</a> <a id="705" class="Keyword">using</a> <a id="711" class="Symbol">(</a><a id="712" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="715" class="Symbol">;</a> <a id="717" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="721" class="Symbol">;</a> <a id="723" href="Relation.Binary.PropositionalEquality.Core.html#1718" class="Function">cong₂</a><a id="728" class="Symbol">)</a>

<a id="731" class="Keyword">private</a>
  <a id="741" class="Keyword">variable</a>
    <a id="754" href="Reflection.AST.Abstraction.html#754" class="Generalizable">a</a> <a id="756" href="Reflection.AST.Abstraction.html#756" class="Generalizable">b</a> <a id="758" class="Symbol">:</a> <a id="760" href="Agda.Primitive.html#742" class="Postulate">Level</a>
    <a id="770" href="Reflection.AST.Abstraction.html#770" class="Generalizable">A</a> <a id="772" href="Reflection.AST.Abstraction.html#772" class="Generalizable">B</a> <a id="774" class="Symbol">:</a> <a id="776" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="780" href="Reflection.AST.Abstraction.html#754" class="Generalizable">a</a>
    <a id="786" href="Reflection.AST.Abstraction.html#786" class="Generalizable">s</a> <a id="788" href="Reflection.AST.Abstraction.html#788" class="Generalizable">t</a> <a id="790" class="Symbol">:</a> <a id="792" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
    <a id="803" href="Reflection.AST.Abstraction.html#803" class="Generalizable">x</a> <a id="805" href="Reflection.AST.Abstraction.html#805" class="Generalizable">y</a> <a id="807" class="Symbol">:</a> <a id="809" href="Reflection.AST.Abstraction.html#770" class="Generalizable">A</a>

<a id="812" class="Comment">------------------------------------------------------------------------</a>
<a id="885" class="Comment">-- Re-exporting the builtins publicly</a>

<a id="924" class="Keyword">open</a> <a id="929" class="Keyword">import</a> <a id="936" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a> <a id="960" class="Keyword">public</a>
  <a id="969" class="Keyword">using</a> <a id="975" class="Symbol">(</a><a id="976" href="Agda.Builtin.Reflection.html#4249" class="Datatype">Abs</a><a id="979" class="Symbol">)</a>

<a id="982" class="Keyword">open</a> <a id="987" href="Agda.Builtin.Reflection.html#4249" class="Module">Abs</a> <a id="991" class="Keyword">public</a>

<a id="999" class="Comment">------------------------------------------------------------------------</a>
<a id="1072" class="Comment">-- Operations</a>

<a id="map"></a><a id="1087" href="Reflection.AST.Abstraction.html#1087" class="Function">map</a> <a id="1091" class="Symbol">:</a> <a id="1093" class="Symbol">(</a><a id="1094" href="Reflection.AST.Abstraction.html#770" class="Generalizable">A</a> <a id="1096" class="Symbol">→</a> <a id="1098" href="Reflection.AST.Abstraction.html#772" class="Generalizable">B</a><a id="1099" class="Symbol">)</a> <a id="1101" class="Symbol">→</a> <a id="1103" href="Agda.Builtin.Reflection.html#4249" class="Datatype">Abs</a> <a id="1107" href="Reflection.AST.Abstraction.html#770" class="Generalizable">A</a> <a id="1109" class="Symbol">→</a> <a id="1111" href="Agda.Builtin.Reflection.html#4249" class="Datatype">Abs</a> <a id="1115" href="Reflection.AST.Abstraction.html#772" class="Generalizable">B</a>
<a id="1117" href="Reflection.AST.Abstraction.html#1087" class="Function">map</a> <a id="1121" href="Reflection.AST.Abstraction.html#1121" class="Bound">f</a> <a id="1123" class="Symbol">(</a><a id="1124" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="1128" href="Reflection.AST.Abstraction.html#1128" class="Bound">s</a> <a id="1130" href="Reflection.AST.Abstraction.html#1130" class="Bound">x</a><a id="1131" class="Symbol">)</a> <a id="1133" class="Symbol">=</a> <a id="1135" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="1139" href="Reflection.AST.Abstraction.html#1128" class="Bound">s</a> <a id="1141" class="Symbol">(</a><a id="1142" href="Reflection.AST.Abstraction.html#1121" class="Bound">f</a> <a id="1144" href="Reflection.AST.Abstraction.html#1130" class="Bound">x</a><a id="1145" class="Symbol">)</a>

<a id="1148" class="Comment">------------------------------------------------------------------------</a>
<a id="1221" class="Comment">-- Decidable equality</a>

<a id="abs-injective₁"></a><a id="1244" href="Reflection.AST.Abstraction.html#1244" class="Function">abs-injective₁</a> <a id="1259" class="Symbol">:</a> <a id="1261" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="1265" href="Reflection.AST.Abstraction.html#786" class="Generalizable">s</a> <a id="1267" href="Reflection.AST.Abstraction.html#803" class="Generalizable">x</a> <a id="1269" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1271" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="1275" href="Reflection.AST.Abstraction.html#788" class="Generalizable">t</a> <a id="1277" href="Reflection.AST.Abstraction.html#805" class="Generalizable">y</a> <a id="1279" class="Symbol">→</a> <a id="1281" href="Reflection.AST.Abstraction.html#786" class="Generalizable">s</a> <a id="1283" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1285" href="Reflection.AST.Abstraction.html#788" class="Generalizable">t</a>
<a id="1287" href="Reflection.AST.Abstraction.html#1244" class="Function">abs-injective₁</a> <a id="1302" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="1307" class="Symbol">=</a> <a id="1309" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="abs-injective₂"></a><a id="1315" href="Reflection.AST.Abstraction.html#1315" class="Function">abs-injective₂</a> <a id="1330" class="Symbol">:</a> <a id="1332" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="1336" href="Reflection.AST.Abstraction.html#786" class="Generalizable">s</a> <a id="1338" href="Reflection.AST.Abstraction.html#803" class="Generalizable">x</a> <a id="1340" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1342" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="1346" href="Reflection.AST.Abstraction.html#788" class="Generalizable">t</a> <a id="1348" href="Reflection.AST.Abstraction.html#805" class="Generalizable">y</a> <a id="1350" class="Symbol">→</a> <a id="1352" href="Reflection.AST.Abstraction.html#803" class="Generalizable">x</a> <a id="1354" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1356" href="Reflection.AST.Abstraction.html#805" class="Generalizable">y</a>
<a id="1358" href="Reflection.AST.Abstraction.html#1315" class="Function">abs-injective₂</a> <a id="1373" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="1378" class="Symbol">=</a> <a id="1380" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="abs-injective"></a><a id="1386" href="Reflection.AST.Abstraction.html#1386" class="Function">abs-injective</a> <a id="1400" class="Symbol">:</a> <a id="1402" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="1406" href="Reflection.AST.Abstraction.html#786" class="Generalizable">s</a> <a id="1408" href="Reflection.AST.Abstraction.html#803" class="Generalizable">x</a> <a id="1410" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1412" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="1416" href="Reflection.AST.Abstraction.html#788" class="Generalizable">t</a> <a id="1418" href="Reflection.AST.Abstraction.html#805" class="Generalizable">y</a> <a id="1420" class="Symbol">→</a> <a id="1422" href="Reflection.AST.Abstraction.html#786" class="Generalizable">s</a> <a id="1424" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1426" href="Reflection.AST.Abstraction.html#788" class="Generalizable">t</a> <a id="1428" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1430" href="Reflection.AST.Abstraction.html#803" class="Generalizable">x</a> <a id="1432" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1434" href="Reflection.AST.Abstraction.html#805" class="Generalizable">y</a>
<a id="1436" href="Reflection.AST.Abstraction.html#1386" class="Function">abs-injective</a> <a id="1450" class="Symbol">=</a> <a id="1452" href="Data.Product.Base.html#2000" class="Function Operator">&lt;</a> <a id="1454" href="Reflection.AST.Abstraction.html#1244" class="Function">abs-injective₁</a> <a id="1469" href="Data.Product.Base.html#2000" class="Function Operator">,</a> <a id="1471" href="Reflection.AST.Abstraction.html#1315" class="Function">abs-injective₂</a> <a id="1486" href="Data.Product.Base.html#2000" class="Function Operator">&gt;</a>

<a id="1489" class="Comment">-- We often need decidability of equality for Abs A when implementing it</a>
<a id="1562" class="Comment">-- for A. Unfortunately ≡-dec makes the termination checker unhappy.</a>
<a id="1631" class="Comment">-- Instead, we can match on both Abs A and use unAbs-dec for an</a>
<a id="1695" class="Comment">-- obviously decreasing recursive call.</a>

<a id="unAbs"></a><a id="1736" href="Reflection.AST.Abstraction.html#1736" class="Function">unAbs</a> <a id="1742" class="Symbol">:</a> <a id="1744" href="Agda.Builtin.Reflection.html#4249" class="Datatype">Abs</a> <a id="1748" href="Reflection.AST.Abstraction.html#770" class="Generalizable">A</a> <a id="1750" class="Symbol">→</a> <a id="1752" href="Reflection.AST.Abstraction.html#770" class="Generalizable">A</a>
<a id="1754" href="Reflection.AST.Abstraction.html#1736" class="Function">unAbs</a> <a id="1760" class="Symbol">(</a><a id="1761" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="1765" href="Reflection.AST.Abstraction.html#1765" class="Bound">s</a> <a id="1767" href="Reflection.AST.Abstraction.html#1767" class="Bound">a</a><a id="1768" class="Symbol">)</a> <a id="1770" class="Symbol">=</a> <a id="1772" href="Reflection.AST.Abstraction.html#1767" class="Bound">a</a>

<a id="unAbs-dec"></a><a id="1775" href="Reflection.AST.Abstraction.html#1775" class="Function">unAbs-dec</a> <a id="1785" class="Symbol">:</a> <a id="1787" class="Symbol">{</a><a id="1788" href="Reflection.AST.Abstraction.html#1788" class="Bound">abs1</a> <a id="1793" href="Reflection.AST.Abstraction.html#1793" class="Bound">abs2</a> <a id="1798" class="Symbol">:</a> <a id="1800" href="Agda.Builtin.Reflection.html#4249" class="Datatype">Abs</a> <a id="1804" href="Reflection.AST.Abstraction.html#770" class="Generalizable">A</a><a id="1805" class="Symbol">}</a> <a id="1807" class="Symbol">→</a> <a id="1809" href="Relation.Nullary.Decidable.Core.html#1972" class="Record">Dec</a> <a id="1813" class="Symbol">(</a><a id="1814" href="Reflection.AST.Abstraction.html#1736" class="Function">unAbs</a> <a id="1820" href="Reflection.AST.Abstraction.html#1788" class="Bound">abs1</a> <a id="1825" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1827" href="Reflection.AST.Abstraction.html#1736" class="Function">unAbs</a> <a id="1833" href="Reflection.AST.Abstraction.html#1793" class="Bound">abs2</a><a id="1837" class="Symbol">)</a> <a id="1839" class="Symbol">→</a> <a id="1841" href="Relation.Nullary.Decidable.Core.html#1972" class="Record">Dec</a> <a id="1845" class="Symbol">(</a><a id="1846" href="Reflection.AST.Abstraction.html#1788" class="Bound">abs1</a> <a id="1851" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1853" href="Reflection.AST.Abstraction.html#1793" class="Bound">abs2</a><a id="1857" class="Symbol">)</a>
<a id="1859" href="Reflection.AST.Abstraction.html#1775" class="Function">unAbs-dec</a> <a id="1869" class="Symbol">{</a><a id="1870" class="Argument">abs1</a> <a id="1875" class="Symbol">=</a> <a id="1877" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="1881" href="Reflection.AST.Abstraction.html#1881" class="Bound">s</a> <a id="1883" href="Reflection.AST.Abstraction.html#1883" class="Bound">a</a><a id="1884" class="Symbol">}</a> <a id="1886" class="Symbol">{</a><a id="1887" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="1891" href="Reflection.AST.Abstraction.html#1891" class="Bound">t</a> <a id="1893" href="Reflection.AST.Abstraction.html#1893" class="Bound">a′</a><a id="1895" class="Symbol">}</a> <a id="1897" href="Reflection.AST.Abstraction.html#1897" class="Bound">a≟a′</a> <a id="1902" class="Symbol">=</a>
  <a id="1906" href="Relation.Nullary.Decidable.Core.html#6261" class="Function">map′</a> <a id="1911" class="Symbol">(</a><a id="1912" href="Data.Product.Base.html#3109" class="Function">uncurry</a> <a id="1920" class="Symbol">(</a><a id="1921" href="Relation.Binary.PropositionalEquality.Core.html#1718" class="Function">cong₂</a> <a id="1927" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a><a id="1930" class="Symbol">))</a> <a id="1933" href="Reflection.AST.Abstraction.html#1386" class="Function">abs-injective</a> <a id="1947" class="Symbol">(</a><a id="1948" href="Reflection.AST.Abstraction.html#1881" class="Bound">s</a> <a id="1950" href="Data.String.Properties.html#2741" class="Function Operator">String.≟</a> <a id="1959" href="Reflection.AST.Abstraction.html#1891" class="Bound">t</a> <a id="1961" href="Relation.Nullary.Decidable.Core.html#3420" class="Function Operator">×?</a> <a id="1964" href="Reflection.AST.Abstraction.html#1897" class="Bound">a≟a′</a><a id="1968" class="Symbol">)</a>

<a id="≡-dec"></a><a id="1971" href="Reflection.AST.Abstraction.html#1971" class="Function">≡-dec</a> <a id="1977" class="Symbol">:</a> <a id="1979" href="Relation.Binary.Definitions.html#7028" class="Function">DecidableEquality</a> <a id="1997" href="Reflection.AST.Abstraction.html#770" class="Generalizable">A</a> <a id="1999" class="Symbol">→</a> <a id="2001" href="Relation.Binary.Definitions.html#7028" class="Function">DecidableEquality</a> <a id="2019" class="Symbol">(</a><a id="2020" href="Agda.Builtin.Reflection.html#4249" class="Datatype">Abs</a> <a id="2024" href="Reflection.AST.Abstraction.html#770" class="Generalizable">A</a><a id="2025" class="Symbol">)</a>
<a id="2027" href="Reflection.AST.Abstraction.html#1971" class="Function">≡-dec</a> <a id="2033" href="Reflection.AST.Abstraction.html#2033" class="Bound Operator">_≟_</a> <a id="2037" href="Reflection.AST.Abstraction.html#2037" class="Bound">x</a> <a id="2039" href="Reflection.AST.Abstraction.html#2039" class="Bound">y</a> <a id="2041" class="Symbol">=</a> <a id="2043" href="Reflection.AST.Abstraction.html#1775" class="Function">unAbs-dec</a> <a id="2053" class="Symbol">(</a><a id="2054" href="Reflection.AST.Abstraction.html#1736" class="Function">unAbs</a> <a id="2060" href="Reflection.AST.Abstraction.html#2037" class="Bound">x</a> <a id="2062" href="Reflection.AST.Abstraction.html#2033" class="Bound Operator">≟</a> <a id="2064" href="Reflection.AST.Abstraction.html#1736" class="Function">unAbs</a> <a id="2070" href="Reflection.AST.Abstraction.html#2039" class="Bound">y</a><a id="2071" class="Symbol">)</a>
</pre></body></html>