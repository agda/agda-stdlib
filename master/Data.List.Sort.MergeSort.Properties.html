<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.List.Sort.MergeSort.Properties</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- An implementation of merge sort along with proofs of correctness.</a>
<a id="175" class="Comment">------------------------------------------------------------------------</a>

<a id="249" class="Comment">-- Unless you are need a particular property of MergeSort, you should</a>
<a id="319" class="Comment">-- import and use the sorting algorithm from `Data.List.Sort` instead</a>
<a id="389" class="Comment">-- of this file.</a>

<a id="407" class="Symbol">{-#</a> <a id="411" class="Keyword">OPTIONS</a> <a id="419" class="Pragma">--cubical-compatible</a> <a id="440" class="Pragma">--safe</a> <a id="447" class="Symbol">#-}</a>

<a id="452" class="Keyword">open</a> <a id="457" class="Keyword">import</a> <a id="464" href="Relation.Binary.Bundles.html" class="Module">Relation.Binary.Bundles</a> <a id="488" class="Keyword">using</a> <a id="494" class="Symbol">(</a><a id="495" href="Relation.Binary.Bundles.html#8160" class="Record">DecTotalOrder</a><a id="508" class="Symbol">)</a>

<a id="511" class="Keyword">module</a> <a id="518" href="Data.List.Sort.MergeSort.Properties.html" class="Module">Data.List.Sort.MergeSort.Properties</a>
  <a id="556" class="Symbol">{</a><a id="557" href="Data.List.Sort.MergeSort.Properties.html#557" class="Bound">a</a> <a id="559" href="Data.List.Sort.MergeSort.Properties.html#559" class="Bound">ℓ₁</a> <a id="562" href="Data.List.Sort.MergeSort.Properties.html#562" class="Bound">ℓ₂</a><a id="564" class="Symbol">}</a> <a id="566" class="Symbol">(</a><a id="567" href="Data.List.Sort.MergeSort.Properties.html#567" class="Bound">O</a> <a id="569" class="Symbol">:</a> <a id="571" href="Relation.Binary.Bundles.html#8160" class="Record">DecTotalOrder</a> <a id="585" href="Data.List.Sort.MergeSort.Properties.html#557" class="Bound">a</a> <a id="587" href="Data.List.Sort.MergeSort.Properties.html#559" class="Bound">ℓ₁</a> <a id="590" href="Data.List.Sort.MergeSort.Properties.html#562" class="Bound">ℓ₂</a><a id="592" class="Symbol">)</a> <a id="594" class="Keyword">where</a>

<a id="601" class="Keyword">open</a> <a id="606" class="Keyword">import</a> <a id="613" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> <a id="628" class="Keyword">using</a> <a id="634" class="Symbol">(</a><a id="635" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a><a id="639" class="Symbol">;</a> <a id="641" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a><a id="646" class="Symbol">)</a>
<a id="648" class="Keyword">open</a> <a id="653" class="Keyword">import</a> <a id="660" href="Data.List.Base.html" class="Module">Data.List.Base</a>
  <a id="677" class="Keyword">using</a> <a id="683" class="Symbol">(</a><a id="684" href="Agda.Builtin.List.html#147" class="Datatype">List</a><a id="688" class="Symbol">;</a> <a id="690" href="Data.List.Base.html#7301" class="InductiveConstructor">[]</a><a id="692" class="Symbol">;</a> <a id="694" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">_∷_</a><a id="697" class="Symbol">;</a> <a id="699" href="Data.List.Base.html#3759" class="Function">merge</a><a id="704" class="Symbol">;</a> <a id="706" href="Data.List.Base.html#4746" class="Function">length</a><a id="712" class="Symbol">;</a> <a id="714" href="Data.List.Base.html#1612" class="Function">map</a><a id="717" class="Symbol">;</a> <a id="719" href="Data.List.Base.html#4907" class="Function Operator">[_]</a><a id="722" class="Symbol">;</a> <a id="724" href="Data.List.Base.html#4328" class="Function">concat</a><a id="730" class="Symbol">;</a> <a id="732" href="Data.List.Base.html#1712" class="Function Operator">_++_</a><a id="736" class="Symbol">)</a>
<a id="738" class="Keyword">open</a> <a id="743" class="Keyword">import</a> <a id="750" href="Data.List.Properties.html" class="Module">Data.List.Properties</a> <a id="771" class="Keyword">using</a> <a id="777" class="Symbol">(</a><a id="778" href="Data.List.Properties.html#51252" class="Function">length-partition</a><a id="794" class="Symbol">;</a> <a id="796" href="Data.List.Properties.html#5197" class="Function">++-assoc</a><a id="804" class="Symbol">;</a> <a id="806" href="Data.List.Properties.html#27977" class="Function Operator">concat-map-[_]</a><a id="820" class="Symbol">)</a>
<a id="822" class="Keyword">open</a> <a id="827" class="Keyword">import</a> <a id="834" href="Data.List.Relation.Unary.Linked.html" class="Module">Data.List.Relation.Unary.Linked</a> <a id="866" class="Keyword">using</a> <a id="872" class="Symbol">(</a><a id="873" href="Data.List.Relation.Unary.Linked.html#1499" class="InductiveConstructor">[]</a><a id="875" class="Symbol">;</a> <a id="877" href="Data.List.Relation.Unary.Linked.html#1519" class="InductiveConstructor">[-]</a><a id="880" class="Symbol">)</a>
<a id="882" class="Keyword">import</a> <a id="889" href="Data.List.Relation.Unary.Sorted.TotalOrder.Properties.html" class="Module">Data.List.Relation.Unary.Sorted.TotalOrder.Properties</a> <a id="943" class="Symbol">as</a> <a id="946" class="Module">Sorted</a>
<a id="953" class="Keyword">open</a> <a id="958" class="Keyword">import</a> <a id="965" href="Data.List.Relation.Unary.All.html" class="Module">Data.List.Relation.Unary.All</a> <a id="994" class="Symbol">as</a> <a id="997" class="Module">All</a> <a id="1001" class="Keyword">using</a> <a id="1007" class="Symbol">(</a><a id="1008" href="Data.List.Relation.Unary.All.html#1638" class="Datatype">All</a><a id="1011" class="Symbol">;</a> <a id="1013" href="Data.List.Relation.Unary.All.html#1701" class="InductiveConstructor">[]</a><a id="1015" class="Symbol">;</a> <a id="1017" href="Data.List.Relation.Unary.All.html#1718" class="InductiveConstructor Operator">_∷_</a><a id="1020" class="Symbol">)</a>
<a id="1022" class="Keyword">import</a> <a id="1029" href="Data.List.Relation.Unary.All.Properties.html" class="Module">Data.List.Relation.Unary.All.Properties</a> <a id="1069" class="Symbol">as</a> <a id="1072" class="Module">All</a>
<a id="1076" class="Keyword">open</a> <a id="1081" class="Keyword">import</a> <a id="1088" href="Data.List.Relation.Binary.Permutation.Propositional.html" class="Module">Data.List.Relation.Binary.Permutation.Propositional</a>
<a id="1140" class="Keyword">import</a> <a id="1147" href="Data.List.Relation.Binary.Permutation.Propositional.Properties.html" class="Module">Data.List.Relation.Binary.Permutation.Propositional.Properties</a> <a id="1210" class="Symbol">as</a> <a id="1213" class="Module">Perm</a>
<a id="1218" class="Keyword">open</a> <a id="1223" class="Keyword">import</a> <a id="1230" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="1246" class="Keyword">using</a> <a id="1252" class="Symbol">(</a><a id="1253" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a><a id="1257" class="Symbol">)</a>
<a id="1259" class="Keyword">open</a> <a id="1264" class="Keyword">import</a> <a id="1271" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="1285" class="Keyword">using</a> <a id="1291" class="Symbol">(</a><a id="1292" href="Data.Nat.Base.html#1807" class="Function Operator">_&lt;_</a><a id="1295" class="Symbol">;</a> <a id="1297" href="Data.Nat.Base.html#2295" class="Function Operator">_&gt;_</a><a id="1300" class="Symbol">;</a> <a id="1302" href="Data.Nat.Base.html#1879" class="InductiveConstructor">z&lt;s</a><a id="1305" class="Symbol">;</a> <a id="1307" href="Data.Nat.Base.html#1919" class="InductiveConstructor">s&lt;s</a><a id="1310" class="Symbol">)</a>
<a id="1312" class="Keyword">open</a> <a id="1317" class="Keyword">import</a> <a id="1324" href="Data.Nat.Induction.html" class="Module">Data.Nat.Induction</a>
<a id="1343" class="Keyword">open</a> <a id="1348" class="Keyword">import</a> <a id="1355" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="1375" class="Keyword">using</a> <a id="1381" class="Symbol">(</a><a id="1382" href="Data.Nat.Properties.html#13186" class="Function">m&lt;n⇒m&lt;1+n</a><a id="1391" class="Symbol">)</a>
<a id="1393" class="Keyword">open</a> <a id="1398" class="Keyword">import</a> <a id="1405" href="Data.Product.Base.html" class="Module">Data.Product.Base</a> <a id="1423" class="Symbol">as</a> <a id="1426" class="Module">Product</a> <a id="1434" class="Keyword">using</a> <a id="1440" class="Symbol">(</a><a id="1441" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a><a id="1444" class="Symbol">)</a>
<a id="1446" class="Keyword">open</a> <a id="1451" class="Keyword">import</a> <a id="1458" href="Function.Base.html" class="Module">Function.Base</a> <a id="1472" class="Keyword">using</a> <a id="1478" class="Symbol">(</a><a id="1479" href="Function.Base.html#1134" class="Function Operator">_∘_</a><a id="1482" class="Symbol">)</a>
<a id="1484" class="Keyword">open</a> <a id="1489" class="Keyword">import</a> <a id="1496" href="Relation.Nullary.Negation.Core.html" class="Module">Relation.Nullary.Negation.Core</a> <a id="1527" class="Keyword">using</a> <a id="1533" class="Symbol">(</a><a id="1534" href="Relation.Nullary.Negation.Core.html#669" class="Function Operator">¬_</a><a id="1536" class="Symbol">)</a>
<a id="1538" class="Keyword">open</a> <a id="1543" class="Keyword">import</a> <a id="1550" href="Relation.Nullary.Decidable.Core.html" class="Module">Relation.Nullary.Decidable.Core</a> <a id="1582" class="Keyword">using</a> <a id="1588" class="Symbol">(</a><a id="1589" href="Relation.Nullary.Decidable.Core.html#2038" class="Field">does</a><a id="1593" class="Symbol">)</a>

<a id="1596" class="Keyword">open</a> <a id="1601" href="Relation.Binary.Bundles.html#8160" class="Module">DecTotalOrder</a> <a id="1615" href="Data.List.Sort.MergeSort.Properties.html#567" class="Bound">O</a> <a id="1617" class="Keyword">renaming</a> <a id="1626" class="Symbol">(</a><a id="1627" href="Relation.Binary.Bundles.html#8244" class="Field">Carrier</a> <a id="1635" class="Symbol">to</a> <a id="1638" class="Field">A</a><a id="1639" class="Symbol">)</a>

<a id="1642" class="Keyword">open</a> <a id="1647" class="Keyword">import</a> <a id="1654" href="Data.List.Sort.Base.html" class="Module">Data.List.Sort.Base</a> <a id="1674" href="Relation.Binary.Bundles.html#8521" class="Function">totalOrder</a>
<a id="1685" class="Keyword">open</a> <a id="1690" class="Keyword">import</a> <a id="1697" href="Data.List.Sort.MergeSort.Base.html" class="Module">Data.List.Sort.MergeSort.Base</a> <a id="1727" href="Data.List.Sort.MergeSort.Properties.html#567" class="Bound">O</a>
<a id="1729" class="Keyword">open</a> <a id="1734" class="Keyword">import</a> <a id="1741" href="Data.List.Relation.Unary.Sorted.TotalOrder.html" class="Module">Data.List.Relation.Unary.Sorted.TotalOrder</a> <a id="1784" href="Relation.Binary.Bundles.html#8521" class="Function">totalOrder</a> <a id="1795" class="Keyword">hiding</a> <a id="1802" class="Symbol">(</a><a id="1803" href="Data.List.Relation.Unary.Sorted.TotalOrder.html#958" class="Function">head</a><a id="1807" class="Symbol">)</a>
<a id="1809" class="Keyword">open</a> <a id="1814" class="Keyword">import</a> <a id="1821" href="Relation.Binary.Properties.DecTotalOrder.html" class="Module">Relation.Binary.Properties.DecTotalOrder</a> <a id="1862" href="Data.List.Sort.MergeSort.Properties.html#567" class="Bound">O</a> <a id="1864" class="Keyword">using</a> <a id="1870" class="Symbol">(</a><a id="1871" href="Relation.Binary.Properties.TotalOrder.html#2570" class="Function">≰⇒≥</a><a id="1874" class="Symbol">;</a> <a id="1876" href="Relation.Binary.Properties.Poset.html#1865" class="Function">≰-respˡ-≈</a><a id="1885" class="Symbol">)</a>

<a id="1888" class="Keyword">open</a> <a id="1893" href="Data.List.Relation.Binary.Permutation.Propositional.html#3935" class="Module">PermutationReasoning</a>

<a id="1915" class="Comment">------------------------------------------------------------------------</a>
<a id="1988" class="Comment">-- Permutation property</a>

<a id="mergePairs-↭"></a><a id="2013" href="Data.List.Sort.MergeSort.Properties.html#2013" class="Function">mergePairs-↭</a> <a id="2026" class="Symbol">:</a> <a id="2028" class="Symbol">∀</a> <a id="2030" href="Data.List.Sort.MergeSort.Properties.html#2030" class="Bound">xss</a> <a id="2034" class="Symbol">→</a> <a id="2036" href="Data.List.Base.html#4328" class="Function">concat</a> <a id="2043" class="Symbol">(</a><a id="2044" href="Data.List.Sort.MergeSort.Base.html#907" class="Function">mergePairs</a> <a id="2055" href="Data.List.Sort.MergeSort.Properties.html#2030" class="Bound">xss</a><a id="2058" class="Symbol">)</a> <a id="2060" href="Data.List.Relation.Binary.Permutation.Propositional.html#1513" class="Datatype Operator">↭</a> <a id="2062" href="Data.List.Base.html#4328" class="Function">concat</a> <a id="2069" href="Data.List.Sort.MergeSort.Properties.html#2030" class="Bound">xss</a>
<a id="2073" href="Data.List.Sort.MergeSort.Properties.html#2013" class="Function">mergePairs-↭</a> <a id="2086" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>              <a id="2102" class="Symbol">=</a> <a id="2104" href="Data.List.Relation.Binary.Permutation.Propositional.html#1715" class="Function">↭-refl</a>
<a id="2111" href="Data.List.Sort.MergeSort.Properties.html#2013" class="Function">mergePairs-↭</a> <a id="2124" class="Symbol">(</a><a id="2125" href="Data.List.Sort.MergeSort.Properties.html#2125" class="Bound">xs</a> <a id="2128" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2130" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="2132" class="Symbol">)</a>       <a id="2140" class="Symbol">=</a> <a id="2142" href="Data.List.Relation.Binary.Permutation.Propositional.html#1715" class="Function">↭-refl</a>
<a id="2149" href="Data.List.Sort.MergeSort.Properties.html#2013" class="Function">mergePairs-↭</a> <a id="2162" class="Symbol">(</a><a id="2163" href="Data.List.Sort.MergeSort.Properties.html#2163" class="Bound">xs</a> <a id="2166" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2168" href="Data.List.Sort.MergeSort.Properties.html#2168" class="Bound">ys</a> <a id="2171" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2173" href="Data.List.Sort.MergeSort.Properties.html#2173" class="Bound">xss</a><a id="2176" class="Symbol">)</a> <a id="2178" class="Symbol">=</a> <a id="2180" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
  <a id="2188" href="Data.List.Base.html#3759" class="Function">merge</a> <a id="2194" class="Symbol">_</a> <a id="2196" href="Data.List.Sort.MergeSort.Properties.html#2163" class="Bound">xs</a> <a id="2199" href="Data.List.Sort.MergeSort.Properties.html#2168" class="Bound">ys</a> <a id="2202" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="2205" href="Data.List.Base.html#4328" class="Function">concat</a> <a id="2212" class="Symbol">(</a><a id="2213" href="Data.List.Sort.MergeSort.Base.html#907" class="Function">mergePairs</a> <a id="2224" href="Data.List.Sort.MergeSort.Properties.html#2173" class="Bound">xss</a><a id="2227" class="Symbol">)</a> <a id="2229" href="Relation.Binary.Reasoning.Syntax.html#9919" class="Function">↭⟨</a> <a id="2232" href="Data.List.Relation.Binary.Permutation.Propositional.Properties.html#6981" class="Function">Perm.++⁺</a> <a id="2241" class="Symbol">(</a><a id="2242" href="Data.List.Relation.Binary.Permutation.Propositional.Properties.html#13356" class="Function">Perm.merge-↭</a> <a id="2255" class="Symbol">_</a> <a id="2257" href="Data.List.Sort.MergeSort.Properties.html#2163" class="Bound">xs</a> <a id="2260" href="Data.List.Sort.MergeSort.Properties.html#2168" class="Bound">ys</a><a id="2262" class="Symbol">)</a> <a id="2264" class="Symbol">(</a><a id="2265" href="Data.List.Sort.MergeSort.Properties.html#2013" class="Function">mergePairs-↭</a> <a id="2278" href="Data.List.Sort.MergeSort.Properties.html#2173" class="Bound">xss</a><a id="2281" class="Symbol">)</a> <a id="2283" href="Relation.Binary.Reasoning.Syntax.html#9919" class="Function">⟩</a>
  <a id="2287" class="Symbol">(</a><a id="2288" href="Data.List.Sort.MergeSort.Properties.html#2163" class="Bound">xs</a> <a id="2291" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="2294" href="Data.List.Sort.MergeSort.Properties.html#2168" class="Bound">ys</a><a id="2296" class="Symbol">)</a>    <a id="2301" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="2304" href="Data.List.Base.html#4328" class="Function">concat</a> <a id="2311" href="Data.List.Sort.MergeSort.Properties.html#2173" class="Bound">xss</a>              <a id="2328" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="2331" href="Data.List.Properties.html#5197" class="Function">++-assoc</a> <a id="2340" href="Data.List.Sort.MergeSort.Properties.html#2163" class="Bound">xs</a> <a id="2343" href="Data.List.Sort.MergeSort.Properties.html#2168" class="Bound">ys</a> <a id="2346" class="Symbol">(</a><a id="2347" href="Data.List.Base.html#4328" class="Function">concat</a> <a id="2354" href="Data.List.Sort.MergeSort.Properties.html#2173" class="Bound">xss</a><a id="2357" class="Symbol">)</a> <a id="2359" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
  <a id="2363" href="Data.List.Sort.MergeSort.Properties.html#2163" class="Bound">xs</a> <a id="2366" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="2369" href="Data.List.Sort.MergeSort.Properties.html#2168" class="Bound">ys</a>      <a id="2377" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="2380" href="Data.List.Base.html#4328" class="Function">concat</a> <a id="2387" href="Data.List.Sort.MergeSort.Properties.html#2173" class="Bound">xss</a>              <a id="2404" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>

<a id="mergeAll-↭"></a><a id="2407" href="Data.List.Sort.MergeSort.Properties.html#2407" class="Function">mergeAll-↭</a> <a id="2418" class="Symbol">:</a> <a id="2420" class="Symbol">∀</a> <a id="2422" href="Data.List.Sort.MergeSort.Properties.html#2422" class="Bound">xss</a> <a id="2426" class="Symbol">(</a><a id="2427" href="Data.List.Sort.MergeSort.Properties.html#2427" class="Bound">rec</a> <a id="2431" class="Symbol">:</a> <a id="2433" href="Induction.WellFounded.html#1545" class="Datatype">Acc</a> <a id="2437" href="Data.Nat.Base.html#1807" class="Function Operator">_&lt;_</a> <a id="2441" class="Symbol">(</a><a id="2442" href="Data.List.Base.html#4746" class="Function">length</a> <a id="2449" href="Data.List.Sort.MergeSort.Properties.html#2422" class="Bound">xss</a><a id="2452" class="Symbol">))</a> <a id="2455" class="Symbol">→</a> <a id="2457" href="Data.List.Sort.MergeSort.Base.html#1372" class="Function">mergeAll</a> <a id="2466" href="Data.List.Sort.MergeSort.Properties.html#2422" class="Bound">xss</a> <a id="2470" href="Data.List.Sort.MergeSort.Properties.html#2427" class="Bound">rec</a> <a id="2474" href="Data.List.Relation.Binary.Permutation.Propositional.html#1513" class="Datatype Operator">↭</a> <a id="2476" href="Data.List.Base.html#4328" class="Function">concat</a> <a id="2483" href="Data.List.Sort.MergeSort.Properties.html#2422" class="Bound">xss</a>
<a id="2487" href="Data.List.Sort.MergeSort.Properties.html#2407" class="Function">mergeAll-↭</a> <a id="2498" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>              <a id="2514" class="Symbol">_</a> <a id="2516" class="Symbol">=</a> <a id="2518" href="Data.List.Relation.Binary.Permutation.Propositional.html#1715" class="Function">↭-refl</a>
<a id="2525" href="Data.List.Sort.MergeSort.Properties.html#2407" class="Function">mergeAll-↭</a> <a id="2536" class="Symbol">(</a><a id="2537" href="Data.List.Sort.MergeSort.Properties.html#2537" class="Bound">xs</a> <a id="2540" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2542" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="2544" class="Symbol">)</a>       <a id="2552" class="Symbol">_</a> <a id="2554" class="Symbol">=</a> <a id="2556" href="Data.List.Relation.Binary.Permutation.Propositional.html#2100" class="Function">↭-sym</a> <a id="2562" class="Symbol">(</a><a id="2563" href="Data.List.Relation.Binary.Permutation.Propositional.Properties.html#10317" class="Function">Perm.++-identityʳ</a> <a id="2581" href="Data.List.Sort.MergeSort.Properties.html#2537" class="Bound">xs</a><a id="2583" class="Symbol">)</a>
<a id="2585" href="Data.List.Sort.MergeSort.Properties.html#2407" class="Function">mergeAll-↭</a> <a id="2596" class="Symbol">(</a><a id="2597" href="Data.List.Sort.MergeSort.Properties.html#2597" class="Bound">xs</a> <a id="2600" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2602" href="Data.List.Sort.MergeSort.Properties.html#2602" class="Bound">ys</a> <a id="2605" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2607" href="Data.List.Sort.MergeSort.Properties.html#2607" class="Bound">xss</a><a id="2610" class="Symbol">)</a> <a id="2612" class="Symbol">(</a><a id="2613" href="Induction.WellFounded.html#1607" class="InductiveConstructor">acc</a> <a id="2617" href="Data.List.Sort.MergeSort.Properties.html#2617" class="Bound">rec</a><a id="2620" class="Symbol">)</a> <a id="2622" class="Symbol">=</a> <a id="2624" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
  <a id="2632" href="Data.List.Sort.MergeSort.Base.html#1372" class="Function">mergeAll</a> <a id="2641" class="Symbol">(</a><a id="2642" href="Data.List.Sort.MergeSort.Base.html#907" class="Function">mergePairs</a> <a id="2653" class="Symbol">(</a><a id="2654" href="Data.List.Sort.MergeSort.Properties.html#2597" class="Bound">xs</a> <a id="2657" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2659" href="Data.List.Sort.MergeSort.Properties.html#2602" class="Bound">ys</a> <a id="2662" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2664" href="Data.List.Sort.MergeSort.Properties.html#2607" class="Bound">xss</a><a id="2667" class="Symbol">))</a> <a id="2670" class="Symbol">_</a> <a id="2672" href="Relation.Binary.Reasoning.Syntax.html#9919" class="Function">↭⟨</a> <a id="2675" href="Data.List.Sort.MergeSort.Properties.html#2407" class="Function">mergeAll-↭</a> <a id="2686" class="Symbol">(</a><a id="2687" href="Data.List.Sort.MergeSort.Base.html#907" class="Function">mergePairs</a> <a id="2698" class="Symbol">(</a><a id="2699" href="Data.List.Sort.MergeSort.Properties.html#2597" class="Bound">xs</a> <a id="2702" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2704" href="Data.List.Sort.MergeSort.Properties.html#2602" class="Bound">ys</a> <a id="2707" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2709" href="Data.List.Sort.MergeSort.Properties.html#2607" class="Bound">xss</a><a id="2712" class="Symbol">))</a> <a id="2715" class="Symbol">_</a> <a id="2717" href="Relation.Binary.Reasoning.Syntax.html#9919" class="Function">⟩</a>
  <a id="2721" href="Data.List.Base.html#4328" class="Function">concat</a>   <a id="2730" class="Symbol">(</a><a id="2731" href="Data.List.Sort.MergeSort.Base.html#907" class="Function">mergePairs</a> <a id="2742" class="Symbol">(</a><a id="2743" href="Data.List.Sort.MergeSort.Properties.html#2597" class="Bound">xs</a> <a id="2746" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2748" href="Data.List.Sort.MergeSort.Properties.html#2602" class="Bound">ys</a> <a id="2751" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2753" href="Data.List.Sort.MergeSort.Properties.html#2607" class="Bound">xss</a><a id="2756" class="Symbol">))</a>   <a id="2761" href="Relation.Binary.Reasoning.Syntax.html#9919" class="Function">↭⟨</a> <a id="2764" href="Data.List.Sort.MergeSort.Properties.html#2013" class="Function">mergePairs-↭</a> <a id="2777" class="Symbol">(</a><a id="2778" href="Data.List.Sort.MergeSort.Properties.html#2597" class="Bound">xs</a> <a id="2781" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2783" href="Data.List.Sort.MergeSort.Properties.html#2602" class="Bound">ys</a> <a id="2786" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2788" href="Data.List.Sort.MergeSort.Properties.html#2607" class="Bound">xss</a><a id="2791" class="Symbol">)</a> <a id="2793" href="Relation.Binary.Reasoning.Syntax.html#9919" class="Function">⟩</a>
  <a id="2797" href="Data.List.Base.html#4328" class="Function">concat</a>   <a id="2806" class="Symbol">(</a><a id="2807" href="Data.List.Sort.MergeSort.Properties.html#2597" class="Bound">xs</a> <a id="2810" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2812" href="Data.List.Sort.MergeSort.Properties.html#2602" class="Bound">ys</a> <a id="2815" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2817" href="Data.List.Sort.MergeSort.Properties.html#2607" class="Bound">xss</a><a id="2820" class="Symbol">)</a>                <a id="2837" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>

<a id="sort-↭"></a><a id="2840" href="Data.List.Sort.MergeSort.Properties.html#2840" class="Function">sort-↭</a> <a id="2847" class="Symbol">:</a> <a id="2849" class="Symbol">∀</a> <a id="2851" href="Data.List.Sort.MergeSort.Properties.html#2851" class="Bound">xs</a> <a id="2854" class="Symbol">→</a> <a id="2856" href="Data.List.Sort.MergeSort.Base.html#1623" class="Function">sort</a> <a id="2861" href="Data.List.Sort.MergeSort.Properties.html#2851" class="Bound">xs</a> <a id="2864" href="Data.List.Relation.Binary.Permutation.Propositional.html#1513" class="Datatype Operator">↭</a> <a id="2866" href="Data.List.Sort.MergeSort.Properties.html#2851" class="Bound">xs</a>
<a id="2869" href="Data.List.Sort.MergeSort.Properties.html#2840" class="Function">sort-↭</a> <a id="2876" href="Data.List.Sort.MergeSort.Properties.html#2876" class="Bound">xs</a> <a id="2879" class="Symbol">=</a> <a id="2881" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
  <a id="2889" href="Data.List.Sort.MergeSort.Base.html#1372" class="Function">mergeAll</a> <a id="2898" class="Symbol">(</a><a id="2899" href="Data.List.Base.html#1612" class="Function">map</a> <a id="2903" href="Data.List.Base.html#4907" class="Function Operator">[_]</a> <a id="2907" href="Data.List.Sort.MergeSort.Properties.html#2876" class="Bound">xs</a><a id="2909" class="Symbol">)</a> <a id="2911" class="Symbol">_</a> <a id="2913" href="Relation.Binary.Reasoning.Syntax.html#9919" class="Function">↭⟨</a> <a id="2916" href="Data.List.Sort.MergeSort.Properties.html#2407" class="Function">mergeAll-↭</a> <a id="2927" class="Symbol">(</a><a id="2928" href="Data.List.Base.html#1612" class="Function">map</a> <a id="2932" href="Data.List.Base.html#4907" class="Function Operator">[_]</a> <a id="2936" href="Data.List.Sort.MergeSort.Properties.html#2876" class="Bound">xs</a><a id="2938" class="Symbol">)</a> <a id="2940" class="Symbol">_</a> <a id="2942" href="Relation.Binary.Reasoning.Syntax.html#9919" class="Function">⟩</a>
  <a id="2946" href="Data.List.Base.html#4328" class="Function">concat</a> <a id="2953" class="Symbol">(</a><a id="2954" href="Data.List.Base.html#1612" class="Function">map</a> <a id="2958" href="Data.List.Base.html#4907" class="Function Operator">[_]</a> <a id="2962" href="Data.List.Sort.MergeSort.Properties.html#2876" class="Bound">xs</a><a id="2964" class="Symbol">)</a>     <a id="2970" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="2973" href="Data.List.Properties.html#27977" class="Function Operator">concat-map-[</a> <a id="2986" href="Data.List.Sort.MergeSort.Properties.html#2876" class="Bound">xs</a> <a id="2989" href="Data.List.Properties.html#27977" class="Function Operator">]</a> <a id="2991" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
  <a id="2995" href="Data.List.Sort.MergeSort.Properties.html#2876" class="Bound">xs</a>                      <a id="3019" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>

<a id="3022" class="Comment">------------------------------------------------------------------------</a>
<a id="3095" class="Comment">-- Sorted property</a>

<a id="mergePairs-↗"></a><a id="3115" href="Data.List.Sort.MergeSort.Properties.html#3115" class="Function">mergePairs-↗</a> <a id="3128" class="Symbol">:</a> <a id="3130" class="Symbol">∀</a> <a id="3132" class="Symbol">{</a><a id="3133" href="Data.List.Sort.MergeSort.Properties.html#3133" class="Bound">xss</a><a id="3136" class="Symbol">}</a> <a id="3138" class="Symbol">→</a> <a id="3140" href="Data.List.Relation.Unary.All.html#1638" class="Datatype">All</a> <a id="3144" href="Data.List.Relation.Unary.Sorted.TotalOrder.html#784" class="Function">Sorted</a> <a id="3151" href="Data.List.Sort.MergeSort.Properties.html#3133" class="Bound">xss</a> <a id="3155" class="Symbol">→</a> <a id="3157" href="Data.List.Relation.Unary.All.html#1638" class="Datatype">All</a> <a id="3161" href="Data.List.Relation.Unary.Sorted.TotalOrder.html#784" class="Function">Sorted</a> <a id="3168" class="Symbol">(</a><a id="3169" href="Data.List.Sort.MergeSort.Base.html#907" class="Function">mergePairs</a> <a id="3180" href="Data.List.Sort.MergeSort.Properties.html#3133" class="Bound">xss</a><a id="3183" class="Symbol">)</a>
<a id="3185" href="Data.List.Sort.MergeSort.Properties.html#3115" class="Function">mergePairs-↗</a> <a id="3198" href="Data.List.Relation.Unary.All.html#1701" class="InductiveConstructor">[]</a>                 <a id="3217" class="Symbol">=</a> <a id="3219" href="Data.List.Relation.Unary.All.html#1701" class="InductiveConstructor">[]</a>
<a id="3222" href="Data.List.Sort.MergeSort.Properties.html#3115" class="Function">mergePairs-↗</a> <a id="3235" class="Symbol">(</a><a id="3236" href="Data.List.Sort.MergeSort.Properties.html#3236" class="Bound">xs↗</a> <a id="3240" href="Data.List.Relation.Unary.All.html#1718" class="InductiveConstructor Operator">∷</a> <a id="3242" href="Data.List.Relation.Unary.All.html#1701" class="InductiveConstructor">[]</a><a id="3244" class="Symbol">)</a>         <a id="3254" class="Symbol">=</a> <a id="3256" href="Data.List.Sort.MergeSort.Properties.html#3236" class="Bound">xs↗</a> <a id="3260" href="Data.List.Relation.Unary.All.html#1718" class="InductiveConstructor Operator">∷</a> <a id="3262" href="Data.List.Relation.Unary.All.html#1701" class="InductiveConstructor">[]</a>
<a id="3265" href="Data.List.Sort.MergeSort.Properties.html#3115" class="Function">mergePairs-↗</a> <a id="3278" class="Symbol">(</a><a id="3279" href="Data.List.Sort.MergeSort.Properties.html#3279" class="Bound">xs↗</a> <a id="3283" href="Data.List.Relation.Unary.All.html#1718" class="InductiveConstructor Operator">∷</a> <a id="3285" href="Data.List.Sort.MergeSort.Properties.html#3285" class="Bound">ys↗</a> <a id="3289" href="Data.List.Relation.Unary.All.html#1718" class="InductiveConstructor Operator">∷</a> <a id="3291" href="Data.List.Sort.MergeSort.Properties.html#3291" class="Bound">xss↗</a><a id="3295" class="Symbol">)</a> <a id="3297" class="Symbol">=</a> <a id="3299" href="Data.List.Relation.Unary.Sorted.TotalOrder.Properties.html#5161" class="Function">Sorted.merge⁺</a> <a id="3313" href="Data.List.Sort.MergeSort.Properties.html#567" class="Bound">O</a> <a id="3315" href="Data.List.Sort.MergeSort.Properties.html#3279" class="Bound">xs↗</a> <a id="3319" href="Data.List.Sort.MergeSort.Properties.html#3285" class="Bound">ys↗</a> <a id="3323" href="Data.List.Relation.Unary.All.html#1718" class="InductiveConstructor Operator">∷</a> <a id="3325" href="Data.List.Sort.MergeSort.Properties.html#3115" class="Function">mergePairs-↗</a> <a id="3338" href="Data.List.Sort.MergeSort.Properties.html#3291" class="Bound">xss↗</a>

<a id="mergeAll-↗"></a><a id="3344" href="Data.List.Sort.MergeSort.Properties.html#3344" class="Function">mergeAll-↗</a> <a id="3355" class="Symbol">:</a> <a id="3357" class="Symbol">∀</a> <a id="3359" class="Symbol">{</a><a id="3360" href="Data.List.Sort.MergeSort.Properties.html#3360" class="Bound">xss</a><a id="3363" class="Symbol">}</a> <a id="3365" class="Symbol">(</a><a id="3366" href="Data.List.Sort.MergeSort.Properties.html#3366" class="Bound">rec</a> <a id="3370" class="Symbol">:</a> <a id="3372" href="Induction.WellFounded.html#1545" class="Datatype">Acc</a> <a id="3376" href="Data.Nat.Base.html#1807" class="Function Operator">_&lt;_</a> <a id="3380" class="Symbol">(</a><a id="3381" href="Data.List.Base.html#4746" class="Function">length</a> <a id="3388" href="Data.List.Sort.MergeSort.Properties.html#3360" class="Bound">xss</a><a id="3391" class="Symbol">))</a> <a id="3394" class="Symbol">→</a>
             <a id="3409" href="Data.List.Relation.Unary.All.html#1638" class="Datatype">All</a> <a id="3413" href="Data.List.Relation.Unary.Sorted.TotalOrder.html#784" class="Function">Sorted</a> <a id="3420" href="Data.List.Sort.MergeSort.Properties.html#3360" class="Bound">xss</a> <a id="3424" class="Symbol">→</a> <a id="3426" href="Data.List.Relation.Unary.Sorted.TotalOrder.html#784" class="Function">Sorted</a> <a id="3433" class="Symbol">(</a><a id="3434" href="Data.List.Sort.MergeSort.Base.html#1372" class="Function">mergeAll</a> <a id="3443" href="Data.List.Sort.MergeSort.Properties.html#3360" class="Bound">xss</a> <a id="3447" href="Data.List.Sort.MergeSort.Properties.html#3366" class="Bound">rec</a><a id="3450" class="Symbol">)</a>
<a id="3452" href="Data.List.Sort.MergeSort.Properties.html#3344" class="Function">mergeAll-↗</a> <a id="3463" href="Data.List.Sort.MergeSort.Properties.html#3463" class="Bound">rec</a>       <a id="3473" href="Data.List.Relation.Unary.All.html#1701" class="InductiveConstructor">[]</a>                 <a id="3492" class="Symbol">=</a> <a id="3494" href="Data.List.Relation.Unary.Linked.html#1499" class="InductiveConstructor">[]</a>
<a id="3497" href="Data.List.Sort.MergeSort.Properties.html#3344" class="Function">mergeAll-↗</a> <a id="3508" href="Data.List.Sort.MergeSort.Properties.html#3508" class="Bound">rec</a>       <a id="3518" class="Symbol">(</a><a id="3519" href="Data.List.Sort.MergeSort.Properties.html#3519" class="Bound">xs↗</a> <a id="3523" href="Data.List.Relation.Unary.All.html#1718" class="InductiveConstructor Operator">∷</a> <a id="3525" href="Data.List.Relation.Unary.All.html#1701" class="InductiveConstructor">[]</a><a id="3527" class="Symbol">)</a>         <a id="3537" class="Symbol">=</a> <a id="3539" href="Data.List.Sort.MergeSort.Properties.html#3519" class="Bound">xs↗</a>
<a id="3543" href="Data.List.Sort.MergeSort.Properties.html#3344" class="Function">mergeAll-↗</a> <a id="3554" class="Symbol">(</a><a id="3555" href="Induction.WellFounded.html#1607" class="InductiveConstructor">acc</a> <a id="3559" href="Data.List.Sort.MergeSort.Properties.html#3559" class="Bound">rec</a><a id="3562" class="Symbol">)</a> <a id="3564" class="Symbol">(</a><a id="3565" href="Data.List.Sort.MergeSort.Properties.html#3565" class="Bound">xs↗</a> <a id="3569" href="Data.List.Relation.Unary.All.html#1718" class="InductiveConstructor Operator">∷</a> <a id="3571" href="Data.List.Sort.MergeSort.Properties.html#3571" class="Bound">ys↗</a> <a id="3575" href="Data.List.Relation.Unary.All.html#1718" class="InductiveConstructor Operator">∷</a> <a id="3577" href="Data.List.Sort.MergeSort.Properties.html#3577" class="Bound">xss↗</a><a id="3581" class="Symbol">)</a> <a id="3583" class="Symbol">=</a> <a id="3585" href="Data.List.Sort.MergeSort.Properties.html#3344" class="Function">mergeAll-↗</a> <a id="3596" class="Symbol">_</a> <a id="3598" class="Symbol">(</a><a id="3599" href="Data.List.Sort.MergeSort.Properties.html#3115" class="Function">mergePairs-↗</a> <a id="3612" class="Symbol">(</a><a id="3613" href="Data.List.Sort.MergeSort.Properties.html#3565" class="Bound">xs↗</a> <a id="3617" href="Data.List.Relation.Unary.All.html#1718" class="InductiveConstructor Operator">∷</a> <a id="3619" href="Data.List.Sort.MergeSort.Properties.html#3571" class="Bound">ys↗</a> <a id="3623" href="Data.List.Relation.Unary.All.html#1718" class="InductiveConstructor Operator">∷</a> <a id="3625" href="Data.List.Sort.MergeSort.Properties.html#3577" class="Bound">xss↗</a><a id="3629" class="Symbol">))</a>

<a id="sort-↗"></a><a id="3633" href="Data.List.Sort.MergeSort.Properties.html#3633" class="Function">sort-↗</a> <a id="3640" class="Symbol">:</a> <a id="3642" class="Symbol">∀</a> <a id="3644" href="Data.List.Sort.MergeSort.Properties.html#3644" class="Bound">xs</a> <a id="3647" class="Symbol">→</a> <a id="3649" href="Data.List.Relation.Unary.Sorted.TotalOrder.html#784" class="Function">Sorted</a> <a id="3656" class="Symbol">(</a><a id="3657" href="Data.List.Sort.MergeSort.Base.html#1623" class="Function">sort</a> <a id="3662" href="Data.List.Sort.MergeSort.Properties.html#3644" class="Bound">xs</a><a id="3664" class="Symbol">)</a>
<a id="3666" href="Data.List.Sort.MergeSort.Properties.html#3633" class="Function">sort-↗</a> <a id="3673" href="Data.List.Sort.MergeSort.Properties.html#3673" class="Bound">xs</a> <a id="3676" class="Symbol">=</a> <a id="3678" href="Data.List.Sort.MergeSort.Properties.html#3344" class="Function">mergeAll-↗</a> <a id="3689" class="Symbol">_</a> <a id="3691" class="Symbol">(</a><a id="3692" href="Data.List.Relation.Unary.All.Properties.html#11943" class="Function">All.map⁺</a> <a id="3701" class="Symbol">(</a><a id="3702" href="Data.List.Relation.Unary.All.html#6554" class="Function">All.universal</a> <a id="3716" class="Symbol">(λ</a> <a id="3719" href="Data.List.Sort.MergeSort.Properties.html#3719" class="Bound">_</a> <a id="3721" class="Symbol">→</a> <a id="3723" href="Data.List.Relation.Unary.Linked.html#1519" class="InductiveConstructor">[-]</a><a id="3726" class="Symbol">)</a> <a id="3728" href="Data.List.Sort.MergeSort.Properties.html#3673" class="Bound">xs</a><a id="3730" class="Symbol">))</a>

<a id="3734" class="Comment">------------------------------------------------------------------------</a>
<a id="3807" class="Comment">-- Algorithm</a>

<a id="mergeSort"></a><a id="3821" href="Data.List.Sort.MergeSort.Properties.html#3821" class="Function">mergeSort</a> <a id="3831" class="Symbol">:</a> <a id="3833" href="Data.List.Sort.Base.html#932" class="Record">SortingAlgorithm</a>
<a id="3850" href="Data.List.Sort.MergeSort.Properties.html#3821" class="Function">mergeSort</a> <a id="3860" class="Symbol">=</a> <a id="3862" class="Keyword">record</a>
  <a id="3871" class="Symbol">{</a> <a id="3873" href="Data.List.Sort.Base.html#987" class="Field">sort</a>   <a id="3880" class="Symbol">=</a> <a id="3882" href="Data.List.Sort.MergeSort.Base.html#1623" class="Function">sort</a>
  <a id="3889" class="Symbol">;</a> <a id="3891" href="Data.List.Sort.Base.html#1366" class="Field">sort-↭</a> <a id="3898" class="Symbol">=</a> <a id="3900" href="Data.List.Sort.MergeSort.Properties.html#2840" class="Function">sort-↭</a>
  <a id="3909" class="Symbol">;</a> <a id="3911" href="Data.List.Sort.Base.html#1439" class="Field">sort-↗</a> <a id="3918" class="Symbol">=</a> <a id="3920" href="Data.List.Sort.MergeSort.Properties.html#3633" class="Function">sort-↗</a>
  <a id="3929" class="Symbol">}</a>
</pre></body></html>