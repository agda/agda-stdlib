<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Effect.Monad.Writer.Transformer.Base</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Basic type and definition of the writer monad transformer</a>
<a id="167" class="Comment">------------------------------------------------------------------------</a>

<a id="241" class="Symbol">{-#</a> <a id="245" class="Keyword">OPTIONS</a> <a id="253" class="Pragma">--cubical-compatible</a> <a id="274" class="Pragma">--safe</a> <a id="281" class="Symbol">#-}</a>

<a id="286" class="Keyword">module</a> <a id="293" href="Effect.Monad.Writer.Transformer.Base.html" class="Module">Effect.Monad.Writer.Transformer.Base</a> <a id="330" class="Keyword">where</a>

<a id="337" class="Keyword">open</a> <a id="342" class="Keyword">import</a> <a id="349" href="Algebra.html" class="Module">Algebra</a> <a id="357" class="Keyword">using</a> <a id="363" class="Symbol">(</a><a id="364" href="Algebra.Bundles.Raw.html#1758" class="Record">RawMonoid</a><a id="373" class="Symbol">)</a>
<a id="375" class="Keyword">open</a> <a id="380" class="Keyword">import</a> <a id="387" href="Data.Product.Base.html" class="Module">Data.Product.Base</a> <a id="405" class="Keyword">using</a> <a id="411" class="Symbol">(</a><a id="412" href="Data.Product.Base.html#1618" class="Function Operator">_×_</a><a id="415" class="Symbol">;</a> <a id="417" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a><a id="420" class="Symbol">;</a> <a id="422" href="Data.Product.Base.html#636" class="Field">proj₁</a><a id="427" class="Symbol">;</a> <a id="429" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="434" class="Symbol">)</a>
<a id="436" class="Keyword">open</a> <a id="441" class="Keyword">import</a> <a id="448" href="Data.Unit.Polymorphic.html" class="Module">Data.Unit.Polymorphic</a> <a id="470" class="Keyword">using</a> <a id="476" class="Symbol">(</a><a id="477" href="Data.Unit.Polymorphic.Base.html#489" class="Function">⊤</a><a id="478" class="Symbol">;</a> <a id="480" href="Data.Unit.Polymorphic.Base.html#533" class="Function">tt</a><a id="482" class="Symbol">)</a>
<a id="484" class="Keyword">open</a> <a id="489" class="Keyword">import</a> <a id="496" href="Function.Base.html" class="Module">Function.Base</a> <a id="510" class="Keyword">using</a> <a id="516" class="Symbol">(</a><a id="517" href="Function.Base.html#704" class="Function">id</a><a id="519" class="Symbol">;</a> <a id="521" href="Function.Base.html#3626" class="Function Operator">_∘′_</a><a id="525" class="Symbol">)</a>
<a id="527" class="Keyword">open</a> <a id="532" class="Keyword">import</a> <a id="539" href="Level.html" class="Module">Level</a> <a id="545" class="Keyword">using</a> <a id="551" class="Symbol">(</a><a id="552" href="Agda.Primitive.html#742" class="Postulate">Level</a><a id="557" class="Symbol">;</a> <a id="559" href="Agda.Primitive.html#931" class="Primitive">suc</a><a id="562" class="Symbol">;</a> <a id="564" href="Agda.Primitive.html#961" class="Primitive Operator">_⊔_</a><a id="567" class="Symbol">)</a>

<a id="570" class="Keyword">open</a> <a id="575" class="Keyword">import</a> <a id="582" href="Effect.Functor.html" class="Module">Effect.Functor</a> <a id="597" class="Keyword">using</a> <a id="603" class="Symbol">(</a><a id="604" href="Effect.Functor.html#579" class="Record">RawFunctor</a><a id="614" class="Symbol">)</a>

<a id="617" class="Keyword">private</a>
  <a id="627" class="Keyword">variable</a>
    <a id="640" href="Effect.Monad.Writer.Transformer.Base.html#640" class="Generalizable">w</a> <a id="642" href="Effect.Monad.Writer.Transformer.Base.html#642" class="Generalizable">f</a> <a id="644" href="Effect.Monad.Writer.Transformer.Base.html#644" class="Generalizable">g</a> <a id="646" class="Symbol">:</a> <a id="648" href="Agda.Primitive.html#742" class="Postulate">Level</a>
    <a id="658" href="Effect.Monad.Writer.Transformer.Base.html#658" class="Generalizable">A</a> <a id="660" class="Symbol">:</a> <a id="662" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="666" href="Effect.Monad.Writer.Transformer.Base.html#644" class="Generalizable">g</a>
    <a id="672" href="Effect.Monad.Writer.Transformer.Base.html#672" class="Generalizable">M</a> <a id="674" class="Symbol">:</a> <a id="676" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="680" href="Effect.Monad.Writer.Transformer.Base.html#640" class="Generalizable">w</a> <a id="682" class="Symbol">→</a> <a id="684" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="688" href="Effect.Monad.Writer.Transformer.Base.html#644" class="Generalizable">g</a>
    <a id="694" href="Effect.Monad.Writer.Transformer.Base.html#694" class="Generalizable">𝕎</a> <a id="696" class="Symbol">:</a> <a id="698" href="Algebra.Bundles.Raw.html#1758" class="Record">RawMonoid</a> <a id="708" href="Effect.Monad.Writer.Transformer.Base.html#640" class="Generalizable">w</a> <a id="710" href="Effect.Monad.Writer.Transformer.Base.html#644" class="Generalizable">g</a>

<a id="713" class="Comment">------------------------------------------------------------------------</a>
<a id="786" class="Comment">-- Writer monad operations</a>

<a id="814" class="Keyword">record</a> <a id="RawMonadWriter"></a><a id="821" href="Effect.Monad.Writer.Transformer.Base.html#821" class="Record">RawMonadWriter</a>
       <a id="843" class="Symbol">(</a><a id="844" href="Effect.Monad.Writer.Transformer.Base.html#844" class="Bound">𝕎</a> <a id="846" class="Symbol">:</a> <a id="848" href="Algebra.Bundles.Raw.html#1758" class="Record">RawMonoid</a> <a id="858" href="Effect.Monad.Writer.Transformer.Base.html#640" class="Generalizable">w</a> <a id="860" href="Effect.Monad.Writer.Transformer.Base.html#642" class="Generalizable">f</a><a id="861" class="Symbol">)</a>
       <a id="870" class="Symbol">(</a><a id="871" href="Effect.Monad.Writer.Transformer.Base.html#871" class="Bound">M</a> <a id="873" class="Symbol">:</a> <a id="875" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="879" href="Effect.Monad.Writer.Transformer.Base.html#640" class="Generalizable">w</a> <a id="881" class="Symbol">→</a> <a id="883" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="887" href="Effect.Monad.Writer.Transformer.Base.html#644" class="Generalizable">g</a><a id="888" class="Symbol">)</a>
       <a id="897" class="Symbol">:</a> <a id="899" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="903" class="Symbol">(</a><a id="904" href="Agda.Primitive.html#931" class="Primitive">suc</a> <a id="908" href="Effect.Monad.Writer.Transformer.Base.html#858" class="Bound">w</a> <a id="910" href="Agda.Primitive.html#961" class="Primitive Operator">⊔</a> <a id="912" href="Effect.Monad.Writer.Transformer.Base.html#887" class="Bound">g</a><a id="913" class="Symbol">)</a> <a id="915" class="Keyword">where</a>
  <a id="923" class="Keyword">open</a> <a id="928" href="Algebra.Bundles.Raw.html#1758" class="Module">RawMonoid</a> <a id="938" href="Effect.Monad.Writer.Transformer.Base.html#844" class="Bound">𝕎</a> <a id="940" class="Keyword">renaming</a> <a id="949" class="Symbol">(</a><a id="950" href="Algebra.Bundles.Raw.html#1840" class="Field">Carrier</a> <a id="958" class="Symbol">to</a> <a id="961" class="Field">W</a><a id="962" class="Symbol">)</a>
  <a id="966" class="Keyword">field</a>
    <a id="RawMonadWriter.writer"></a><a id="976" href="Effect.Monad.Writer.Transformer.Base.html#976" class="Field">writer</a> <a id="983" class="Symbol">:</a> <a id="985" href="Effect.Monad.Writer.Transformer.Base.html#961" class="Function">W</a> <a id="987" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="989" href="Effect.Monad.Writer.Transformer.Base.html#658" class="Generalizable">A</a> <a id="991" class="Symbol">→</a> <a id="993" href="Effect.Monad.Writer.Transformer.Base.html#871" class="Bound">M</a> <a id="995" href="Effect.Monad.Writer.Transformer.Base.html#658" class="Generalizable">A</a>
    <a id="RawMonadWriter.listen"></a><a id="1001" href="Effect.Monad.Writer.Transformer.Base.html#1001" class="Field">listen</a> <a id="1008" class="Symbol">:</a> <a id="1010" href="Effect.Monad.Writer.Transformer.Base.html#871" class="Bound">M</a> <a id="1012" href="Effect.Monad.Writer.Transformer.Base.html#658" class="Generalizable">A</a> <a id="1014" class="Symbol">→</a> <a id="1016" href="Effect.Monad.Writer.Transformer.Base.html#871" class="Bound">M</a> <a id="1018" class="Symbol">(</a><a id="1019" href="Effect.Monad.Writer.Transformer.Base.html#961" class="Function">W</a> <a id="1021" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1023" href="Effect.Monad.Writer.Transformer.Base.html#658" class="Generalizable">A</a><a id="1024" class="Symbol">)</a>
    <a id="RawMonadWriter.pass"></a><a id="1030" href="Effect.Monad.Writer.Transformer.Base.html#1030" class="Field">pass</a>   <a id="1037" class="Symbol">:</a> <a id="1039" href="Effect.Monad.Writer.Transformer.Base.html#871" class="Bound">M</a> <a id="1041" class="Symbol">((</a><a id="1043" href="Effect.Monad.Writer.Transformer.Base.html#961" class="Function">W</a> <a id="1045" class="Symbol">→</a> <a id="1047" href="Effect.Monad.Writer.Transformer.Base.html#961" class="Function">W</a><a id="1048" class="Symbol">)</a> <a id="1050" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1052" href="Effect.Monad.Writer.Transformer.Base.html#658" class="Generalizable">A</a><a id="1053" class="Symbol">)</a> <a id="1055" class="Symbol">→</a> <a id="1057" href="Effect.Monad.Writer.Transformer.Base.html#871" class="Bound">M</a> <a id="1059" href="Effect.Monad.Writer.Transformer.Base.html#658" class="Generalizable">A</a>

  <a id="RawMonadWriter.tell"></a><a id="1064" href="Effect.Monad.Writer.Transformer.Base.html#1064" class="Function">tell</a> <a id="1069" class="Symbol">:</a> <a id="1071" href="Effect.Monad.Writer.Transformer.Base.html#961" class="Function">W</a> <a id="1073" class="Symbol">→</a> <a id="1075" href="Effect.Monad.Writer.Transformer.Base.html#871" class="Bound">M</a> <a id="1077" href="Data.Unit.Polymorphic.Base.html#489" class="Function">⊤</a>
  <a id="1081" href="Effect.Monad.Writer.Transformer.Base.html#1064" class="Function">tell</a> <a id="1086" href="Effect.Monad.Writer.Transformer.Base.html#1086" class="Bound">w</a> <a id="1088" class="Symbol">=</a> <a id="1090" href="Effect.Monad.Writer.Transformer.Base.html#976" class="Field">writer</a> <a id="1097" class="Symbol">(</a><a id="1098" href="Effect.Monad.Writer.Transformer.Base.html#1086" class="Bound">w</a> <a id="1100" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1102" href="Data.Unit.Polymorphic.Base.html#533" class="Function">tt</a><a id="1104" class="Symbol">)</a>

<a id="1107" class="Comment">------------------------------------------------------------------------</a>
<a id="1180" class="Comment">-- Writer monad transformer (CPS-encoded)</a>

<a id="1223" class="Keyword">record</a> <a id="WriterT"></a><a id="1230" href="Effect.Monad.Writer.Transformer.Base.html#1230" class="Record">WriterT</a>
       <a id="1245" class="Symbol">(</a><a id="1246" href="Effect.Monad.Writer.Transformer.Base.html#1246" class="Bound">𝕎</a> <a id="1248" class="Symbol">:</a> <a id="1250" href="Algebra.Bundles.Raw.html#1758" class="Record">RawMonoid</a> <a id="1260" href="Effect.Monad.Writer.Transformer.Base.html#640" class="Generalizable">w</a> <a id="1262" href="Effect.Monad.Writer.Transformer.Base.html#642" class="Generalizable">f</a><a id="1263" class="Symbol">)</a>
       <a id="1272" class="Symbol">(</a><a id="1273" href="Effect.Monad.Writer.Transformer.Base.html#1273" class="Bound">M</a> <a id="1275" class="Symbol">:</a> <a id="1277" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1281" href="Effect.Monad.Writer.Transformer.Base.html#640" class="Generalizable">w</a> <a id="1283" class="Symbol">→</a> <a id="1285" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1289" href="Effect.Monad.Writer.Transformer.Base.html#644" class="Generalizable">g</a><a id="1290" class="Symbol">)</a>
       <a id="1299" class="Symbol">(</a><a id="1300" href="Effect.Monad.Writer.Transformer.Base.html#1300" class="Bound">A</a> <a id="1302" class="Symbol">:</a> <a id="1304" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1308" href="Effect.Monad.Writer.Transformer.Base.html#640" class="Generalizable">w</a><a id="1309" class="Symbol">)</a>
       <a id="1318" class="Symbol">:</a> <a id="1320" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1324" class="Symbol">(</a><a id="1325" href="Effect.Monad.Writer.Transformer.Base.html#1260" class="Bound">w</a> <a id="1327" href="Agda.Primitive.html#961" class="Primitive Operator">⊔</a> <a id="1329" href="Effect.Monad.Writer.Transformer.Base.html#1289" class="Bound">g</a><a id="1330" class="Symbol">)</a> <a id="1332" class="Keyword">where</a>
  <a id="1340" class="Keyword">constructor</a> <a id="mkWriterT"></a><a id="1352" href="Effect.Monad.Writer.Transformer.Base.html#1352" class="InductiveConstructor">mkWriterT</a>
  <a id="1364" class="Keyword">open</a> <a id="1369" href="Algebra.Bundles.Raw.html#1758" class="Module">RawMonoid</a> <a id="1379" href="Effect.Monad.Writer.Transformer.Base.html#1246" class="Bound">𝕎</a> <a id="1381" class="Keyword">renaming</a> <a id="1390" class="Symbol">(</a><a id="1391" href="Algebra.Bundles.Raw.html#1840" class="Field">Carrier</a> <a id="1399" class="Symbol">to</a> <a id="1402" class="Field">W</a><a id="1403" class="Symbol">)</a>
  <a id="1407" class="Keyword">field</a> <a id="WriterT.runWriterT"></a><a id="1413" href="Effect.Monad.Writer.Transformer.Base.html#1413" class="Field">runWriterT</a> <a id="1424" class="Symbol">:</a> <a id="1426" href="Effect.Monad.Writer.Transformer.Base.html#1402" class="Function">W</a> <a id="1428" class="Symbol">→</a> <a id="1430" href="Effect.Monad.Writer.Transformer.Base.html#1273" class="Bound">M</a> <a id="1432" class="Symbol">(</a><a id="1433" href="Effect.Monad.Writer.Transformer.Base.html#1402" class="Function">W</a> <a id="1435" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1437" href="Effect.Monad.Writer.Transformer.Base.html#1300" class="Bound">A</a><a id="1438" class="Symbol">)</a>
<a id="1440" class="Keyword">open</a> <a id="1445" href="Effect.Monad.Writer.Transformer.Base.html#1230" class="Module">WriterT</a> <a id="1453" class="Keyword">public</a>

<a id="1461" class="Keyword">module</a> <a id="1468" href="Effect.Monad.Writer.Transformer.Base.html#1468" class="Module">_</a> <a id="1470" class="Symbol">{</a><a id="1471" href="Effect.Monad.Writer.Transformer.Base.html#1471" class="Bound">𝕎</a> <a id="1473" class="Symbol">:</a> <a id="1475" href="Algebra.Bundles.Raw.html#1758" class="Record">RawMonoid</a> <a id="1485" href="Effect.Monad.Writer.Transformer.Base.html#640" class="Generalizable">w</a> <a id="1487" href="Effect.Monad.Writer.Transformer.Base.html#642" class="Generalizable">f</a><a id="1488" class="Symbol">}</a> <a id="1490" class="Keyword">where</a>

  <a id="1499" class="Keyword">open</a> <a id="1504" href="Algebra.Bundles.Raw.html#1758" class="Module">RawMonoid</a> <a id="1514" href="Effect.Monad.Writer.Transformer.Base.html#1471" class="Bound">𝕎</a> <a id="1516" class="Keyword">renaming</a> <a id="1525" class="Symbol">(</a><a id="1526" href="Algebra.Bundles.Raw.html#1840" class="Field">Carrier</a> <a id="1534" class="Symbol">to</a> <a id="1537" class="Field">W</a><a id="1538" class="Symbol">)</a>

  <a id="1543" href="Effect.Monad.Writer.Transformer.Base.html#1543" class="Function">evalWriterT</a> <a id="1555" class="Symbol">:</a> <a id="1557" href="Effect.Functor.html#579" class="Record">RawFunctor</a> <a id="1568" href="Effect.Monad.Writer.Transformer.Base.html#672" class="Generalizable">M</a> <a id="1570" class="Symbol">→</a> <a id="1572" href="Effect.Monad.Writer.Transformer.Base.html#1230" class="Record">WriterT</a> <a id="1580" href="Effect.Monad.Writer.Transformer.Base.html#1471" class="Bound">𝕎</a> <a id="1582" href="Effect.Monad.Writer.Transformer.Base.html#672" class="Generalizable">M</a> <a id="1584" href="Effect.Monad.Writer.Transformer.Base.html#658" class="Generalizable">A</a> <a id="1586" class="Symbol">→</a> <a id="1588" href="Effect.Monad.Writer.Transformer.Base.html#672" class="Generalizable">M</a> <a id="1590" href="Effect.Monad.Writer.Transformer.Base.html#658" class="Generalizable">A</a>
  <a id="1594" href="Effect.Monad.Writer.Transformer.Base.html#1543" class="Function">evalWriterT</a> <a id="1606" href="Effect.Monad.Writer.Transformer.Base.html#1606" class="Bound">M</a> <a id="1608" href="Effect.Monad.Writer.Transformer.Base.html#1608" class="Bound">ma</a> <a id="1611" class="Symbol">=</a> <a id="1613" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="1619" href="Effect.Functor.html#687" class="Function Operator">&lt;$&gt;</a> <a id="1623" href="Effect.Monad.Writer.Transformer.Base.html#1413" class="Field">runWriterT</a> <a id="1634" href="Effect.Monad.Writer.Transformer.Base.html#1608" class="Bound">ma</a> <a id="1637" href="Algebra.Bundles.Raw.html#1914" class="Field">ε</a>
    <a id="1643" class="Keyword">where</a> <a id="1649" class="Keyword">open</a> <a id="1654" href="Effect.Functor.html#579" class="Module">RawFunctor</a> <a id="1665" href="Effect.Monad.Writer.Transformer.Base.html#1606" class="Bound">M</a>

  <a id="1670" href="Effect.Monad.Writer.Transformer.Base.html#1670" class="Function">execWriterT</a> <a id="1682" class="Symbol">:</a> <a id="1684" href="Effect.Functor.html#579" class="Record">RawFunctor</a> <a id="1695" href="Effect.Monad.Writer.Transformer.Base.html#672" class="Generalizable">M</a> <a id="1697" class="Symbol">→</a> <a id="1699" href="Effect.Monad.Writer.Transformer.Base.html#1230" class="Record">WriterT</a> <a id="1707" href="Effect.Monad.Writer.Transformer.Base.html#1471" class="Bound">𝕎</a> <a id="1709" href="Effect.Monad.Writer.Transformer.Base.html#672" class="Generalizable">M</a> <a id="1711" href="Effect.Monad.Writer.Transformer.Base.html#658" class="Generalizable">A</a> <a id="1713" class="Symbol">→</a> <a id="1715" href="Effect.Monad.Writer.Transformer.Base.html#672" class="Generalizable">M</a> <a id="1717" href="Effect.Monad.Writer.Transformer.Base.html#1537" class="Field">W</a>
  <a id="1721" href="Effect.Monad.Writer.Transformer.Base.html#1670" class="Function">execWriterT</a> <a id="1733" href="Effect.Monad.Writer.Transformer.Base.html#1733" class="Bound">M</a> <a id="1735" href="Effect.Monad.Writer.Transformer.Base.html#1735" class="Bound">ma</a> <a id="1738" class="Symbol">=</a> <a id="1740" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="1746" href="Effect.Functor.html#687" class="Function Operator">&lt;$&gt;</a> <a id="1750" href="Effect.Monad.Writer.Transformer.Base.html#1413" class="Field">runWriterT</a> <a id="1761" href="Effect.Monad.Writer.Transformer.Base.html#1735" class="Bound">ma</a> <a id="1764" href="Algebra.Bundles.Raw.html#1914" class="Field">ε</a>
    <a id="1770" class="Keyword">where</a> <a id="1776" class="Keyword">open</a> <a id="1781" href="Effect.Functor.html#579" class="Module">RawFunctor</a> <a id="1792" href="Effect.Monad.Writer.Transformer.Base.html#1733" class="Bound">M</a>
</pre></body></html>