<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Container.FreeMonad</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- The free monad construction on containers</a>
<a id="151" class="Comment">------------------------------------------------------------------------</a>

<a id="225" class="Symbol">{-#</a> <a id="229" class="Keyword">OPTIONS</a> <a id="237" class="Pragma">--without-K</a> <a id="249" class="Pragma">--safe</a> <a id="256" class="Pragma">--sized-types</a> <a id="270" class="Symbol">#-}</a>

<a id="275" class="Keyword">module</a> <a id="282" href="Data.Container.FreeMonad.html" class="Module">Data.Container.FreeMonad</a> <a id="307" class="Keyword">where</a>

<a id="314" class="Keyword">open</a> <a id="319" class="Keyword">import</a> <a id="326" href="Level.html" class="Module">Level</a>
<a id="332" class="Keyword">open</a> <a id="337" class="Keyword">import</a> <a id="344" href="Data.Sum.html" class="Module">Data.Sum</a> <a id="353" class="Keyword">using</a> <a id="359" class="Symbol">(</a><a id="360" href="Data.Sum.Base.html#662" class="InductiveConstructor">inj₁</a><a id="364" class="Symbol">;</a> <a id="366" href="Data.Sum.Base.html#687" class="InductiveConstructor">inj₂</a> <a id="371" class="Symbol">;</a> <a id="373" href="Data.Sum.Base.html#967" class="Function Operator">[_,_]′</a><a id="379" class="Symbol">)</a>
<a id="381" class="Keyword">open</a> <a id="386" class="Keyword">import</a> <a id="393" href="Data.Product.html" class="Module">Data.Product</a>
<a id="406" class="Keyword">open</a> <a id="411" class="Keyword">import</a> <a id="418" href="Data.Container.html" class="Module">Data.Container</a>
<a id="433" class="Keyword">open</a> <a id="438" class="Keyword">import</a> <a id="445" href="Data.Container.Combinator.html" class="Module">Data.Container.Combinator</a> <a id="471" class="Keyword">using</a> <a id="477" class="Symbol">(</a><a id="478" href="Data.Container.Combinator.html#833" class="Function">const</a><a id="483" class="Symbol">;</a> <a id="485" href="Data.Container.Combinator.html#1968" class="Function Operator">_⊎_</a><a id="488" class="Symbol">)</a>
<a id="490" class="Keyword">open</a> <a id="495" class="Keyword">import</a> <a id="502" href="Data.W.html" class="Module">Data.W</a>
<a id="509" class="Keyword">open</a> <a id="514" class="Keyword">import</a> <a id="521" href="Category.Monad.html" class="Module">Category.Monad</a>

<a id="537" class="Keyword">infixl</a> <a id="544" class="Number">1</a> <a id="546" href="Data.Container.FreeMonad.html#1434" class="Function Operator">_⋆C_</a>
<a id="551" class="Keyword">infix</a>  <a id="558" class="Number">1</a> <a id="560" href="Data.Container.FreeMonad.html#1519" class="Function Operator">_⋆_</a>

<a id="565" class="Comment">------------------------------------------------------------------------</a>
<a id="638" class="Comment">-- The free monad construction over a container and a set is, in</a>
<a id="703" class="Comment">-- universal algebra terminology, also known as the term algebra over a</a>
<a id="775" class="Comment">-- signature (a container) and a set (of variable symbols). The return</a>
<a id="846" class="Comment">-- of the free monad corresponds to variables and the bind operator</a>
<a id="914" class="Comment">-- corresponds to (parallel) substitution.</a>

<a id="958" class="Comment">-- A useful intuition is to think of containers describing single</a>
<a id="1024" class="Comment">-- operations and the free monad construction over a container and a set</a>
<a id="1097" class="Comment">-- describing a tree of operations as nodes and elements of the set as</a>
<a id="1168" class="Comment">-- leafs. If one starts at the root, then any path will pass finitely</a>
<a id="1238" class="Comment">-- many nodes (operations described by the container) and eventually end</a>
<a id="1311" class="Comment">-- up in a leaf (element of the set) -- hence the Kleene star notation</a>
<a id="1382" class="Comment">-- (the type can be read as a regular expression).</a>

<a id="_⋆C_"></a><a id="1434" href="Data.Container.FreeMonad.html#1434" class="Function Operator">_⋆C_</a> <a id="1439" class="Symbol">:</a> <a id="1441" class="Symbol">∀</a> <a id="1443" class="Symbol">{</a><a id="1444" href="Data.Container.FreeMonad.html#1444" class="Bound">x</a> <a id="1446" href="Data.Container.FreeMonad.html#1446" class="Bound">s</a> <a id="1448" href="Data.Container.FreeMonad.html#1448" class="Bound">p</a><a id="1449" class="Symbol">}</a> <a id="1451" class="Symbol">→</a> <a id="1453" href="Data.Container.Core.html#553" class="Record">Container</a> <a id="1463" href="Data.Container.FreeMonad.html#1446" class="Bound">s</a> <a id="1465" href="Data.Container.FreeMonad.html#1448" class="Bound">p</a> <a id="1467" class="Symbol">→</a> <a id="1469" class="PrimitiveType">Set</a> <a id="1473" href="Data.Container.FreeMonad.html#1444" class="Bound">x</a> <a id="1475" class="Symbol">→</a> <a id="1477" href="Data.Container.Core.html#553" class="Record">Container</a> <a id="1487" class="Symbol">(</a><a id="1488" href="Data.Container.FreeMonad.html#1446" class="Bound">s</a> <a id="1490" href="Agda.Primitive.html#657" class="Primitive Operator">⊔</a> <a id="1492" href="Data.Container.FreeMonad.html#1444" class="Bound">x</a><a id="1493" class="Symbol">)</a> <a id="1495" href="Data.Container.FreeMonad.html#1448" class="Bound">p</a>
<a id="1497" href="Data.Container.FreeMonad.html#1497" class="Bound">C</a> <a id="1499" href="Data.Container.FreeMonad.html#1434" class="Function Operator">⋆C</a> <a id="1502" href="Data.Container.FreeMonad.html#1502" class="Bound">X</a> <a id="1504" class="Symbol">=</a> <a id="1506" href="Data.Container.Combinator.html#833" class="Function">const</a> <a id="1512" href="Data.Container.FreeMonad.html#1502" class="Bound">X</a> <a id="1514" href="Data.Container.Combinator.html#1968" class="Function Operator">⊎</a> <a id="1516" href="Data.Container.FreeMonad.html#1497" class="Bound">C</a>

<a id="_⋆_"></a><a id="1519" href="Data.Container.FreeMonad.html#1519" class="Function Operator">_⋆_</a> <a id="1523" class="Symbol">:</a> <a id="1525" class="Symbol">∀</a> <a id="1527" class="Symbol">{</a><a id="1528" href="Data.Container.FreeMonad.html#1528" class="Bound">x</a> <a id="1530" href="Data.Container.FreeMonad.html#1530" class="Bound">s</a> <a id="1532" href="Data.Container.FreeMonad.html#1532" class="Bound">p</a><a id="1533" class="Symbol">}</a> <a id="1535" class="Symbol">→</a> <a id="1537" href="Data.Container.Core.html#553" class="Record">Container</a> <a id="1547" href="Data.Container.FreeMonad.html#1530" class="Bound">s</a> <a id="1549" href="Data.Container.FreeMonad.html#1532" class="Bound">p</a> <a id="1551" class="Symbol">→</a> <a id="1553" class="PrimitiveType">Set</a> <a id="1557" href="Data.Container.FreeMonad.html#1528" class="Bound">x</a> <a id="1559" class="Symbol">→</a> <a id="1561" class="PrimitiveType">Set</a> <a id="1565" class="Symbol">(</a><a id="1566" href="Data.Container.FreeMonad.html#1528" class="Bound">x</a> <a id="1568" href="Agda.Primitive.html#657" class="Primitive Operator">⊔</a> <a id="1570" href="Data.Container.FreeMonad.html#1530" class="Bound">s</a> <a id="1572" href="Agda.Primitive.html#657" class="Primitive Operator">⊔</a> <a id="1574" href="Data.Container.FreeMonad.html#1532" class="Bound">p</a><a id="1575" class="Symbol">)</a>
<a id="1577" href="Data.Container.FreeMonad.html#1577" class="Bound">C</a> <a id="1579" href="Data.Container.FreeMonad.html#1519" class="Function Operator">⋆</a> <a id="1581" href="Data.Container.FreeMonad.html#1581" class="Bound">X</a> <a id="1583" class="Symbol">=</a> <a id="1585" href="Data.Container.html#1546" class="Function">μ</a> <a id="1587" class="Symbol">(</a><a id="1588" href="Data.Container.FreeMonad.html#1577" class="Bound">C</a> <a id="1590" href="Data.Container.FreeMonad.html#1434" class="Function Operator">⋆C</a> <a id="1593" href="Data.Container.FreeMonad.html#1581" class="Bound">X</a><a id="1594" class="Symbol">)</a>

<a id="1597" class="Keyword">module</a> <a id="1604" href="Data.Container.FreeMonad.html#1604" class="Module">_</a> <a id="1606" class="Symbol">{</a><a id="1607" href="Data.Container.FreeMonad.html#1607" class="Bound">s</a> <a id="1609" href="Data.Container.FreeMonad.html#1609" class="Bound">p</a><a id="1610" class="Symbol">}</a> <a id="1612" class="Symbol">{</a><a id="1613" href="Data.Container.FreeMonad.html#1613" class="Bound">C</a> <a id="1615" class="Symbol">:</a> <a id="1617" href="Data.Container.Core.html#553" class="Record">Container</a> <a id="1627" href="Data.Container.FreeMonad.html#1607" class="Bound">s</a> <a id="1629" href="Data.Container.FreeMonad.html#1609" class="Bound">p</a><a id="1630" class="Symbol">}</a> <a id="1632" class="Keyword">where</a>

  <a id="1641" href="Data.Container.FreeMonad.html#1641" class="Function">inn</a> <a id="1645" class="Symbol">:</a> <a id="1647" class="Symbol">∀</a> <a id="1649" class="Symbol">{</a><a id="1650" href="Data.Container.FreeMonad.html#1650" class="Bound">x</a><a id="1651" class="Symbol">}</a> <a id="1653" class="Symbol">{</a><a id="1654" href="Data.Container.FreeMonad.html#1654" class="Bound">X</a> <a id="1656" class="Symbol">:</a> <a id="1658" class="PrimitiveType">Set</a> <a id="1662" href="Data.Container.FreeMonad.html#1650" class="Bound">x</a><a id="1663" class="Symbol">}</a> <a id="1665" class="Symbol">→</a> <a id="1667" href="Data.Container.Core.html#750" class="Function Operator">⟦</a> <a id="1669" href="Data.Container.FreeMonad.html#1613" class="Bound">C</a> <a id="1671" href="Data.Container.Core.html#750" class="Function Operator">⟧</a> <a id="1673" class="Symbol">(</a><a id="1674" href="Data.Container.FreeMonad.html#1613" class="Bound">C</a> <a id="1676" href="Data.Container.FreeMonad.html#1519" class="Function Operator">⋆</a> <a id="1678" href="Data.Container.FreeMonad.html#1654" class="Bound">X</a><a id="1679" class="Symbol">)</a> <a id="1681" class="Symbol">→</a> <a id="1683" href="Data.Container.FreeMonad.html#1613" class="Bound">C</a> <a id="1685" href="Data.Container.FreeMonad.html#1519" class="Function Operator">⋆</a> <a id="1687" href="Data.Container.FreeMonad.html#1654" class="Bound">X</a>
  <a id="1691" href="Data.Container.FreeMonad.html#1641" class="Function">inn</a> <a id="1695" class="Symbol">(</a><a id="1696" href="Data.Container.FreeMonad.html#1696" class="Bound">s</a> <a id="1698" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1700" href="Data.Container.FreeMonad.html#1700" class="Bound">f</a><a id="1701" class="Symbol">)</a> <a id="1703" class="Symbol">=</a> <a id="1705" href="Data.W.html#577" class="InductiveConstructor">sup</a> <a id="1709" class="Symbol">(</a><a id="1710" href="Data.Sum.Base.html#687" class="InductiveConstructor">inj₂</a> <a id="1715" href="Data.Container.FreeMonad.html#1696" class="Bound">s</a> <a id="1717" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1719" href="Data.Container.FreeMonad.html#1700" class="Bound">f</a><a id="1720" class="Symbol">)</a>

  <a id="1725" href="Data.Container.FreeMonad.html#1725" class="Function">rawMonad</a> <a id="1734" class="Symbol">:</a> <a id="1736" class="Symbol">∀</a> <a id="1738" class="Symbol">{</a><a id="1739" href="Data.Container.FreeMonad.html#1739" class="Bound">x</a><a id="1740" class="Symbol">}</a> <a id="1742" class="Symbol">→</a> <a id="1744" href="Category.Monad.html#396" class="Function">RawMonad</a> <a id="1753" class="Symbol">{</a><a id="1754" href="Data.Container.FreeMonad.html#1607" class="Bound">s</a> <a id="1756" href="Agda.Primitive.html#657" class="Primitive Operator">⊔</a> <a id="1758" href="Data.Container.FreeMonad.html#1609" class="Bound">p</a> <a id="1760" href="Agda.Primitive.html#657" class="Primitive Operator">⊔</a> <a id="1762" href="Data.Container.FreeMonad.html#1739" class="Bound">x</a><a id="1763" class="Symbol">}</a> <a id="1765" class="Symbol">(</a><a id="1766" href="Data.Container.FreeMonad.html#1613" class="Bound">C</a> <a id="1768" href="Data.Container.FreeMonad.html#1519" class="Function Operator">⋆_</a><a id="1770" class="Symbol">)</a>
  <a id="1774" href="Data.Container.FreeMonad.html#1725" class="Function">rawMonad</a> <a id="1783" class="Symbol">=</a> <a id="1785" class="Keyword">record</a> <a id="1792" class="Symbol">{</a> <a id="1794" href="Category.Monad.Indexed.html#569" class="Field">return</a> <a id="1801" class="Symbol">=</a> <a id="1803" href="Data.Container.FreeMonad.html#1841" class="Function">return</a><a id="1809" class="Symbol">;</a> <a id="1811" href="Category.Monad.Indexed.html#604" class="Field Operator">_&gt;&gt;=_</a> <a id="1817" class="Symbol">=</a> <a id="1819" href="Data.Container.FreeMonad.html#1908" class="Function Operator">_&gt;&gt;=_</a> <a id="1825" class="Symbol">}</a>
    <a id="1831" class="Keyword">where</a>
    <a id="1841" href="Data.Container.FreeMonad.html#1841" class="Function">return</a> <a id="1848" class="Symbol">:</a> <a id="1850" class="Symbol">∀</a> <a id="1852" class="Symbol">{</a><a id="1853" href="Data.Container.FreeMonad.html#1853" class="Bound">X</a><a id="1854" class="Symbol">}</a> <a id="1856" class="Symbol">→</a> <a id="1858" href="Data.Container.FreeMonad.html#1853" class="Bound">X</a> <a id="1860" class="Symbol">→</a> <a id="1862" href="Data.Container.FreeMonad.html#1613" class="Bound">C</a> <a id="1864" href="Data.Container.FreeMonad.html#1519" class="Function Operator">⋆</a> <a id="1866" href="Data.Container.FreeMonad.html#1853" class="Bound">X</a>
    <a id="1872" href="Data.Container.FreeMonad.html#1841" class="Function">return</a> <a id="1879" href="Data.Container.FreeMonad.html#1879" class="Bound">x</a> <a id="1881" class="Symbol">=</a> <a id="1883" href="Data.W.html#577" class="InductiveConstructor">sup</a> <a id="1887" class="Symbol">(</a><a id="1888" href="Data.Sum.Base.html#662" class="InductiveConstructor">inj₁</a> <a id="1893" href="Data.Container.FreeMonad.html#1879" class="Bound">x</a> <a id="1895" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1897" class="Symbol">λ</a> <a id="1899" class="Symbol">())</a>

    <a id="1908" href="Data.Container.FreeMonad.html#1908" class="Function Operator">_&gt;&gt;=_</a> <a id="1914" class="Symbol">:</a> <a id="1916" class="Symbol">∀</a> <a id="1918" class="Symbol">{</a><a id="1919" href="Data.Container.FreeMonad.html#1919" class="Bound">X</a> <a id="1921" href="Data.Container.FreeMonad.html#1921" class="Bound">Y</a><a id="1922" class="Symbol">}</a> <a id="1924" class="Symbol">→</a> <a id="1926" href="Data.Container.FreeMonad.html#1613" class="Bound">C</a> <a id="1928" href="Data.Container.FreeMonad.html#1519" class="Function Operator">⋆</a> <a id="1930" href="Data.Container.FreeMonad.html#1919" class="Bound">X</a> <a id="1932" class="Symbol">→</a> <a id="1934" class="Symbol">(</a><a id="1935" href="Data.Container.FreeMonad.html#1919" class="Bound">X</a> <a id="1937" class="Symbol">→</a> <a id="1939" href="Data.Container.FreeMonad.html#1613" class="Bound">C</a> <a id="1941" href="Data.Container.FreeMonad.html#1519" class="Function Operator">⋆</a> <a id="1943" href="Data.Container.FreeMonad.html#1921" class="Bound">Y</a><a id="1944" class="Symbol">)</a> <a id="1946" class="Symbol">→</a> <a id="1948" href="Data.Container.FreeMonad.html#1613" class="Bound">C</a> <a id="1950" href="Data.Container.FreeMonad.html#1519" class="Function Operator">⋆</a> <a id="1952" href="Data.Container.FreeMonad.html#1921" class="Bound">Y</a>
    <a id="1958" href="Data.W.html#577" class="InductiveConstructor">sup</a> <a id="1962" class="Symbol">(</a><a id="1963" href="Data.Sum.Base.html#662" class="InductiveConstructor">inj₁</a> <a id="1968" href="Data.Container.FreeMonad.html#1968" class="Bound">x</a> <a id="1970" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="1972" class="Symbol">_)</a> <a id="1975" href="Data.Container.FreeMonad.html#1908" class="Function Operator">&gt;&gt;=</a> <a id="1979" href="Data.Container.FreeMonad.html#1979" class="Bound">k</a> <a id="1981" class="Symbol">=</a> <a id="1983" href="Data.Container.FreeMonad.html#1979" class="Bound">k</a> <a id="1985" href="Data.Container.FreeMonad.html#1968" class="Bound">x</a>
    <a id="1991" href="Data.W.html#577" class="InductiveConstructor">sup</a> <a id="1995" class="Symbol">(</a><a id="1996" href="Data.Sum.Base.html#687" class="InductiveConstructor">inj₂</a> <a id="2001" href="Data.Container.FreeMonad.html#2001" class="Bound">s</a> <a id="2003" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2005" href="Data.Container.FreeMonad.html#2005" class="Bound">f</a><a id="2006" class="Symbol">)</a> <a id="2008" href="Data.Container.FreeMonad.html#1908" class="Function Operator">&gt;&gt;=</a> <a id="2012" href="Data.Container.FreeMonad.html#2012" class="Bound">k</a> <a id="2014" class="Symbol">=</a> <a id="2016" href="Data.Container.FreeMonad.html#1641" class="Function">inn</a> <a id="2020" class="Symbol">(</a><a id="2021" href="Data.Container.FreeMonad.html#2001" class="Bound">s</a> <a id="2023" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="2025" class="Symbol">λ</a> <a id="2027" href="Data.Container.FreeMonad.html#2027" class="Bound">p</a> <a id="2029" class="Symbol">→</a> <a id="2031" href="Data.Container.FreeMonad.html#2005" class="Bound">f</a> <a id="2033" href="Data.Container.FreeMonad.html#2027" class="Bound">p</a> <a id="2035" href="Data.Container.FreeMonad.html#1908" class="Function Operator">&gt;&gt;=</a> <a id="2039" href="Data.Container.FreeMonad.html#2012" class="Bound">k</a><a id="2040" class="Symbol">)</a>
</pre></body></html>