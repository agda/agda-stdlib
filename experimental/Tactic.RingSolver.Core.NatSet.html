<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.RingSolver.Core.NatSet</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Simple implementation of sets of ℕ.</a>
<a id="145" class="Comment">--</a>
<a id="148" class="Comment">-- Since ℕ is represented as unary numbers, simply having an ordered list of</a>
<a id="225" class="Comment">-- numbers to represent a set is quite inefficient. For instance, to see if</a>
<a id="301" class="Comment">-- 6 is in the set {1, 3, 4}, we have to do a comparison with 1, then 3, and</a>
<a id="378" class="Comment">-- then 4. But 4 is equal to suc 3, so we should be able to share the work</a>
<a id="453" class="Comment">-- accross those two comparisons.</a>
<a id="487" class="Comment">--</a>
<a id="490" class="Comment">-- This module defines a type that represents {1, 3, 4} as:</a>
<a id="550" class="Comment">--</a>
<a id="553" class="Comment">--   1 ∷ 1 ∷ 0 ∷ []</a>
<a id="573" class="Comment">--</a>
<a id="576" class="Comment">-- i.e. we only store the gaps. When checking if a number (the needle) is in the</a>
<a id="657" class="Comment">-- set (the haystack), we subtract each successive member of the haystack from the</a>
<a id="740" class="Comment">-- needle as we go. For example, to check if 6 is in the above set, we do the</a>
<a id="818" class="Comment">-- following:</a>
<a id="832" class="Comment">--</a>
<a id="835" class="Comment">--   start:                  6 ∈? (1 ∷ 1 ∷ 0 ∷ [])</a>
<a id="886" class="Comment">--   test head:              6 ≟ 1</a>
<a id="921" class="Comment">--   not equal, so continue: (6 - 1 - 1) ∈? (1 ∷ 0 ∷ [])</a>
<a id="978" class="Comment">--   compute:                4 ∈? (1 ∷ 0 ∷ [])</a>
<a id="1025" class="Comment">--   test head:              4 ≟ 1</a>
<a id="1060" class="Comment">--   not equal, so continue: (4 - 1 - 1) ∈? (0 ∷ [])</a>
<a id="1113" class="Comment">--   compute:                2 ∈? (0 ∷ [])</a>
<a id="1156" class="Comment">--   test head:              2 ≟ 0</a>
<a id="1191" class="Comment">--   not equal, so continue: (2 - 1 - 1) ∈? []</a>
<a id="1238" class="Comment">--   empty list:             false</a>
<a id="1273" class="Comment">--</a>
<a id="1276" class="Comment">-- In this way, we change the membership test from O(n²) to O(n).</a>
<a id="1342" class="Comment">------------------------------------------------------------------------</a>

<a id="1416" class="Symbol">{-#</a> <a id="1420" class="Keyword">OPTIONS</a> <a id="1428" class="Pragma">--without-K</a> <a id="1440" class="Pragma">--safe</a> <a id="1447" class="Symbol">#-}</a>

<a id="1452" class="Keyword">module</a> <a id="1459" href="Tactic.RingSolver.Core.NatSet.html" class="Module">Tactic.RingSolver.Core.NatSet</a> <a id="1489" class="Keyword">where</a>

<a id="1496" class="Keyword">open</a> <a id="1501" class="Keyword">import</a> <a id="1508" href="Data.Nat.html" class="Module">Data.Nat</a>   <a id="1519" class="Symbol">as</a> <a id="1522" class="Module">ℕ</a>     <a id="1528" class="Keyword">using</a> <a id="1534" class="Symbol">(</a><a id="1535" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1536" class="Symbol">;</a> <a id="1538" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="1541" class="Symbol">;</a> <a id="1543" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="1547" class="Symbol">)</a>
<a id="1549" class="Keyword">open</a> <a id="1554" class="Keyword">import</a> <a id="1561" href="Data.List.html" class="Module">Data.List</a>  <a id="1572" class="Symbol">as</a> <a id="1575" class="Module">List</a>  <a id="1581" class="Keyword">using</a> <a id="1587" class="Symbol">(</a><a id="1588" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="1592" class="Symbol">;</a> <a id="1594" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="1597" class="Symbol">;</a> <a id="1599" href="Data.List.Base.html#9981" class="InductiveConstructor">[]</a><a id="1601" class="Symbol">)</a>
<a id="1603" class="Keyword">open</a> <a id="1608" class="Keyword">import</a> <a id="1615" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="1631" class="Symbol">as</a> <a id="1634" class="Module">Maybe</a> <a id="1640" class="Keyword">using</a> <a id="1646" class="Symbol">(</a><a id="1647" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a><a id="1652" class="Symbol">;</a> <a id="1654" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a><a id="1658" class="Symbol">;</a> <a id="1660" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="1667" class="Symbol">)</a>
<a id="1669" class="Keyword">open</a> <a id="1674" class="Keyword">import</a> <a id="1681" href="Data.Bool.html" class="Module">Data.Bool</a>  <a id="1692" class="Symbol">as</a> <a id="1695" class="Module">Bool</a>  <a id="1701" class="Keyword">using</a> <a id="1707" class="Symbol">(</a><a id="1708" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="1712" class="Symbol">)</a>
<a id="1714" class="Keyword">open</a> <a id="1719" class="Keyword">import</a> <a id="1726" href="Function.html" class="Module">Function</a>
<a id="1735" class="Keyword">open</a> <a id="1740" class="Keyword">import</a> <a id="1747" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>

<a id="1786" class="Comment">------------------------------------------------------------------------</a>
<a id="1859" class="Comment">-- Helper methods</a>

<a id="para"></a><a id="1878" href="Tactic.RingSolver.Core.NatSet.html#1878" class="Function">para</a> <a id="1883" class="Symbol">:</a> <a id="1885" class="Symbol">∀</a> <a id="1887" class="Symbol">{</a><a id="1888" href="Tactic.RingSolver.Core.NatSet.html#1888" class="Bound">a</a> <a id="1890" href="Tactic.RingSolver.Core.NatSet.html#1890" class="Bound">b</a><a id="1891" class="Symbol">}</a> <a id="1893" class="Symbol">{</a><a id="1894" href="Tactic.RingSolver.Core.NatSet.html#1894" class="Bound">A</a> <a id="1896" class="Symbol">:</a> <a id="1898" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1902" href="Tactic.RingSolver.Core.NatSet.html#1888" class="Bound">a</a><a id="1903" class="Symbol">}</a> <a id="1905" class="Symbol">{</a><a id="1906" href="Tactic.RingSolver.Core.NatSet.html#1906" class="Bound">B</a> <a id="1908" class="Symbol">:</a> <a id="1910" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1914" href="Tactic.RingSolver.Core.NatSet.html#1890" class="Bound">b</a><a id="1915" class="Symbol">}</a> <a id="1917" class="Symbol">→</a>
       <a id="1926" class="Symbol">(</a><a id="1927" href="Tactic.RingSolver.Core.NatSet.html#1894" class="Bound">A</a> <a id="1929" class="Symbol">→</a> <a id="1931" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1936" href="Tactic.RingSolver.Core.NatSet.html#1894" class="Bound">A</a> <a id="1938" class="Symbol">→</a> <a id="1940" href="Tactic.RingSolver.Core.NatSet.html#1906" class="Bound">B</a> <a id="1942" class="Symbol">→</a> <a id="1944" href="Tactic.RingSolver.Core.NatSet.html#1906" class="Bound">B</a><a id="1945" class="Symbol">)</a> <a id="1947" class="Symbol">→</a> <a id="1949" href="Tactic.RingSolver.Core.NatSet.html#1906" class="Bound">B</a> <a id="1951" class="Symbol">→</a> <a id="1953" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1958" href="Tactic.RingSolver.Core.NatSet.html#1894" class="Bound">A</a> <a id="1960" class="Symbol">→</a> <a id="1962" href="Tactic.RingSolver.Core.NatSet.html#1906" class="Bound">B</a>
<a id="1964" href="Tactic.RingSolver.Core.NatSet.html#1878" class="Function">para</a> <a id="1969" href="Tactic.RingSolver.Core.NatSet.html#1969" class="Bound">f</a> <a id="1971" href="Tactic.RingSolver.Core.NatSet.html#1971" class="Bound">b</a> <a id="1973" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>       <a id="1982" class="Symbol">=</a> <a id="1984" href="Tactic.RingSolver.Core.NatSet.html#1971" class="Bound">b</a>
<a id="1986" href="Tactic.RingSolver.Core.NatSet.html#1878" class="Function">para</a> <a id="1991" href="Tactic.RingSolver.Core.NatSet.html#1991" class="Bound">f</a> <a id="1993" href="Tactic.RingSolver.Core.NatSet.html#1993" class="Bound">b</a> <a id="1995" class="Symbol">(</a><a id="1996" href="Tactic.RingSolver.Core.NatSet.html#1996" class="Bound">x</a> <a id="1998" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2000" href="Tactic.RingSolver.Core.NatSet.html#2000" class="Bound">xs</a><a id="2002" class="Symbol">)</a> <a id="2004" class="Symbol">=</a> <a id="2006" href="Tactic.RingSolver.Core.NatSet.html#1991" class="Bound">f</a> <a id="2008" href="Tactic.RingSolver.Core.NatSet.html#1996" class="Bound">x</a> <a id="2010" href="Tactic.RingSolver.Core.NatSet.html#2000" class="Bound">xs</a> <a id="2013" class="Symbol">(</a><a id="2014" href="Tactic.RingSolver.Core.NatSet.html#1878" class="Function">para</a> <a id="2019" href="Tactic.RingSolver.Core.NatSet.html#1991" class="Bound">f</a> <a id="2021" href="Tactic.RingSolver.Core.NatSet.html#1993" class="Bound">b</a> <a id="2023" href="Tactic.RingSolver.Core.NatSet.html#2000" class="Bound">xs</a><a id="2025" class="Symbol">)</a>

<a id="2028" class="Comment">------------------------------------------------------------------------</a>
<a id="2101" class="Comment">-- Definition</a>

<a id="NatSet"></a><a id="2116" href="Tactic.RingSolver.Core.NatSet.html#2116" class="Function">NatSet</a> <a id="2123" class="Symbol">:</a> <a id="2125" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="2129" href="Tactic.RingSolver.Core.NatSet.html#2116" class="Function">NatSet</a> <a id="2136" class="Symbol">=</a> <a id="2138" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2143" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="2146" class="Comment">------------------------------------------------------------------------</a>
<a id="2219" class="Comment">-- Functions</a>

<a id="insert"></a><a id="2233" href="Tactic.RingSolver.Core.NatSet.html#2233" class="Function">insert</a> <a id="2240" class="Symbol">:</a> <a id="2242" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2244" class="Symbol">→</a> <a id="2246" href="Tactic.RingSolver.Core.NatSet.html#2116" class="Function">NatSet</a> <a id="2253" class="Symbol">→</a> <a id="2255" href="Tactic.RingSolver.Core.NatSet.html#2116" class="Function">NatSet</a>
<a id="2262" href="Tactic.RingSolver.Core.NatSet.html#2233" class="Function">insert</a> <a id="2269" href="Tactic.RingSolver.Core.NatSet.html#2269" class="Bound">x</a> <a id="2271" href="Tactic.RingSolver.Core.NatSet.html#2271" class="Bound">xs</a> <a id="2274" class="Symbol">=</a> <a id="2276" href="Tactic.RingSolver.Core.NatSet.html#1878" class="Function">para</a> <a id="2281" href="Tactic.RingSolver.Core.NatSet.html#2306" class="Function">f</a> <a id="2283" class="Symbol">(</a><a id="2284" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷</a> <a id="2287" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="2289" class="Symbol">)</a> <a id="2291" href="Tactic.RingSolver.Core.NatSet.html#2271" class="Bound">xs</a> <a id="2294" href="Tactic.RingSolver.Core.NatSet.html#2269" class="Bound">x</a>
  <a id="2298" class="Keyword">where</a>
  <a id="2306" href="Tactic.RingSolver.Core.NatSet.html#2306" class="Function">f</a> <a id="2308" class="Symbol">:</a> <a id="2310" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2312" class="Symbol">→</a> <a id="2314" href="Tactic.RingSolver.Core.NatSet.html#2116" class="Function">NatSet</a> <a id="2321" class="Symbol">→</a> <a id="2323" class="Symbol">(</a><a id="2324" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2326" class="Symbol">→</a> <a id="2328" href="Tactic.RingSolver.Core.NatSet.html#2116" class="Function">NatSet</a><a id="2334" class="Symbol">)</a> <a id="2336" class="Symbol">→</a> <a id="2338" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2340" class="Symbol">→</a> <a id="2342" href="Tactic.RingSolver.Core.NatSet.html#2116" class="Function">NatSet</a>
  <a id="2351" href="Tactic.RingSolver.Core.NatSet.html#2306" class="Function">f</a> <a id="2353" href="Tactic.RingSolver.Core.NatSet.html#2353" class="Bound">y</a> <a id="2355" href="Tactic.RingSolver.Core.NatSet.html#2355" class="Bound">ys</a> <a id="2358" href="Tactic.RingSolver.Core.NatSet.html#2358" class="Bound">c</a> <a id="2360" href="Tactic.RingSolver.Core.NatSet.html#2360" class="Bound">x</a> <a id="2362" class="Keyword">with</a> <a id="2367" href="Data.Nat.Base.html#5181" class="Function">ℕ.compare</a> <a id="2377" href="Tactic.RingSolver.Core.NatSet.html#2360" class="Bound">x</a> <a id="2379" href="Tactic.RingSolver.Core.NatSet.html#2353" class="Bound">y</a>
  <a id="2383" class="Symbol">...</a> <a id="2387" class="Symbol">|</a> <a id="2389" href="Data.Nat.Base.html#5059" class="InductiveConstructor">ℕ.less</a> <a id="2396" class="Bound">x</a> <a id="2398" href="Tactic.RingSolver.Core.NatSet.html#2398" class="Bound">k</a>    <a id="2403" class="Symbol">=</a> <a id="2405" class="Bound">x</a> <a id="2407" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2409" href="Tactic.RingSolver.Core.NatSet.html#2398" class="Bound">k</a> <a id="2411" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2413" class="Bound">ys</a>
  <a id="2418" class="Symbol">...</a> <a id="2422" class="Symbol">|</a> <a id="2424" href="Data.Nat.Base.html#5104" class="InductiveConstructor">ℕ.equal</a> <a id="2432" class="Bound">x</a>     <a id="2438" class="Symbol">=</a> <a id="2440" class="Bound">x</a> <a id="2442" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2444" class="Bound">ys</a>
  <a id="2449" class="Symbol">...</a> <a id="2453" class="Symbol">|</a> <a id="2455" href="Data.Nat.Base.html#5137" class="InductiveConstructor">ℕ.greater</a> <a id="2465" class="Bound">y</a> <a id="2467" href="Tactic.RingSolver.Core.NatSet.html#2467" class="Bound">k</a> <a id="2469" class="Symbol">=</a> <a id="2471" class="Bound">y</a> <a id="2473" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2475" class="Bound">c</a> <a id="2477" href="Tactic.RingSolver.Core.NatSet.html#2467" class="Bound">k</a>

<a id="delete"></a><a id="2480" href="Tactic.RingSolver.Core.NatSet.html#2480" class="Function">delete</a> <a id="2487" class="Symbol">:</a> <a id="2489" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2491" class="Symbol">→</a> <a id="2493" href="Tactic.RingSolver.Core.NatSet.html#2116" class="Function">NatSet</a> <a id="2500" class="Symbol">→</a> <a id="2502" href="Tactic.RingSolver.Core.NatSet.html#2116" class="Function">NatSet</a>
<a id="2509" href="Tactic.RingSolver.Core.NatSet.html#2480" class="Function">delete</a> <a id="2516" href="Tactic.RingSolver.Core.NatSet.html#2516" class="Bound">x</a> <a id="2518" href="Tactic.RingSolver.Core.NatSet.html#2518" class="Bound">xs</a> <a id="2521" class="Symbol">=</a> <a id="2523" href="Tactic.RingSolver.Core.NatSet.html#1878" class="Function">para</a> <a id="2528" href="Tactic.RingSolver.Core.NatSet.html#2556" class="Function">f</a> <a id="2530" class="Symbol">(</a><a id="2531" href="Function.Base.html#636" class="Function">const</a> <a id="2537" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="2539" class="Symbol">)</a> <a id="2541" href="Tactic.RingSolver.Core.NatSet.html#2518" class="Bound">xs</a> <a id="2544" href="Tactic.RingSolver.Core.NatSet.html#2516" class="Bound">x</a>
  <a id="2548" class="Keyword">where</a>
  <a id="2556" href="Tactic.RingSolver.Core.NatSet.html#2556" class="Function">f</a> <a id="2558" class="Symbol">:</a> <a id="2560" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2562" class="Symbol">→</a> <a id="2564" href="Tactic.RingSolver.Core.NatSet.html#2116" class="Function">NatSet</a> <a id="2571" class="Symbol">→</a> <a id="2573" class="Symbol">(</a><a id="2574" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2576" class="Symbol">→</a> <a id="2578" href="Tactic.RingSolver.Core.NatSet.html#2116" class="Function">NatSet</a><a id="2584" class="Symbol">)</a> <a id="2586" class="Symbol">→</a> <a id="2588" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2590" class="Symbol">→</a> <a id="2592" href="Tactic.RingSolver.Core.NatSet.html#2116" class="Function">NatSet</a>
  <a id="2601" href="Tactic.RingSolver.Core.NatSet.html#2556" class="Function">f</a> <a id="2603" href="Tactic.RingSolver.Core.NatSet.html#2603" class="Bound">y</a> <a id="2605" href="Tactic.RingSolver.Core.NatSet.html#2605" class="Bound">ys</a> <a id="2608" href="Tactic.RingSolver.Core.NatSet.html#2608" class="Bound">c</a> <a id="2610" href="Tactic.RingSolver.Core.NatSet.html#2610" class="Bound">x</a> <a id="2612" class="Keyword">with</a> <a id="2617" href="Data.Nat.Base.html#5181" class="Function">ℕ.compare</a> <a id="2627" href="Tactic.RingSolver.Core.NatSet.html#2610" class="Bound">x</a> <a id="2629" href="Tactic.RingSolver.Core.NatSet.html#2603" class="Bound">y</a>
  <a id="2633" href="Tactic.RingSolver.Core.NatSet.html#2556" class="Function">f</a> <a id="2635" href="Tactic.RingSolver.Core.NatSet.html#2635" class="Bound">y</a> <a id="2637" href="Tactic.RingSolver.Core.NatSet.html#2637" class="Bound">ys</a> <a id="2640" href="Tactic.RingSolver.Core.NatSet.html#2640" class="Bound">c</a> <a id="2642" href="Tactic.RingSolver.Core.NatSet.html#2642" class="Bound">x</a>         <a id="2652" class="Symbol">|</a> <a id="2654" href="Data.Nat.Base.html#5059" class="InductiveConstructor">ℕ.less</a>    <a id="2664" href="Tactic.RingSolver.Core.NatSet.html#2642" class="Bound">x</a> <a id="2666" href="Tactic.RingSolver.Core.NatSet.html#2666" class="Bound">k</a> <a id="2668" class="Symbol">=</a> <a id="2670" href="Tactic.RingSolver.Core.NatSet.html#2635" class="Bound">y</a> <a id="2672" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2674" href="Tactic.RingSolver.Core.NatSet.html#2637" class="Bound">ys</a>
  <a id="2679" href="Tactic.RingSolver.Core.NatSet.html#2556" class="Function">f</a> <a id="2681" href="Tactic.RingSolver.Core.NatSet.html#2681" class="Bound">y</a> <a id="2683" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="2686" href="Tactic.RingSolver.Core.NatSet.html#2686" class="Bound">c</a> <a id="2688" href="Tactic.RingSolver.Core.NatSet.html#2688" class="Bound">x</a>         <a id="2698" class="Symbol">|</a> <a id="2700" href="Data.Nat.Base.html#5104" class="InductiveConstructor">ℕ.equal</a>   <a id="2710" href="Tactic.RingSolver.Core.NatSet.html#2688" class="Bound">x</a>   <a id="2714" class="Symbol">=</a> <a id="2716" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="2721" href="Tactic.RingSolver.Core.NatSet.html#2556" class="Function">f</a> <a id="2723" href="Tactic.RingSolver.Core.NatSet.html#2723" class="Bound">y₁</a> <a id="2726" class="Symbol">(</a><a id="2727" href="Tactic.RingSolver.Core.NatSet.html#2727" class="Bound">y₂</a> <a id="2730" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2732" href="Tactic.RingSolver.Core.NatSet.html#2732" class="Bound">ys</a><a id="2734" class="Symbol">)</a> <a id="2736" href="Tactic.RingSolver.Core.NatSet.html#2736" class="Bound">c</a> <a id="2738" href="Tactic.RingSolver.Core.NatSet.html#2738" class="Bound">x</a> <a id="2740" class="Symbol">|</a> <a id="2742" href="Data.Nat.Base.html#5104" class="InductiveConstructor">ℕ.equal</a>   <a id="2752" href="Tactic.RingSolver.Core.NatSet.html#2738" class="Bound">x</a>   <a id="2756" class="Symbol">=</a> <a id="2758" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2762" href="Tactic.RingSolver.Core.NatSet.html#2738" class="Bound">x</a> <a id="2764" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">ℕ.+</a> <a id="2768" href="Tactic.RingSolver.Core.NatSet.html#2727" class="Bound">y₂</a> <a id="2771" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2773" href="Tactic.RingSolver.Core.NatSet.html#2732" class="Bound">ys</a>
  <a id="2778" href="Tactic.RingSolver.Core.NatSet.html#2556" class="Function">f</a> <a id="2780" href="Tactic.RingSolver.Core.NatSet.html#2780" class="Bound">y</a> <a id="2782" href="Tactic.RingSolver.Core.NatSet.html#2782" class="Bound">ys</a> <a id="2785" href="Tactic.RingSolver.Core.NatSet.html#2785" class="Bound">c</a> <a id="2787" href="Tactic.RingSolver.Core.NatSet.html#2787" class="Bound">x</a>         <a id="2797" class="Symbol">|</a> <a id="2799" href="Data.Nat.Base.html#5137" class="InductiveConstructor">ℕ.greater</a> <a id="2809" href="Tactic.RingSolver.Core.NatSet.html#2780" class="Bound">y</a> <a id="2811" href="Tactic.RingSolver.Core.NatSet.html#2811" class="Bound">k</a> <a id="2813" class="Symbol">=</a> <a id="2815" href="Tactic.RingSolver.Core.NatSet.html#2780" class="Bound">y</a> <a id="2817" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2819" href="Tactic.RingSolver.Core.NatSet.html#2785" class="Bound">c</a> <a id="2821" href="Tactic.RingSolver.Core.NatSet.html#2811" class="Bound">k</a>

<a id="2824" class="Comment">-- Returns the position of the element, if it&#39;s present.</a>
<a id="lookup"></a><a id="2881" href="Tactic.RingSolver.Core.NatSet.html#2881" class="Function">lookup</a> <a id="2888" class="Symbol">:</a> <a id="2890" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2892" class="Symbol">→</a> <a id="2894" href="Tactic.RingSolver.Core.NatSet.html#2116" class="Function">NatSet</a> <a id="2901" class="Symbol">→</a> <a id="2903" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2909" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="2911" href="Tactic.RingSolver.Core.NatSet.html#2881" class="Function">lookup</a> <a id="2918" href="Tactic.RingSolver.Core.NatSet.html#2918" class="Bound">x</a> <a id="2920" href="Tactic.RingSolver.Core.NatSet.html#2920" class="Bound">xs</a> <a id="2923" class="Symbol">=</a> <a id="2925" href="Data.List.Base.html#3905" class="Function">List.foldr</a> <a id="2936" href="Tactic.RingSolver.Core.NatSet.html#2979" class="Function">f</a> <a id="2938" class="Symbol">(</a><a id="2939" href="Function.Base.html#636" class="Function">const</a> <a id="2945" class="Symbol">(</a><a id="2946" href="Function.Base.html#636" class="Function">const</a> <a id="2952" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="2959" class="Symbol">))</a> <a id="2962" href="Tactic.RingSolver.Core.NatSet.html#2920" class="Bound">xs</a> <a id="2965" href="Tactic.RingSolver.Core.NatSet.html#2918" class="Bound">x</a> <a id="2967" class="Number">0</a>
  <a id="2971" class="Keyword">where</a>
  <a id="2979" href="Tactic.RingSolver.Core.NatSet.html#2979" class="Function">f</a> <a id="2981" class="Symbol">:</a> <a id="2983" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2985" class="Symbol">→</a> <a id="2987" class="Symbol">(</a><a id="2988" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2990" class="Symbol">→</a> <a id="2992" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2994" class="Symbol">→</a> <a id="2996" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="3002" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="3003" class="Symbol">)</a> <a id="3005" class="Symbol">→</a> <a id="3007" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="3009" class="Symbol">→</a> <a id="3011" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="3013" class="Symbol">→</a> <a id="3015" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="3021" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
  <a id="3025" href="Tactic.RingSolver.Core.NatSet.html#2979" class="Function">f</a> <a id="3027" href="Tactic.RingSolver.Core.NatSet.html#3027" class="Bound">y</a> <a id="3029" href="Tactic.RingSolver.Core.NatSet.html#3029" class="Bound">ys</a> <a id="3032" href="Tactic.RingSolver.Core.NatSet.html#3032" class="Bound">x</a> <a id="3034" href="Tactic.RingSolver.Core.NatSet.html#3034" class="Bound">i</a> <a id="3036" class="Keyword">with</a> <a id="3041" href="Data.Nat.Base.html#5181" class="Function">ℕ.compare</a> <a id="3051" href="Tactic.RingSolver.Core.NatSet.html#3032" class="Bound">x</a> <a id="3053" href="Tactic.RingSolver.Core.NatSet.html#3027" class="Bound">y</a>
  <a id="3057" class="Symbol">...</a> <a id="3061" class="Symbol">|</a> <a id="3063" href="Data.Nat.Base.html#5059" class="InductiveConstructor">ℕ.less</a>     <a id="3074" class="Bound">x</a> <a id="3076" href="Tactic.RingSolver.Core.NatSet.html#3076" class="Bound">k</a> <a id="3078" class="Symbol">=</a> <a id="3080" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>
  <a id="3090" class="Symbol">...</a> <a id="3094" class="Symbol">|</a> <a id="3096" href="Data.Nat.Base.html#5104" class="InductiveConstructor">ℕ.equal</a>    <a id="3107" class="Bound">y</a>   <a id="3111" class="Symbol">=</a> <a id="3113" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="3118" class="Bound">i</a>
  <a id="3122" class="Symbol">...</a> <a id="3126" class="Symbol">|</a> <a id="3128" href="Data.Nat.Base.html#5137" class="InductiveConstructor">ℕ.greater</a>  <a id="3139" class="Bound">y</a> <a id="3141" href="Tactic.RingSolver.Core.NatSet.html#3141" class="Bound">k</a> <a id="3143" class="Symbol">=</a> <a id="3145" class="Bound">ys</a> <a id="3148" href="Tactic.RingSolver.Core.NatSet.html#3141" class="Bound">k</a> <a id="3150" class="Symbol">(</a><a id="3151" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="3155" class="Bound">i</a><a id="3156" class="Symbol">)</a>


<a id="member"></a><a id="3160" href="Tactic.RingSolver.Core.NatSet.html#3160" class="Function">member</a> <a id="3167" class="Symbol">:</a> <a id="3169" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="3171" class="Symbol">→</a> <a id="3173" href="Tactic.RingSolver.Core.NatSet.html#2116" class="Function">NatSet</a> <a id="3180" class="Symbol">→</a> <a id="3182" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="3187" href="Tactic.RingSolver.Core.NatSet.html#3160" class="Function">member</a> <a id="3194" href="Tactic.RingSolver.Core.NatSet.html#3194" class="Bound">x</a> <a id="3196" class="Symbol">=</a> <a id="3198" href="Data.Maybe.Base.html#1081" class="Function">Maybe.is-just</a> <a id="3212" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3214" href="Tactic.RingSolver.Core.NatSet.html#2881" class="Function">lookup</a> <a id="3221" href="Tactic.RingSolver.Core.NatSet.html#3194" class="Bound">x</a>

<a id="fromList"></a><a id="3224" href="Tactic.RingSolver.Core.NatSet.html#3224" class="Function">fromList</a> <a id="3233" class="Symbol">:</a> <a id="3235" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3240" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="3242" class="Symbol">→</a> <a id="3244" href="Tactic.RingSolver.Core.NatSet.html#2116" class="Function">NatSet</a>
<a id="3251" href="Tactic.RingSolver.Core.NatSet.html#3224" class="Function">fromList</a> <a id="3260" class="Symbol">=</a> <a id="3262" href="Data.List.Base.html#3905" class="Function">List.foldr</a> <a id="3273" href="Tactic.RingSolver.Core.NatSet.html#2233" class="Function">insert</a> <a id="3280" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>

<a id="toList"></a><a id="3284" href="Tactic.RingSolver.Core.NatSet.html#3284" class="Function">toList</a> <a id="3291" class="Symbol">:</a> <a id="3293" href="Tactic.RingSolver.Core.NatSet.html#2116" class="Function">NatSet</a> <a id="3300" class="Symbol">→</a> <a id="3302" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3307" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="3309" href="Tactic.RingSolver.Core.NatSet.html#3284" class="Function">toList</a> <a id="3316" class="Symbol">=</a> <a id="3318" href="Data.List.Base.html#7051" class="Function">List.drop</a> <a id="3328" class="Number">1</a> <a id="3330" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3332" href="Data.List.Base.html#1497" class="Function">List.map</a> <a id="3341" href="Data.Nat.Base.html#2875" class="Function">ℕ.pred</a> <a id="3348" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="3350" href="Data.List.Base.html#5336" class="Function">List.scanl</a> <a id="3361" class="Symbol">(λ</a> <a id="3364" href="Tactic.RingSolver.Core.NatSet.html#3364" class="Bound">x</a> <a id="3366" href="Tactic.RingSolver.Core.NatSet.html#3366" class="Bound">y</a> <a id="3368" class="Symbol">→</a> <a id="3370" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="3374" class="Symbol">(</a><a id="3375" href="Tactic.RingSolver.Core.NatSet.html#3366" class="Bound">y</a> <a id="3377" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">ℕ.+</a> <a id="3381" href="Tactic.RingSolver.Core.NatSet.html#3364" class="Bound">x</a><a id="3382" class="Symbol">))</a> <a id="3385" class="Number">0</a>

<a id="3388" class="Comment">------------------------------------------------------------------------</a>
<a id="3461" class="Comment">-- Tests</a>

<a id="3471" class="Keyword">private</a>
  <a id="example₁"></a><a id="3481" href="Tactic.RingSolver.Core.NatSet.html#3481" class="Function">example₁</a> <a id="3490" class="Symbol">:</a> <a id="3492" href="Tactic.RingSolver.Core.NatSet.html#3224" class="Function">fromList</a> <a id="3501" class="Symbol">(</a><a id="3502" class="Number">4</a> <a id="3504" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3506" class="Number">3</a> <a id="3508" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3510" class="Number">1</a> <a id="3512" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3514" class="Number">0</a> <a id="3516" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3518" class="Number">2</a> <a id="3520" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3522" class="InductiveConstructor">[]</a><a id="3524" class="Symbol">)</a> <a id="3526" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3528" class="Symbol">(</a><a id="3529" class="Number">0</a> <a id="3531" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3533" class="Number">0</a> <a id="3535" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3537" class="Number">0</a> <a id="3539" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3541" class="Number">0</a> <a id="3543" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3545" class="Number">0</a> <a id="3547" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3549" class="InductiveConstructor">[]</a><a id="3551" class="Symbol">)</a>
  <a id="3555" href="Tactic.RingSolver.Core.NatSet.html#3481" class="Function">example₁</a> <a id="3564" class="Symbol">=</a> <a id="3566" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="example₂"></a><a id="3574" href="Tactic.RingSolver.Core.NatSet.html#3574" class="Function">example₂</a> <a id="3583" class="Symbol">:</a> <a id="3585" href="Tactic.RingSolver.Core.NatSet.html#2881" class="Function">lookup</a> <a id="3592" class="Number">3</a> <a id="3594" class="Symbol">(</a><a id="3595" href="Tactic.RingSolver.Core.NatSet.html#3224" class="Function">fromList</a> <a id="3604" class="Symbol">(</a><a id="3605" class="Number">4</a> <a id="3607" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3609" class="Number">3</a> <a id="3611" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3613" class="Number">1</a> <a id="3615" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3617" class="Number">0</a> <a id="3619" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3621" class="Number">2</a> <a id="3623" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3625" class="InductiveConstructor">[]</a><a id="3627" class="Symbol">))</a> <a id="3630" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3632" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="3637" class="Number">3</a>
  <a id="3641" href="Tactic.RingSolver.Core.NatSet.html#3574" class="Function">example₂</a> <a id="3650" class="Symbol">=</a> <a id="3652" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="example₃"></a><a id="3660" href="Tactic.RingSolver.Core.NatSet.html#3660" class="Function">example₃</a> <a id="3669" class="Symbol">:</a> <a id="3671" href="Tactic.RingSolver.Core.NatSet.html#3284" class="Function">toList</a> <a id="3678" class="Symbol">(</a><a id="3679" href="Tactic.RingSolver.Core.NatSet.html#3224" class="Function">fromList</a> <a id="3688" class="Symbol">(</a><a id="3689" class="Number">4</a> <a id="3691" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3693" class="Number">3</a> <a id="3695" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3697" class="Number">1</a> <a id="3699" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3701" class="Number">0</a> <a id="3703" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3705" class="Number">2</a> <a id="3707" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3709" class="InductiveConstructor">[]</a><a id="3711" class="Symbol">))</a> <a id="3714" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3716" class="Symbol">(</a><a id="3717" class="Number">0</a> <a id="3719" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3721" class="Number">1</a> <a id="3723" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3725" class="Number">2</a> <a id="3727" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3729" class="Number">3</a> <a id="3731" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3733" class="Number">4</a> <a id="3735" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3737" class="InductiveConstructor">[]</a><a id="3739" class="Symbol">)</a>
  <a id="3743" href="Tactic.RingSolver.Core.NatSet.html#3660" class="Function">example₃</a> <a id="3752" class="Symbol">=</a> <a id="3754" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="example₄"></a><a id="3762" href="Tactic.RingSolver.Core.NatSet.html#3762" class="Function">example₄</a> <a id="3771" class="Symbol">:</a> <a id="3773" href="Tactic.RingSolver.Core.NatSet.html#2480" class="Function">delete</a> <a id="3780" class="Number">3</a> <a id="3782" class="Symbol">(</a><a id="3783" href="Tactic.RingSolver.Core.NatSet.html#3224" class="Function">fromList</a> <a id="3792" class="Symbol">(</a><a id="3793" class="Number">4</a> <a id="3795" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3797" class="Number">3</a> <a id="3799" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3801" class="Number">1</a> <a id="3803" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3805" class="Number">2</a> <a id="3807" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3809" class="InductiveConstructor">[]</a><a id="3811" class="Symbol">))</a> <a id="3814" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3816" href="Tactic.RingSolver.Core.NatSet.html#3224" class="Function">fromList</a> <a id="3825" class="Symbol">(</a><a id="3826" class="Number">4</a> <a id="3828" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3830" class="Number">1</a> <a id="3832" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3834" class="Number">2</a> <a id="3836" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3838" class="InductiveConstructor">[]</a><a id="3840" class="Symbol">)</a>
  <a id="3844" href="Tactic.RingSolver.Core.NatSet.html#3762" class="Function">example₄</a> <a id="3853" class="Symbol">=</a> <a id="3855" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

  <a id="example₅"></a><a id="3863" href="Tactic.RingSolver.Core.NatSet.html#3863" class="Function">example₅</a> <a id="3872" class="Symbol">:</a> <a id="3874" href="Tactic.RingSolver.Core.NatSet.html#2480" class="Function">delete</a> <a id="3881" class="Number">3</a> <a id="3883" class="Symbol">(</a><a id="3884" href="Tactic.RingSolver.Core.NatSet.html#3224" class="Function">fromList</a> <a id="3893" class="Symbol">(</a><a id="3894" class="Number">4</a> <a id="3896" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3898" class="Number">1</a> <a id="3900" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3902" class="Number">2</a> <a id="3904" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3906" class="InductiveConstructor">[]</a><a id="3908" class="Symbol">))</a> <a id="3911" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3913" href="Tactic.RingSolver.Core.NatSet.html#3224" class="Function">fromList</a> <a id="3922" class="Symbol">(</a><a id="3923" class="Number">4</a> <a id="3925" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3927" class="Number">1</a> <a id="3929" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3931" class="Number">2</a> <a id="3933" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3935" class="InductiveConstructor">[]</a><a id="3937" class="Symbol">)</a>
  <a id="3941" href="Tactic.RingSolver.Core.NatSet.html#3863" class="Function">example₅</a> <a id="3950" class="Symbol">=</a> <a id="3952" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre></body></html>