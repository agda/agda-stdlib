<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.These.Effectful.Right.Base</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Base definitions for the right-biased universe-sensitive functor and</a>
<a id="178" class="Comment">-- monad instances for These.</a>
<a id="208" class="Comment">--</a>
<a id="211" class="Comment">-- To minimize the universe level of the RawFunctor, we require that</a>
<a id="280" class="Comment">-- elements of B are &quot;lifted&quot; to a copy of B at a higher universe level</a>
<a id="352" class="Comment">-- (a ⊔ b).</a>
<a id="364" class="Comment">-- See the Data.Product.Effectful.Examples for how this is done in a</a>
<a id="433" class="Comment">-- Product-based similar setting.</a>
<a id="467" class="Comment">------------------------------------------------------------------------</a>

<a id="541" class="Symbol">{-#</a> <a id="545" class="Keyword">OPTIONS</a> <a id="553" class="Pragma">--cubical-compatible</a> <a id="574" class="Pragma">--safe</a> <a id="581" class="Symbol">#-}</a>

<a id="586" class="Keyword">open</a> <a id="591" class="Keyword">import</a> <a id="598" href="Level.html" class="Module">Level</a>

<a id="605" class="Keyword">module</a> <a id="612" href="Data.These.Effectful.Right.Base.html" class="Module">Data.These.Effectful.Right.Base</a> <a id="644" class="Symbol">(</a><a id="645" href="Data.These.Effectful.Right.Base.html#645" class="Bound">a</a> <a id="647" class="Symbol">:</a> <a id="649" href="Agda.Primitive.html#742" class="Postulate">Level</a><a id="654" class="Symbol">)</a> <a id="656" class="Symbol">{</a><a id="657" href="Data.These.Effectful.Right.Base.html#657" class="Bound">b</a><a id="658" class="Symbol">}</a> <a id="660" class="Symbol">(</a><a id="661" href="Data.These.Effectful.Right.Base.html#661" class="Bound">B</a> <a id="663" class="Symbol">:</a> <a id="665" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="669" href="Data.These.Effectful.Right.Base.html#657" class="Bound">b</a><a id="670" class="Symbol">)</a> <a id="672" class="Keyword">where</a>

<a id="679" class="Keyword">open</a> <a id="684" class="Keyword">import</a> <a id="691" href="Data.These.Base.html" class="Module">Data.These.Base</a> <a id="707" class="Keyword">using</a> <a id="713" class="Symbol">(</a><a id="714" href="Data.These.Base.html#573" class="Datatype">These</a><a id="719" class="Symbol">;</a> <a id="721" href="Data.These.Base.html#631" class="InductiveConstructor">this</a><a id="725" class="Symbol">;</a> <a id="727" href="Data.These.Base.html#659" class="InductiveConstructor">that</a><a id="731" class="Symbol">;</a> <a id="733" href="Data.These.Base.html#687" class="InductiveConstructor">these</a><a id="738" class="Symbol">;</a> <a id="740" href="Data.These.Base.html#1041" class="Function">map₁</a><a id="744" class="Symbol">)</a>
<a id="746" class="Keyword">open</a> <a id="751" class="Keyword">import</a> <a id="758" href="Effect.Functor.html" class="Module">Effect.Functor</a> <a id="773" class="Keyword">using</a> <a id="779" class="Symbol">(</a><a id="780" href="Effect.Functor.html#602" class="Record">RawFunctor</a><a id="790" class="Symbol">)</a>
<a id="792" class="Keyword">open</a> <a id="797" class="Keyword">import</a> <a id="804" href="Effect.Applicative.html" class="Module">Effect.Applicative</a> <a id="823" class="Keyword">using</a> <a id="829" class="Symbol">(</a><a id="830" href="Effect.Applicative.html#977" class="Record">RawApplicative</a><a id="844" class="Symbol">)</a>
<a id="846" class="Keyword">open</a> <a id="851" class="Keyword">import</a> <a id="858" href="Effect.Monad.html" class="Module">Effect.Monad</a> <a id="871" class="Keyword">using</a> <a id="877" class="Symbol">(</a><a id="878" href="Effect.Monad.html#899" class="Record">RawMonad</a><a id="886" class="Symbol">)</a>
<a id="888" class="Keyword">open</a> <a id="893" class="Keyword">import</a> <a id="900" href="Function.Base.html" class="Module">Function.Base</a> <a id="914" class="Keyword">using</a> <a id="920" class="Symbol">(</a><a id="921" href="Function.Base.html#1638" class="Function">flip</a><a id="925" class="Symbol">;</a> <a id="927" href="Function.Base.html#1115" class="Function Operator">_∘_</a><a id="930" class="Symbol">)</a>

<a id="Theseᵣ"></a><a id="933" href="Data.These.Effectful.Right.Base.html#933" class="Function">Theseᵣ</a> <a id="940" class="Symbol">:</a> <a id="942" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="946" class="Symbol">(</a><a id="947" href="Data.These.Effectful.Right.Base.html#645" class="Bound">a</a> <a id="949" href="Agda.Primitive.html#961" class="Primitive Operator">⊔</a> <a id="951" href="Data.These.Effectful.Right.Base.html#657" class="Bound">b</a><a id="952" class="Symbol">)</a> <a id="954" class="Symbol">→</a> <a id="956" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="960" class="Symbol">(</a><a id="961" href="Data.These.Effectful.Right.Base.html#645" class="Bound">a</a> <a id="963" href="Agda.Primitive.html#961" class="Primitive Operator">⊔</a> <a id="965" href="Data.These.Effectful.Right.Base.html#657" class="Bound">b</a><a id="966" class="Symbol">)</a>
<a id="968" href="Data.These.Effectful.Right.Base.html#933" class="Function">Theseᵣ</a> <a id="975" href="Data.These.Effectful.Right.Base.html#975" class="Bound">A</a> <a id="977" class="Symbol">=</a> <a id="979" href="Data.These.Base.html#573" class="Datatype">These</a> <a id="985" href="Data.These.Effectful.Right.Base.html#975" class="Bound">A</a> <a id="987" href="Data.These.Effectful.Right.Base.html#661" class="Bound">B</a>

<a id="functor"></a><a id="990" href="Data.These.Effectful.Right.Base.html#990" class="Function">functor</a> <a id="998" class="Symbol">:</a> <a id="1000" href="Effect.Functor.html#602" class="Record">RawFunctor</a> <a id="1011" href="Data.These.Effectful.Right.Base.html#933" class="Function">Theseᵣ</a>
<a id="1018" href="Data.These.Effectful.Right.Base.html#990" class="Function">functor</a> <a id="1026" class="Symbol">=</a> <a id="1028" class="Keyword">record</a> <a id="1035" class="Symbol">{</a> <a id="1037" href="Effect.Functor.html#710" class="Field Operator">_&lt;$&gt;_</a> <a id="1043" class="Symbol">=</a> <a id="1045" href="Data.These.Base.html#1041" class="Function">map₁</a> <a id="1050" class="Symbol">}</a>

<a id="1053" class="Comment">------------------------------------------------------------------------</a>
<a id="1126" class="Comment">-- Get access to other monadic functions</a>

<a id="1168" class="Keyword">module</a> <a id="1175" href="Data.These.Effectful.Right.Base.html#1175" class="Module">_</a> <a id="1177" class="Symbol">{</a><a id="1178" href="Data.These.Effectful.Right.Base.html#1178" class="Bound">F</a><a id="1179" class="Symbol">}</a> <a id="1181" class="Symbol">(</a><a id="1182" href="Data.These.Effectful.Right.Base.html#1182" class="Bound">App</a> <a id="1186" class="Symbol">:</a> <a id="1188" href="Effect.Applicative.html#977" class="Record">RawApplicative</a> <a id="1203" class="Symbol">{</a><a id="1204" href="Data.These.Effectful.Right.Base.html#645" class="Bound">a</a> <a id="1206" href="Agda.Primitive.html#961" class="Primitive Operator">⊔</a> <a id="1208" href="Data.These.Effectful.Right.Base.html#657" class="Bound">b</a><a id="1209" class="Symbol">}</a> <a id="1211" class="Symbol">{</a><a id="1212" href="Data.These.Effectful.Right.Base.html#645" class="Bound">a</a> <a id="1214" href="Agda.Primitive.html#961" class="Primitive Operator">⊔</a> <a id="1216" href="Data.These.Effectful.Right.Base.html#657" class="Bound">b</a><a id="1217" class="Symbol">}</a> <a id="1219" href="Data.These.Effectful.Right.Base.html#1178" class="Bound">F</a><a id="1220" class="Symbol">)</a> <a id="1222" class="Keyword">where</a>

  <a id="1231" class="Keyword">open</a> <a id="1236" href="Effect.Applicative.html#977" class="Module">RawApplicative</a> <a id="1251" href="Data.These.Effectful.Right.Base.html#1182" class="Bound">App</a>

  <a id="1258" href="Data.These.Effectful.Right.Base.html#1258" class="Function">sequenceA</a> <a id="1268" class="Symbol">:</a> <a id="1270" class="Symbol">∀</a> <a id="1272" class="Symbol">{</a><a id="1273" href="Data.These.Effectful.Right.Base.html#1273" class="Bound">A</a><a id="1274" class="Symbol">}</a> <a id="1276" class="Symbol">→</a> <a id="1278" href="Data.These.Effectful.Right.Base.html#933" class="Function">Theseᵣ</a> <a id="1285" class="Symbol">(</a><a id="1286" href="Data.These.Effectful.Right.Base.html#1178" class="Bound">F</a> <a id="1288" href="Data.These.Effectful.Right.Base.html#1273" class="Bound">A</a><a id="1289" class="Symbol">)</a> <a id="1291" class="Symbol">→</a> <a id="1293" href="Data.These.Effectful.Right.Base.html#1178" class="Bound">F</a> <a id="1295" class="Symbol">(</a><a id="1296" href="Data.These.Effectful.Right.Base.html#933" class="Function">Theseᵣ</a> <a id="1303" href="Data.These.Effectful.Right.Base.html#1273" class="Bound">A</a><a id="1304" class="Symbol">)</a>
  <a id="1308" href="Data.These.Effectful.Right.Base.html#1258" class="Function">sequenceA</a> <a id="1318" class="Symbol">(</a><a id="1319" href="Data.These.Base.html#631" class="InductiveConstructor">this</a> <a id="1324" href="Data.These.Effectful.Right.Base.html#1324" class="Bound">a</a><a id="1325" class="Symbol">)</a>    <a id="1330" class="Symbol">=</a> <a id="1332" href="Data.These.Base.html#631" class="InductiveConstructor">this</a> <a id="1337" href="Effect.Functor.html#710" class="Function Operator">&lt;$&gt;</a> <a id="1341" href="Data.These.Effectful.Right.Base.html#1324" class="Bound">a</a>
  <a id="1345" href="Data.These.Effectful.Right.Base.html#1258" class="Function">sequenceA</a> <a id="1355" class="Symbol">(</a><a id="1356" href="Data.These.Base.html#659" class="InductiveConstructor">that</a> <a id="1361" href="Data.These.Effectful.Right.Base.html#1361" class="Bound">b</a><a id="1362" class="Symbol">)</a>    <a id="1367" class="Symbol">=</a> <a id="1369" href="Effect.Applicative.html#1145" class="Field">pure</a> <a id="1374" class="Symbol">(</a><a id="1375" href="Data.These.Base.html#659" class="InductiveConstructor">that</a> <a id="1380" href="Data.These.Effectful.Right.Base.html#1361" class="Bound">b</a><a id="1381" class="Symbol">)</a>
  <a id="1385" href="Data.These.Effectful.Right.Base.html#1258" class="Function">sequenceA</a> <a id="1395" class="Symbol">(</a><a id="1396" href="Data.These.Base.html#687" class="InductiveConstructor">these</a> <a id="1402" href="Data.These.Effectful.Right.Base.html#1402" class="Bound">a</a> <a id="1404" href="Data.These.Effectful.Right.Base.html#1404" class="Bound">b</a><a id="1405" class="Symbol">)</a> <a id="1407" class="Symbol">=</a> <a id="1409" href="Function.Base.html#1638" class="Function">flip</a> <a id="1414" href="Data.These.Base.html#687" class="InductiveConstructor">these</a> <a id="1420" href="Data.These.Effectful.Right.Base.html#1404" class="Bound">b</a> <a id="1422" href="Effect.Functor.html#710" class="Function Operator">&lt;$&gt;</a> <a id="1426" href="Data.These.Effectful.Right.Base.html#1402" class="Bound">a</a>

  <a id="1431" href="Data.These.Effectful.Right.Base.html#1431" class="Function">mapA</a> <a id="1436" class="Symbol">:</a> <a id="1438" class="Symbol">∀</a> <a id="1440" class="Symbol">{</a><a id="1441" href="Data.These.Effectful.Right.Base.html#1441" class="Bound">A</a> <a id="1443" href="Data.These.Effectful.Right.Base.html#1443" class="Bound">B</a><a id="1444" class="Symbol">}</a> <a id="1446" class="Symbol">→</a> <a id="1448" class="Symbol">(</a><a id="1449" href="Data.These.Effectful.Right.Base.html#1441" class="Bound">A</a> <a id="1451" class="Symbol">→</a> <a id="1453" href="Data.These.Effectful.Right.Base.html#1178" class="Bound">F</a> <a id="1455" href="Data.These.Effectful.Right.Base.html#1443" class="Bound">B</a><a id="1456" class="Symbol">)</a> <a id="1458" class="Symbol">→</a> <a id="1460" href="Data.These.Effectful.Right.Base.html#933" class="Function">Theseᵣ</a> <a id="1467" href="Data.These.Effectful.Right.Base.html#1441" class="Bound">A</a> <a id="1469" class="Symbol">→</a> <a id="1471" href="Data.These.Effectful.Right.Base.html#1178" class="Bound">F</a> <a id="1473" class="Symbol">(</a><a id="1474" href="Data.These.Effectful.Right.Base.html#933" class="Function">Theseᵣ</a> <a id="1481" href="Data.These.Effectful.Right.Base.html#1443" class="Bound">B</a><a id="1482" class="Symbol">)</a>
  <a id="1486" href="Data.These.Effectful.Right.Base.html#1431" class="Function">mapA</a> <a id="1491" href="Data.These.Effectful.Right.Base.html#1491" class="Bound">f</a> <a id="1493" class="Symbol">=</a> <a id="1495" href="Data.These.Effectful.Right.Base.html#1258" class="Function">sequenceA</a> <a id="1505" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1507" href="Data.These.Base.html#1041" class="Function">map₁</a> <a id="1512" href="Data.These.Effectful.Right.Base.html#1491" class="Bound">f</a>

  <a id="1517" href="Data.These.Effectful.Right.Base.html#1517" class="Function">forA</a> <a id="1522" class="Symbol">:</a> <a id="1524" class="Symbol">∀</a> <a id="1526" class="Symbol">{</a><a id="1527" href="Data.These.Effectful.Right.Base.html#1527" class="Bound">A</a> <a id="1529" href="Data.These.Effectful.Right.Base.html#1529" class="Bound">B</a><a id="1530" class="Symbol">}</a> <a id="1532" class="Symbol">→</a> <a id="1534" href="Data.These.Effectful.Right.Base.html#933" class="Function">Theseᵣ</a> <a id="1541" href="Data.These.Effectful.Right.Base.html#1527" class="Bound">A</a> <a id="1543" class="Symbol">→</a> <a id="1545" class="Symbol">(</a><a id="1546" href="Data.These.Effectful.Right.Base.html#1527" class="Bound">A</a> <a id="1548" class="Symbol">→</a> <a id="1550" href="Data.These.Effectful.Right.Base.html#1178" class="Bound">F</a> <a id="1552" href="Data.These.Effectful.Right.Base.html#1529" class="Bound">B</a><a id="1553" class="Symbol">)</a> <a id="1555" class="Symbol">→</a> <a id="1557" href="Data.These.Effectful.Right.Base.html#1178" class="Bound">F</a> <a id="1559" class="Symbol">(</a><a id="1560" href="Data.These.Effectful.Right.Base.html#933" class="Function">Theseᵣ</a> <a id="1567" href="Data.These.Effectful.Right.Base.html#1529" class="Bound">B</a><a id="1568" class="Symbol">)</a>
  <a id="1572" href="Data.These.Effectful.Right.Base.html#1517" class="Function">forA</a> <a id="1577" class="Symbol">=</a> <a id="1579" href="Function.Base.html#1638" class="Function">flip</a> <a id="1584" href="Data.These.Effectful.Right.Base.html#1431" class="Function">mapA</a>

<a id="1590" class="Keyword">module</a> <a id="1597" href="Data.These.Effectful.Right.Base.html#1597" class="Module">_</a> <a id="1599" class="Symbol">{</a><a id="1600" href="Data.These.Effectful.Right.Base.html#1600" class="Bound">M</a><a id="1601" class="Symbol">}</a> <a id="1603" class="Symbol">(</a><a id="1604" href="Data.These.Effectful.Right.Base.html#1604" class="Bound">Mon</a> <a id="1608" class="Symbol">:</a> <a id="1610" href="Effect.Monad.html#899" class="Record">RawMonad</a> <a id="1619" class="Symbol">{</a><a id="1620" href="Data.These.Effectful.Right.Base.html#645" class="Bound">a</a> <a id="1622" href="Agda.Primitive.html#961" class="Primitive Operator">⊔</a> <a id="1624" href="Data.These.Effectful.Right.Base.html#657" class="Bound">b</a><a id="1625" class="Symbol">}</a> <a id="1627" class="Symbol">{</a><a id="1628" href="Data.These.Effectful.Right.Base.html#645" class="Bound">a</a> <a id="1630" href="Agda.Primitive.html#961" class="Primitive Operator">⊔</a> <a id="1632" href="Data.These.Effectful.Right.Base.html#657" class="Bound">b</a><a id="1633" class="Symbol">}</a> <a id="1635" href="Data.These.Effectful.Right.Base.html#1600" class="Bound">M</a><a id="1636" class="Symbol">)</a> <a id="1638" class="Keyword">where</a>

  <a id="1647" class="Keyword">private</a> <a id="1655" href="Data.These.Effectful.Right.Base.html#1655" class="Function">App</a> <a id="1659" class="Symbol">=</a> <a id="1661" href="Effect.Monad.html#1015" class="Field">RawMonad.rawApplicative</a> <a id="1685" href="Data.These.Effectful.Right.Base.html#1604" class="Bound">Mon</a>

  <a id="1692" href="Data.These.Effectful.Right.Base.html#1692" class="Function">sequenceM</a> <a id="1702" class="Symbol">:</a> <a id="1704" class="Symbol">∀</a> <a id="1706" class="Symbol">{</a><a id="1707" href="Data.These.Effectful.Right.Base.html#1707" class="Bound">A</a><a id="1708" class="Symbol">}</a> <a id="1710" class="Symbol">→</a> <a id="1712" href="Data.These.Effectful.Right.Base.html#933" class="Function">Theseᵣ</a> <a id="1719" class="Symbol">(</a><a id="1720" href="Data.These.Effectful.Right.Base.html#1600" class="Bound">M</a> <a id="1722" href="Data.These.Effectful.Right.Base.html#1707" class="Bound">A</a><a id="1723" class="Symbol">)</a> <a id="1725" class="Symbol">→</a> <a id="1727" href="Data.These.Effectful.Right.Base.html#1600" class="Bound">M</a> <a id="1729" class="Symbol">(</a><a id="1730" href="Data.These.Effectful.Right.Base.html#933" class="Function">Theseᵣ</a> <a id="1737" href="Data.These.Effectful.Right.Base.html#1707" class="Bound">A</a><a id="1738" class="Symbol">)</a>
  <a id="1742" href="Data.These.Effectful.Right.Base.html#1692" class="Function">sequenceM</a> <a id="1752" class="Symbol">=</a> <a id="1754" href="Data.These.Effectful.Right.Base.html#1258" class="Function">sequenceA</a> <a id="1764" href="Data.These.Effectful.Right.Base.html#1655" class="Function">App</a>

  <a id="1771" href="Data.These.Effectful.Right.Base.html#1771" class="Function">mapM</a> <a id="1776" class="Symbol">:</a> <a id="1778" class="Symbol">∀</a> <a id="1780" class="Symbol">{</a><a id="1781" href="Data.These.Effectful.Right.Base.html#1781" class="Bound">A</a> <a id="1783" href="Data.These.Effectful.Right.Base.html#1783" class="Bound">B</a><a id="1784" class="Symbol">}</a> <a id="1786" class="Symbol">→</a> <a id="1788" class="Symbol">(</a><a id="1789" href="Data.These.Effectful.Right.Base.html#1781" class="Bound">A</a> <a id="1791" class="Symbol">→</a> <a id="1793" href="Data.These.Effectful.Right.Base.html#1600" class="Bound">M</a> <a id="1795" href="Data.These.Effectful.Right.Base.html#1783" class="Bound">B</a><a id="1796" class="Symbol">)</a> <a id="1798" class="Symbol">→</a> <a id="1800" href="Data.These.Effectful.Right.Base.html#933" class="Function">Theseᵣ</a> <a id="1807" href="Data.These.Effectful.Right.Base.html#1781" class="Bound">A</a> <a id="1809" class="Symbol">→</a> <a id="1811" href="Data.These.Effectful.Right.Base.html#1600" class="Bound">M</a> <a id="1813" class="Symbol">(</a><a id="1814" href="Data.These.Effectful.Right.Base.html#933" class="Function">Theseᵣ</a> <a id="1821" href="Data.These.Effectful.Right.Base.html#1783" class="Bound">B</a><a id="1822" class="Symbol">)</a>
  <a id="1826" href="Data.These.Effectful.Right.Base.html#1771" class="Function">mapM</a> <a id="1831" class="Symbol">=</a> <a id="1833" href="Data.These.Effectful.Right.Base.html#1431" class="Function">mapA</a> <a id="1838" href="Data.These.Effectful.Right.Base.html#1655" class="Function">App</a>

  <a id="1845" href="Data.These.Effectful.Right.Base.html#1845" class="Function">forM</a> <a id="1850" class="Symbol">:</a> <a id="1852" class="Symbol">∀</a> <a id="1854" class="Symbol">{</a><a id="1855" href="Data.These.Effectful.Right.Base.html#1855" class="Bound">A</a> <a id="1857" href="Data.These.Effectful.Right.Base.html#1857" class="Bound">B</a><a id="1858" class="Symbol">}</a> <a id="1860" class="Symbol">→</a> <a id="1862" href="Data.These.Effectful.Right.Base.html#933" class="Function">Theseᵣ</a> <a id="1869" href="Data.These.Effectful.Right.Base.html#1855" class="Bound">A</a> <a id="1871" class="Symbol">→</a> <a id="1873" class="Symbol">(</a><a id="1874" href="Data.These.Effectful.Right.Base.html#1855" class="Bound">A</a> <a id="1876" class="Symbol">→</a> <a id="1878" href="Data.These.Effectful.Right.Base.html#1600" class="Bound">M</a> <a id="1880" href="Data.These.Effectful.Right.Base.html#1857" class="Bound">B</a><a id="1881" class="Symbol">)</a> <a id="1883" class="Symbol">→</a> <a id="1885" href="Data.These.Effectful.Right.Base.html#1600" class="Bound">M</a> <a id="1887" class="Symbol">(</a><a id="1888" href="Data.These.Effectful.Right.Base.html#933" class="Function">Theseᵣ</a> <a id="1895" href="Data.These.Effectful.Right.Base.html#1857" class="Bound">B</a><a id="1896" class="Symbol">)</a>
  <a id="1900" href="Data.These.Effectful.Right.Base.html#1845" class="Function">forM</a> <a id="1905" class="Symbol">=</a> <a id="1907" href="Data.These.Effectful.Right.Base.html#1517" class="Function">forA</a> <a id="1912" href="Data.These.Effectful.Right.Base.html#1655" class="Function">App</a>
</pre></body></html>