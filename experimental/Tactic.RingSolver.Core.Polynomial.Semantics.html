<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.RingSolver.Core.Polynomial.Semantics</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- &quot;Evaluating&quot; a polynomial, using Horner&#39;s method.</a>
<a id="159" class="Comment">------------------------------------------------------------------------</a>

<a id="233" class="Symbol">{-#</a> <a id="237" class="Keyword">OPTIONS</a> <a id="245" class="Pragma">--without-K</a> <a id="257" class="Pragma">--safe</a> <a id="264" class="Symbol">#-}</a>

<a id="269" class="Keyword">open</a> <a id="274" class="Keyword">import</a> <a id="281" href="Tactic.RingSolver.Core.Polynomial.Parameters.html" class="Module">Tactic.RingSolver.Core.Polynomial.Parameters</a>

<a id="327" class="Keyword">module</a> <a id="334" href="Tactic.RingSolver.Core.Polynomial.Semantics.html" class="Module">Tactic.RingSolver.Core.Polynomial.Semantics</a>
  <a id="380" class="Symbol">{</a><a id="381" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#381" class="Bound">r₁</a> <a id="384" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#384" class="Bound">r₂</a> <a id="387" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#387" class="Bound">r₃</a> <a id="390" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#390" class="Bound">r₄</a><a id="392" class="Symbol">}</a>
  <a id="396" class="Symbol">(</a><a id="397" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#397" class="Bound">homo</a> <a id="402" class="Symbol">:</a> <a id="404" href="Tactic.RingSolver.Core.Polynomial.Parameters.html#1104" class="Record">Homomorphism</a> <a id="417" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#381" class="Bound">r₁</a> <a id="420" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#384" class="Bound">r₂</a> <a id="423" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#387" class="Bound">r₃</a> <a id="426" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#390" class="Bound">r₄</a><a id="428" class="Symbol">)</a>
  <a id="432" class="Keyword">where</a>

<a id="439" class="Keyword">open</a> <a id="444" class="Keyword">import</a> <a id="451" href="Data.Nat.html" class="Module">Data.Nat</a>     <a id="464" class="Keyword">using</a> <a id="470" class="Symbol">(</a><a id="471" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="472" class="Symbol">;</a> <a id="474" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="477" class="Symbol">;</a> <a id="479" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="483" class="Symbol">;</a> <a id="485" href="Data.Nat.Base.html#3879" class="Datatype Operator">_≤′_</a><a id="489" class="Symbol">;</a> <a id="491" href="Data.Nat.Base.html#3953" class="InductiveConstructor">≤′-step</a><a id="498" class="Symbol">;</a> <a id="500" href="Data.Nat.Base.html#3910" class="InductiveConstructor">≤′-refl</a><a id="507" class="Symbol">)</a>
<a id="509" class="Keyword">open</a> <a id="514" class="Keyword">import</a> <a id="521" href="Data.Vec.html" class="Module">Data.Vec</a>     <a id="534" class="Keyword">using</a> <a id="540" class="Symbol">(</a><a id="541" href="Data.Vec.Base.html#998" class="Datatype">Vec</a><a id="544" class="Symbol">;</a> <a id="546" href="Data.Vec.Base.html#1034" class="InductiveConstructor">[]</a><a id="548" class="Symbol">;</a> <a id="550" href="Data.Vec.Base.html#1053" class="InductiveConstructor Operator">_∷_</a><a id="553" class="Symbol">;</a> <a id="555" href="Data.Vec.Base.html#7250" class="Function">uncons</a><a id="561" class="Symbol">)</a>
<a id="563" class="Keyword">open</a> <a id="568" class="Keyword">import</a> <a id="575" href="Data.List.html" class="Module">Data.List</a>    <a id="588" class="Keyword">using</a> <a id="594" class="Symbol">(</a><a id="595" href="Data.List.Base.html#10383" class="InductiveConstructor">[]</a><a id="597" class="Symbol">;</a> <a id="599" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="602" class="Symbol">)</a>
<a id="604" class="Keyword">open</a> <a id="609" class="Keyword">import</a> <a id="616" href="Data.Product.html" class="Module">Data.Product</a> <a id="629" class="Keyword">using</a> <a id="635" class="Symbol">(</a><a id="636" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="639" class="Symbol">;</a> <a id="641" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="644" class="Symbol">)</a>
<a id="646" class="Keyword">open</a> <a id="651" class="Keyword">import</a> <a id="658" href="Data.List.Kleene.html" class="Module">Data.List.Kleene</a> <a id="675" class="Keyword">using</a> <a id="681" class="Symbol">(</a><a id="682" href="Data.List.Kleene.Base.html#1533" class="Record Operator">_+</a><a id="684" class="Symbol">;</a> <a id="686" href="Data.List.Kleene.Base.html#1565" class="Datatype Operator">_*</a><a id="688" class="Symbol">;</a> <a id="690" href="Data.List.Kleene.Base.html#1750" class="InductiveConstructor Operator">∹_</a><a id="692" class="Symbol">;</a> <a id="694" href="Data.List.Kleene.Base.html#1656" class="InductiveConstructor Operator">_&amp;_</a><a id="697" class="Symbol">;</a> <a id="699" href="Data.List.Kleene.Base.html#1739" class="InductiveConstructor">[]</a><a id="701" class="Symbol">)</a>

<a id="704" class="Keyword">open</a> <a id="709" href="Tactic.RingSolver.Core.Polynomial.Parameters.html#1104" class="Module">Homomorphism</a> <a id="722" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#397" class="Bound">homo</a> <a id="727" class="Keyword">hiding</a> <a id="734" class="Symbol">(</a><a id="735" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#2408" class="Function Operator">_^_</a><a id="738" class="Symbol">)</a>
<a id="740" class="Keyword">open</a> <a id="745" class="Keyword">import</a> <a id="752" href="Tactic.RingSolver.Core.Polynomial.Base.html" class="Module">Tactic.RingSolver.Core.Polynomial.Base</a> <a id="791" href="Tactic.RingSolver.Core.Polynomial.Parameters.html#1179" class="Field">from</a>
<a id="796" class="Keyword">open</a> <a id="801" class="Keyword">import</a> <a id="808" href="Algebra.Properties.Semiring.Exp.TCOptimised.html" class="Module">Algebra.Properties.Semiring.Exp.TCOptimised</a> <a id="852" href="Algebra.Bundles.html#17812" class="Function">semiring</a>

<a id="drop"></a><a id="862" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#862" class="Function">drop</a> <a id="867" class="Symbol">:</a> <a id="869" class="Symbol">∀</a> <a id="871" class="Symbol">{</a><a id="872" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#872" class="Bound">i</a> <a id="874" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#874" class="Bound">n</a><a id="875" class="Symbol">}</a> <a id="877" class="Symbol">→</a> <a id="879" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#872" class="Bound">i</a> <a id="881" href="Data.Nat.Base.html#3879" class="Datatype Operator">≤′</a> <a id="884" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#874" class="Bound">n</a> <a id="886" class="Symbol">→</a> <a id="888" href="Data.Vec.Base.html#998" class="Datatype">Vec</a> <a id="892" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1387" class="Function">Carrier</a> <a id="900" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#874" class="Bound">n</a> <a id="902" class="Symbol">→</a> <a id="904" href="Data.Vec.Base.html#998" class="Datatype">Vec</a> <a id="908" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1387" class="Function">Carrier</a> <a id="916" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#872" class="Bound">i</a>
<a id="918" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#862" class="Function">drop</a> <a id="923" href="Data.Nat.Base.html#3910" class="InductiveConstructor">≤′-refl</a>         <a id="939" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#939" class="Bound">xs</a>       <a id="948" class="Symbol">=</a> <a id="950" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#939" class="Bound">xs</a>
<a id="953" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#862" class="Function">drop</a> <a id="958" class="Symbol">(</a><a id="959" href="Data.Nat.Base.html#3953" class="InductiveConstructor">≤′-step</a> <a id="967" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#967" class="Bound">i+1≤n</a><a id="972" class="Symbol">)</a> <a id="974" class="Symbol">(_</a> <a id="977" href="Data.Vec.Base.html#1053" class="InductiveConstructor Operator">∷</a> <a id="979" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#979" class="Bound">xs</a><a id="981" class="Symbol">)</a> <a id="983" class="Symbol">=</a> <a id="985" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#862" class="Function">drop</a> <a id="990" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#967" class="Bound">i+1≤n</a> <a id="996" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#979" class="Bound">xs</a>

<a id="drop-1"></a><a id="1000" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1000" class="Function">drop-1</a> <a id="1007" class="Symbol">:</a> <a id="1009" class="Symbol">∀</a> <a id="1011" class="Symbol">{</a><a id="1012" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1012" class="Bound">i</a> <a id="1014" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1014" class="Bound">n</a><a id="1015" class="Symbol">}</a> <a id="1017" class="Symbol">→</a> <a id="1019" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1023" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1012" class="Bound">i</a> <a id="1025" href="Data.Nat.Base.html#3879" class="Datatype Operator">≤′</a> <a id="1028" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1014" class="Bound">n</a> <a id="1030" class="Symbol">→</a> <a id="1032" href="Data.Vec.Base.html#998" class="Datatype">Vec</a> <a id="1036" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1387" class="Function">Carrier</a> <a id="1044" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1014" class="Bound">n</a> <a id="1046" class="Symbol">→</a> <a id="1048" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1387" class="Function">Carrier</a> <a id="1056" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1058" href="Data.Vec.Base.html#998" class="Datatype">Vec</a> <a id="1062" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1387" class="Function">Carrier</a> <a id="1070" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1012" class="Bound">i</a>
<a id="1072" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1000" class="Function">drop-1</a> <a id="1079" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1079" class="Bound">si≤n</a> <a id="1084" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1084" class="Bound">xs</a> <a id="1087" class="Symbol">=</a> <a id="1089" href="Data.Vec.Base.html#7250" class="Function">uncons</a> <a id="1096" class="Symbol">(</a><a id="1097" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#862" class="Function">drop</a> <a id="1102" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1079" class="Bound">si≤n</a> <a id="1107" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1084" class="Bound">xs</a><a id="1109" class="Symbol">)</a>
<a id="1111" class="Symbol">{-#</a> <a id="1115" class="Keyword">INLINE</a> <a id="1122" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1000" class="Function">drop-1</a> <a id="1129" class="Symbol">#-}</a>

<a id="_*⟨_⟩^_"></a><a id="1134" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1134" class="Function Operator">_*⟨_⟩^_</a> <a id="1142" class="Symbol">:</a> <a id="1144" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1387" class="Function">Carrier</a> <a id="1152" class="Symbol">→</a> <a id="1154" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1387" class="Function">Carrier</a> <a id="1162" class="Symbol">→</a> <a id="1164" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1166" class="Symbol">→</a> <a id="1168" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1387" class="Function">Carrier</a>
<a id="1176" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1176" class="Bound">x</a> <a id="1178" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1134" class="Function Operator">*⟨</a> <a id="1181" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1181" class="Bound">ρ</a> <a id="1183" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1134" class="Function Operator">⟩^</a> <a id="1186" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="1191" class="Symbol">=</a> <a id="1193" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1176" class="Bound">x</a>
<a id="1195" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1195" class="Bound">x</a> <a id="1197" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1134" class="Function Operator">*⟨</a> <a id="1200" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1200" class="Bound">ρ</a> <a id="1202" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1134" class="Function Operator">⟩^</a> <a id="1205" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1209" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1209" class="Bound">i</a> <a id="1211" class="Symbol">=</a> <a id="1213" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1200" class="Bound">ρ</a> <a id="1215" href="Algebra.Properties.Semiring.Exp.TCOptimised.html#1015" class="Function Operator">^</a> <a id="1217" class="Symbol">(</a><a id="1218" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1222" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1209" class="Bound">i</a><a id="1223" class="Symbol">)</a> <a id="1225" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1509" class="Function Operator">*</a> <a id="1227" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1195" class="Bound">x</a>
<a id="1229" class="Symbol">{-#</a> <a id="1233" class="Keyword">INLINE</a> <a id="1240" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1134" class="Function Operator">_*⟨_⟩^_</a> <a id="1248" class="Symbol">#-}</a>

<a id="1253" class="Comment">--------------------------------------------------------------------------------</a>
<a id="1334" class="Comment">-- Evaluation</a>
<a id="1348" class="Comment">--------------------------------------------------------------------------------</a>
<a id="1429" class="Comment">-- Why do we have three functions here? Why are they so weird looking?</a>
<a id="1500" class="Comment">--</a>
<a id="1503" class="Comment">-- These three functions are the main bottleneck for all of the proofs: as such,</a>
<a id="1584" class="Comment">-- slight changes can dramatically affect the length of proof code.</a>

<a id="1653" class="Keyword">mutual</a>

  <a id="_⟦∷⟧_"></a><a id="1663" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1663" class="Function Operator">_⟦∷⟧_</a> <a id="1669" class="Symbol">:</a> <a id="1671" class="Symbol">∀</a> <a id="1673" class="Symbol">{</a><a id="1674" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1674" class="Bound">n</a><a id="1675" class="Symbol">}</a> <a id="1677" class="Symbol">→</a> <a id="1679" href="Tactic.RingSolver.Core.Polynomial.Base.html#4200" class="Record">Poly</a> <a id="1684" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1674" class="Bound">n</a> <a id="1686" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1688" href="Tactic.RingSolver.Core.Polynomial.Base.html#4249" class="Function">Coeff</a> <a id="1694" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1674" class="Bound">n</a> <a id="1696" href="Data.List.Kleene.Base.html#1565" class="Datatype Operator">*</a> <a id="1698" class="Symbol">→</a> <a id="1700" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1387" class="Function">Carrier</a> <a id="1708" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1710" href="Data.Vec.Base.html#998" class="Datatype">Vec</a> <a id="1714" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1387" class="Function">Carrier</a> <a id="1722" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1674" class="Bound">n</a> <a id="1724" class="Symbol">→</a> <a id="1726" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1387" class="Function">Carrier</a>
  <a id="1736" class="Symbol">(</a><a id="1737" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1737" class="Bound">x</a> <a id="1739" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1741" href="Data.List.Kleene.Base.html#1739" class="InductiveConstructor">[]</a><a id="1743" class="Symbol">)</a>     <a id="1749" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1663" class="Function Operator">⟦∷⟧</a> <a id="1753" class="Symbol">(</a><a id="1754" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1754" class="Bound">ρ</a> <a id="1756" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1758" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1758" class="Bound">ρs</a><a id="1760" class="Symbol">)</a> <a id="1762" class="Symbol">=</a> <a id="1764" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1992" class="Function Operator">⟦</a> <a id="1766" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1737" class="Bound">x</a> <a id="1768" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1992" class="Function Operator">⟧</a> <a id="1770" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1758" class="Bound">ρs</a>
  <a id="1775" class="Symbol">(</a><a id="1776" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1776" class="Bound">x</a> <a id="1778" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1780" class="Symbol">(</a><a id="1781" href="Data.List.Kleene.Base.html#1750" class="InductiveConstructor Operator">∹</a> <a id="1783" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1783" class="Bound">xs</a><a id="1785" class="Symbol">))</a> <a id="1788" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1663" class="Function Operator">⟦∷⟧</a> <a id="1792" class="Symbol">(</a><a id="1793" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1793" class="Bound">ρ</a> <a id="1795" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1797" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1797" class="Bound">ρs</a><a id="1799" class="Symbol">)</a> <a id="1801" class="Symbol">=</a> <a id="1803" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1793" class="Bound">ρ</a> <a id="1805" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1509" class="Function Operator">*</a> <a id="1807" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1838" class="Function Operator">⅀⟦</a> <a id="1810" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1783" class="Bound">xs</a> <a id="1813" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1838" class="Function Operator">⟧</a> <a id="1815" class="Symbol">(</a><a id="1816" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1793" class="Bound">ρ</a> <a id="1818" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1820" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1797" class="Bound">ρs</a><a id="1822" class="Symbol">)</a> <a id="1824" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1467" class="Function Operator">+</a> <a id="1826" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1992" class="Function Operator">⟦</a> <a id="1828" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1776" class="Bound">x</a> <a id="1830" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1992" class="Function Operator">⟧</a> <a id="1832" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1797" class="Bound">ρs</a>

  <a id="⅀⟦_⟧"></a><a id="1838" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1838" class="Function Operator">⅀⟦_⟧</a> <a id="1843" class="Symbol">:</a> <a id="1845" class="Symbol">∀</a> <a id="1847" class="Symbol">{</a><a id="1848" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1848" class="Bound">n</a><a id="1849" class="Symbol">}</a> <a id="1851" class="Symbol">→</a> <a id="1853" href="Tactic.RingSolver.Core.Polynomial.Base.html#4249" class="Function">Coeff</a> <a id="1859" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1848" class="Bound">n</a> <a id="1861" href="Data.List.Kleene.Base.html#1533" class="Record Operator">+</a> <a id="1863" class="Symbol">→</a> <a id="1865" class="Symbol">(</a><a id="1866" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1387" class="Function">Carrier</a> <a id="1874" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1876" href="Data.Vec.Base.html#998" class="Datatype">Vec</a> <a id="1880" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1387" class="Function">Carrier</a> <a id="1888" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1848" class="Bound">n</a><a id="1889" class="Symbol">)</a> <a id="1891" class="Symbol">→</a> <a id="1893" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1387" class="Function">Carrier</a>
  <a id="1903" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1838" class="Function Operator">⅀⟦</a> <a id="1906" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1906" class="Bound">x</a> <a id="1908" href="Tactic.RingSolver.Core.Polynomial.Base.html#4958" class="InductiveConstructor Operator">≠0</a> <a id="1911" href="Tactic.RingSolver.Core.Polynomial.Base.html#4132" class="InductiveConstructor Operator">Δ</a> <a id="1913" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1913" class="Bound">i</a> <a id="1915" href="Data.List.Kleene.Base.html#1656" class="InductiveConstructor Operator">&amp;</a> <a id="1917" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1917" class="Bound">xs</a> <a id="1920" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1838" class="Function Operator">⟧</a> <a id="1922" class="Symbol">(</a><a id="1923" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1923" class="Bound">ρ</a> <a id="1925" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1927" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1927" class="Bound">ρs</a><a id="1929" class="Symbol">)</a> <a id="1931" class="Symbol">=</a> <a id="1933" class="Symbol">((</a><a id="1935" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1906" class="Bound">x</a> <a id="1937" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1939" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1917" class="Bound">xs</a><a id="1941" class="Symbol">)</a> <a id="1943" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1663" class="Function Operator">⟦∷⟧</a> <a id="1947" class="Symbol">(</a><a id="1948" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1923" class="Bound">ρ</a> <a id="1950" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1952" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1927" class="Bound">ρs</a><a id="1954" class="Symbol">))</a> <a id="1957" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1134" class="Function Operator">*⟨</a> <a id="1960" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1923" class="Bound">ρ</a> <a id="1962" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1134" class="Function Operator">⟩^</a> <a id="1965" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1913" class="Bound">i</a>
  <a id="1969" class="Symbol">{-#</a> <a id="1973" class="Keyword">INLINE</a> <a id="1980" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1838" class="Function Operator">⅀⟦_⟧</a> <a id="1985" class="Symbol">#-}</a>

  <a id="⟦_⟧"></a><a id="1992" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1992" class="Function Operator">⟦_⟧</a> <a id="1996" class="Symbol">:</a> <a id="1998" class="Symbol">∀</a> <a id="2000" class="Symbol">{</a><a id="2001" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#2001" class="Bound">n</a><a id="2002" class="Symbol">}</a> <a id="2004" class="Symbol">→</a> <a id="2006" href="Tactic.RingSolver.Core.Polynomial.Base.html#4200" class="Record">Poly</a> <a id="2011" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#2001" class="Bound">n</a> <a id="2013" class="Symbol">→</a> <a id="2015" href="Data.Vec.Base.html#998" class="Datatype">Vec</a> <a id="2019" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1387" class="Function">Carrier</a> <a id="2027" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#2001" class="Bound">n</a> <a id="2029" class="Symbol">→</a> <a id="2031" href="Tactic.RingSolver.Core.AlmostCommutativeRing.html#1387" class="Function">Carrier</a>
  <a id="2041" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1992" class="Function Operator">⟦</a> <a id="2043" href="Tactic.RingSolver.Core.Polynomial.Base.html#4632" class="InductiveConstructor">Κ</a> <a id="2045" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#2045" class="Bound">x</a>  <a id="2048" href="Tactic.RingSolver.Core.Polynomial.Base.html#4492" class="InductiveConstructor Operator">⊐</a> <a id="2050" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#2050" class="Bound">i≤n</a> <a id="2054" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1992" class="Function Operator">⟧</a> <a id="2056" class="Symbol">_</a> <a id="2058" class="Symbol">=</a> <a id="2060" href="Tactic.RingSolver.Core.Polynomial.Parameters.html#1431" class="Function Operator">⟦</a> <a id="2062" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#2045" class="Bound">x</a> <a id="2064" href="Tactic.RingSolver.Core.Polynomial.Parameters.html#1431" class="Function Operator">⟧ᵣ</a>
  <a id="2069" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1992" class="Function Operator">⟦</a> <a id="2071" href="Tactic.RingSolver.Core.Polynomial.Base.html#4662" class="InductiveConstructor">⅀</a> <a id="2073" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#2073" class="Bound">xs</a> <a id="2076" href="Tactic.RingSolver.Core.Polynomial.Base.html#4492" class="InductiveConstructor Operator">⊐</a> <a id="2078" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#2078" class="Bound">i≤n</a> <a id="2082" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1992" class="Function Operator">⟧</a> <a id="2084" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#2084" class="Bound">Ρ</a> <a id="2086" class="Symbol">=</a> <a id="2088" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1838" class="Function Operator">⅀⟦</a> <a id="2091" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#2073" class="Bound">xs</a> <a id="2094" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1838" class="Function Operator">⟧</a> <a id="2096" class="Symbol">(</a><a id="2097" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1000" class="Function">drop-1</a> <a id="2104" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#2078" class="Bound">i≤n</a> <a id="2108" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#2084" class="Bound">Ρ</a><a id="2109" class="Symbol">)</a>
  <a id="2113" class="Symbol">{-#</a> <a id="2117" class="Keyword">INLINE</a> <a id="2124" href="Tactic.RingSolver.Core.Polynomial.Semantics.html#1992" class="Function Operator">⟦_⟧</a> <a id="2128" class="Symbol">#-}</a>

<a id="2133" class="Comment">--------------------------------------------------------------------------------</a>
<a id="2214" class="Comment">-- Performance</a>
<a id="2229" class="Comment">--------------------------------------------------------------------------------</a>
<a id="2310" class="Comment">-- As you might imagine, the implementation of the functions above seriously</a>
<a id="2387" class="Comment">-- affect performance. What you might not realise, though, is that the most</a>
<a id="2463" class="Comment">-- important component is the *order of the arguments*. For instance, if</a>
<a id="2536" class="Comment">-- we change:</a>
<a id="2550" class="Comment">--</a>
<a id="2553" class="Comment">--   (x , xs) ⟦∷⟧ (ρ , ρs) = ρ * ⅀⟦ xs ⟧ (ρ , ρs) + ⟦ x ⟧ ρs</a>
<a id="2614" class="Comment">--</a>
<a id="2617" class="Comment">-- To:</a>
<a id="2624" class="Comment">--</a>
<a id="2627" class="Comment">--   (x , xs) ⟦∷⟧ (ρ , ρs) = ⟦ x ⟧ ρs +  ⅀⟦ xs ⟧ (ρ , ρs) * ρ</a>
<a id="2689" class="Comment">--</a>
<a id="2692" class="Comment">-- We get a function that&#39;s several orders of magnitude slower!</a>
</pre></body></html>