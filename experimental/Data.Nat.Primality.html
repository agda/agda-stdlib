<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Nat.Primality</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Primality</a>
<a id="119" class="Comment">------------------------------------------------------------------------</a>

<a id="193" class="Symbol">{-#</a> <a id="197" class="Keyword">OPTIONS</a> <a id="205" class="Pragma">--cubical-compatible</a> <a id="226" class="Pragma">--safe</a> <a id="233" class="Symbol">#-}</a>

<a id="238" class="Keyword">module</a> <a id="245" href="Data.Nat.Primality.html" class="Module">Data.Nat.Primality</a> <a id="264" class="Keyword">where</a>

<a id="271" class="Keyword">open</a> <a id="276" class="Keyword">import</a> <a id="283" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="298" class="Keyword">using</a> <a id="304" class="Symbol">(</a><a id="305" href="Data.List.Base.html#7599" class="InductiveConstructor">[]</a><a id="307" class="Symbol">;</a> <a id="309" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">_∷_</a><a id="312" class="Symbol">;</a> <a id="314" href="Data.List.Base.html#5000" class="Function">product</a><a id="321" class="Symbol">)</a>
<a id="323" class="Keyword">open</a> <a id="328" class="Keyword">import</a> <a id="335" href="Data.List.Properties.html" class="Module">Data.List.Properties</a> <a id="356" class="Keyword">using</a> <a id="362" class="Symbol">(</a><a id="363" href="Data.List.Properties.html#33082" class="Function">product≢0</a><a id="372" class="Symbol">)</a>
<a id="374" class="Keyword">open</a> <a id="379" class="Keyword">import</a> <a id="386" href="Data.List.Relation.Unary.All.html" class="Module">Data.List.Relation.Unary.All</a> <a id="415" class="Symbol">as</a> <a id="418" class="Module">All</a> <a id="422" class="Keyword">using</a> <a id="428" class="Symbol">(</a><a id="429" href="Data.List.Relation.Unary.All.html#1644" class="Datatype">All</a><a id="432" class="Symbol">;</a> <a id="434" href="Data.List.Relation.Unary.All.html#1707" class="InductiveConstructor">[]</a><a id="436" class="Symbol">;</a> <a id="438" href="Data.List.Relation.Unary.All.html#1724" class="InductiveConstructor Operator">_∷_</a><a id="441" class="Symbol">)</a>
<a id="443" class="Keyword">open</a> <a id="448" class="Keyword">import</a> <a id="455" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="469" class="Keyword">open</a> <a id="474" class="Keyword">import</a> <a id="481" href="Data.Nat.Divisibility.html" class="Module">Data.Nat.Divisibility</a>
<a id="503" class="Keyword">open</a> <a id="508" class="Keyword">import</a> <a id="515" href="Data.Nat.GCD.html" class="Module">Data.Nat.GCD</a> <a id="528" class="Keyword">using</a> <a id="534" class="Symbol">(</a><a id="535" class="Keyword">module</a> <a id="542" href="Data.Nat.GCD.html#8073" class="Module">GCD</a><a id="545" class="Symbol">;</a> <a id="547" class="Keyword">module</a> <a id="554" href="Data.Nat.GCD.html#10995" class="Module">Bézout</a><a id="560" class="Symbol">)</a>
<a id="562" class="Keyword">open</a> <a id="567" class="Keyword">import</a> <a id="574" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a>
<a id="594" class="Keyword">open</a> <a id="599" class="Keyword">import</a> <a id="606" href="Data.Product.Base.html" class="Module">Data.Product.Base</a> <a id="624" class="Keyword">using</a> <a id="630" class="Symbol">(</a><a id="631" href="Data.Product.Base.html#1371" class="Function">∃-syntax</a><a id="639" class="Symbol">;</a> <a id="641" href="Data.Product.Base.html#1618" class="Function Operator">_×_</a><a id="644" class="Symbol">;</a> <a id="646" href="Data.Product.Base.html#2362" class="Function">map₂</a><a id="650" class="Symbol">;</a> <a id="652" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a><a id="655" class="Symbol">)</a>
<a id="657" class="Keyword">open</a> <a id="662" class="Keyword">import</a> <a id="669" href="Data.Sum.Base.html" class="Module">Data.Sum.Base</a> <a id="683" class="Keyword">using</a> <a id="689" class="Symbol">(</a><a id="690" href="Data.Sum.Base.html#625" class="Datatype Operator">_⊎_</a><a id="693" class="Symbol">;</a> <a id="695" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a><a id="699" class="Symbol">;</a> <a id="701" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a><a id="705" class="Symbol">;</a> <a id="707" href="Data.Sum.Base.html#980" class="Function Operator">[_,_]′</a><a id="713" class="Symbol">)</a>
<a id="715" class="Keyword">open</a> <a id="720" class="Keyword">import</a> <a id="727" href="Function.Base.html" class="Module">Function.Base</a> <a id="741" class="Keyword">using</a> <a id="747" class="Symbol">(</a><a id="748" href="Function.Base.html#1638" class="Function">flip</a><a id="752" class="Symbol">;</a> <a id="754" href="Function.Base.html#1115" class="Function Operator">_∘_</a><a id="757" class="Symbol">;</a> <a id="759" href="Function.Base.html#3626" class="Function Operator">_∘′_</a><a id="763" class="Symbol">)</a>
<a id="765" class="Keyword">open</a> <a id="770" class="Keyword">import</a> <a id="777" href="Function.Bundles.html" class="Module">Function.Bundles</a> <a id="794" class="Keyword">using</a> <a id="800" class="Symbol">(</a><a id="801" href="Function.Bundles.html#12400" class="Function Operator">_⇔_</a><a id="804" class="Symbol">;</a> <a id="806" href="Function.Bundles.html#13499" class="Function">mk⇔</a><a id="809" class="Symbol">)</a>
<a id="811" class="Keyword">open</a> <a id="816" class="Keyword">import</a> <a id="823" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="850" class="Symbol">as</a> <a id="853" class="Module">Dec</a>
  <a id="859" class="Keyword">using</a> <a id="865" class="Symbol">(</a><a id="866" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a><a id="869" class="Symbol">;</a> <a id="871" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a><a id="873" class="Symbol">;</a> <a id="875" href="Relation.Nullary.Decidable.Core.html#5517" class="Function">from-yes</a><a id="883" class="Symbol">;</a> <a id="885" href="Relation.Nullary.Decidable.Core.html#5719" class="Function">from-no</a><a id="892" class="Symbol">;</a> <a id="894" href="Relation.Nullary.Decidable.Core.html#3011" class="Function">¬?</a><a id="896" class="Symbol">;</a> <a id="898" href="Relation.Nullary.Decidable.Core.html#3103" class="Function Operator">_×-dec_</a><a id="905" class="Symbol">;</a> <a id="907" href="Relation.Nullary.Decidable.Core.html#3233" class="Function Operator">_⊎-dec_</a><a id="914" class="Symbol">;</a> <a id="916" href="Relation.Nullary.Decidable.Core.html#3363" class="Function Operator">_→-dec_</a><a id="923" class="Symbol">;</a> <a id="925" href="Relation.Nullary.Decidable.Core.html#6289" class="Function">decidable-stable</a><a id="941" class="Symbol">)</a>
<a id="943" class="Keyword">open</a> <a id="948" class="Keyword">import</a> <a id="955" href="Relation.Nullary.Negation.html" class="Module">Relation.Nullary.Negation</a> <a id="981" class="Keyword">using</a> <a id="987" class="Symbol">(</a><a id="988" href="Relation.Nullary.Negation.Core.html#658" class="Function Operator">¬_</a><a id="990" class="Symbol">;</a> <a id="992" href="Relation.Nullary.Negation.Core.html#1270" class="Function">contradiction</a><a id="1005" class="Symbol">;</a> <a id="1007" href="Relation.Nullary.Negation.Core.html#1344" class="Function">contradiction₂</a><a id="1021" class="Symbol">)</a>
<a id="1023" class="Keyword">open</a> <a id="1028" class="Keyword">import</a> <a id="1035" href="Relation.Unary.html" class="Module">Relation.Unary</a> <a id="1050" class="Keyword">using</a> <a id="1056" class="Symbol">(</a><a id="1057" href="Relation.Unary.html#1178" class="Function">Pred</a><a id="1061" class="Symbol">;</a> <a id="1063" href="Relation.Unary.html#4543" class="Function">Decidable</a><a id="1072" class="Symbol">)</a>
<a id="1074" class="Keyword">open</a> <a id="1079" class="Keyword">import</a> <a id="1086" href="Relation.Binary.Core.html" class="Module">Relation.Binary.Core</a> <a id="1107" class="Keyword">using</a> <a id="1113" class="Symbol">(</a><a id="1114" href="Relation.Binary.Core.html#896" class="Function">Rel</a><a id="1117" class="Symbol">)</a>
<a id="1119" class="Keyword">open</a> <a id="1124" class="Keyword">import</a> <a id="1131" href="Relation.Binary.PropositionalEquality.Core.html" class="Module">Relation.Binary.PropositionalEquality.Core</a>
  <a id="1176" class="Keyword">using</a> <a id="1182" class="Symbol">(</a><a id="1183" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="1186" class="Symbol">;</a> <a id="1188" href="Relation.Binary.PropositionalEquality.Core.html#858" class="Function Operator">_≢_</a><a id="1191" class="Symbol">;</a> <a id="1193" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="1197" class="Symbol">;</a> <a id="1199" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a><a id="1203" class="Symbol">)</a>

<a id="1206" class="Keyword">private</a>
  <a id="1216" class="Keyword">variable</a>
    <a id="1229" href="Data.Nat.Primality.html#1229" class="Generalizable">d</a> <a id="1231" href="Data.Nat.Primality.html#1231" class="Generalizable">m</a> <a id="1233" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a> <a id="1235" href="Data.Nat.Primality.html#1235" class="Generalizable">o</a> <a id="1237" href="Data.Nat.Primality.html#1237" class="Generalizable">p</a> <a id="1239" class="Symbol">:</a> <a id="1241" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

  <a id="recompute-nonTrivial"></a><a id="1246" href="Data.Nat.Primality.html#1246" class="Function">recompute-nonTrivial</a> <a id="1267" class="Symbol">:</a> <a id="1269" class="Symbol">.{{</a><a id="1272" href="Data.Nat.Base.html#3801" class="Record">NonTrivial</a> <a id="1283" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a><a id="1284" class="Symbol">}}</a> <a id="1287" class="Symbol">→</a> <a id="1289" href="Data.Nat.Base.html#3801" class="Record">NonTrivial</a> <a id="1300" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a>
  <a id="1304" href="Data.Nat.Primality.html#1246" class="Function">recompute-nonTrivial</a> <a id="1325" class="Symbol">{</a><a id="1326" href="Data.Nat.Primality.html#1326" class="Bound">n</a><a id="1327" class="Symbol">}</a> <a id="1329" class="Symbol">{{</a><a id="1331" href="Data.Nat.Primality.html#1331" class="Bound">nontrivial</a><a id="1341" class="Symbol">}}</a> <a id="1344" class="Symbol">=</a>
    <a id="1350" href="Relation.Nullary.Decidable.Core.html#2575" class="Function">Dec.recompute</a> <a id="1364" class="Symbol">(</a><a id="1365" href="Data.Nat.Properties.html#2977" class="Function">nonTrivial?</a> <a id="1377" href="Data.Nat.Primality.html#1326" class="Bound">n</a><a id="1378" class="Symbol">)</a> <a id="1380" href="Data.Nat.Primality.html#1331" class="Bound">nontrivial</a>

<a id="1392" class="Comment">------------------------------------------------------------------------</a>
<a id="1465" class="Comment">-- Definitions</a>
<a id="1480" class="Comment">------------------------------------------------------------------------</a>

<a id="1554" class="Comment">-- The positive/existential relation `BoundedNonTrivialDivisor` is</a>
<a id="1621" class="Comment">-- the basis for the whole development, as it captures the possible</a>
<a id="1689" class="Comment">-- non-trivial divisors of a given number; its complement, `Rough`,</a>
<a id="1757" class="Comment">-- therefore sets *lower* bounds on any possible such divisors.</a>

<a id="1822" class="Comment">-- The predicate `Composite` is then defined as the &#39;diagonal&#39; instance</a>
<a id="1894" class="Comment">-- of `BoundedNonTrivialDivisor`, while `Prime` is essentially defined as</a>
<a id="1968" class="Comment">-- the complement of `Composite`. Finally, `Irreducible` is the positive</a>
<a id="2041" class="Comment">-- analogue of `Prime`.</a>

<a id="2066" class="Comment">------------------------------------------------------------------------</a>
<a id="2139" class="Comment">-- Roughness</a>

<a id="2153" class="Comment">-- A number is m-rough if all its non-trivial divisors are bounded below</a>
<a id="2226" class="Comment">-- by m.</a>
<a id="2235" class="Keyword">infix</a> <a id="2241" class="Number">10</a> <a id="2244" href="Data.Nat.Primality.html#2253" class="Function Operator">_Rough_</a>

<a id="_Rough_"></a><a id="2253" href="Data.Nat.Primality.html#2253" class="Function Operator">_Rough_</a> <a id="2261" class="Symbol">:</a> <a id="2263" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2265" class="Symbol">→</a> <a id="2267" href="Relation.Unary.html#1178" class="Function">Pred</a> <a id="2272" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2274" class="Symbol">_</a>
<a id="2276" href="Data.Nat.Primality.html#2276" class="Bound">m</a> <a id="2278" href="Data.Nat.Primality.html#2253" class="Function Operator">Rough</a> <a id="2284" href="Data.Nat.Primality.html#2284" class="Bound">n</a> <a id="2286" class="Symbol">=</a> <a id="2288" href="Relation.Nullary.Negation.Core.html#658" class="Function Operator">¬</a> <a id="2290" class="Symbol">(</a><a id="2291" href="Data.Nat.Primality.html#2284" class="Bound">n</a> <a id="2293" href="Data.Nat.Divisibility.Core.html#1656" class="Record Operator">HasNonTrivialDivisorLessThan</a> <a id="2322" href="Data.Nat.Primality.html#2276" class="Bound">m</a><a id="2323" class="Symbol">)</a>

<a id="2326" class="Comment">------------------------------------------------------------------------</a>
<a id="2399" class="Comment">-- Compositeness</a>

<a id="2417" class="Comment">-- A number is composite if it has a proper non-trivial divisor.</a>
<a id="Composite"></a><a id="2482" href="Data.Nat.Primality.html#2482" class="Function">Composite</a> <a id="2492" class="Symbol">:</a> <a id="2494" href="Relation.Unary.html#1178" class="Function">Pred</a> <a id="2499" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2501" class="Symbol">_</a>
<a id="2503" href="Data.Nat.Primality.html#2482" class="Function">Composite</a> <a id="2513" href="Data.Nat.Primality.html#2513" class="Bound">n</a> <a id="2515" class="Symbol">=</a> <a id="2517" href="Data.Nat.Primality.html#2513" class="Bound">n</a> <a id="2519" href="Data.Nat.Divisibility.Core.html#1656" class="Record Operator">HasNonTrivialDivisorLessThan</a> <a id="2548" href="Data.Nat.Primality.html#2513" class="Bound">n</a>

<a id="2551" class="Comment">-- A shorter pattern synonym for the record constructor producing a</a>
<a id="2619" class="Comment">-- witness for `Composite`.</a>
<a id="2647" class="Keyword">pattern</a>
  <a id="composite"></a><a id="2657" href="Data.Nat.Primality.html#2657" class="InductiveConstructor">composite</a> <a id="2667" class="Symbol">{</a><a id="2668" href="Data.Nat.Primality.html#2713" class="Bound">d</a><a id="2669" class="Symbol">}</a> <a id="2671" href="Data.Nat.Primality.html#2716" class="Bound">d&lt;n</a> <a id="2675" href="Data.Nat.Primality.html#2720" class="Bound">d∣n</a> <a id="2679" class="Symbol">=</a> <a id="2681" href="Data.Nat.Divisibility.Core.html#1723" class="InductiveConstructor">hasNonTrivialDivisor</a> <a id="2702" class="Symbol">{</a><a id="2703" class="Argument">divisor</a> <a id="2711" class="Symbol">=</a> <a id="2713" href="Data.Nat.Primality.html#2713" class="Bound">d</a><a id="2714" class="Symbol">}</a> <a id="2716" href="Data.Nat.Primality.html#2716" class="Bound">d&lt;n</a> <a id="2720" href="Data.Nat.Primality.html#2720" class="Bound">d∣n</a>

<a id="2725" class="Comment">------------------------------------------------------------------------</a>
<a id="2798" class="Comment">-- Primality</a>

<a id="2812" class="Comment">-- Prime as the complement of Composite (and hence the diagonal of Rough</a>
<a id="2885" class="Comment">-- as defined above). The constructor `prime` takes a proof `notComposite`</a>
<a id="2960" class="Comment">-- that NonTrivial p is not composite and thereby enforces that:</a>
<a id="3025" class="Comment">-- * p is a fortiori NonZero and NonUnit</a>
<a id="3066" class="Comment">-- * p is p-Rough, i.e. any proper divisor must be at least p, i.e. p itself</a>
<a id="3143" class="Keyword">record</a> <a id="Prime"></a><a id="3150" href="Data.Nat.Primality.html#3150" class="Record">Prime</a> <a id="3156" class="Symbol">(</a><a id="3157" href="Data.Nat.Primality.html#3157" class="Bound">p</a> <a id="3159" class="Symbol">:</a> <a id="3161" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="3162" class="Symbol">)</a> <a id="3164" class="Symbol">:</a> <a id="3166" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="3170" class="Keyword">where</a>
  <a id="3178" class="Keyword">constructor</a> <a id="prime"></a><a id="3190" href="Data.Nat.Primality.html#3190" class="InductiveConstructor">prime</a>
  <a id="3198" class="Keyword">field</a>
    <a id="3208" class="Symbol">.{{</a><a id="Prime.nontrivial"></a><a id="3211" href="Data.Nat.Primality.html#3211" class="Field">nontrivial</a><a id="3221" class="Symbol">}}</a> <a id="3224" class="Symbol">:</a> <a id="3226" href="Data.Nat.Base.html#3801" class="Record">NonTrivial</a> <a id="3237" href="Data.Nat.Primality.html#3157" class="Bound">p</a>
    <a id="Prime.notComposite"></a><a id="3243" href="Data.Nat.Primality.html#3243" class="Field">notComposite</a>    <a id="3259" class="Symbol">:</a> <a id="3261" href="Relation.Nullary.Negation.Core.html#658" class="Function Operator">¬</a> <a id="3263" href="Data.Nat.Primality.html#2482" class="Function">Composite</a> <a id="3273" href="Data.Nat.Primality.html#3157" class="Bound">p</a>

<a id="3276" class="Comment">------------------------------------------------------------------------</a>
<a id="3349" class="Comment">-- Irreducibility</a>

<a id="Irreducible"></a><a id="3368" href="Data.Nat.Primality.html#3368" class="Function">Irreducible</a> <a id="3380" class="Symbol">:</a> <a id="3382" href="Relation.Unary.html#1178" class="Function">Pred</a> <a id="3387" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3389" class="Symbol">_</a>
<a id="3391" href="Data.Nat.Primality.html#3368" class="Function">Irreducible</a> <a id="3403" href="Data.Nat.Primality.html#3403" class="Bound">n</a> <a id="3405" class="Symbol">=</a> <a id="3407" class="Symbol">∀</a> <a id="3409" class="Symbol">{</a><a id="3410" href="Data.Nat.Primality.html#3410" class="Bound">d</a><a id="3411" class="Symbol">}</a> <a id="3413" class="Symbol">→</a> <a id="3415" href="Data.Nat.Primality.html#3410" class="Bound">d</a> <a id="3417" href="Data.Nat.Divisibility.Core.html#1159" class="Record Operator">∣</a> <a id="3419" href="Data.Nat.Primality.html#3403" class="Bound">n</a> <a id="3421" class="Symbol">→</a> <a id="3423" href="Data.Nat.Primality.html#3410" class="Bound">d</a> <a id="3425" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3427" class="Number">1</a> <a id="3429" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="3431" href="Data.Nat.Primality.html#3410" class="Bound">d</a> <a id="3433" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3435" href="Data.Nat.Primality.html#3403" class="Bound">n</a>

<a id="3438" class="Comment">------------------------------------------------------------------------</a>
<a id="3511" class="Comment">-- Properties</a>
<a id="3525" class="Comment">------------------------------------------------------------------------</a>

<a id="3599" class="Comment">------------------------------------------------------------------------</a>
<a id="3672" class="Comment">-- Roughness</a>

<a id="3686" class="Comment">-- 1 is always n-rough</a>
<a id="rough-1"></a><a id="3709" href="Data.Nat.Primality.html#3709" class="Function">rough-1</a> <a id="3717" class="Symbol">:</a> <a id="3719" class="Symbol">∀</a> <a id="3721" href="Data.Nat.Primality.html#3721" class="Bound">n</a> <a id="3723" class="Symbol">→</a> <a id="3725" href="Data.Nat.Primality.html#3721" class="Bound">n</a> <a id="3727" href="Data.Nat.Primality.html#2253" class="Function Operator">Rough</a> <a id="3733" class="Number">1</a>
<a id="3735" href="Data.Nat.Primality.html#3709" class="Function">rough-1</a> <a id="3743" class="Symbol">_</a> <a id="3745" class="Symbol">(</a><a id="3746" href="Data.Nat.Divisibility.Core.html#1723" class="InductiveConstructor">hasNonTrivialDivisor</a> <a id="3767" class="Symbol">_</a> <a id="3769" href="Data.Nat.Primality.html#3769" class="Bound">d∣1</a><a id="3772" class="Symbol">)</a> <a id="3774" class="Symbol">=</a>
  <a id="3778" href="Relation.Nullary.Negation.Core.html#1270" class="Function">contradiction</a> <a id="3792" class="Symbol">(</a><a id="3793" href="Data.Nat.Divisibility.html#5586" class="Function">∣1⇒≡1</a> <a id="3799" href="Data.Nat.Primality.html#3769" class="Bound">d∣1</a><a id="3802" class="Symbol">)</a> <a id="3804" href="Data.Nat.Base.html#4224" class="Function">nonTrivial⇒≢1</a>

<a id="3819" class="Comment">-- Any number is 0-, 1- and 2-rough,</a>
<a id="3856" class="Comment">-- because no proper divisor d can be strictly less than 0, 1, or 2</a>
<a id="0-rough"></a><a id="3924" href="Data.Nat.Primality.html#3924" class="Function">0-rough</a> <a id="3932" class="Symbol">:</a> <a id="3934" class="Number">0</a> <a id="3936" href="Data.Nat.Primality.html#2253" class="Function Operator">Rough</a> <a id="3942" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a>
<a id="3944" href="Data.Nat.Primality.html#3924" class="Function">0-rough</a> <a id="3952" class="Symbol">(</a><a id="3953" href="Data.Nat.Divisibility.Core.html#1723" class="InductiveConstructor">hasNonTrivialDivisor</a> <a id="3974" class="Symbol">()</a> <a id="3977" class="Symbol">_)</a>

<a id="1-rough"></a><a id="3981" href="Data.Nat.Primality.html#3981" class="Function">1-rough</a> <a id="3989" class="Symbol">:</a> <a id="3991" class="Number">1</a> <a id="3993" href="Data.Nat.Primality.html#2253" class="Function Operator">Rough</a> <a id="3999" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a>
<a id="4001" href="Data.Nat.Primality.html#3981" class="Function">1-rough</a> <a id="4009" class="Symbol">(</a><a id="4010" href="Data.Nat.Divisibility.Core.html#1723" class="InductiveConstructor">hasNonTrivialDivisor</a> <a id="4031" class="Symbol">{{()}}</a> <a id="4038" href="Data.Nat.Base.html#1879" class="InductiveConstructor">z&lt;s</a> <a id="4042" class="Symbol">_)</a>

<a id="2-rough"></a><a id="4046" href="Data.Nat.Primality.html#4046" class="Function">2-rough</a> <a id="4054" class="Symbol">:</a> <a id="4056" class="Number">2</a> <a id="4058" href="Data.Nat.Primality.html#2253" class="Function Operator">Rough</a> <a id="4064" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a>
<a id="4066" href="Data.Nat.Primality.html#4046" class="Function">2-rough</a> <a id="4074" class="Symbol">(</a><a id="4075" href="Data.Nat.Divisibility.Core.html#1723" class="InductiveConstructor">hasNonTrivialDivisor</a> <a id="4096" class="Symbol">{{()}}</a> <a id="4103" class="Symbol">(</a><a id="4104" href="Data.Nat.Base.html#1919" class="InductiveConstructor">s&lt;s</a> <a id="4108" href="Data.Nat.Base.html#1879" class="InductiveConstructor">z&lt;s</a><a id="4111" class="Symbol">)</a> <a id="4113" class="Symbol">_)</a>

<a id="4117" class="Comment">-- If a number n &gt; 1 is m-rough, then m ≤ n</a>
<a id="rough⇒≤"></a><a id="4161" href="Data.Nat.Primality.html#4161" class="Function">rough⇒≤</a> <a id="4169" class="Symbol">:</a> <a id="4171" class="Symbol">.{{</a><a id="4174" href="Data.Nat.Base.html#3801" class="Record">NonTrivial</a> <a id="4185" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a><a id="4186" class="Symbol">}}</a> <a id="4189" class="Symbol">→</a> <a id="4191" href="Data.Nat.Primality.html#1231" class="Generalizable">m</a> <a id="4193" href="Data.Nat.Primality.html#2253" class="Function Operator">Rough</a> <a id="4199" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a> <a id="4201" class="Symbol">→</a> <a id="4203" href="Data.Nat.Primality.html#1231" class="Generalizable">m</a> <a id="4205" href="Data.Nat.Base.html#1697" class="Datatype Operator">≤</a> <a id="4207" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a>
<a id="4209" href="Data.Nat.Primality.html#4161" class="Function">rough⇒≤</a> <a id="4217" href="Data.Nat.Primality.html#4217" class="Bound">rough</a> <a id="4223" class="Symbol">=</a> <a id="4225" href="Data.Nat.Properties.html#9729" class="Function">≮⇒≥</a> <a id="4229" href="Data.Nat.Primality.html#4241" class="Function">n≮m</a>
  <a id="4235" class="Keyword">where</a> <a id="4241" href="Data.Nat.Primality.html#4241" class="Function">n≮m</a> <a id="4245" class="Symbol">=</a> <a id="4247" class="Symbol">λ</a> <a id="4249" href="Data.Nat.Primality.html#4249" class="Bound">m&gt;n</a> <a id="4253" class="Symbol">→</a> <a id="4255" href="Data.Nat.Primality.html#4217" class="Bound">rough</a> <a id="4261" class="Symbol">(</a><a id="4262" href="Data.Nat.Divisibility.Core.html#1723" class="InductiveConstructor">hasNonTrivialDivisor</a> <a id="4283" href="Data.Nat.Primality.html#4249" class="Bound">m&gt;n</a> <a id="4287" href="Data.Nat.Divisibility.html#3921" class="Function">∣-refl</a><a id="4293" class="Symbol">)</a>

<a id="4296" class="Comment">-- If a number n is m-rough, and m ∤ n, then n is (suc m)-rough</a>
<a id="∤⇒rough-suc"></a><a id="4360" href="Data.Nat.Primality.html#4360" class="Function">∤⇒rough-suc</a> <a id="4372" class="Symbol">:</a> <a id="4374" href="Data.Nat.Primality.html#1231" class="Generalizable">m</a> <a id="4376" href="Data.Nat.Divisibility.Core.html#1265" class="Function Operator">∤</a> <a id="4378" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a> <a id="4380" class="Symbol">→</a> <a id="4382" href="Data.Nat.Primality.html#1231" class="Generalizable">m</a> <a id="4384" href="Data.Nat.Primality.html#2253" class="Function Operator">Rough</a> <a id="4390" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a> <a id="4392" class="Symbol">→</a> <a id="4394" class="Symbol">(</a><a id="4395" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4399" href="Data.Nat.Primality.html#1231" class="Generalizable">m</a><a id="4400" class="Symbol">)</a> <a id="4402" href="Data.Nat.Primality.html#2253" class="Function Operator">Rough</a> <a id="4408" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a>
<a id="4410" href="Data.Nat.Primality.html#4360" class="Function">∤⇒rough-suc</a> <a id="4422" href="Data.Nat.Primality.html#4422" class="Bound">m∤n</a> <a id="4426" href="Data.Nat.Primality.html#4426" class="Bound">r</a> <a id="4428" class="Symbol">(</a><a id="4429" href="Data.Nat.Divisibility.Core.html#1723" class="InductiveConstructor">hasNonTrivialDivisor</a> <a id="4450" href="Data.Nat.Primality.html#4450" class="Bound">d&lt;1+m</a> <a id="4456" href="Data.Nat.Primality.html#4456" class="Bound">d∣n</a><a id="4459" class="Symbol">)</a>
  <a id="4463" class="Keyword">with</a> <a id="4468" href="Data.Nat.Properties.html#13438" class="Function">m&lt;1+n⇒m&lt;n∨m≡n</a> <a id="4482" href="Data.Nat.Primality.html#4450" class="Bound">d&lt;1+m</a>
<a id="4488" class="Symbol">...</a> <a id="4492" class="Symbol">|</a> <a id="4494" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="4499" href="Data.Nat.Primality.html#4499" class="Bound">d&lt;m</a>      <a id="4508" class="Symbol">=</a> <a id="4510" class="Bound">r</a> <a id="4512" class="Symbol">(</a><a id="4513" href="Data.Nat.Divisibility.Core.html#1723" class="InductiveConstructor">hasNonTrivialDivisor</a> <a id="4534" href="Data.Nat.Primality.html#4499" class="Bound">d&lt;m</a> <a id="4538" class="Bound">d∣n</a><a id="4541" class="Symbol">)</a>
<a id="4543" class="Symbol">...</a> <a id="4547" class="Symbol">|</a> <a id="4549" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="4554" href="Data.Nat.Primality.html#4554" class="Bound">d≡m</a><a id="4557" class="Symbol">@</a><a id="4558" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="4563" class="Symbol">=</a> <a id="4565" href="Relation.Nullary.Negation.Core.html#1270" class="Function">contradiction</a> <a id="4579" class="Bound">d∣n</a> <a id="4583" class="Bound">m∤n</a>

<a id="4588" class="Comment">-- If a number is m-rough, then so are all of its divisors</a>
<a id="rough∧∣⇒rough"></a><a id="4647" href="Data.Nat.Primality.html#4647" class="Function">rough∧∣⇒rough</a> <a id="4661" class="Symbol">:</a> <a id="4663" href="Data.Nat.Primality.html#1231" class="Generalizable">m</a> <a id="4665" href="Data.Nat.Primality.html#2253" class="Function Operator">Rough</a> <a id="4671" href="Data.Nat.Primality.html#1235" class="Generalizable">o</a> <a id="4673" class="Symbol">→</a> <a id="4675" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a> <a id="4677" href="Data.Nat.Divisibility.Core.html#1159" class="Record Operator">∣</a> <a id="4679" href="Data.Nat.Primality.html#1235" class="Generalizable">o</a> <a id="4681" class="Symbol">→</a> <a id="4683" href="Data.Nat.Primality.html#1231" class="Generalizable">m</a> <a id="4685" href="Data.Nat.Primality.html#2253" class="Function Operator">Rough</a> <a id="4691" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a>
<a id="4693" href="Data.Nat.Primality.html#4647" class="Function">rough∧∣⇒rough</a> <a id="4707" href="Data.Nat.Primality.html#4707" class="Bound">r</a> <a id="4709" href="Data.Nat.Primality.html#4709" class="Bound">n∣o</a> <a id="4713" href="Data.Nat.Primality.html#4713" class="Bound">bntd</a> <a id="4718" class="Symbol">=</a> <a id="4720" href="Data.Nat.Primality.html#4707" class="Bound">r</a> <a id="4722" class="Symbol">(</a><a id="4723" href="Data.Nat.Divisibility.html#11452" class="Function">hasNonTrivialDivisor-∣</a> <a id="4746" href="Data.Nat.Primality.html#4713" class="Bound">bntd</a> <a id="4751" href="Data.Nat.Primality.html#4709" class="Bound">n∣o</a><a id="4754" class="Symbol">)</a>

<a id="4757" class="Comment">------------------------------------------------------------------------</a>
<a id="4830" class="Comment">-- Compositeness</a>

<a id="4848" class="Comment">-- Smart constructors</a>

<a id="composite-≢"></a><a id="4871" href="Data.Nat.Primality.html#4871" class="Function">composite-≢</a> <a id="4883" class="Symbol">:</a> <a id="4885" class="Symbol">∀</a> <a id="4887" href="Data.Nat.Primality.html#4887" class="Bound">d</a> <a id="4889" class="Symbol">→</a> <a id="4891" class="Symbol">.{{</a><a id="4894" href="Data.Nat.Base.html#3801" class="Record">NonTrivial</a> <a id="4905" href="Data.Nat.Primality.html#4887" class="Bound">d</a><a id="4906" class="Symbol">}}</a> <a id="4909" class="Symbol">→</a> <a id="4911" class="Symbol">.{{</a><a id="4914" href="Data.Nat.Base.html#3266" class="Record">NonZero</a> <a id="4922" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a><a id="4923" class="Symbol">}}</a> <a id="4926" class="Symbol">→</a>
              <a id="4942" href="Data.Nat.Primality.html#4887" class="Bound">d</a> <a id="4944" href="Relation.Binary.PropositionalEquality.Core.html#858" class="Function Operator">≢</a> <a id="4946" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a> <a id="4948" class="Symbol">→</a> <a id="4950" href="Data.Nat.Primality.html#4887" class="Bound">d</a> <a id="4952" href="Data.Nat.Divisibility.Core.html#1159" class="Record Operator">∣</a> <a id="4954" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a> <a id="4956" class="Symbol">→</a> <a id="4958" href="Data.Nat.Primality.html#2482" class="Function">Composite</a> <a id="4968" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a>
<a id="4970" href="Data.Nat.Primality.html#4871" class="Function">composite-≢</a> <a id="4982" href="Data.Nat.Primality.html#4982" class="Bound">d</a> <a id="4984" class="Symbol">=</a> <a id="4986" href="Data.Nat.Divisibility.html#11210" class="Function">hasNonTrivialDivisor-≢</a> <a id="5009" class="Symbol">{</a><a id="5010" href="Data.Nat.Primality.html#4982" class="Bound">d</a><a id="5011" class="Symbol">}</a>

<a id="composite-∣"></a><a id="5014" href="Data.Nat.Primality.html#5014" class="Function">composite-∣</a> <a id="5026" class="Symbol">:</a> <a id="5028" class="Symbol">.{{</a><a id="5031" href="Data.Nat.Base.html#3266" class="Record">NonZero</a> <a id="5039" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a><a id="5040" class="Symbol">}}</a> <a id="5043" class="Symbol">→</a> <a id="5045" href="Data.Nat.Primality.html#2482" class="Function">Composite</a> <a id="5055" href="Data.Nat.Primality.html#1231" class="Generalizable">m</a> <a id="5057" class="Symbol">→</a> <a id="5059" href="Data.Nat.Primality.html#1231" class="Generalizable">m</a> <a id="5061" href="Data.Nat.Divisibility.Core.html#1159" class="Record Operator">∣</a> <a id="5063" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a> <a id="5065" class="Symbol">→</a> <a id="5067" href="Data.Nat.Primality.html#2482" class="Function">Composite</a> <a id="5077" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a>
<a id="5079" href="Data.Nat.Primality.html#5014" class="Function">composite-∣</a> <a id="5091" class="Symbol">(</a><a id="5092" href="Data.Nat.Primality.html#2657" class="InductiveConstructor">composite</a> <a id="5102" class="Symbol">{</a><a id="5103" href="Data.Nat.Primality.html#5103" class="Bound">d</a><a id="5104" class="Symbol">}</a> <a id="5106" href="Data.Nat.Primality.html#5106" class="Bound">d&lt;m</a> <a id="5110" href="Data.Nat.Primality.html#5110" class="Bound">d∣n</a><a id="5113" class="Symbol">)</a> <a id="5115" href="Data.Nat.Primality.html#5115" class="Bound">m∣n</a><a id="5118" class="Symbol">@(</a><a id="5120" href="Data.Nat.Divisibility.Core.html#1328" class="InductiveConstructor">divides-refl</a> <a id="5133" href="Data.Nat.Primality.html#5133" class="Bound">q</a><a id="5134" class="Symbol">)</a>
  <a id="5138" class="Symbol">=</a> <a id="5140" href="Data.Nat.Primality.html#2657" class="InductiveConstructor">composite</a> <a id="5150" class="Symbol">(</a><a id="5151" href="Data.Nat.Properties.html#28242" class="Function">*-monoʳ-&lt;</a> <a id="5161" href="Data.Nat.Primality.html#5133" class="Bound">q</a> <a id="5163" href="Data.Nat.Primality.html#5106" class="Bound">d&lt;m</a><a id="5166" class="Symbol">)</a> <a id="5168" class="Symbol">(</a><a id="5169" href="Data.Nat.Divisibility.html#7072" class="Function">*-monoʳ-∣</a> <a id="5179" href="Data.Nat.Primality.html#5133" class="Bound">q</a> <a id="5181" href="Data.Nat.Primality.html#5110" class="Bound">d∣n</a><a id="5184" class="Symbol">)</a>
  <a id="5188" class="Keyword">where</a> <a id="5194" class="Keyword">instance</a>
    <a id="5207" href="Data.Nat.Primality.html#5207" class="Function">_</a> <a id="5209" class="Symbol">=</a> <a id="5211" href="Data.Nat.Properties.html#26869" class="Function">m≢0∧n&gt;1⇒m*n&gt;1</a> <a id="5225" href="Data.Nat.Primality.html#5133" class="Bound">q</a> <a id="5227" href="Data.Nat.Primality.html#5103" class="Bound">d</a>
    <a id="5233" href="Data.Nat.Primality.html#5233" class="Function">_</a> <a id="5235" class="Symbol">=</a> <a id="5237" href="Data.Nat.Properties.html#25929" class="Function">m*n≢0⇒m≢0</a> <a id="5247" href="Data.Nat.Primality.html#5133" class="Bound">q</a>

<a id="5250" class="Comment">-- Basic (counter-)examples of Composite</a>

<a id="¬composite[0]"></a><a id="5292" href="Data.Nat.Primality.html#5292" class="Function">¬composite[0]</a> <a id="5306" class="Symbol">:</a> <a id="5308" href="Relation.Nullary.Negation.Core.html#658" class="Function Operator">¬</a> <a id="5310" href="Data.Nat.Primality.html#2482" class="Function">Composite</a> <a id="5320" class="Number">0</a>
<a id="5322" href="Data.Nat.Primality.html#5292" class="Function">¬composite[0]</a> <a id="5336" class="Symbol">=</a> <a id="5338" href="Data.Nat.Primality.html#3924" class="Function">0-rough</a>

<a id="¬composite[1]"></a><a id="5347" href="Data.Nat.Primality.html#5347" class="Function">¬composite[1]</a> <a id="5361" class="Symbol">:</a> <a id="5363" href="Relation.Nullary.Negation.Core.html#658" class="Function Operator">¬</a> <a id="5365" href="Data.Nat.Primality.html#2482" class="Function">Composite</a> <a id="5375" class="Number">1</a>
<a id="5377" href="Data.Nat.Primality.html#5347" class="Function">¬composite[1]</a> <a id="5391" class="Symbol">=</a> <a id="5393" href="Data.Nat.Primality.html#3981" class="Function">1-rough</a>

<a id="composite[4]"></a><a id="5402" href="Data.Nat.Primality.html#5402" class="Function">composite[4]</a> <a id="5415" class="Symbol">:</a> <a id="5417" href="Data.Nat.Primality.html#2482" class="Function">Composite</a> <a id="5427" class="Number">4</a>
<a id="5429" href="Data.Nat.Primality.html#5402" class="Function">composite[4]</a> <a id="5442" class="Symbol">=</a> <a id="5444" href="Data.Nat.Primality.html#4871" class="Function">composite-≢</a> <a id="5456" class="Number">2</a> <a id="5458" class="Symbol">(λ())</a> <a id="5464" class="Symbol">(</a><a id="5465" href="Data.Nat.Divisibility.Core.html#1328" class="InductiveConstructor">divides-refl</a> <a id="5478" class="Number">2</a><a id="5479" class="Symbol">)</a>

<a id="composite[6]"></a><a id="5482" href="Data.Nat.Primality.html#5482" class="Function">composite[6]</a> <a id="5495" class="Symbol">:</a> <a id="5497" href="Data.Nat.Primality.html#2482" class="Function">Composite</a> <a id="5507" class="Number">6</a>
<a id="5509" href="Data.Nat.Primality.html#5482" class="Function">composite[6]</a> <a id="5522" class="Symbol">=</a> <a id="5524" href="Data.Nat.Primality.html#4871" class="Function">composite-≢</a> <a id="5536" class="Number">3</a> <a id="5538" class="Symbol">(λ())</a> <a id="5544" class="Symbol">(</a><a id="5545" href="Data.Nat.Divisibility.Core.html#1328" class="InductiveConstructor">divides-refl</a> <a id="5558" class="Number">2</a><a id="5559" class="Symbol">)</a>

<a id="composite⇒nonZero"></a><a id="5562" href="Data.Nat.Primality.html#5562" class="Function">composite⇒nonZero</a> <a id="5580" class="Symbol">:</a> <a id="5582" href="Data.Nat.Primality.html#2482" class="Function">Composite</a> <a id="5592" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a> <a id="5594" class="Symbol">→</a> <a id="5596" href="Data.Nat.Base.html#3266" class="Record">NonZero</a> <a id="5604" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a>
<a id="5606" href="Data.Nat.Primality.html#5562" class="Function">composite⇒nonZero</a> <a id="5624" class="Symbol">{</a><a id="5625" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="5629" class="Symbol">_}</a> <a id="5632" class="Symbol">_</a> <a id="5634" class="Symbol">=</a> <a id="5636" class="Symbol">_</a>

<a id="composite⇒nonTrivial"></a><a id="5639" href="Data.Nat.Primality.html#5639" class="Function">composite⇒nonTrivial</a> <a id="5660" class="Symbol">:</a> <a id="5662" href="Data.Nat.Primality.html#2482" class="Function">Composite</a> <a id="5672" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a> <a id="5674" class="Symbol">→</a> <a id="5676" href="Data.Nat.Base.html#3801" class="Record">NonTrivial</a> <a id="5687" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a>
<a id="5689" href="Data.Nat.Primality.html#5639" class="Function">composite⇒nonTrivial</a> <a id="5710" class="Symbol">{</a><a id="5711" class="Number">1</a><a id="5712" class="Symbol">}</a>    <a id="5717" href="Data.Nat.Primality.html#5717" class="Bound">composite[1]</a> <a id="5730" class="Symbol">=</a>
  <a id="5734" href="Relation.Nullary.Negation.Core.html#1270" class="Function">contradiction</a> <a id="5748" href="Data.Nat.Primality.html#5717" class="Bound">composite[1]</a> <a id="5761" href="Data.Nat.Primality.html#5347" class="Function">¬composite[1]</a>
<a id="5775" href="Data.Nat.Primality.html#5639" class="Function">composite⇒nonTrivial</a> <a id="5796" class="Symbol">{</a><a id="5797" href="Data.Nat.Base.html#1101" class="InductiveConstructor">2+</a> <a id="5800" class="Symbol">_}</a> <a id="5803" class="Symbol">_</a>            <a id="5816" class="Symbol">=</a> <a id="5818" class="Symbol">_</a>

<a id="composite?"></a><a id="5821" href="Data.Nat.Primality.html#5821" class="Function">composite?</a> <a id="5832" class="Symbol">:</a> <a id="5834" href="Relation.Unary.html#4543" class="Function">Decidable</a> <a id="5844" href="Data.Nat.Primality.html#2482" class="Function">Composite</a>
<a id="5854" href="Data.Nat.Primality.html#5821" class="Function">composite?</a> <a id="5865" href="Data.Nat.Primality.html#5865" class="Bound">n</a> <a id="5867" class="Symbol">=</a> <a id="5869" href="Relation.Nullary.Decidable.html#1241" class="Function">Dec.map</a> <a id="5877" href="Data.Nat.Primality.html#6619" class="Function">CompositeUpTo⇔Composite</a> <a id="5901" class="Symbol">(</a><a id="5902" href="Data.Nat.Primality.html#6767" class="Function">compositeUpTo?</a> <a id="5917" href="Data.Nat.Primality.html#5865" class="Bound">n</a><a id="5918" class="Symbol">)</a>
  <a id="5922" class="Keyword">where</a>
  <a id="5930" class="Comment">-- For technical reasons, in order to be able to prove decidability</a>
  <a id="6000" class="Comment">-- via the `all?` and `any?` combinators for *bounded* predicates on</a>
  <a id="6071" class="Comment">-- `ℕ`, we further define the bounded counterparts to predicates</a>
  <a id="6138" class="Comment">-- `P...` as `P...UpTo` and show the equivalence of the two.</a>

  <a id="6202" class="Comment">-- Equivalent bounded predicate definition</a>
  <a id="6247" href="Data.Nat.Primality.html#6247" class="Function">CompositeUpTo</a> <a id="6261" class="Symbol">:</a> <a id="6263" href="Relation.Unary.html#1178" class="Function">Pred</a> <a id="6268" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6270" class="Symbol">_</a>
  <a id="6274" href="Data.Nat.Primality.html#6247" class="Function">CompositeUpTo</a> <a id="6288" href="Data.Nat.Primality.html#6288" class="Bound">n</a> <a id="6290" class="Symbol">=</a> <a id="6292" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="6295" href="Data.Nat.Primality.html#6295" class="Bound">d</a> <a id="6297" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="6299" href="Data.Nat.Primality.html#6295" class="Bound">d</a> <a id="6301" href="Data.Nat.Base.html#1807" class="Function Operator">&lt;</a> <a id="6303" href="Data.Nat.Primality.html#6288" class="Bound">n</a> <a id="6305" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="6307" href="Data.Nat.Base.html#3801" class="Record">NonTrivial</a> <a id="6318" href="Data.Nat.Primality.html#6295" class="Bound">d</a> <a id="6320" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="6322" href="Data.Nat.Primality.html#6295" class="Bound">d</a> <a id="6324" href="Data.Nat.Divisibility.Core.html#1159" class="Record Operator">∣</a> <a id="6326" href="Data.Nat.Primality.html#6288" class="Bound">n</a>

  <a id="6331" class="Comment">-- Proof of equivalence</a>
  <a id="6357" href="Data.Nat.Primality.html#6357" class="Function">comp-upto⇒comp</a> <a id="6372" class="Symbol">:</a> <a id="6374" href="Data.Nat.Primality.html#6247" class="Function">CompositeUpTo</a> <a id="6388" href="Data.Nat.Primality.html#5865" class="Bound">n</a> <a id="6390" class="Symbol">→</a> <a id="6392" href="Data.Nat.Primality.html#2482" class="Function">Composite</a> <a id="6402" href="Data.Nat.Primality.html#5865" class="Bound">n</a>
  <a id="6406" href="Data.Nat.Primality.html#6357" class="Function">comp-upto⇒comp</a> <a id="6421" class="Symbol">(_</a> <a id="6424" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6426" href="Data.Nat.Primality.html#6426" class="Bound">d&lt;n</a> <a id="6430" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6432" href="Data.Nat.Primality.html#6432" class="Bound">ntd</a> <a id="6436" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6438" href="Data.Nat.Primality.html#6438" class="Bound">d∣n</a><a id="6441" class="Symbol">)</a> <a id="6443" class="Symbol">=</a> <a id="6445" href="Data.Nat.Primality.html#2657" class="InductiveConstructor">composite</a> <a id="6455" href="Data.Nat.Primality.html#6426" class="Bound">d&lt;n</a> <a id="6459" href="Data.Nat.Primality.html#6438" class="Bound">d∣n</a>
    <a id="6467" class="Keyword">where</a> <a id="6473" class="Keyword">instance</a> <a id="6482" href="Data.Nat.Primality.html#6482" class="Function">_</a> <a id="6484" class="Symbol">=</a> <a id="6486" href="Data.Nat.Primality.html#6432" class="Bound">ntd</a>

  <a id="6493" href="Data.Nat.Primality.html#6493" class="Function">comp⇒comp-upto</a> <a id="6508" class="Symbol">:</a> <a id="6510" href="Data.Nat.Primality.html#2482" class="Function">Composite</a> <a id="6520" href="Data.Nat.Primality.html#5865" class="Bound">n</a> <a id="6522" class="Symbol">→</a> <a id="6524" href="Data.Nat.Primality.html#6247" class="Function">CompositeUpTo</a> <a id="6538" href="Data.Nat.Primality.html#5865" class="Bound">n</a>
  <a id="6542" href="Data.Nat.Primality.html#6493" class="Function">comp⇒comp-upto</a> <a id="6557" class="Symbol">(</a><a id="6558" href="Data.Nat.Primality.html#2657" class="InductiveConstructor">composite</a> <a id="6568" href="Data.Nat.Primality.html#6568" class="Bound">d&lt;n</a> <a id="6572" href="Data.Nat.Primality.html#6572" class="Bound">d∣n</a><a id="6575" class="Symbol">)</a> <a id="6577" class="Symbol">=</a> <a id="6579" class="Symbol">_</a> <a id="6581" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6583" href="Data.Nat.Primality.html#6568" class="Bound">d&lt;n</a> <a id="6587" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6589" href="Data.Nat.Primality.html#1246" class="Function">recompute-nonTrivial</a> <a id="6610" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6612" href="Data.Nat.Primality.html#6572" class="Bound">d∣n</a>

  <a id="6619" href="Data.Nat.Primality.html#6619" class="Function">CompositeUpTo⇔Composite</a> <a id="6643" class="Symbol">:</a> <a id="6645" href="Data.Nat.Primality.html#6247" class="Function">CompositeUpTo</a> <a id="6659" href="Data.Nat.Primality.html#5865" class="Bound">n</a> <a id="6661" href="Function.Bundles.html#12400" class="Function Operator">⇔</a> <a id="6663" href="Data.Nat.Primality.html#2482" class="Function">Composite</a> <a id="6673" href="Data.Nat.Primality.html#5865" class="Bound">n</a>
  <a id="6677" href="Data.Nat.Primality.html#6619" class="Function">CompositeUpTo⇔Composite</a> <a id="6701" class="Symbol">=</a> <a id="6703" href="Function.Bundles.html#13499" class="Function">mk⇔</a> <a id="6707" href="Data.Nat.Primality.html#6357" class="Function">comp-upto⇒comp</a> <a id="6722" href="Data.Nat.Primality.html#6493" class="Function">comp⇒comp-upto</a>

  <a id="6740" class="Comment">-- Proof of decidability</a>
  <a id="6767" href="Data.Nat.Primality.html#6767" class="Function">compositeUpTo?</a> <a id="6782" class="Symbol">:</a> <a id="6784" href="Relation.Unary.html#4543" class="Function">Decidable</a> <a id="6794" href="Data.Nat.Primality.html#6247" class="Function">CompositeUpTo</a>
  <a id="6810" href="Data.Nat.Primality.html#6767" class="Function">compositeUpTo?</a> <a id="6825" href="Data.Nat.Primality.html#6825" class="Bound">n</a> <a id="6827" class="Symbol">=</a> <a id="6829" href="Data.Nat.Properties.html#69824" class="Function">anyUpTo?</a> <a id="6838" class="Symbol">(λ</a> <a id="6841" href="Data.Nat.Primality.html#6841" class="Bound">d</a> <a id="6843" class="Symbol">→</a> <a id="6845" href="Data.Nat.Properties.html#2977" class="Function">nonTrivial?</a> <a id="6857" href="Data.Nat.Primality.html#6841" class="Bound">d</a> <a id="6859" href="Relation.Nullary.Decidable.Core.html#3103" class="Function Operator">×-dec</a> <a id="6865" href="Data.Nat.Primality.html#6841" class="Bound">d</a> <a id="6867" href="Data.Nat.Divisibility.html#4316" class="Function Operator">∣?</a> <a id="6870" href="Data.Nat.Primality.html#6825" class="Bound">n</a><a id="6871" class="Symbol">)</a> <a id="6873" href="Data.Nat.Primality.html#6825" class="Bound">n</a>

<a id="6876" class="Comment">------------------------------------------------------------------------</a>
<a id="6949" class="Comment">-- Primality</a>

<a id="6963" class="Comment">-- Basic (counter-)examples</a>

<a id="¬prime[0]"></a><a id="6992" href="Data.Nat.Primality.html#6992" class="Function">¬prime[0]</a> <a id="7002" class="Symbol">:</a> <a id="7004" href="Relation.Nullary.Negation.Core.html#658" class="Function Operator">¬</a> <a id="7006" href="Data.Nat.Primality.html#3150" class="Record">Prime</a> <a id="7012" class="Number">0</a>
<a id="7014" href="Data.Nat.Primality.html#6992" class="Function">¬prime[0]</a> <a id="7024" class="Symbol">()</a>

<a id="¬prime[1]"></a><a id="7028" href="Data.Nat.Primality.html#7028" class="Function">¬prime[1]</a> <a id="7038" class="Symbol">:</a> <a id="7040" href="Relation.Nullary.Negation.Core.html#658" class="Function Operator">¬</a> <a id="7042" href="Data.Nat.Primality.html#3150" class="Record">Prime</a> <a id="7048" class="Number">1</a>
<a id="7050" href="Data.Nat.Primality.html#7028" class="Function">¬prime[1]</a> <a id="7060" class="Symbol">()</a>

<a id="prime[2]"></a><a id="7064" href="Data.Nat.Primality.html#7064" class="Function">prime[2]</a> <a id="7073" class="Symbol">:</a> <a id="7075" href="Data.Nat.Primality.html#3150" class="Record">Prime</a> <a id="7081" class="Number">2</a>
<a id="7083" href="Data.Nat.Primality.html#7064" class="Function">prime[2]</a> <a id="7092" class="Symbol">=</a> <a id="7094" href="Data.Nat.Primality.html#3190" class="InductiveConstructor">prime</a> <a id="7100" href="Data.Nat.Primality.html#4046" class="Function">2-rough</a>

<a id="prime⇒nonZero"></a><a id="7109" href="Data.Nat.Primality.html#7109" class="Function">prime⇒nonZero</a> <a id="7123" class="Symbol">:</a> <a id="7125" href="Data.Nat.Primality.html#3150" class="Record">Prime</a> <a id="7131" href="Data.Nat.Primality.html#1237" class="Generalizable">p</a> <a id="7133" class="Symbol">→</a> <a id="7135" href="Data.Nat.Base.html#3266" class="Record">NonZero</a> <a id="7143" href="Data.Nat.Primality.html#1237" class="Generalizable">p</a>
<a id="7145" href="Data.Nat.Primality.html#7109" class="Function">prime⇒nonZero</a> <a id="7159" class="Symbol">_</a> <a id="7161" class="Symbol">=</a> <a id="7163" href="Data.Nat.Base.html#4056" class="Function">nonTrivial⇒nonZero</a> <a id="7182" class="Symbol">_</a>

<a id="prime⇒nonTrivial"></a><a id="7185" href="Data.Nat.Primality.html#7185" class="Function">prime⇒nonTrivial</a> <a id="7202" class="Symbol">:</a> <a id="7204" href="Data.Nat.Primality.html#3150" class="Record">Prime</a> <a id="7210" href="Data.Nat.Primality.html#1237" class="Generalizable">p</a> <a id="7212" class="Symbol">→</a> <a id="7214" href="Data.Nat.Base.html#3801" class="Record">NonTrivial</a> <a id="7225" href="Data.Nat.Primality.html#1237" class="Generalizable">p</a>
<a id="7227" href="Data.Nat.Primality.html#7185" class="Function">prime⇒nonTrivial</a> <a id="7244" class="Symbol">_</a> <a id="7246" class="Symbol">=</a> <a id="7248" href="Data.Nat.Primality.html#1246" class="Function">recompute-nonTrivial</a>

<a id="prime?"></a><a id="7270" href="Data.Nat.Primality.html#7270" class="Function">prime?</a> <a id="7277" class="Symbol">:</a> <a id="7279" href="Relation.Unary.html#4543" class="Function">Decidable</a> <a id="7289" href="Data.Nat.Primality.html#3150" class="Record">Prime</a>
<a id="7295" href="Data.Nat.Primality.html#7270" class="Function">prime?</a> <a id="7302" class="Number">0</a>        <a id="7311" class="Symbol">=</a> <a id="7313" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="7316" href="Data.Nat.Primality.html#6992" class="Function">¬prime[0]</a>
<a id="7326" href="Data.Nat.Primality.html#7270" class="Function">prime?</a> <a id="7333" class="Number">1</a>        <a id="7342" class="Symbol">=</a> <a id="7344" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="7347" href="Data.Nat.Primality.html#7028" class="Function">¬prime[1]</a>
<a id="7357" href="Data.Nat.Primality.html#7270" class="Function">prime?</a> <a id="7364" href="Data.Nat.Primality.html#7364" class="Bound">n</a><a id="7365" class="Symbol">@(</a><a id="7367" href="Data.Nat.Base.html#1101" class="InductiveConstructor">2+</a> <a id="7370" class="Symbol">_)</a> <a id="7373" class="Symbol">=</a> <a id="7375" href="Relation.Nullary.Decidable.html#1241" class="Function">Dec.map</a> <a id="7383" href="Data.Nat.Primality.html#7870" class="Function">PrimeUpTo⇔Prime</a> <a id="7399" class="Symbol">(</a><a id="7400" href="Data.Nat.Primality.html#8018" class="Function">primeUpTo?</a> <a id="7411" href="Data.Nat.Primality.html#7364" class="Bound">n</a><a id="7412" class="Symbol">)</a>
  <a id="7416" class="Keyword">where</a>
  <a id="7424" class="Comment">-- Equivalent bounded predicate definition</a>
  <a id="7469" href="Data.Nat.Primality.html#7469" class="Function">PrimeUpTo</a> <a id="7479" class="Symbol">:</a> <a id="7481" href="Relation.Unary.html#1178" class="Function">Pred</a> <a id="7486" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="7488" class="Symbol">_</a>
  <a id="7492" href="Data.Nat.Primality.html#7469" class="Function">PrimeUpTo</a> <a id="7502" href="Data.Nat.Primality.html#7502" class="Bound">n</a> <a id="7504" class="Symbol">=</a> <a id="7506" class="Symbol">∀</a> <a id="7508" class="Symbol">{</a><a id="7509" href="Data.Nat.Primality.html#7509" class="Bound">d</a><a id="7510" class="Symbol">}</a> <a id="7512" class="Symbol">→</a> <a id="7514" href="Data.Nat.Primality.html#7509" class="Bound">d</a> <a id="7516" href="Data.Nat.Base.html#1807" class="Function Operator">&lt;</a> <a id="7518" href="Data.Nat.Primality.html#7502" class="Bound">n</a> <a id="7520" class="Symbol">→</a> <a id="7522" href="Data.Nat.Base.html#3801" class="Record">NonTrivial</a> <a id="7533" href="Data.Nat.Primality.html#7509" class="Bound">d</a> <a id="7535" class="Symbol">→</a> <a id="7537" href="Data.Nat.Primality.html#7509" class="Bound">d</a> <a id="7539" href="Data.Nat.Divisibility.Core.html#1265" class="Function Operator">∤</a> <a id="7541" href="Data.Nat.Primality.html#7502" class="Bound">n</a>

  <a id="7546" class="Comment">-- Proof of equivalence</a>
  <a id="7572" href="Data.Nat.Primality.html#7572" class="Function">prime⇒prime-upto</a> <a id="7589" class="Symbol">:</a> <a id="7591" href="Data.Nat.Primality.html#3150" class="Record">Prime</a> <a id="7597" href="Data.Nat.Primality.html#7364" class="Bound">n</a> <a id="7599" class="Symbol">→</a> <a id="7601" href="Data.Nat.Primality.html#7469" class="Function">PrimeUpTo</a> <a id="7611" href="Data.Nat.Primality.html#7364" class="Bound">n</a>
  <a id="7615" href="Data.Nat.Primality.html#7572" class="Function">prime⇒prime-upto</a> <a id="7632" class="Symbol">(</a><a id="7633" href="Data.Nat.Primality.html#3190" class="InductiveConstructor">prime</a> <a id="7639" href="Data.Nat.Primality.html#7639" class="Bound">p</a><a id="7640" class="Symbol">)</a> <a id="7642" class="Symbol">{</a><a id="7643" href="Data.Nat.Primality.html#7643" class="Bound">d</a><a id="7644" class="Symbol">}</a> <a id="7646" href="Data.Nat.Primality.html#7646" class="Bound">d&lt;n</a> <a id="7650" href="Data.Nat.Primality.html#7650" class="Bound">ntd</a> <a id="7654" href="Data.Nat.Primality.html#7654" class="Bound">d∣n</a>
    <a id="7662" class="Symbol">=</a> <a id="7664" href="Data.Nat.Primality.html#7639" class="Bound">p</a> <a id="7666" class="Symbol">(</a><a id="7667" href="Data.Nat.Primality.html#2657" class="InductiveConstructor">composite</a> <a id="7677" href="Data.Nat.Primality.html#7646" class="Bound">d&lt;n</a> <a id="7681" href="Data.Nat.Primality.html#7654" class="Bound">d∣n</a><a id="7684" class="Symbol">)</a> <a id="7686" class="Keyword">where</a> <a id="7692" class="Keyword">instance</a> <a id="7701" href="Data.Nat.Primality.html#7701" class="Function">_</a> <a id="7703" class="Symbol">=</a> <a id="7705" href="Data.Nat.Primality.html#7650" class="Bound">ntd</a>

  <a id="7712" href="Data.Nat.Primality.html#7712" class="Function">prime-upto⇒prime</a> <a id="7729" class="Symbol">:</a> <a id="7731" class="Symbol">.{{</a><a id="7734" href="Data.Nat.Base.html#3801" class="Record">NonTrivial</a> <a id="7745" href="Data.Nat.Primality.html#7364" class="Bound">n</a><a id="7746" class="Symbol">}}</a> <a id="7749" class="Symbol">→</a> <a id="7751" href="Data.Nat.Primality.html#7469" class="Function">PrimeUpTo</a> <a id="7761" href="Data.Nat.Primality.html#7364" class="Bound">n</a> <a id="7763" class="Symbol">→</a> <a id="7765" href="Data.Nat.Primality.html#3150" class="Record">Prime</a> <a id="7771" href="Data.Nat.Primality.html#7364" class="Bound">n</a>
  <a id="7775" href="Data.Nat.Primality.html#7712" class="Function">prime-upto⇒prime</a> <a id="7792" href="Data.Nat.Primality.html#7792" class="Bound">upto</a> <a id="7797" class="Symbol">=</a> <a id="7799" href="Data.Nat.Primality.html#3190" class="InductiveConstructor">prime</a>
    <a id="7809" class="Symbol">λ</a> <a id="7811" class="Symbol">(</a><a id="7812" href="Data.Nat.Primality.html#2657" class="InductiveConstructor">composite</a> <a id="7822" href="Data.Nat.Primality.html#7822" class="Bound">d&lt;n</a> <a id="7826" href="Data.Nat.Primality.html#7826" class="Bound">d∣n</a><a id="7829" class="Symbol">)</a> <a id="7831" class="Symbol">→</a> <a id="7833" href="Data.Nat.Primality.html#7792" class="Bound">upto</a> <a id="7838" href="Data.Nat.Primality.html#7822" class="Bound">d&lt;n</a> <a id="7842" href="Data.Nat.Primality.html#1246" class="Function">recompute-nonTrivial</a> <a id="7863" href="Data.Nat.Primality.html#7826" class="Bound">d∣n</a>

  <a id="7870" href="Data.Nat.Primality.html#7870" class="Function">PrimeUpTo⇔Prime</a> <a id="7886" class="Symbol">:</a> <a id="7888" class="Symbol">.{{</a><a id="7891" href="Data.Nat.Base.html#3801" class="Record">NonTrivial</a> <a id="7902" href="Data.Nat.Primality.html#7364" class="Bound">n</a><a id="7903" class="Symbol">}}</a> <a id="7906" class="Symbol">→</a> <a id="7908" href="Data.Nat.Primality.html#7469" class="Function">PrimeUpTo</a> <a id="7918" href="Data.Nat.Primality.html#7364" class="Bound">n</a> <a id="7920" href="Function.Bundles.html#12400" class="Function Operator">⇔</a> <a id="7922" href="Data.Nat.Primality.html#3150" class="Record">Prime</a> <a id="7928" href="Data.Nat.Primality.html#7364" class="Bound">n</a>
  <a id="7932" href="Data.Nat.Primality.html#7870" class="Function">PrimeUpTo⇔Prime</a> <a id="7948" class="Symbol">=</a> <a id="7950" href="Function.Bundles.html#13499" class="Function">mk⇔</a> <a id="7954" href="Data.Nat.Primality.html#7712" class="Function">prime-upto⇒prime</a> <a id="7971" href="Data.Nat.Primality.html#7572" class="Function">prime⇒prime-upto</a>

  <a id="7991" class="Comment">-- Proof of decidability</a>
  <a id="8018" href="Data.Nat.Primality.html#8018" class="Function">primeUpTo?</a> <a id="8029" class="Symbol">:</a> <a id="8031" href="Relation.Unary.html#4543" class="Function">Decidable</a> <a id="8041" href="Data.Nat.Primality.html#7469" class="Function">PrimeUpTo</a>
  <a id="8053" href="Data.Nat.Primality.html#8018" class="Function">primeUpTo?</a> <a id="8064" href="Data.Nat.Primality.html#8064" class="Bound">n</a> <a id="8066" class="Symbol">=</a> <a id="8068" href="Data.Nat.Properties.html#70303" class="Function">allUpTo?</a> <a id="8077" class="Symbol">(λ</a> <a id="8080" href="Data.Nat.Primality.html#8080" class="Bound">d</a> <a id="8082" class="Symbol">→</a> <a id="8084" href="Data.Nat.Properties.html#2977" class="Function">nonTrivial?</a> <a id="8096" href="Data.Nat.Primality.html#8080" class="Bound">d</a> <a id="8098" href="Relation.Nullary.Decidable.Core.html#3363" class="Function Operator">→-dec</a> <a id="8104" href="Relation.Nullary.Decidable.Core.html#3011" class="Function">¬?</a> <a id="8107" class="Symbol">(</a><a id="8108" href="Data.Nat.Primality.html#8080" class="Bound">d</a> <a id="8110" href="Data.Nat.Divisibility.html#4316" class="Function Operator">∣?</a> <a id="8113" href="Data.Nat.Primality.html#8064" class="Bound">n</a><a id="8114" class="Symbol">))</a> <a id="8117" href="Data.Nat.Primality.html#8064" class="Bound">n</a>

<a id="8120" class="Comment">-- Euclid&#39;s lemma - for p prime, if p ∣ m * n, then either p ∣ m or p ∣ n.</a>
<a id="8195" class="Comment">--</a>
<a id="8198" class="Comment">-- This demonstrates that the usual definition of prime numbers matches</a>
<a id="8270" class="Comment">-- the ring theoretic definition of a prime element of the semiring ℕ.</a>
<a id="8341" class="Comment">-- This is useful for proving many other theorems involving prime numbers.</a>
<a id="euclidsLemma"></a><a id="8416" href="Data.Nat.Primality.html#8416" class="Function">euclidsLemma</a> <a id="8429" class="Symbol">:</a> <a id="8431" class="Symbol">∀</a> <a id="8433" href="Data.Nat.Primality.html#8433" class="Bound">m</a> <a id="8435" href="Data.Nat.Primality.html#8435" class="Bound">n</a> <a id="8437" class="Symbol">{</a><a id="8438" href="Data.Nat.Primality.html#8438" class="Bound">p</a><a id="8439" class="Symbol">}</a> <a id="8441" class="Symbol">→</a> <a id="8443" href="Data.Nat.Primality.html#3150" class="Record">Prime</a> <a id="8449" href="Data.Nat.Primality.html#8438" class="Bound">p</a> <a id="8451" class="Symbol">→</a> <a id="8453" href="Data.Nat.Primality.html#8438" class="Bound">p</a> <a id="8455" href="Data.Nat.Divisibility.Core.html#1159" class="Record Operator">∣</a> <a id="8457" href="Data.Nat.Primality.html#8433" class="Bound">m</a> <a id="8459" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="8461" href="Data.Nat.Primality.html#8435" class="Bound">n</a> <a id="8463" class="Symbol">→</a> <a id="8465" href="Data.Nat.Primality.html#8438" class="Bound">p</a> <a id="8467" href="Data.Nat.Divisibility.Core.html#1159" class="Record Operator">∣</a> <a id="8469" href="Data.Nat.Primality.html#8433" class="Bound">m</a> <a id="8471" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="8473" href="Data.Nat.Primality.html#8438" class="Bound">p</a> <a id="8475" href="Data.Nat.Divisibility.Core.html#1159" class="Record Operator">∣</a> <a id="8477" href="Data.Nat.Primality.html#8435" class="Bound">n</a>
<a id="8479" href="Data.Nat.Primality.html#8416" class="Function">euclidsLemma</a> <a id="8492" href="Data.Nat.Primality.html#8492" class="Bound">m</a> <a id="8494" href="Data.Nat.Primality.html#8494" class="Bound">n</a> <a id="8496" class="Symbol">{</a><a id="8497" href="Data.Nat.Primality.html#8497" class="Bound">p</a><a id="8498" class="Symbol">}</a> <a id="8500" href="Data.Nat.Primality.html#8500" class="Bound">pp</a><a id="8502" class="Symbol">@(</a><a id="8504" href="Data.Nat.Primality.html#3190" class="InductiveConstructor">prime</a> <a id="8510" href="Data.Nat.Primality.html#8510" class="Bound">pr</a><a id="8512" class="Symbol">)</a> <a id="8514" href="Data.Nat.Primality.html#8514" class="Bound">p∣m*n</a> <a id="8520" class="Symbol">=</a> <a id="8522" href="Data.Nat.Primality.html#8749" class="Function">result</a>
  <a id="8531" class="Keyword">where</a>
  <a id="8539" class="Keyword">open</a> <a id="8544" href="Data.Nat.Divisibility.html#5070" class="Module">∣-Reasoning</a>
  <a id="8558" class="Keyword">instance</a> <a id="8567" href="Data.Nat.Primality.html#8567" class="Function">_</a> <a id="8569" class="Symbol">=</a> <a id="8571" href="Data.Nat.Primality.html#7109" class="Function">prime⇒nonZero</a> <a id="8585" href="Data.Nat.Primality.html#8500" class="Bound">pp</a>

  <a id="8591" href="Data.Nat.Primality.html#8591" class="Function">p∣rmn</a> <a id="8597" class="Symbol">:</a> <a id="8599" class="Symbol">∀</a> <a id="8601" href="Data.Nat.Primality.html#8601" class="Bound">r</a> <a id="8603" class="Symbol">→</a> <a id="8605" href="Data.Nat.Primality.html#8497" class="Bound">p</a> <a id="8607" href="Data.Nat.Divisibility.Core.html#1159" class="Record Operator">∣</a> <a id="8609" href="Data.Nat.Primality.html#8601" class="Bound">r</a> <a id="8611" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="8613" href="Data.Nat.Primality.html#8492" class="Bound">m</a> <a id="8615" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="8617" href="Data.Nat.Primality.html#8494" class="Bound">n</a>
  <a id="8621" href="Data.Nat.Primality.html#8591" class="Function">p∣rmn</a> <a id="8627" href="Data.Nat.Primality.html#8627" class="Bound">r</a> <a id="8629" class="Symbol">=</a> <a id="8631" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
    <a id="8641" href="Data.Nat.Primality.html#8497" class="Bound">p</a>           <a id="8653" href="Relation.Binary.Reasoning.Syntax.html#6402" class="Function">∣⟨</a> <a id="8656" href="Data.Nat.Primality.html#8514" class="Bound">p∣m*n</a> <a id="8662" href="Relation.Binary.Reasoning.Syntax.html#6402" class="Function">⟩</a>
    <a id="8668" href="Data.Nat.Primality.html#8492" class="Bound">m</a> <a id="8670" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="8672" href="Data.Nat.Primality.html#8494" class="Bound">n</a>       <a id="8680" href="Relation.Binary.Reasoning.Syntax.html#6402" class="Function">∣⟨</a> <a id="8683" href="Data.Nat.Divisibility.html#6358" class="Function">n∣m*n</a> <a id="8689" href="Data.Nat.Primality.html#8627" class="Bound">r</a> <a id="8691" href="Relation.Binary.Reasoning.Syntax.html#6402" class="Function">⟩</a>
    <a id="8697" href="Data.Nat.Primality.html#8627" class="Bound">r</a> <a id="8699" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="8701" class="Symbol">(</a><a id="8702" href="Data.Nat.Primality.html#8492" class="Bound">m</a> <a id="8704" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="8706" href="Data.Nat.Primality.html#8494" class="Bound">n</a><a id="8707" class="Symbol">)</a> <a id="8709" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">≡⟨</a> <a id="8712" href="Data.Nat.Properties.html#22870" class="Function">*-assoc</a> <a id="8720" href="Data.Nat.Primality.html#8627" class="Bound">r</a> <a id="8722" href="Data.Nat.Primality.html#8492" class="Bound">m</a> <a id="8724" href="Data.Nat.Primality.html#8494" class="Bound">n</a> <a id="8726" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">⟨</a>
    <a id="8732" href="Data.Nat.Primality.html#8627" class="Bound">r</a> <a id="8734" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="8736" href="Data.Nat.Primality.html#8492" class="Bound">m</a> <a id="8738" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="8740" href="Data.Nat.Primality.html#8494" class="Bound">n</a>   <a id="8744" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>

  <a id="8749" href="Data.Nat.Primality.html#8749" class="Function">result</a> <a id="8756" class="Symbol">:</a> <a id="8758" href="Data.Nat.Primality.html#8497" class="Bound">p</a> <a id="8760" href="Data.Nat.Divisibility.Core.html#1159" class="Record Operator">∣</a> <a id="8762" href="Data.Nat.Primality.html#8492" class="Bound">m</a> <a id="8764" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="8766" href="Data.Nat.Primality.html#8497" class="Bound">p</a> <a id="8768" href="Data.Nat.Divisibility.Core.html#1159" class="Record Operator">∣</a> <a id="8770" href="Data.Nat.Primality.html#8494" class="Bound">n</a>
  <a id="8774" href="Data.Nat.Primality.html#8749" class="Function">result</a> <a id="8781" class="Keyword">with</a> <a id="8786" href="Data.Nat.GCD.html#13472" class="Function">Bézout.lemma</a> <a id="8799" href="Data.Nat.Primality.html#8492" class="Bound">m</a> <a id="8801" href="Data.Nat.Primality.html#8497" class="Bound">p</a>
  <a id="8805" class="Comment">-- if the GCD of m and p is zero then p must be zero, which is</a>
  <a id="8870" class="Comment">-- impossible as p is a prime.</a>
  <a id="8903" class="Comment">-- note: this should be a typechecker-rejectable case!?</a>
  <a id="8961" href="Data.Nat.Primality.html#8749" class="Function">...</a> <a id="8965" class="Symbol">|</a> <a id="8967" href="Data.Nat.GCD.html#12698" class="InductiveConstructor">Bézout.result</a> <a id="8981" class="Number">0</a> <a id="8983" href="Data.Nat.Primality.html#8983" class="Bound">g</a> <a id="8985" class="Symbol">_</a> <a id="8987" class="Symbol">=</a>
    <a id="8993" href="Relation.Nullary.Negation.Core.html#1270" class="Function">contradiction</a> <a id="9007" class="Symbol">(</a><a id="9008" href="Data.Nat.Divisibility.html#5468" class="Function">0∣⇒≡0</a> <a id="9014" class="Symbol">(</a><a id="9015" href="Data.Nat.GCD.html#8558" class="Function">GCD.gcd∣n</a> <a id="9025" href="Data.Nat.Primality.html#8983" class="Bound">g</a><a id="9026" class="Symbol">))</a> <a id="9029" class="Symbol">(</a><a id="9030" href="Data.Nat.Base.html#3610" class="Function">≢-nonZero⁻¹</a> <a id="9042" class="Symbol">_)</a>

  <a id="9048" class="Comment">-- if the GCD of m and p is one then m and p are coprime, and we know</a>
  <a id="9120" class="Comment">-- that for some integers s and r, sm + rp = 1. We can use this fact</a>
  <a id="9191" class="Comment">-- to determine that p divides n</a>
  <a id="9226" href="Data.Nat.Primality.html#8749" class="Function">...</a> <a id="9230" class="Symbol">|</a> <a id="9232" href="Data.Nat.GCD.html#12698" class="InductiveConstructor">Bézout.result</a> <a id="9246" class="Number">1</a> <a id="9248" class="Symbol">_</a> <a id="9250" class="Symbol">(</a><a id="9251" href="Data.Nat.GCD.html#11420" class="InductiveConstructor">Bézout.+-</a> <a id="9261" href="Data.Nat.Primality.html#9261" class="Bound">r</a> <a id="9263" href="Data.Nat.Primality.html#9263" class="Bound">s</a> <a id="9265" href="Data.Nat.Primality.html#9265" class="Bound">1+sp≡rm</a><a id="9272" class="Symbol">)</a> <a id="9274" class="Symbol">=</a>
    <a id="9280" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="9285" class="Symbol">(</a><a id="9286" href="Function.Base.html#1638" class="Function">flip</a> <a id="9291" href="Data.Nat.Divisibility.html#5905" class="Function">∣m+n∣m⇒∣n</a> <a id="9301" class="Symbol">(</a><a id="9302" href="Data.Nat.Divisibility.html#6474" class="Function">n∣m*n*o</a> <a id="9310" href="Data.Nat.Primality.html#9263" class="Bound">s</a> <a id="9312" href="Data.Nat.Primality.html#8494" class="Bound">n</a><a id="9313" class="Symbol">)</a> <a id="9315" class="Symbol">(</a><a id="9316" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
      <a id="9328" href="Data.Nat.Primality.html#8497" class="Bound">p</a>             <a id="9342" href="Relation.Binary.Reasoning.Syntax.html#6402" class="Function">∣⟨</a> <a id="9345" href="Data.Nat.Primality.html#8591" class="Function">p∣rmn</a> <a id="9351" href="Data.Nat.Primality.html#9261" class="Bound">r</a> <a id="9353" href="Relation.Binary.Reasoning.Syntax.html#6402" class="Function">⟩</a>
      <a id="9361" href="Data.Nat.Primality.html#9261" class="Bound">r</a> <a id="9363" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="9365" href="Data.Nat.Primality.html#8492" class="Bound">m</a> <a id="9367" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="9369" href="Data.Nat.Primality.html#8494" class="Bound">n</a>     <a id="9375" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">≡⟨</a> <a id="9378" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a> <a id="9383" class="Symbol">(</a><a id="9384" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">_*</a> <a id="9387" href="Data.Nat.Primality.html#8494" class="Bound">n</a><a id="9388" class="Symbol">)</a> <a id="9390" href="Data.Nat.Primality.html#9265" class="Bound">1+sp≡rm</a> <a id="9398" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">⟨</a>
      <a id="9406" href="Data.Nat.Primality.html#8494" class="Bound">n</a> <a id="9408" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="9410" href="Data.Nat.Primality.html#9263" class="Bound">s</a> <a id="9412" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="9414" href="Data.Nat.Primality.html#8497" class="Bound">p</a> <a id="9416" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="9418" href="Data.Nat.Primality.html#8494" class="Bound">n</a> <a id="9420" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="9423" href="Data.Nat.Properties.html#15642" class="Function">+-comm</a> <a id="9430" href="Data.Nat.Primality.html#8494" class="Bound">n</a> <a id="9432" class="Symbol">(</a><a id="9433" href="Data.Nat.Primality.html#9263" class="Bound">s</a> <a id="9435" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="9437" href="Data.Nat.Primality.html#8497" class="Bound">p</a> <a id="9439" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="9441" href="Data.Nat.Primality.html#8494" class="Bound">n</a><a id="9442" class="Symbol">)</a> <a id="9444" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
      <a id="9452" href="Data.Nat.Primality.html#9263" class="Bound">s</a> <a id="9454" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="9456" href="Data.Nat.Primality.html#8497" class="Bound">p</a> <a id="9458" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="9460" href="Data.Nat.Primality.html#8494" class="Bound">n</a> <a id="9462" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="9464" href="Data.Nat.Primality.html#8494" class="Bound">n</a> <a id="9466" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a><a id="9467" class="Symbol">))</a>

  <a id="9473" href="Data.Nat.Primality.html#8749" class="Function">...</a> <a id="9477" class="Symbol">|</a> <a id="9479" href="Data.Nat.GCD.html#12698" class="InductiveConstructor">Bézout.result</a> <a id="9493" class="Number">1</a> <a id="9495" class="Symbol">_</a> <a id="9497" class="Symbol">(</a><a id="9498" href="Data.Nat.GCD.html#11483" class="InductiveConstructor">Bézout.-+</a> <a id="9508" href="Data.Nat.Primality.html#9508" class="Bound">r</a> <a id="9510" href="Data.Nat.Primality.html#9510" class="Bound">s</a> <a id="9512" href="Data.Nat.Primality.html#9512" class="Bound">1+rm≡sp</a><a id="9519" class="Symbol">)</a> <a id="9521" class="Symbol">=</a>
    <a id="9527" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="9532" class="Symbol">(</a><a id="9533" href="Function.Base.html#1638" class="Function">flip</a> <a id="9538" href="Data.Nat.Divisibility.html#5905" class="Function">∣m+n∣m⇒∣n</a> <a id="9548" class="Symbol">(</a><a id="9549" href="Data.Nat.Primality.html#8591" class="Function">p∣rmn</a> <a id="9555" href="Data.Nat.Primality.html#9508" class="Bound">r</a><a id="9556" class="Symbol">)</a> <a id="9558" class="Symbol">(</a><a id="9559" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
      <a id="9571" href="Data.Nat.Primality.html#8497" class="Bound">p</a>             <a id="9585" href="Relation.Binary.Reasoning.Syntax.html#6402" class="Function">∣⟨</a> <a id="9588" href="Data.Nat.Divisibility.html#6474" class="Function">n∣m*n*o</a> <a id="9596" href="Data.Nat.Primality.html#9510" class="Bound">s</a> <a id="9598" href="Data.Nat.Primality.html#8494" class="Bound">n</a> <a id="9600" href="Relation.Binary.Reasoning.Syntax.html#6402" class="Function">⟩</a>
      <a id="9608" href="Data.Nat.Primality.html#9510" class="Bound">s</a> <a id="9610" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="9612" href="Data.Nat.Primality.html#8497" class="Bound">p</a> <a id="9614" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="9616" href="Data.Nat.Primality.html#8494" class="Bound">n</a>     <a id="9622" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">≡⟨</a> <a id="9625" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a> <a id="9630" class="Symbol">(</a><a id="9631" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">_*</a> <a id="9634" href="Data.Nat.Primality.html#8494" class="Bound">n</a><a id="9635" class="Symbol">)</a> <a id="9637" href="Data.Nat.Primality.html#9512" class="Bound">1+rm≡sp</a> <a id="9645" href="Relation.Binary.Reasoning.Syntax.html#11140" class="Function">⟨</a>
      <a id="9653" href="Data.Nat.Primality.html#8494" class="Bound">n</a> <a id="9655" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="9657" href="Data.Nat.Primality.html#9508" class="Bound">r</a> <a id="9659" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="9661" href="Data.Nat.Primality.html#8492" class="Bound">m</a> <a id="9663" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="9665" href="Data.Nat.Primality.html#8494" class="Bound">n</a> <a id="9667" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="9670" href="Data.Nat.Properties.html#15642" class="Function">+-comm</a> <a id="9677" href="Data.Nat.Primality.html#8494" class="Bound">n</a> <a id="9679" class="Symbol">(</a><a id="9680" href="Data.Nat.Primality.html#9508" class="Bound">r</a> <a id="9682" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="9684" href="Data.Nat.Primality.html#8492" class="Bound">m</a> <a id="9686" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="9688" href="Data.Nat.Primality.html#8494" class="Bound">n</a><a id="9689" class="Symbol">)</a> <a id="9691" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
      <a id="9699" href="Data.Nat.Primality.html#9508" class="Bound">r</a> <a id="9701" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="9703" href="Data.Nat.Primality.html#8492" class="Bound">m</a> <a id="9705" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="9707" href="Data.Nat.Primality.html#8494" class="Bound">n</a> <a id="9709" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="9711" href="Data.Nat.Primality.html#8494" class="Bound">n</a> <a id="9713" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a><a id="9714" class="Symbol">))</a>

  <a id="9720" class="Comment">-- if the GCD of m and p is greater than one, then it must be p and</a>
  <a id="9790" class="Comment">-- hence p ∣ m.</a>
  <a id="9808" href="Data.Nat.Primality.html#8749" class="Function">...</a> <a id="9812" class="Symbol">|</a> <a id="9814" href="Data.Nat.GCD.html#12698" class="InductiveConstructor">Bézout.result</a> <a id="9828" href="Data.Nat.Primality.html#9828" class="Bound">d</a><a id="9829" class="Symbol">@(</a><a id="9831" href="Data.Nat.Base.html#1101" class="InductiveConstructor">2+</a> <a id="9834" class="Symbol">_)</a> <a id="9837" href="Data.Nat.Primality.html#9837" class="Bound">g</a> <a id="9839" class="Symbol">_</a> <a id="9841" class="Keyword">with</a> <a id="9846" href="Data.Nat.Primality.html#9828" class="Bound">d</a> <a id="9848" href="Data.Nat.Properties.html#3874" class="Function Operator">≟</a> <a id="9850" href="Data.Nat.Primality.html#8497" class="Bound">p</a>
  <a id="9854" class="Symbol">...</a>   <a id="9860" class="Symbol">|</a> <a id="9862" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a> <a id="9866" href="Data.Nat.Primality.html#9866" class="Bound">d≡p</a><a id="9869" class="Symbol">@</a><a id="9870" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="9875" class="Symbol">=</a> <a id="9877" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="9882" class="Symbol">(</a><a id="9883" href="Data.Nat.GCD.html#8505" class="Function">GCD.gcd∣m</a> <a id="9893" class="Bound">g</a><a id="9894" class="Symbol">)</a>
  <a id="9898" class="Symbol">...</a>   <a id="9904" class="Symbol">|</a> <a id="9906" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a>  <a id="9910" href="Data.Nat.Primality.html#9910" class="Bound">d≢p</a> <a id="9914" class="Symbol">=</a> <a id="9916" href="Relation.Nullary.Negation.Core.html#1270" class="Function">contradiction</a> <a id="9930" class="Symbol">(</a><a id="9931" href="Data.Nat.Primality.html#4871" class="Function">composite-≢</a> <a id="9943" class="Bound">d</a> <a id="9945" href="Data.Nat.Primality.html#9910" class="Bound">d≢p</a> <a id="9949" class="Symbol">(</a><a id="9950" href="Data.Nat.GCD.html#8558" class="Function">GCD.gcd∣n</a> <a id="9960" class="Bound">g</a><a id="9961" class="Symbol">))</a> <a id="9964" href="Data.Nat.Primality.html#8510" class="Bound">pr</a>

<a id="9968" class="Comment">-- Relationship between roughness and primality.</a>
<a id="prime⇒rough"></a><a id="10017" href="Data.Nat.Primality.html#10017" class="Function">prime⇒rough</a> <a id="10029" class="Symbol">:</a> <a id="10031" href="Data.Nat.Primality.html#3150" class="Record">Prime</a> <a id="10037" href="Data.Nat.Primality.html#1237" class="Generalizable">p</a> <a id="10039" class="Symbol">→</a> <a id="10041" href="Data.Nat.Primality.html#1237" class="Generalizable">p</a> <a id="10043" href="Data.Nat.Primality.html#2253" class="Function Operator">Rough</a> <a id="10049" href="Data.Nat.Primality.html#1237" class="Generalizable">p</a>
<a id="10051" href="Data.Nat.Primality.html#10017" class="Function">prime⇒rough</a> <a id="10063" class="Symbol">(</a><a id="10064" href="Data.Nat.Primality.html#3190" class="InductiveConstructor">prime</a> <a id="10070" href="Data.Nat.Primality.html#10070" class="Bound">pr</a><a id="10072" class="Symbol">)</a> <a id="10074" class="Symbol">=</a> <a id="10076" href="Data.Nat.Primality.html#10070" class="Bound">pr</a>

<a id="10080" class="Comment">-- If a number n is p-rough, and p &gt; 1 divides n, then p must be prime</a>
<a id="rough∧∣⇒prime"></a><a id="10151" href="Data.Nat.Primality.html#10151" class="Function">rough∧∣⇒prime</a> <a id="10165" class="Symbol">:</a> <a id="10167" class="Symbol">.{{</a><a id="10170" href="Data.Nat.Base.html#3801" class="Record">NonTrivial</a> <a id="10181" href="Data.Nat.Primality.html#1237" class="Generalizable">p</a><a id="10182" class="Symbol">}}</a> <a id="10185" class="Symbol">→</a> <a id="10187" href="Data.Nat.Primality.html#1237" class="Generalizable">p</a> <a id="10189" href="Data.Nat.Primality.html#2253" class="Function Operator">Rough</a> <a id="10195" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a> <a id="10197" class="Symbol">→</a> <a id="10199" href="Data.Nat.Primality.html#1237" class="Generalizable">p</a> <a id="10201" href="Data.Nat.Divisibility.Core.html#1159" class="Record Operator">∣</a> <a id="10203" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a> <a id="10205" class="Symbol">→</a> <a id="10207" href="Data.Nat.Primality.html#3150" class="Record">Prime</a> <a id="10213" href="Data.Nat.Primality.html#1237" class="Generalizable">p</a>
<a id="10215" href="Data.Nat.Primality.html#10151" class="Function">rough∧∣⇒prime</a> <a id="10229" href="Data.Nat.Primality.html#10229" class="Bound">r</a> <a id="10231" href="Data.Nat.Primality.html#10231" class="Bound">p∣n</a> <a id="10235" class="Symbol">=</a> <a id="10237" href="Data.Nat.Primality.html#3190" class="InductiveConstructor">prime</a> <a id="10243" class="Symbol">(</a><a id="10244" href="Data.Nat.Primality.html#4647" class="Function">rough∧∣⇒rough</a> <a id="10258" href="Data.Nat.Primality.html#10229" class="Bound">r</a> <a id="10260" href="Data.Nat.Primality.html#10231" class="Bound">p∣n</a><a id="10263" class="Symbol">)</a>

<a id="10266" class="Comment">-- If a number n is m-rough, and m * m &gt; n, then n must be prime.</a>
<a id="rough∧square&gt;⇒prime"></a><a id="10332" href="Data.Nat.Primality.html#10332" class="Function">rough∧square&gt;⇒prime</a> <a id="10352" class="Symbol">:</a> <a id="10354" class="Symbol">.{{</a><a id="10357" href="Data.Nat.Base.html#3801" class="Record">NonTrivial</a> <a id="10368" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a><a id="10369" class="Symbol">}}</a> <a id="10372" class="Symbol">→</a> <a id="10374" href="Data.Nat.Primality.html#1231" class="Generalizable">m</a> <a id="10376" href="Data.Nat.Primality.html#2253" class="Function Operator">Rough</a> <a id="10382" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a> <a id="10384" class="Symbol">→</a> <a id="10386" href="Data.Nat.Primality.html#1231" class="Generalizable">m</a> <a id="10388" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="10390" href="Data.Nat.Primality.html#1231" class="Generalizable">m</a> <a id="10392" href="Data.Nat.Base.html#2295" class="Function Operator">&gt;</a> <a id="10394" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a> <a id="10396" class="Symbol">→</a> <a id="10398" href="Data.Nat.Primality.html#3150" class="Record">Prime</a> <a id="10404" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a>
<a id="10406" href="Data.Nat.Primality.html#10332" class="Function">rough∧square&gt;⇒prime</a> <a id="10426" href="Data.Nat.Primality.html#10426" class="Bound">rough</a> <a id="10432" href="Data.Nat.Primality.html#10432" class="Bound">m*m&gt;n</a> <a id="10438" class="Symbol">=</a> <a id="10440" href="Data.Nat.Primality.html#3190" class="InductiveConstructor">prime</a> <a id="10446" href="Data.Nat.Primality.html#10469" class="Function">¬composite</a>
  <a id="10459" class="Keyword">where</a>
    <a id="10469" href="Data.Nat.Primality.html#10469" class="Function">¬composite</a> <a id="10480" class="Symbol">:</a> <a id="10482" href="Relation.Nullary.Negation.Core.html#658" class="Function Operator">¬</a> <a id="10484" href="Data.Nat.Primality.html#2482" class="Function">Composite</a> <a id="10494" class="Symbol">_</a>
    <a id="10500" href="Data.Nat.Primality.html#10469" class="Function">¬composite</a> <a id="10511" class="Symbol">(</a><a id="10512" href="Data.Nat.Primality.html#2657" class="InductiveConstructor">composite</a> <a id="10522" href="Data.Nat.Primality.html#10522" class="Bound">d&lt;n</a> <a id="10526" href="Data.Nat.Primality.html#10526" class="Bound">d∣n</a><a id="10529" class="Symbol">)</a> <a id="10531" class="Symbol">=</a> <a id="10533" href="Relation.Nullary.Negation.Core.html#1270" class="Function">contradiction</a> <a id="10547" class="Symbol">(</a><a id="10548" href="Data.Nat.Divisibility.html#1614" class="Function">m∣n⇒n≡quotient*m</a> <a id="10565" href="Data.Nat.Primality.html#10526" class="Bound">d∣n</a><a id="10568" class="Symbol">)</a>
      <a id="10576" class="Symbol">(</a><a id="10577" href="Data.Nat.Properties.html#9258" class="Function">&lt;⇒≢</a> <a id="10581" class="Symbol">(</a><a id="10582" href="Data.Nat.Properties.html#10921" class="Function">&lt;-≤-trans</a> <a id="10592" href="Data.Nat.Primality.html#10432" class="Bound">m*m&gt;n</a> <a id="10598" class="Symbol">(</a><a id="10599" href="Data.Nat.Properties.html#27583" class="Function">*-mono-≤</a>
        <a id="10616" class="Symbol">(</a><a id="10617" href="Data.Nat.Primality.html#4161" class="Function">rough⇒≤</a> <a id="10625" class="Symbol">(</a><a id="10626" href="Data.Nat.Primality.html#4647" class="Function">rough∧∣⇒rough</a> <a id="10640" href="Data.Nat.Primality.html#10426" class="Bound">rough</a> <a id="10646" class="Symbol">(</a><a id="10647" href="Data.Nat.Divisibility.html#1852" class="Function">quotient-∣</a> <a id="10658" href="Data.Nat.Primality.html#10526" class="Bound">d∣n</a><a id="10661" class="Symbol">)))</a>
        <a id="10673" class="Symbol">(</a><a id="10674" href="Data.Nat.Primality.html#4161" class="Function">rough⇒≤</a> <a id="10682" class="Symbol">(</a><a id="10683" href="Data.Nat.Primality.html#4647" class="Function">rough∧∣⇒rough</a> <a id="10697" href="Data.Nat.Primality.html#10426" class="Bound">rough</a> <a id="10703" href="Data.Nat.Primality.html#10526" class="Bound">d∣n</a><a id="10706" class="Symbol">)))))</a>
      <a id="10718" class="Keyword">where</a> <a id="10724" class="Keyword">instance</a> <a id="10733" href="Data.Nat.Primality.html#10733" class="Function">_</a> <a id="10735" class="Symbol">=</a> <a id="10737" href="Data.Nat.Base.html#3968" class="Function">n&gt;1⇒nonTrivial</a> <a id="10752" class="Symbol">(</a><a id="10753" href="Data.Nat.Divisibility.html#1959" class="Function">quotient&gt;1</a> <a id="10764" href="Data.Nat.Primality.html#10526" class="Bound">d∣n</a> <a id="10768" href="Data.Nat.Primality.html#10522" class="Bound">d&lt;n</a><a id="10771" class="Symbol">)</a>

<a id="10774" class="Comment">-- Relationship between compositeness and primality.</a>
<a id="composite⇒¬prime"></a><a id="10827" href="Data.Nat.Primality.html#10827" class="Function">composite⇒¬prime</a> <a id="10844" class="Symbol">:</a> <a id="10846" href="Data.Nat.Primality.html#2482" class="Function">Composite</a> <a id="10856" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a> <a id="10858" class="Symbol">→</a> <a id="10860" href="Relation.Nullary.Negation.Core.html#658" class="Function Operator">¬</a> <a id="10862" href="Data.Nat.Primality.html#3150" class="Record">Prime</a> <a id="10868" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a>
<a id="10870" href="Data.Nat.Primality.html#10827" class="Function">composite⇒¬prime</a> <a id="10887" href="Data.Nat.Primality.html#10887" class="Bound">composite[d]</a> <a id="10900" class="Symbol">(</a><a id="10901" href="Data.Nat.Primality.html#3190" class="InductiveConstructor">prime</a> <a id="10907" href="Data.Nat.Primality.html#10907" class="Bound">p</a><a id="10908" class="Symbol">)</a> <a id="10910" class="Symbol">=</a> <a id="10912" href="Data.Nat.Primality.html#10907" class="Bound">p</a> <a id="10914" href="Data.Nat.Primality.html#10887" class="Bound">composite[d]</a>

<a id="¬composite⇒prime"></a><a id="10928" href="Data.Nat.Primality.html#10928" class="Function">¬composite⇒prime</a> <a id="10945" class="Symbol">:</a> <a id="10947" class="Symbol">.{{</a><a id="10950" href="Data.Nat.Base.html#3801" class="Record">NonTrivial</a> <a id="10961" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a><a id="10962" class="Symbol">}}</a> <a id="10965" class="Symbol">→</a> <a id="10967" href="Relation.Nullary.Negation.Core.html#658" class="Function Operator">¬</a> <a id="10969" href="Data.Nat.Primality.html#2482" class="Function">Composite</a> <a id="10979" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a> <a id="10981" class="Symbol">→</a> <a id="10983" href="Data.Nat.Primality.html#3150" class="Record">Prime</a> <a id="10989" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a>
<a id="10991" href="Data.Nat.Primality.html#10928" class="Function">¬composite⇒prime</a> <a id="11008" class="Symbol">=</a> <a id="11010" href="Data.Nat.Primality.html#3190" class="InductiveConstructor">prime</a>

<a id="prime⇒¬composite"></a><a id="11017" href="Data.Nat.Primality.html#11017" class="Function">prime⇒¬composite</a> <a id="11034" class="Symbol">:</a> <a id="11036" href="Data.Nat.Primality.html#3150" class="Record">Prime</a> <a id="11042" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a> <a id="11044" class="Symbol">→</a> <a id="11046" href="Relation.Nullary.Negation.Core.html#658" class="Function Operator">¬</a> <a id="11048" href="Data.Nat.Primality.html#2482" class="Function">Composite</a> <a id="11058" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a>
<a id="11060" href="Data.Nat.Primality.html#11017" class="Function">prime⇒¬composite</a> <a id="11077" class="Symbol">(</a><a id="11078" href="Data.Nat.Primality.html#3190" class="InductiveConstructor">prime</a> <a id="11084" href="Data.Nat.Primality.html#11084" class="Bound">p</a><a id="11085" class="Symbol">)</a> <a id="11087" class="Symbol">=</a> <a id="11089" href="Data.Nat.Primality.html#11084" class="Bound">p</a>

<a id="11092" class="Comment">-- Note that this has to recompute the factor!</a>
<a id="¬prime⇒composite"></a><a id="11139" href="Data.Nat.Primality.html#11139" class="Function">¬prime⇒composite</a> <a id="11156" class="Symbol">:</a> <a id="11158" class="Symbol">.{{</a><a id="11161" href="Data.Nat.Base.html#3801" class="Record">NonTrivial</a> <a id="11172" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a><a id="11173" class="Symbol">}}</a> <a id="11176" class="Symbol">→</a> <a id="11178" href="Relation.Nullary.Negation.Core.html#658" class="Function Operator">¬</a> <a id="11180" href="Data.Nat.Primality.html#3150" class="Record">Prime</a> <a id="11186" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a> <a id="11188" class="Symbol">→</a> <a id="11190" href="Data.Nat.Primality.html#2482" class="Function">Composite</a> <a id="11200" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a>
<a id="11202" href="Data.Nat.Primality.html#11139" class="Function">¬prime⇒composite</a> <a id="11219" class="Symbol">{</a><a id="11220" href="Data.Nat.Primality.html#11220" class="Bound">n</a><a id="11221" class="Symbol">}</a> <a id="11223" href="Data.Nat.Primality.html#11223" class="Bound">¬prime[n]</a> <a id="11233" class="Symbol">=</a>
  <a id="11237" href="Relation.Nullary.Decidable.Core.html#6289" class="Function">decidable-stable</a> <a id="11254" class="Symbol">(</a><a id="11255" href="Data.Nat.Primality.html#5821" class="Function">composite?</a> <a id="11266" href="Data.Nat.Primality.html#11220" class="Bound">n</a><a id="11267" class="Symbol">)</a> <a id="11269" class="Symbol">(</a><a id="11270" href="Data.Nat.Primality.html#11223" class="Bound">¬prime[n]</a> <a id="11280" href="Function.Base.html#3626" class="Function Operator">∘′</a> <a id="11283" href="Data.Nat.Primality.html#10928" class="Function">¬composite⇒prime</a><a id="11299" class="Symbol">)</a>

<a id="productOfPrimes≢0"></a><a id="11302" href="Data.Nat.Primality.html#11302" class="Function">productOfPrimes≢0</a> <a id="11320" class="Symbol">:</a> <a id="11322" class="Symbol">∀</a> <a id="11324" class="Symbol">{</a><a id="11325" href="Data.Nat.Primality.html#11325" class="Bound">as</a><a id="11327" class="Symbol">}</a> <a id="11329" class="Symbol">→</a> <a id="11331" href="Data.List.Relation.Unary.All.html#1644" class="Datatype">All</a> <a id="11335" href="Data.Nat.Primality.html#3150" class="Record">Prime</a> <a id="11341" href="Data.Nat.Primality.html#11325" class="Bound">as</a> <a id="11344" class="Symbol">→</a> <a id="11346" href="Data.Nat.Base.html#3266" class="Record">NonZero</a> <a id="11354" class="Symbol">(</a><a id="11355" href="Data.List.Base.html#5000" class="Function">product</a> <a id="11363" href="Data.Nat.Primality.html#11325" class="Bound">as</a><a id="11365" class="Symbol">)</a>
<a id="11367" href="Data.Nat.Primality.html#11302" class="Function">productOfPrimes≢0</a> <a id="11385" href="Data.Nat.Primality.html#11385" class="Bound">pas</a> <a id="11389" class="Symbol">=</a> <a id="11391" href="Data.List.Properties.html#33082" class="Function">product≢0</a> <a id="11401" class="Symbol">(</a><a id="11402" href="Data.List.Relation.Unary.All.html#3133" class="Function">All.map</a> <a id="11410" href="Data.Nat.Primality.html#7109" class="Function">prime⇒nonZero</a> <a id="11424" href="Data.Nat.Primality.html#11385" class="Bound">pas</a><a id="11427" class="Symbol">)</a>

<a id="productOfPrimes≥1"></a><a id="11430" href="Data.Nat.Primality.html#11430" class="Function">productOfPrimes≥1</a> <a id="11448" class="Symbol">:</a> <a id="11450" class="Symbol">∀</a> <a id="11452" class="Symbol">{</a><a id="11453" href="Data.Nat.Primality.html#11453" class="Bound">as</a><a id="11455" class="Symbol">}</a> <a id="11457" class="Symbol">→</a> <a id="11459" href="Data.List.Relation.Unary.All.html#1644" class="Datatype">All</a> <a id="11463" href="Data.Nat.Primality.html#3150" class="Record">Prime</a> <a id="11469" href="Data.Nat.Primality.html#11453" class="Bound">as</a> <a id="11472" class="Symbol">→</a> <a id="11474" href="Data.List.Base.html#5000" class="Function">product</a> <a id="11482" href="Data.Nat.Primality.html#11453" class="Bound">as</a> <a id="11485" href="Data.Nat.Base.html#2265" class="Function Operator">≥</a> <a id="11487" class="Number">1</a>
<a id="11489" href="Data.Nat.Primality.html#11430" class="Function">productOfPrimes≥1</a> <a id="11507" class="Symbol">{</a><a id="11508" href="Data.Nat.Primality.html#11508" class="Bound">as</a><a id="11510" class="Symbol">}</a> <a id="11512" href="Data.Nat.Primality.html#11512" class="Bound">pas</a> <a id="11516" class="Symbol">=</a> <a id="11518" href="Data.Nat.Base.html#3677" class="Function">&gt;-nonZero⁻¹</a> <a id="11530" class="Symbol">_</a> <a id="11532" class="Symbol">{{</a><a id="11534" href="Data.Nat.Primality.html#11302" class="Function">productOfPrimes≢0</a> <a id="11552" href="Data.Nat.Primality.html#11512" class="Bound">pas</a><a id="11555" class="Symbol">}}</a>

<a id="11559" class="Comment">------------------------------------------------------------------------</a>
<a id="11632" class="Comment">-- Basic (counter-)examples of Irreducible</a>

<a id="¬irreducible[0]"></a><a id="11676" href="Data.Nat.Primality.html#11676" class="Function">¬irreducible[0]</a> <a id="11692" class="Symbol">:</a> <a id="11694" href="Relation.Nullary.Negation.Core.html#658" class="Function Operator">¬</a> <a id="11696" href="Data.Nat.Primality.html#3368" class="Function">Irreducible</a> <a id="11708" class="Number">0</a>
<a id="11710" href="Data.Nat.Primality.html#11676" class="Function">¬irreducible[0]</a> <a id="11726" href="Data.Nat.Primality.html#11726" class="Bound">irr[0]</a> <a id="11733" class="Symbol">=</a> <a id="11735" href="Relation.Nullary.Negation.Core.html#1344" class="Function">contradiction₂</a> <a id="11750" href="Data.Nat.Primality.html#11780" class="Function">2≡1⊎2≡0</a> <a id="11758" class="Symbol">(λ</a> <a id="11761" class="Symbol">())</a> <a id="11765" class="Symbol">(λ</a> <a id="11768" class="Symbol">())</a>
  <a id="11774" class="Keyword">where</a> <a id="11780" href="Data.Nat.Primality.html#11780" class="Function">2≡1⊎2≡0</a> <a id="11788" class="Symbol">=</a> <a id="11790" href="Data.Nat.Primality.html#11726" class="Bound">irr[0]</a> <a id="11797" class="Symbol">{</a><a id="11798" class="Number">2</a><a id="11799" class="Symbol">}</a> <a id="11801" class="Symbol">(</a><a id="11802" href="Data.Nat.Divisibility.Core.html#1328" class="InductiveConstructor">divides-refl</a> <a id="11815" class="Number">0</a><a id="11816" class="Symbol">)</a>

<a id="irreducible[1]"></a><a id="11819" href="Data.Nat.Primality.html#11819" class="Function">irreducible[1]</a> <a id="11834" class="Symbol">:</a> <a id="11836" href="Data.Nat.Primality.html#3368" class="Function">Irreducible</a> <a id="11848" class="Number">1</a>
<a id="11850" href="Data.Nat.Primality.html#11819" class="Function">irreducible[1]</a> <a id="11865" href="Data.Nat.Primality.html#11865" class="Bound">m∣1</a> <a id="11869" class="Symbol">=</a> <a id="11871" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="11876" class="Symbol">(</a><a id="11877" href="Data.Nat.Divisibility.html#5586" class="Function">∣1⇒≡1</a> <a id="11883" href="Data.Nat.Primality.html#11865" class="Bound">m∣1</a><a id="11886" class="Symbol">)</a>

<a id="irreducible[2]"></a><a id="11889" href="Data.Nat.Primality.html#11889" class="Function">irreducible[2]</a> <a id="11904" class="Symbol">:</a> <a id="11906" href="Data.Nat.Primality.html#3368" class="Function">Irreducible</a> <a id="11918" class="Number">2</a>
<a id="11920" href="Data.Nat.Primality.html#11889" class="Function">irreducible[2]</a> <a id="11935" class="Symbol">{</a><a id="11936" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a><a id="11940" class="Symbol">}</a>  <a id="11943" href="Data.Nat.Primality.html#11943" class="Bound">0∣2</a> <a id="11947" class="Keyword">with</a> <a id="11952" class="Symbol">()</a> ← <a id="11957" href="Data.Nat.Divisibility.html#5468" class="Function">0∣⇒≡0</a> <a id="11963" href="Data.Nat.Primality.html#11943" class="Bound">0∣2</a>
<a id="11967" href="Data.Nat.Primality.html#11889" class="Function">irreducible[2]</a> <a id="11982" class="Symbol">{</a><a id="11983" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="11987" class="Symbol">_}</a> <a id="11990" href="Data.Nat.Primality.html#11990" class="Bound">d∣2</a> <a id="11994" class="Keyword">with</a> <a id="11999" href="Data.Nat.Divisibility.html#3450" class="Function">∣⇒≤</a> <a id="12003" href="Data.Nat.Primality.html#11990" class="Bound">d∣2</a>
<a id="12007" class="Symbol">...</a> <a id="12011" class="Symbol">|</a> <a id="12013" href="Data.Nat.Base.html#1879" class="InductiveConstructor">z&lt;s</a>     <a id="12021" class="Symbol">=</a> <a id="12023" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="12028" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="12033" class="Symbol">...</a> <a id="12037" class="Symbol">|</a> <a id="12039" href="Data.Nat.Base.html#1919" class="InductiveConstructor">s&lt;s</a> <a id="12043" href="Data.Nat.Base.html#1879" class="InductiveConstructor">z&lt;s</a> <a id="12047" class="Symbol">=</a> <a id="12049" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="12054" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="irreducible⇒nonZero"></a><a id="12060" href="Data.Nat.Primality.html#12060" class="Function">irreducible⇒nonZero</a> <a id="12080" class="Symbol">:</a> <a id="12082" href="Data.Nat.Primality.html#3368" class="Function">Irreducible</a> <a id="12094" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a> <a id="12096" class="Symbol">→</a> <a id="12098" href="Data.Nat.Base.html#3266" class="Record">NonZero</a> <a id="12106" href="Data.Nat.Primality.html#1233" class="Generalizable">n</a>
<a id="12108" href="Data.Nat.Primality.html#12060" class="Function">irreducible⇒nonZero</a> <a id="12128" class="Symbol">{</a><a id="12129" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a><a id="12133" class="Symbol">}</a>    <a id="12138" class="Symbol">=</a> <a id="12140" href="Function.Base.html#1638" class="Function">flip</a> <a id="12145" href="Relation.Nullary.Negation.Core.html#1270" class="Function">contradiction</a> <a id="12159" href="Data.Nat.Primality.html#11676" class="Function">¬irreducible[0]</a>
<a id="12175" href="Data.Nat.Primality.html#12060" class="Function">irreducible⇒nonZero</a> <a id="12195" class="Symbol">{</a><a id="12196" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="12200" class="Symbol">_}</a> <a id="12203" class="Symbol">_</a> <a id="12205" class="Symbol">=</a> <a id="12207" class="Symbol">_</a>

<a id="irreducible?"></a><a id="12210" href="Data.Nat.Primality.html#12210" class="Function">irreducible?</a> <a id="12223" class="Symbol">:</a> <a id="12225" href="Relation.Unary.html#4543" class="Function">Decidable</a> <a id="12235" href="Data.Nat.Primality.html#3368" class="Function">Irreducible</a>
<a id="12247" href="Data.Nat.Primality.html#12210" class="Function">irreducible?</a> <a id="12260" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a>      <a id="12270" class="Symbol">=</a> <a id="12272" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="12275" href="Data.Nat.Primality.html#11676" class="Function">¬irreducible[0]</a>
<a id="12291" href="Data.Nat.Primality.html#12210" class="Function">irreducible?</a> <a id="12304" href="Data.Nat.Primality.html#12304" class="Bound">n</a><a id="12305" class="Symbol">@(</a><a id="12307" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="12311" class="Symbol">_)</a> <a id="12314" class="Symbol">=</a>
  <a id="12318" href="Relation.Nullary.Decidable.html#1241" class="Function">Dec.map</a> <a id="12326" href="Data.Nat.Primality.html#12792" class="Function">IrreducibleUpTo⇔Irreducible</a> <a id="12354" class="Symbol">(</a><a id="12355" href="Data.Nat.Primality.html#12989" class="Function">irreducibleUpTo?</a> <a id="12372" href="Data.Nat.Primality.html#12304" class="Bound">n</a><a id="12373" class="Symbol">)</a>
  <a id="12377" class="Keyword">where</a>
  <a id="12385" class="Comment">-- Equivalent bounded predicate definition</a>
  <a id="12430" href="Data.Nat.Primality.html#12430" class="Function">IrreducibleUpTo</a> <a id="12446" class="Symbol">:</a> <a id="12448" href="Relation.Unary.html#1178" class="Function">Pred</a> <a id="12453" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="12455" class="Symbol">_</a>
  <a id="12459" href="Data.Nat.Primality.html#12430" class="Function">IrreducibleUpTo</a> <a id="12475" href="Data.Nat.Primality.html#12475" class="Bound">n</a> <a id="12477" class="Symbol">=</a> <a id="12479" class="Symbol">∀</a> <a id="12481" class="Symbol">{</a><a id="12482" href="Data.Nat.Primality.html#12482" class="Bound">d</a><a id="12483" class="Symbol">}</a> <a id="12485" class="Symbol">→</a> <a id="12487" href="Data.Nat.Primality.html#12482" class="Bound">d</a> <a id="12489" href="Data.Nat.Base.html#1807" class="Function Operator">&lt;</a> <a id="12491" href="Data.Nat.Primality.html#12475" class="Bound">n</a> <a id="12493" class="Symbol">→</a> <a id="12495" href="Data.Nat.Primality.html#12482" class="Bound">d</a> <a id="12497" href="Data.Nat.Divisibility.Core.html#1159" class="Record Operator">∣</a> <a id="12499" href="Data.Nat.Primality.html#12475" class="Bound">n</a> <a id="12501" class="Symbol">→</a> <a id="12503" href="Data.Nat.Primality.html#12482" class="Bound">d</a> <a id="12505" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="12507" class="Number">1</a> <a id="12509" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="12511" href="Data.Nat.Primality.html#12482" class="Bound">d</a> <a id="12513" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="12515" href="Data.Nat.Primality.html#12475" class="Bound">n</a>

  <a id="12520" class="Comment">-- Proof of equivalence</a>
  <a id="12546" href="Data.Nat.Primality.html#12546" class="Function">irr-upto⇒irr</a> <a id="12559" class="Symbol">:</a> <a id="12561" class="Symbol">.{{</a><a id="12564" href="Data.Nat.Base.html#3266" class="Record">NonZero</a> <a id="12572" href="Data.Nat.Primality.html#12304" class="Bound">n</a><a id="12573" class="Symbol">}}</a> <a id="12576" class="Symbol">→</a> <a id="12578" href="Data.Nat.Primality.html#12430" class="Function">IrreducibleUpTo</a> <a id="12594" href="Data.Nat.Primality.html#12304" class="Bound">n</a> <a id="12596" class="Symbol">→</a> <a id="12598" href="Data.Nat.Primality.html#3368" class="Function">Irreducible</a> <a id="12610" href="Data.Nat.Primality.html#12304" class="Bound">n</a>
  <a id="12614" href="Data.Nat.Primality.html#12546" class="Function">irr-upto⇒irr</a> <a id="12627" href="Data.Nat.Primality.html#12627" class="Bound">irr-upto</a> <a id="12636" href="Data.Nat.Primality.html#12636" class="Bound">m∣n</a>
    <a id="12644" class="Symbol">=</a> <a id="12646" href="Data.Sum.Base.html#980" class="Function Operator">[</a> <a id="12648" href="Function.Base.html#1638" class="Function">flip</a> <a id="12653" href="Data.Nat.Primality.html#12627" class="Bound">irr-upto</a> <a id="12662" href="Data.Nat.Primality.html#12636" class="Bound">m∣n</a> <a id="12666" href="Data.Sum.Base.html#980" class="Function Operator">,</a> <a id="12668" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="12673" href="Data.Sum.Base.html#980" class="Function Operator">]′</a> <a id="12676" class="Symbol">(</a><a id="12677" href="Data.Nat.Properties.html#13690" class="Function">m≤n⇒m&lt;n∨m≡n</a> <a id="12689" class="Symbol">(</a><a id="12690" href="Data.Nat.Divisibility.html#3450" class="Function">∣⇒≤</a> <a id="12694" href="Data.Nat.Primality.html#12636" class="Bound">m∣n</a><a id="12697" class="Symbol">))</a>

  <a id="12703" href="Data.Nat.Primality.html#12703" class="Function">irr⇒irr-upto</a> <a id="12716" class="Symbol">:</a> <a id="12718" href="Data.Nat.Primality.html#3368" class="Function">Irreducible</a> <a id="12730" href="Data.Nat.Primality.html#12304" class="Bound">n</a> <a id="12732" class="Symbol">→</a> <a id="12734" href="Data.Nat.Primality.html#12430" class="Function">IrreducibleUpTo</a> <a id="12750" href="Data.Nat.Primality.html#12304" class="Bound">n</a>
  <a id="12754" href="Data.Nat.Primality.html#12703" class="Function">irr⇒irr-upto</a> <a id="12767" href="Data.Nat.Primality.html#12767" class="Bound">irr</a> <a id="12771" href="Data.Nat.Primality.html#12771" class="Bound">m&lt;n</a> <a id="12775" href="Data.Nat.Primality.html#12775" class="Bound">m∣n</a> <a id="12779" class="Symbol">=</a> <a id="12781" href="Data.Nat.Primality.html#12767" class="Bound">irr</a> <a id="12785" href="Data.Nat.Primality.html#12775" class="Bound">m∣n</a>

  <a id="12792" href="Data.Nat.Primality.html#12792" class="Function">IrreducibleUpTo⇔Irreducible</a> <a id="12820" class="Symbol">:</a> <a id="12822" class="Symbol">.{{</a><a id="12825" href="Data.Nat.Base.html#3266" class="Record">NonZero</a> <a id="12833" href="Data.Nat.Primality.html#12304" class="Bound">n</a><a id="12834" class="Symbol">}}</a> <a id="12837" class="Symbol">→</a>
                                 <a id="12872" href="Data.Nat.Primality.html#12430" class="Function">IrreducibleUpTo</a> <a id="12888" href="Data.Nat.Primality.html#12304" class="Bound">n</a> <a id="12890" href="Function.Bundles.html#12400" class="Function Operator">⇔</a> <a id="12892" href="Data.Nat.Primality.html#3368" class="Function">Irreducible</a> <a id="12904" href="Data.Nat.Primality.html#12304" class="Bound">n</a>
  <a id="12908" href="Data.Nat.Primality.html#12792" class="Function">IrreducibleUpTo⇔Irreducible</a> <a id="12936" class="Symbol">=</a> <a id="12938" href="Function.Bundles.html#13499" class="Function">mk⇔</a> <a id="12942" href="Data.Nat.Primality.html#12546" class="Function">irr-upto⇒irr</a> <a id="12955" href="Data.Nat.Primality.html#12703" class="Function">irr⇒irr-upto</a>

  <a id="12971" class="Comment">-- Decidability</a>
  <a id="12989" href="Data.Nat.Primality.html#12989" class="Function">irreducibleUpTo?</a> <a id="13006" class="Symbol">:</a> <a id="13008" href="Relation.Unary.html#4543" class="Function">Decidable</a> <a id="13018" href="Data.Nat.Primality.html#12430" class="Function">IrreducibleUpTo</a>
  <a id="13036" href="Data.Nat.Primality.html#12989" class="Function">irreducibleUpTo?</a> <a id="13053" href="Data.Nat.Primality.html#13053" class="Bound">n</a> <a id="13055" class="Symbol">=</a> <a id="13057" href="Data.Nat.Properties.html#70303" class="Function">allUpTo?</a>
    <a id="13070" class="Symbol">(λ</a> <a id="13073" href="Data.Nat.Primality.html#13073" class="Bound">m</a> <a id="13075" class="Symbol">→</a> <a id="13077" class="Symbol">(</a><a id="13078" href="Data.Nat.Primality.html#13073" class="Bound">m</a> <a id="13080" href="Data.Nat.Divisibility.html#4316" class="Function Operator">∣?</a> <a id="13083" href="Data.Nat.Primality.html#13053" class="Bound">n</a><a id="13084" class="Symbol">)</a> <a id="13086" href="Relation.Nullary.Decidable.Core.html#3363" class="Function Operator">→-dec</a> <a id="13092" class="Symbol">(</a><a id="13093" href="Data.Nat.Primality.html#13073" class="Bound">m</a> <a id="13095" href="Data.Nat.Properties.html#3874" class="Function Operator">≟</a> <a id="13097" class="Number">1</a> <a id="13099" href="Relation.Nullary.Decidable.Core.html#3233" class="Function Operator">⊎-dec</a> <a id="13105" href="Data.Nat.Primality.html#13073" class="Bound">m</a> <a id="13107" href="Data.Nat.Properties.html#3874" class="Function Operator">≟</a> <a id="13109" href="Data.Nat.Primality.html#13053" class="Bound">n</a><a id="13110" class="Symbol">))</a> <a id="13113" href="Data.Nat.Primality.html#13053" class="Bound">n</a>

<a id="13116" class="Comment">-- Relationship between primality and irreducibility.</a>
<a id="prime⇒irreducible"></a><a id="13170" href="Data.Nat.Primality.html#13170" class="Function">prime⇒irreducible</a> <a id="13188" class="Symbol">:</a> <a id="13190" href="Data.Nat.Primality.html#3150" class="Record">Prime</a> <a id="13196" href="Data.Nat.Primality.html#1237" class="Generalizable">p</a> <a id="13198" class="Symbol">→</a> <a id="13200" href="Data.Nat.Primality.html#3368" class="Function">Irreducible</a> <a id="13212" href="Data.Nat.Primality.html#1237" class="Generalizable">p</a>
<a id="13214" href="Data.Nat.Primality.html#13170" class="Function">prime⇒irreducible</a> <a id="13232" class="Symbol">{</a><a id="13233" href="Data.Nat.Primality.html#13233" class="Bound">p</a><a id="13234" class="Symbol">}</a> <a id="13236" href="Data.Nat.Primality.html#13236" class="Bound">pp</a><a id="13238" class="Symbol">@(</a><a id="13240" href="Data.Nat.Primality.html#3190" class="InductiveConstructor">prime</a> <a id="13246" href="Data.Nat.Primality.html#13246" class="Bound">pr</a><a id="13248" class="Symbol">)</a> <a id="13250" class="Symbol">=</a> <a id="13252" href="Data.Nat.Primality.html#13298" class="Function">irr</a>
  <a id="13258" class="Keyword">where</a>
  <a id="13266" class="Keyword">instance</a> <a id="13275" href="Data.Nat.Primality.html#13275" class="Function">_</a> <a id="13277" class="Symbol">=</a> <a id="13279" href="Data.Nat.Primality.html#7109" class="Function">prime⇒nonZero</a> <a id="13293" href="Data.Nat.Primality.html#13236" class="Bound">pp</a>
  <a id="13298" href="Data.Nat.Primality.html#13298" class="Function">irr</a> <a id="13302" class="Symbol">:</a> <a id="13304" class="Symbol">.{{</a><a id="13307" href="Data.Nat.Base.html#3266" class="Record">NonZero</a> <a id="13315" href="Data.Nat.Primality.html#13233" class="Bound">p</a><a id="13316" class="Symbol">}}</a> <a id="13319" class="Symbol">→</a> <a id="13321" href="Data.Nat.Primality.html#3368" class="Function">Irreducible</a> <a id="13333" href="Data.Nat.Primality.html#13233" class="Bound">p</a>
  <a id="13337" href="Data.Nat.Primality.html#13298" class="Function">irr</a> <a id="13341" class="Symbol">{</a><a id="13342" class="Number">0</a><a id="13343" class="Symbol">}</a>    <a id="13348" href="Data.Nat.Primality.html#13348" class="Bound">0∣p</a> <a id="13352" class="Symbol">=</a> <a id="13354" href="Relation.Nullary.Negation.Core.html#1270" class="Function">contradiction</a> <a id="13368" class="Symbol">(</a><a id="13369" href="Data.Nat.Divisibility.html#5468" class="Function">0∣⇒≡0</a> <a id="13375" href="Data.Nat.Primality.html#13348" class="Bound">0∣p</a><a id="13378" class="Symbol">)</a> <a id="13380" class="Symbol">(</a><a id="13381" href="Data.Nat.Base.html#3610" class="Function">≢-nonZero⁻¹</a> <a id="13393" href="Data.Nat.Primality.html#13233" class="Bound">p</a><a id="13394" class="Symbol">)</a>
  <a id="13398" href="Data.Nat.Primality.html#13298" class="Function">irr</a> <a id="13402" class="Symbol">{</a><a id="13403" class="Number">1</a><a id="13404" class="Symbol">}</a>    <a id="13409" href="Data.Nat.Primality.html#13409" class="Bound">1∣p</a> <a id="13413" class="Symbol">=</a> <a id="13415" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="13420" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="13427" href="Data.Nat.Primality.html#13298" class="Function">irr</a> <a id="13431" class="Symbol">{</a><a id="13432" href="Data.Nat.Base.html#1101" class="InductiveConstructor">2+</a> <a id="13435" class="Symbol">_}</a> <a id="13438" href="Data.Nat.Primality.html#13438" class="Bound">d∣p</a> <a id="13442" class="Symbol">=</a> <a id="13444" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="13449" class="Symbol">(</a><a id="13450" href="Data.Nat.Properties.html#10111" class="Function">≤∧≮⇒≡</a> <a id="13456" class="Symbol">(</a><a id="13457" href="Data.Nat.Divisibility.html#3450" class="Function">∣⇒≤</a> <a id="13461" href="Data.Nat.Primality.html#13438" class="Bound">d∣p</a><a id="13464" class="Symbol">)</a> <a id="13466" href="Data.Nat.Primality.html#13481" class="Function">d≮p</a><a id="13469" class="Symbol">)</a>
    <a id="13475" class="Keyword">where</a> <a id="13481" href="Data.Nat.Primality.html#13481" class="Function">d≮p</a> <a id="13485" class="Symbol">=</a> <a id="13487" class="Symbol">λ</a> <a id="13489" href="Data.Nat.Primality.html#13489" class="Bound">d&lt;p</a> <a id="13493" class="Symbol">→</a> <a id="13495" href="Data.Nat.Primality.html#13246" class="Bound">pr</a> <a id="13498" class="Symbol">(</a><a id="13499" href="Data.Nat.Primality.html#2657" class="InductiveConstructor">composite</a> <a id="13509" href="Data.Nat.Primality.html#13489" class="Bound">d&lt;p</a> <a id="13513" href="Data.Nat.Primality.html#13438" class="Bound">d∣p</a><a id="13516" class="Symbol">)</a>


<a id="irreducible⇒prime"></a><a id="13520" href="Data.Nat.Primality.html#13520" class="Function">irreducible⇒prime</a> <a id="13538" class="Symbol">:</a> <a id="13540" class="Symbol">.{{</a><a id="13543" href="Data.Nat.Base.html#3801" class="Record">NonTrivial</a> <a id="13554" href="Data.Nat.Primality.html#1237" class="Generalizable">p</a><a id="13555" class="Symbol">}}</a> <a id="13558" class="Symbol">→</a> <a id="13560" href="Data.Nat.Primality.html#3368" class="Function">Irreducible</a> <a id="13572" href="Data.Nat.Primality.html#1237" class="Generalizable">p</a> <a id="13574" class="Symbol">→</a> <a id="13576" href="Data.Nat.Primality.html#3150" class="Record">Prime</a> <a id="13582" href="Data.Nat.Primality.html#1237" class="Generalizable">p</a>
<a id="13584" href="Data.Nat.Primality.html#13520" class="Function">irreducible⇒prime</a> <a id="13602" href="Data.Nat.Primality.html#13602" class="Bound">irr</a> <a id="13606" class="Symbol">=</a> <a id="13608" href="Data.Nat.Primality.html#3190" class="InductiveConstructor">prime</a>
  <a id="13616" class="Symbol">λ</a> <a id="13618" class="Symbol">(</a><a id="13619" href="Data.Nat.Primality.html#2657" class="InductiveConstructor">composite</a> <a id="13629" href="Data.Nat.Primality.html#13629" class="Bound">d&lt;p</a> <a id="13633" href="Data.Nat.Primality.html#13633" class="Bound">d∣p</a><a id="13636" class="Symbol">)</a> <a id="13638" class="Symbol">→</a> <a id="13640" href="Data.Sum.Base.html#980" class="Function Operator">[</a> <a id="13642" href="Data.Nat.Base.html#4224" class="Function">nonTrivial⇒≢1</a> <a id="13656" href="Data.Sum.Base.html#980" class="Function Operator">,</a> <a id="13658" class="Symbol">(</a><a id="13659" href="Data.Nat.Properties.html#9258" class="Function">&lt;⇒≢</a> <a id="13663" href="Data.Nat.Primality.html#13629" class="Bound">d&lt;p</a><a id="13666" class="Symbol">)</a> <a id="13668" href="Data.Sum.Base.html#980" class="Function Operator">]′</a> <a id="13671" class="Symbol">(</a><a id="13672" href="Data.Nat.Primality.html#13602" class="Bound">irr</a> <a id="13676" href="Data.Nat.Primality.html#13633" class="Bound">d∣p</a><a id="13679" class="Symbol">)</a>

<a id="13682" class="Comment">------------------------------------------------------------------------</a>
<a id="13755" class="Comment">-- Using decidability</a>

<a id="13778" class="Comment">-- Once we have the above decision procedures, then instead of</a>
<a id="13841" class="Comment">-- constructing proofs of e.g. Prime-ness by hand, we call the</a>
<a id="13904" class="Comment">-- appropriate function, and use the witness extraction functions</a>
<a id="13970" class="Comment">-- `from-yes`, `from-no` to return the checked proofs.</a>

<a id="14026" class="Keyword">private</a>

  <a id="14037" class="Comment">-- Example: 2 is prime, but not-composite.</a>
  <a id="2-is-prime"></a><a id="14082" href="Data.Nat.Primality.html#14082" class="Function">2-is-prime</a> <a id="14093" class="Symbol">:</a> <a id="14095" href="Data.Nat.Primality.html#3150" class="Record">Prime</a> <a id="14101" class="Number">2</a>
  <a id="14105" href="Data.Nat.Primality.html#14082" class="Function">2-is-prime</a> <a id="14116" class="Symbol">=</a> <a id="14118" href="Relation.Nullary.Decidable.Core.html#5517" class="Function">from-yes</a> <a id="14127" class="Symbol">(</a><a id="14128" href="Data.Nat.Primality.html#7270" class="Function">prime?</a> <a id="14135" class="Number">2</a><a id="14136" class="Symbol">)</a>

  <a id="2-is-not-composite"></a><a id="14141" href="Data.Nat.Primality.html#14141" class="Function">2-is-not-composite</a> <a id="14160" class="Symbol">:</a> <a id="14162" href="Relation.Nullary.Negation.Core.html#658" class="Function Operator">¬</a> <a id="14164" href="Data.Nat.Primality.html#2482" class="Function">Composite</a> <a id="14174" class="Number">2</a>
  <a id="14178" href="Data.Nat.Primality.html#14141" class="Function">2-is-not-composite</a> <a id="14197" class="Symbol">=</a> <a id="14199" href="Relation.Nullary.Decidable.Core.html#5719" class="Function">from-no</a> <a id="14207" class="Symbol">(</a><a id="14208" href="Data.Nat.Primality.html#5821" class="Function">composite?</a> <a id="14219" class="Number">2</a><a id="14220" class="Symbol">)</a>

  <a id="14225" class="Comment">-- Example: 4 and 6 are composite, hence not-prime</a>
  <a id="4-is-composite"></a><a id="14278" href="Data.Nat.Primality.html#14278" class="Function">4-is-composite</a> <a id="14293" class="Symbol">:</a> <a id="14295" href="Data.Nat.Primality.html#2482" class="Function">Composite</a> <a id="14305" class="Number">4</a>
  <a id="14309" href="Data.Nat.Primality.html#14278" class="Function">4-is-composite</a> <a id="14324" class="Symbol">=</a> <a id="14326" href="Relation.Nullary.Decidable.Core.html#5517" class="Function">from-yes</a> <a id="14335" class="Symbol">(</a><a id="14336" href="Data.Nat.Primality.html#5821" class="Function">composite?</a> <a id="14347" class="Number">4</a><a id="14348" class="Symbol">)</a>

  <a id="4-is-not-prime"></a><a id="14353" href="Data.Nat.Primality.html#14353" class="Function">4-is-not-prime</a> <a id="14368" class="Symbol">:</a> <a id="14370" href="Relation.Nullary.Negation.Core.html#658" class="Function Operator">¬</a> <a id="14372" href="Data.Nat.Primality.html#3150" class="Record">Prime</a> <a id="14378" class="Number">4</a>
  <a id="14382" href="Data.Nat.Primality.html#14353" class="Function">4-is-not-prime</a> <a id="14397" class="Symbol">=</a> <a id="14399" href="Relation.Nullary.Decidable.Core.html#5719" class="Function">from-no</a> <a id="14407" class="Symbol">(</a><a id="14408" href="Data.Nat.Primality.html#7270" class="Function">prime?</a> <a id="14415" class="Number">4</a><a id="14416" class="Symbol">)</a>

  <a id="6-is-composite"></a><a id="14421" href="Data.Nat.Primality.html#14421" class="Function">6-is-composite</a> <a id="14436" class="Symbol">:</a> <a id="14438" href="Data.Nat.Primality.html#2482" class="Function">Composite</a> <a id="14448" class="Number">6</a>
  <a id="14452" href="Data.Nat.Primality.html#14421" class="Function">6-is-composite</a> <a id="14467" class="Symbol">=</a> <a id="14469" href="Relation.Nullary.Decidable.Core.html#5517" class="Function">from-yes</a> <a id="14478" class="Symbol">(</a><a id="14479" href="Data.Nat.Primality.html#5821" class="Function">composite?</a> <a id="14490" class="Number">6</a><a id="14491" class="Symbol">)</a>

  <a id="6-is-not-prime"></a><a id="14496" href="Data.Nat.Primality.html#14496" class="Function">6-is-not-prime</a> <a id="14511" class="Symbol">:</a> <a id="14513" href="Relation.Nullary.Negation.Core.html#658" class="Function Operator">¬</a> <a id="14515" href="Data.Nat.Primality.html#3150" class="Record">Prime</a> <a id="14521" class="Number">6</a>
  <a id="14525" href="Data.Nat.Primality.html#14496" class="Function">6-is-not-prime</a> <a id="14540" class="Symbol">=</a> <a id="14542" href="Relation.Nullary.Decidable.Core.html#5719" class="Function">from-no</a> <a id="14550" class="Symbol">(</a><a id="14551" href="Data.Nat.Primality.html#7270" class="Function">prime?</a> <a id="14558" class="Number">6</a><a id="14559" class="Symbol">)</a>
</pre></body></html>