<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Reflection.TCM.Utilities</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Reflection utilities</a>
<a id="130" class="Comment">------------------------------------------------------------------------</a>

<a id="204" class="Symbol">{-#</a> <a id="208" class="Keyword">OPTIONS</a> <a id="216" class="Pragma">--cubical-compatible</a> <a id="237" class="Pragma">--safe</a> <a id="244" class="Symbol">#-}</a>

<a id="249" class="Keyword">module</a> <a id="256" href="Reflection.TCM.Utilities.html" class="Module">Reflection.TCM.Utilities</a> <a id="281" class="Keyword">where</a>

<a id="288" class="Keyword">open</a> <a id="293" class="Keyword">import</a> <a id="300" href="Data.List.html" class="Module">Data.List</a> <a id="310" class="Keyword">using</a> <a id="316" class="Symbol">(</a><a id="317" href="Agda.Builtin.List.html#147" class="Datatype">List</a><a id="321" class="Symbol">;</a> <a id="323" href="Data.List.Base.html#7301" class="InductiveConstructor">[]</a><a id="325" class="Symbol">;</a> <a id="327" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">_∷_</a><a id="330" class="Symbol">;</a> <a id="332" href="Data.List.Base.html#1712" class="Function Operator">_++_</a><a id="336" class="Symbol">;</a> <a id="338" href="Data.List.Base.html#1612" class="Function">map</a><a id="341" class="Symbol">)</a>
<a id="343" class="Keyword">open</a> <a id="348" class="Keyword">import</a> <a id="355" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="365" class="Keyword">using</a> <a id="371" class="Symbol">(</a><a id="372" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a><a id="373" class="Symbol">;</a> <a id="375" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="377" class="Symbol">)</a>
<a id="379" class="Keyword">open</a> <a id="384" class="Keyword">import</a> <a id="391" href="Effect.Applicative.html" class="Module">Effect.Applicative</a> <a id="410" class="Keyword">using</a> <a id="416" class="Symbol">(</a><a id="417" href="Effect.Applicative.html#977" class="Record">RawApplicative</a><a id="431" class="Symbol">;</a> <a id="433" href="Effect.Applicative.html#1851" class="Function">mkRawApplicative</a><a id="449" class="Symbol">)</a>
<a id="451" class="Keyword">open</a> <a id="456" class="Keyword">import</a> <a id="463" href="Function.Base.html" class="Module">Function.Base</a> <a id="477" class="Keyword">using</a> <a id="483" class="Symbol">(</a><a id="484" href="Function.Base.html#4061" class="Function Operator">case_of_</a><a id="492" class="Symbol">)</a>
<a id="494" class="Keyword">open</a> <a id="499" class="Keyword">import</a> <a id="506" href="Reflection.AST.Meta.html" class="Module">Reflection.AST.Meta</a> <a id="526" class="Keyword">using</a> <a id="532" class="Symbol">(</a><a id="533" href="Agda.Builtin.Reflection.html#2457" class="Postulate">Meta</a><a id="537" class="Symbol">)</a>
<a id="539" class="Keyword">open</a> <a id="544" class="Keyword">import</a> <a id="551" href="Reflection.AST.Term.html" class="Module">Reflection.AST.Term</a> <a id="571" class="Keyword">using</a> <a id="577" class="Symbol">(</a><a id="578" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="582" class="Symbol">)</a>
<a id="584" class="Keyword">open</a> <a id="589" class="Keyword">import</a> <a id="596" href="Reflection.TCM.html" class="Module">Reflection.TCM</a> <a id="611" class="Keyword">using</a> <a id="617" class="Symbol">(</a><a id="618" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a><a id="620" class="Symbol">;</a> <a id="622" href="Reflection.TCM.html#1087" class="Postulate">pure</a><a id="626" class="Symbol">;</a> <a id="628" href="Agda.Builtin.Reflection.html#9808" class="Postulate">blockTC</a><a id="635" class="Symbol">;</a> <a id="637" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">blockerAll</a><a id="647" class="Symbol">;</a> <a id="649" href="Agda.Builtin.Reflection.html#4019" class="InductiveConstructor">blockerMeta</a><a id="660" class="Symbol">)</a>

<a id="663" class="Keyword">import</a> <a id="670" href="Reflection.AST.Traversal.html" class="Module">Reflection.AST.Traversal</a> <a id="695" class="Symbol">as</a> <a id="698" class="Module">Traversal</a>

<a id="blockOnMetas"></a><a id="709" href="Reflection.TCM.Utilities.html#709" class="Function">blockOnMetas</a> <a id="722" class="Symbol">:</a> <a id="724" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="729" class="Symbol">→</a> <a id="731" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="734" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="736" href="Reflection.TCM.Utilities.html#709" class="Function">blockOnMetas</a> <a id="749" href="Reflection.TCM.Utilities.html#749" class="Bound">t</a> <a id="751" class="Symbol">=</a>
  <a id="755" href="Function.Base.html#4061" class="Function Operator">case</a> <a id="760" href="Reflection.AST.Traversal.html#1982" class="Function">traverseTerm</a> <a id="773" href="Reflection.TCM.Utilities.html#1056" class="Function">actions</a> <a id="781" class="Symbol">(</a><a id="782" class="Number">0</a> <a id="784" href="Reflection.AST.Traversal.html#1007" class="InductiveConstructor Operator">,</a> <a id="786" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="788" class="Symbol">)</a> <a id="790" href="Reflection.TCM.Utilities.html#749" class="Bound">t</a> <a id="792" href="Function.Base.html#4061" class="Function Operator">of</a> <a id="795" class="Symbol">λ</a> <a id="797" class="Keyword">where</a>
    <a id="807" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>         <a id="818" class="Symbol">→</a> <a id="820" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="825" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a>
    <a id="832" href="Reflection.TCM.Utilities.html#832" class="Bound">xs</a><a id="834" class="Symbol">@(_</a> <a id="838" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="840" class="Symbol">_)</a> <a id="843" class="Symbol">→</a> <a id="845" href="Agda.Builtin.Reflection.html#9808" class="Postulate">blockTC</a> <a id="853" class="Symbol">(</a><a id="854" href="Agda.Builtin.Reflection.html#3980" class="InductiveConstructor">blockerAll</a> <a id="865" class="Symbol">(</a><a id="866" href="Data.List.Base.html#1612" class="Function">map</a> <a id="870" href="Agda.Builtin.Reflection.html#4019" class="InductiveConstructor">blockerMeta</a> <a id="882" href="Reflection.TCM.Utilities.html#832" class="Bound">xs</a><a id="884" class="Symbol">))</a>
  <a id="889" class="Keyword">where</a>
  <a id="897" href="Reflection.TCM.Utilities.html#897" class="Function">applicative</a> <a id="909" class="Symbol">:</a> <a id="911" class="Symbol">∀</a> <a id="913" class="Symbol">{</a><a id="914" href="Reflection.TCM.Utilities.html#914" class="Bound">ℓ</a><a id="915" class="Symbol">}</a> <a id="917" class="Symbol">→</a> <a id="919" href="Effect.Applicative.html#977" class="Record">RawApplicative</a> <a id="934" class="Symbol">{</a><a id="935" href="Reflection.TCM.Utilities.html#914" class="Bound">ℓ</a><a id="936" class="Symbol">}</a> <a id="938" class="Symbol">(λ</a> <a id="941" href="Reflection.TCM.Utilities.html#941" class="Bound">_</a> <a id="943" class="Symbol">→</a> <a id="945" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="950" href="Agda.Builtin.Reflection.html#2457" class="Postulate">Meta</a><a id="954" class="Symbol">)</a>
  <a id="958" href="Reflection.TCM.Utilities.html#897" class="Function">applicative</a> <a id="970" class="Symbol">=</a> <a id="972" href="Effect.Applicative.html#1851" class="Function">mkRawApplicative</a> <a id="989" class="Symbol">(λ</a> <a id="992" href="Reflection.TCM.Utilities.html#992" class="Bound">_</a> <a id="994" class="Symbol">→</a> <a id="996" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1001" href="Agda.Builtin.Reflection.html#2457" class="Postulate">Meta</a><a id="1005" class="Symbol">)</a> <a id="1007" class="Symbol">(λ</a> <a id="1010" href="Reflection.TCM.Utilities.html#1010" class="Bound">_</a> <a id="1012" class="Symbol">→</a> <a id="1014" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="1016" class="Symbol">)</a> <a id="1018" href="Data.List.Base.html#1712" class="Function Operator">_++_</a>

  <a id="1026" class="Keyword">open</a> <a id="1031" href="Reflection.AST.Traversal.html" class="Module">Traversal</a> <a id="1041" href="Reflection.TCM.Utilities.html#897" class="Function">applicative</a>

  <a id="1056" href="Reflection.TCM.Utilities.html#1056" class="Function">actions</a> <a id="1064" class="Symbol">:</a> <a id="1066" href="Reflection.AST.Traversal.html#1480" class="Record">Actions</a>
  <a id="1076" href="Reflection.TCM.Utilities.html#1056" class="Function">actions</a> <a id="1084" class="Symbol">=</a> <a id="1086" class="Keyword">record</a> <a id="1093" href="Reflection.AST.Traversal.html#1637" class="Function">defaultActions</a> <a id="1108" class="Symbol">{</a> <a id="1110" href="Reflection.AST.Traversal.html#1534" class="Field">onMeta</a> <a id="1117" class="Symbol">=</a> <a id="1119" class="Symbol">λ</a> <a id="1121" href="Reflection.TCM.Utilities.html#1121" class="Bound">_</a> <a id="1123" href="Reflection.TCM.Utilities.html#1123" class="Bound">x</a> <a id="1125" class="Symbol">→</a> <a id="1127" href="Reflection.TCM.Utilities.html#1123" class="Bound">x</a> <a id="1129" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1131" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="1134" class="Symbol">}</a>
</pre></body></html>