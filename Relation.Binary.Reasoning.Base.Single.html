<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Relation.Binary.Reasoning.Base.Single</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- The basic code for equational reasoning with a single relation</a>
<a id="172" class="Comment">------------------------------------------------------------------------</a>

<a id="246" class="Symbol">{-#</a> <a id="250" class="Keyword">OPTIONS</a> <a id="258" class="Pragma">--cubical-compatible</a> <a id="279" class="Pragma">--safe</a> <a id="286" class="Symbol">#-}</a>

<a id="291" class="Keyword">open</a> <a id="296" class="Keyword">import</a> <a id="303" href="Relation.Binary.Core.html" class="Module">Relation.Binary.Core</a> <a id="324" class="Keyword">using</a> <a id="330" class="Symbol">(</a><a id="331" href="Relation.Binary.Core.html#896" class="Function">Rel</a><a id="334" class="Symbol">)</a>
<a id="336" class="Keyword">open</a> <a id="341" class="Keyword">import</a> <a id="348" href="Relation.Binary.Definitions.html" class="Module">Relation.Binary.Definitions</a> <a id="376" class="Keyword">using</a> <a id="382" class="Symbol">(</a><a id="383" href="Relation.Binary.Definitions.html#1418" class="Function">Reflexive</a><a id="392" class="Symbol">;</a> <a id="394" href="Relation.Binary.Definitions.html#1945" class="Function">Transitive</a><a id="404" class="Symbol">)</a>

<a id="407" class="Keyword">module</a> <a id="414" href="Relation.Binary.Reasoning.Base.Single.html" class="Module">Relation.Binary.Reasoning.Base.Single</a>
  <a id="454" class="Symbol">{</a><a id="455" href="Relation.Binary.Reasoning.Base.Single.html#455" class="Bound">a</a> <a id="457" href="Relation.Binary.Reasoning.Base.Single.html#457" class="Bound">ℓ</a><a id="458" class="Symbol">}</a> <a id="460" class="Symbol">{</a><a id="461" href="Relation.Binary.Reasoning.Base.Single.html#461" class="Bound">A</a> <a id="463" class="Symbol">:</a> <a id="465" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="469" href="Relation.Binary.Reasoning.Base.Single.html#455" class="Bound">a</a><a id="470" class="Symbol">}</a> <a id="472" class="Symbol">(</a><a id="473" href="Relation.Binary.Reasoning.Base.Single.html#473" class="Bound Operator">_∼_</a> <a id="477" class="Symbol">:</a> <a id="479" href="Relation.Binary.Core.html#896" class="Function">Rel</a> <a id="483" href="Relation.Binary.Reasoning.Base.Single.html#461" class="Bound">A</a> <a id="485" href="Relation.Binary.Reasoning.Base.Single.html#457" class="Bound">ℓ</a><a id="486" class="Symbol">)</a>
  <a id="490" class="Symbol">(</a><a id="491" href="Relation.Binary.Reasoning.Base.Single.html#491" class="Bound">refl</a> <a id="496" class="Symbol">:</a> <a id="498" href="Relation.Binary.Definitions.html#1418" class="Function">Reflexive</a> <a id="508" href="Relation.Binary.Reasoning.Base.Single.html#473" class="Bound Operator">_∼_</a><a id="511" class="Symbol">)</a> <a id="513" class="Symbol">(</a><a id="514" href="Relation.Binary.Reasoning.Base.Single.html#514" class="Bound">trans</a> <a id="520" class="Symbol">:</a> <a id="522" href="Relation.Binary.Definitions.html#1945" class="Function">Transitive</a> <a id="533" href="Relation.Binary.Reasoning.Base.Single.html#473" class="Bound Operator">_∼_</a><a id="536" class="Symbol">)</a>
  <a id="540" class="Keyword">where</a>

<a id="547" class="Comment">-- TODO: the following part is copied from Relation.Binary.Reasoning.Base.Partial</a>
<a id="629" class="Comment">-- in order to avoid larger refactors. We will refactor this part later</a>
<a id="701" class="Comment">-- so taht we use the same framework as Relation.Binary.Reasoning.Base.Partial.</a>

<a id="782" class="Keyword">open</a> <a id="787" class="Keyword">import</a> <a id="794" href="Level.html" class="Module">Level</a> <a id="800" class="Keyword">using</a> <a id="806" class="Symbol">(</a><a id="807" href="Agda.Primitive.html#804" class="Primitive Operator">_⊔_</a><a id="810" class="Symbol">)</a>
<a id="812" class="Keyword">open</a> <a id="817" class="Keyword">import</a> <a id="824" href="Relation.Binary.PropositionalEquality.Core.html" class="Module">Relation.Binary.PropositionalEquality.Core</a> <a id="867" class="Symbol">as</a> <a id="870" class="Module">P</a>
  <a id="874" class="Keyword">using</a> <a id="880" class="Symbol">(</a><a id="881" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">_≡_</a><a id="884" class="Symbol">)</a>

<a id="887" class="Keyword">infix</a>  <a id="894" class="Number">4</a> <a id="896" href="Relation.Binary.Reasoning.Base.Single.html#1149" class="Datatype Operator">_IsRelatedTo_</a>

<a id="911" class="Comment">------------------------------------------------------------------------</a>
<a id="984" class="Comment">-- Definition of &quot;related to&quot;</a>

<a id="1015" class="Comment">-- This seemingly unnecessary type is used to make it possible to</a>
<a id="1081" class="Comment">-- infer arguments even if the underlying equality evaluates.</a>

<a id="1144" class="Keyword">data</a> <a id="_IsRelatedTo_"></a><a id="1149" href="Relation.Binary.Reasoning.Base.Single.html#1149" class="Datatype Operator">_IsRelatedTo_</a> <a id="1163" class="Symbol">(</a><a id="1164" href="Relation.Binary.Reasoning.Base.Single.html#1164" class="Bound">x</a> <a id="1166" href="Relation.Binary.Reasoning.Base.Single.html#1166" class="Bound">y</a> <a id="1168" class="Symbol">:</a> <a id="1170" href="Relation.Binary.Reasoning.Base.Single.html#461" class="Bound">A</a><a id="1171" class="Symbol">)</a> <a id="1173" class="Symbol">:</a> <a id="1175" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="1179" href="Relation.Binary.Reasoning.Base.Single.html#457" class="Bound">ℓ</a> <a id="1181" class="Keyword">where</a>
  <a id="_IsRelatedTo_.relTo"></a><a id="1189" href="Relation.Binary.Reasoning.Base.Single.html#1189" class="InductiveConstructor">relTo</a> <a id="1195" class="Symbol">:</a> <a id="1197" class="Symbol">(</a><a id="1198" href="Relation.Binary.Reasoning.Base.Single.html#1198" class="Bound">x∼y</a> <a id="1202" class="Symbol">:</a> <a id="1204" href="Relation.Binary.Reasoning.Base.Single.html#1164" class="Bound">x</a> <a id="1206" href="Relation.Binary.Reasoning.Base.Single.html#473" class="Bound Operator">∼</a> <a id="1208" href="Relation.Binary.Reasoning.Base.Single.html#1166" class="Bound">y</a><a id="1209" class="Symbol">)</a> <a id="1211" class="Symbol">→</a> <a id="1213" href="Relation.Binary.Reasoning.Base.Single.html#1164" class="Bound">x</a> <a id="1215" href="Relation.Binary.Reasoning.Base.Single.html#1149" class="Datatype Operator">IsRelatedTo</a> <a id="1227" href="Relation.Binary.Reasoning.Base.Single.html#1166" class="Bound">y</a>

<a id="1230" class="Comment">------------------------------------------------------------------------</a>
<a id="1303" class="Comment">-- Reasoning combinators</a>

<a id="1329" class="Comment">-- Note that the arguments to the `step`s are not provided in their</a>
<a id="1397" class="Comment">-- &quot;natural&quot; order and syntax declarations are later used to re-order</a>
<a id="1467" class="Comment">-- them. This is because the `step` ordering allows the type-checker to</a>
<a id="1539" class="Comment">-- better infer the middle argument `y` from the `_IsRelatedTo_`</a>
<a id="1604" class="Comment">-- argument (see issue 622).</a>
<a id="1633" class="Comment">--</a>
<a id="1636" class="Comment">-- This has two practical benefits. First it speeds up type-checking by</a>
<a id="1708" class="Comment">-- approximately a factor of 5. Secondly it allows the combinators to be</a>
<a id="1781" class="Comment">-- used with macros that use reflection, e.g. `Tactic.RingSolver`, where</a>
<a id="1854" class="Comment">-- they need to be able to extract `y` using reflection.</a>

<a id="1912" class="Keyword">infix</a>  <a id="1919" class="Number">1</a> <a id="1921" href="Relation.Binary.Reasoning.Base.Single.html#2012" class="Function Operator">begin_</a>
<a id="1928" class="Keyword">infixr</a> <a id="1935" class="Number">2</a> <a id="1937" href="Relation.Binary.Reasoning.Base.Single.html#2114" class="Function">step-∼</a> <a id="1944" href="Relation.Binary.Reasoning.Base.Single.html#2278" class="Function">step-≡</a> <a id="1951" href="Relation.Binary.Reasoning.Base.Single.html#2427" class="Function">step-≡˘</a>
<a id="1959" class="Keyword">infixr</a> <a id="1966" class="Number">2</a> <a id="1968" href="Relation.Binary.Reasoning.Base.Single.html#2566" class="Function Operator">_≡⟨⟩_</a>
<a id="1974" class="Keyword">infix</a>  <a id="1981" class="Number">3</a> <a id="1983" href="Relation.Binary.Reasoning.Base.Single.html#2651" class="Function Operator">_∎</a>

<a id="1987" class="Comment">-- Beginning of a proof</a>

<a id="begin_"></a><a id="2012" href="Relation.Binary.Reasoning.Base.Single.html#2012" class="Function Operator">begin_</a> <a id="2019" class="Symbol">:</a> <a id="2021" class="Symbol">∀</a> <a id="2023" class="Symbol">{</a><a id="2024" href="Relation.Binary.Reasoning.Base.Single.html#2024" class="Bound">x</a> <a id="2026" href="Relation.Binary.Reasoning.Base.Single.html#2026" class="Bound">y</a><a id="2027" class="Symbol">}</a> <a id="2029" class="Symbol">→</a> <a id="2031" href="Relation.Binary.Reasoning.Base.Single.html#2024" class="Bound">x</a> <a id="2033" href="Relation.Binary.Reasoning.Base.Single.html#1149" class="Datatype Operator">IsRelatedTo</a> <a id="2045" href="Relation.Binary.Reasoning.Base.Single.html#2026" class="Bound">y</a> <a id="2047" class="Symbol">→</a> <a id="2049" href="Relation.Binary.Reasoning.Base.Single.html#2024" class="Bound">x</a> <a id="2051" href="Relation.Binary.Reasoning.Base.Single.html#473" class="Bound Operator">∼</a> <a id="2053" href="Relation.Binary.Reasoning.Base.Single.html#2026" class="Bound">y</a>
<a id="2055" href="Relation.Binary.Reasoning.Base.Single.html#2012" class="Function Operator">begin</a> <a id="2061" href="Relation.Binary.Reasoning.Base.Single.html#1189" class="InductiveConstructor">relTo</a> <a id="2067" href="Relation.Binary.Reasoning.Base.Single.html#2067" class="Bound">x∼y</a> <a id="2071" class="Symbol">=</a> <a id="2073" href="Relation.Binary.Reasoning.Base.Single.html#2067" class="Bound">x∼y</a>

<a id="2078" class="Comment">-- Standard step with the relation</a>

<a id="step-∼"></a><a id="2114" href="Relation.Binary.Reasoning.Base.Single.html#2114" class="Function">step-∼</a> <a id="2121" class="Symbol">:</a> <a id="2123" class="Symbol">∀</a> <a id="2125" href="Relation.Binary.Reasoning.Base.Single.html#2125" class="Bound">x</a> <a id="2127" class="Symbol">{</a><a id="2128" href="Relation.Binary.Reasoning.Base.Single.html#2128" class="Bound">y</a> <a id="2130" href="Relation.Binary.Reasoning.Base.Single.html#2130" class="Bound">z</a><a id="2131" class="Symbol">}</a> <a id="2133" class="Symbol">→</a> <a id="2135" href="Relation.Binary.Reasoning.Base.Single.html#2128" class="Bound">y</a> <a id="2137" href="Relation.Binary.Reasoning.Base.Single.html#1149" class="Datatype Operator">IsRelatedTo</a> <a id="2149" href="Relation.Binary.Reasoning.Base.Single.html#2130" class="Bound">z</a> <a id="2151" class="Symbol">→</a> <a id="2153" href="Relation.Binary.Reasoning.Base.Single.html#2125" class="Bound">x</a> <a id="2155" href="Relation.Binary.Reasoning.Base.Single.html#473" class="Bound Operator">∼</a> <a id="2157" href="Relation.Binary.Reasoning.Base.Single.html#2128" class="Bound">y</a> <a id="2159" class="Symbol">→</a> <a id="2161" href="Relation.Binary.Reasoning.Base.Single.html#2125" class="Bound">x</a> <a id="2163" href="Relation.Binary.Reasoning.Base.Single.html#1149" class="Datatype Operator">IsRelatedTo</a> <a id="2175" href="Relation.Binary.Reasoning.Base.Single.html#2130" class="Bound">z</a>
<a id="2177" href="Relation.Binary.Reasoning.Base.Single.html#2114" class="Function">step-∼</a> <a id="2184" class="Symbol">_</a> <a id="2186" class="Symbol">(</a><a id="2187" href="Relation.Binary.Reasoning.Base.Single.html#1189" class="InductiveConstructor">relTo</a> <a id="2193" href="Relation.Binary.Reasoning.Base.Single.html#2193" class="Bound">y∼z</a><a id="2196" class="Symbol">)</a> <a id="2198" href="Relation.Binary.Reasoning.Base.Single.html#2198" class="Bound">x∼y</a> <a id="2202" class="Symbol">=</a> <a id="2204" href="Relation.Binary.Reasoning.Base.Single.html#1189" class="InductiveConstructor">relTo</a> <a id="2210" class="Symbol">(</a><a id="2211" href="Relation.Binary.Reasoning.Base.Single.html#514" class="Bound">trans</a> <a id="2217" href="Relation.Binary.Reasoning.Base.Single.html#2198" class="Bound">x∼y</a> <a id="2221" href="Relation.Binary.Reasoning.Base.Single.html#2193" class="Bound">y∼z</a><a id="2224" class="Symbol">)</a>

<a id="2227" class="Comment">-- Step with a non-trivial propositional equality</a>

<a id="step-≡"></a><a id="2278" href="Relation.Binary.Reasoning.Base.Single.html#2278" class="Function">step-≡</a> <a id="2285" class="Symbol">:</a> <a id="2287" class="Symbol">∀</a> <a id="2289" href="Relation.Binary.Reasoning.Base.Single.html#2289" class="Bound">x</a> <a id="2291" class="Symbol">{</a><a id="2292" href="Relation.Binary.Reasoning.Base.Single.html#2292" class="Bound">y</a> <a id="2294" href="Relation.Binary.Reasoning.Base.Single.html#2294" class="Bound">z</a><a id="2295" class="Symbol">}</a> <a id="2297" class="Symbol">→</a> <a id="2299" href="Relation.Binary.Reasoning.Base.Single.html#2292" class="Bound">y</a> <a id="2301" href="Relation.Binary.Reasoning.Base.Single.html#1149" class="Datatype Operator">IsRelatedTo</a> <a id="2313" href="Relation.Binary.Reasoning.Base.Single.html#2294" class="Bound">z</a> <a id="2315" class="Symbol">→</a> <a id="2317" href="Relation.Binary.Reasoning.Base.Single.html#2289" class="Bound">x</a> <a id="2319" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="2321" href="Relation.Binary.Reasoning.Base.Single.html#2292" class="Bound">y</a> <a id="2323" class="Symbol">→</a> <a id="2325" href="Relation.Binary.Reasoning.Base.Single.html#2289" class="Bound">x</a> <a id="2327" href="Relation.Binary.Reasoning.Base.Single.html#1149" class="Datatype Operator">IsRelatedTo</a> <a id="2339" href="Relation.Binary.Reasoning.Base.Single.html#2294" class="Bound">z</a>
<a id="2341" href="Relation.Binary.Reasoning.Base.Single.html#2278" class="Function">step-≡</a> <a id="2348" class="Symbol">_</a> <a id="2350" href="Relation.Binary.Reasoning.Base.Single.html#2350" class="Bound">x∼z</a> <a id="2354" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">P.refl</a> <a id="2361" class="Symbol">=</a> <a id="2363" href="Relation.Binary.Reasoning.Base.Single.html#2350" class="Bound">x∼z</a>

<a id="2368" class="Comment">-- Step with a flipped non-trivial propositional equality</a>

<a id="step-≡˘"></a><a id="2427" href="Relation.Binary.Reasoning.Base.Single.html#2427" class="Function">step-≡˘</a> <a id="2435" class="Symbol">:</a> <a id="2437" class="Symbol">∀</a> <a id="2439" href="Relation.Binary.Reasoning.Base.Single.html#2439" class="Bound">x</a> <a id="2441" class="Symbol">{</a><a id="2442" href="Relation.Binary.Reasoning.Base.Single.html#2442" class="Bound">y</a> <a id="2444" href="Relation.Binary.Reasoning.Base.Single.html#2444" class="Bound">z</a><a id="2445" class="Symbol">}</a> <a id="2447" class="Symbol">→</a> <a id="2449" href="Relation.Binary.Reasoning.Base.Single.html#2442" class="Bound">y</a> <a id="2451" href="Relation.Binary.Reasoning.Base.Single.html#1149" class="Datatype Operator">IsRelatedTo</a> <a id="2463" href="Relation.Binary.Reasoning.Base.Single.html#2444" class="Bound">z</a> <a id="2465" class="Symbol">→</a> <a id="2467" href="Relation.Binary.Reasoning.Base.Single.html#2442" class="Bound">y</a> <a id="2469" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="2471" href="Relation.Binary.Reasoning.Base.Single.html#2439" class="Bound">x</a> <a id="2473" class="Symbol">→</a> <a id="2475" href="Relation.Binary.Reasoning.Base.Single.html#2439" class="Bound">x</a> <a id="2477" href="Relation.Binary.Reasoning.Base.Single.html#1149" class="Datatype Operator">IsRelatedTo</a> <a id="2489" href="Relation.Binary.Reasoning.Base.Single.html#2444" class="Bound">z</a>
<a id="2491" href="Relation.Binary.Reasoning.Base.Single.html#2427" class="Function">step-≡˘</a> <a id="2499" class="Symbol">_</a> <a id="2501" href="Relation.Binary.Reasoning.Base.Single.html#2501" class="Bound">x∼z</a> <a id="2505" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">P.refl</a> <a id="2512" class="Symbol">=</a> <a id="2514" href="Relation.Binary.Reasoning.Base.Single.html#2501" class="Bound">x∼z</a>

<a id="2519" class="Comment">-- Step with a trivial propositional equality</a>

<a id="_≡⟨⟩_"></a><a id="2566" href="Relation.Binary.Reasoning.Base.Single.html#2566" class="Function Operator">_≡⟨⟩_</a> <a id="2572" class="Symbol">:</a> <a id="2574" class="Symbol">∀</a> <a id="2576" href="Relation.Binary.Reasoning.Base.Single.html#2576" class="Bound">x</a> <a id="2578" class="Symbol">{</a><a id="2579" href="Relation.Binary.Reasoning.Base.Single.html#2579" class="Bound">y</a><a id="2580" class="Symbol">}</a> <a id="2582" class="Symbol">→</a> <a id="2584" href="Relation.Binary.Reasoning.Base.Single.html#2576" class="Bound">x</a> <a id="2586" href="Relation.Binary.Reasoning.Base.Single.html#1149" class="Datatype Operator">IsRelatedTo</a> <a id="2598" href="Relation.Binary.Reasoning.Base.Single.html#2579" class="Bound">y</a> <a id="2600" class="Symbol">→</a> <a id="2602" href="Relation.Binary.Reasoning.Base.Single.html#2576" class="Bound">x</a> <a id="2604" href="Relation.Binary.Reasoning.Base.Single.html#1149" class="Datatype Operator">IsRelatedTo</a> <a id="2616" href="Relation.Binary.Reasoning.Base.Single.html#2579" class="Bound">y</a>
<a id="2618" class="Symbol">_</a> <a id="2620" href="Relation.Binary.Reasoning.Base.Single.html#2566" class="Function Operator">≡⟨⟩</a> <a id="2624" href="Relation.Binary.Reasoning.Base.Single.html#2624" class="Bound">x∼y</a> <a id="2628" class="Symbol">=</a> <a id="2630" href="Relation.Binary.Reasoning.Base.Single.html#2624" class="Bound">x∼y</a>

<a id="2635" class="Comment">-- Termination</a>

<a id="_∎"></a><a id="2651" href="Relation.Binary.Reasoning.Base.Single.html#2651" class="Function Operator">_∎</a> <a id="2654" class="Symbol">:</a> <a id="2656" class="Symbol">∀</a> <a id="2658" href="Relation.Binary.Reasoning.Base.Single.html#2658" class="Bound">x</a> <a id="2660" class="Symbol">→</a> <a id="2662" href="Relation.Binary.Reasoning.Base.Single.html#2658" class="Bound">x</a> <a id="2664" href="Relation.Binary.Reasoning.Base.Single.html#1149" class="Datatype Operator">IsRelatedTo</a> <a id="2676" href="Relation.Binary.Reasoning.Base.Single.html#2658" class="Bound">x</a>
<a id="2678" href="Relation.Binary.Reasoning.Base.Single.html#2678" class="Bound">x</a> <a id="2680" href="Relation.Binary.Reasoning.Base.Single.html#2651" class="Function Operator">∎</a> <a id="2682" class="Symbol">=</a> <a id="2684" href="Relation.Binary.Reasoning.Base.Single.html#1189" class="InductiveConstructor">relTo</a> <a id="2690" href="Relation.Binary.Reasoning.Base.Single.html#491" class="Bound">refl</a>

<a id="2696" class="Comment">-- Syntax declarations</a>

<a id="2720" class="Keyword">syntax</a> <a id="2727" href="Relation.Binary.Reasoning.Base.Single.html#2114" class="Function">step-∼</a>  <a id="2735" class="Bound">x</a> <a id="2737" class="Bound">y∼z</a> <a id="2741" class="Bound">x∼y</a> <a id="2745" class="Symbol">=</a> <a id="2747" class="Bound">x</a> <a id="2749" class="Function">∼⟨</a>  <a id="2753" class="Bound">x∼y</a> <a id="2757" class="Function">⟩</a> <a id="2759" class="Bound">y∼z</a>
<a id="2763" class="Keyword">syntax</a> <a id="2770" href="Relation.Binary.Reasoning.Base.Single.html#2278" class="Function">step-≡</a>  <a id="2778" class="Bound">x</a> <a id="2780" class="Bound">y≡z</a> <a id="2784" class="Bound">x≡y</a> <a id="2788" class="Symbol">=</a> <a id="2790" class="Bound">x</a> <a id="2792" class="Function">≡⟨</a>  <a id="2796" class="Bound">x≡y</a> <a id="2800" class="Function">⟩</a> <a id="2802" class="Bound">y≡z</a>
<a id="2806" class="Keyword">syntax</a> <a id="2813" href="Relation.Binary.Reasoning.Base.Single.html#2427" class="Function">step-≡˘</a> <a id="2821" class="Bound">x</a> <a id="2823" class="Bound">y≡z</a> <a id="2827" class="Bound">y≡x</a> <a id="2831" class="Symbol">=</a> <a id="2833" class="Bound">x</a> <a id="2835" class="Function">≡˘⟨</a> <a id="2839" class="Bound">y≡x</a> <a id="2843" class="Function">⟩</a> <a id="2845" class="Bound">y≡z</a>
</pre></body></html>