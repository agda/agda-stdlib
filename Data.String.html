<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.String</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Strings</a>
<a id="117" class="Comment">------------------------------------------------------------------------</a>

<a id="191" class="Symbol">{-#</a> <a id="195" class="Keyword">OPTIONS</a> <a id="203" class="Pragma">--cubical-compatible</a> <a id="224" class="Pragma">--safe</a> <a id="231" class="Symbol">#-}</a>

<a id="236" class="Keyword">module</a> <a id="243" href="Data.String.html" class="Module">Data.String</a> <a id="255" class="Keyword">where</a>

<a id="262" class="Keyword">open</a> <a id="267" class="Keyword">import</a> <a id="274" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> <a id="289" class="Keyword">using</a> <a id="295" class="Symbol">(</a><a id="296" href="Data.Bool.Base.html#1292" class="Function Operator">if_then_else_</a><a id="309" class="Symbol">)</a>
<a id="311" class="Keyword">open</a> <a id="316" class="Keyword">import</a> <a id="323" href="Data.Char.html" class="Module">Data.Char</a> <a id="333" class="Symbol">as</a> <a id="336" class="Module">Char</a> <a id="341" class="Keyword">using</a> <a id="347" class="Symbol">(</a><a id="348" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a><a id="352" class="Symbol">)</a>
<a id="354" class="Keyword">open</a> <a id="359" class="Keyword">import</a> <a id="366" href="Function.Base.html" class="Module">Function.Base</a> <a id="380" class="Keyword">using</a> <a id="386" class="Symbol">(</a><a id="387" href="Function.Base.html#1115" class="Function Operator">_∘_</a><a id="390" class="Symbol">;</a> <a id="392" href="Function.Base.html#1974" class="Function Operator">_$_</a><a id="395" class="Symbol">)</a>
<a id="397" class="Keyword">open</a> <a id="402" class="Keyword">import</a> <a id="409" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="423" class="Symbol">as</a> <a id="426" class="Module">ℕ</a> <a id="428" class="Keyword">using</a> <a id="434" class="Symbol">(</a><a id="435" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="436" class="Symbol">)</a>
<a id="438" class="Keyword">import</a> <a id="445" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="465" class="Symbol">as</a> <a id="468" class="Module">ℕₚ</a>
<a id="471" class="Keyword">open</a> <a id="476" class="Keyword">import</a> <a id="483" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="498" class="Symbol">as</a> <a id="501" class="Module">List</a> <a id="506" class="Keyword">using</a> <a id="512" class="Symbol">(</a><a id="513" href="Agda.Builtin.List.html#130" class="Datatype">List</a><a id="517" class="Symbol">)</a>
<a id="519" class="Keyword">open</a> <a id="524" class="Keyword">import</a> <a id="531" href="Data.List.Extrema.html" class="Module">Data.List.Extrema</a> <a id="549" href="Data.Nat.Properties.html#7760" class="Function">ℕₚ.≤-totalOrder</a>
<a id="565" class="Keyword">open</a> <a id="570" class="Keyword">import</a> <a id="577" href="Data.Vec.Base.html" class="Module">Data.Vec.Base</a> <a id="591" class="Symbol">as</a> <a id="594" class="Module">Vec</a> <a id="598" class="Keyword">using</a> <a id="604" class="Symbol">(</a><a id="605" href="Data.Vec.Base.html#1107" class="Datatype">Vec</a><a id="608" class="Symbol">)</a>
<a id="610" class="Keyword">open</a> <a id="615" class="Keyword">import</a> <a id="622" href="Data.Char.Base.html" class="Module">Data.Char.Base</a> <a id="637" class="Symbol">as</a> <a id="640" class="Module">Char</a> <a id="645" class="Keyword">using</a> <a id="651" class="Symbol">(</a><a id="652" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a><a id="656" class="Symbol">)</a>
<a id="658" class="Keyword">import</a> <a id="665" href="Data.Char.Properties.html" class="Module">Data.Char.Properties</a> <a id="686" class="Symbol">as</a> <a id="689" class="Module">Char</a> <a id="694" class="Keyword">using</a> <a id="700" class="Symbol">(</a><a id="701" href="Data.Char.Properties.html#2071" class="Function Operator">_≟_</a><a id="704" class="Symbol">)</a>
<a id="706" class="Keyword">open</a> <a id="711" class="Keyword">import</a> <a id="718" href="Relation.Nullary.Decidable.Core.html" class="Module">Relation.Nullary.Decidable.Core</a> <a id="750" class="Keyword">using</a> <a id="756" class="Symbol">(</a><a id="757" href="Relation.Nullary.Decidable.Core.html#1544" class="Field">does</a><a id="761" class="Symbol">)</a>

<a id="764" class="Keyword">open</a> <a id="769" class="Keyword">import</a> <a id="776" href="Data.List.Membership.DecPropositional.html" class="Module">Data.List.Membership.DecPropositional</a> <a id="814" href="Data.Char.Properties.html#2071" class="Function Operator">Char._≟_</a>



<a id="826" class="Comment">------------------------------------------------------------------------</a>
<a id="899" class="Comment">-- Re-export contents of base, and decidability of equality</a>

<a id="960" class="Keyword">open</a> <a id="965" class="Keyword">import</a> <a id="972" href="Data.String.Base.html" class="Module">Data.String.Base</a> <a id="989" class="Keyword">public</a>
<a id="996" class="Keyword">open</a> <a id="1001" class="Keyword">import</a> <a id="1008" href="Data.String.Properties.html" class="Module">Data.String.Properties</a> <a id="1031" class="Keyword">using</a> <a id="1037" class="Symbol">(</a><a id="1038" href="Data.String.Properties.html#2036" class="Function Operator">_≈?_</a><a id="1042" class="Symbol">;</a> <a id="1044" href="Data.String.Properties.html#2717" class="Function Operator">_≟_</a><a id="1047" class="Symbol">;</a> <a id="1049" href="Data.String.Properties.html#3003" class="Function Operator">_&lt;?_</a><a id="1053" class="Symbol">;</a> <a id="1055" href="Data.String.Properties.html#4782" class="Function Operator">_==_</a><a id="1059" class="Symbol">)</a> <a id="1061" class="Keyword">public</a>

<a id="1069" class="Comment">------------------------------------------------------------------------</a>
<a id="1142" class="Comment">-- Conversion functions</a>

<a id="toVec"></a><a id="1167" href="Data.String.html#1167" class="Function">toVec</a> <a id="1173" class="Symbol">:</a> <a id="1175" class="Symbol">(</a><a id="1176" href="Data.String.html#1176" class="Bound">s</a> <a id="1178" class="Symbol">:</a> <a id="1180" href="Agda.Builtin.String.html#318" class="Postulate">String</a><a id="1186" class="Symbol">)</a> <a id="1188" class="Symbol">→</a> <a id="1190" href="Data.Vec.Base.html#1107" class="Datatype">Vec</a> <a id="1194" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="1199" class="Symbol">(</a><a id="1200" href="Data.String.Base.html#2464" class="Function">length</a> <a id="1207" href="Data.String.html#1176" class="Bound">s</a><a id="1208" class="Symbol">)</a>
<a id="1210" href="Data.String.html#1167" class="Function">toVec</a> <a id="1216" href="Data.String.html#1216" class="Bound">s</a> <a id="1218" class="Symbol">=</a> <a id="1220" href="Data.Vec.Base.html#8367" class="Function">Vec.fromList</a> <a id="1233" class="Symbol">(</a><a id="1234" href="Data.String.Base.html#1533" class="Primitive">toList</a> <a id="1241" href="Data.String.html#1216" class="Bound">s</a><a id="1242" class="Symbol">)</a>

<a id="fromVec"></a><a id="1245" href="Data.String.html#1245" class="Function">fromVec</a> <a id="1253" class="Symbol">:</a> <a id="1255" class="Symbol">∀</a> <a id="1257" class="Symbol">{</a><a id="1258" href="Data.String.html#1258" class="Bound">n</a><a id="1259" class="Symbol">}</a> <a id="1261" class="Symbol">→</a> <a id="1263" href="Data.Vec.Base.html#1107" class="Datatype">Vec</a> <a id="1267" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="1272" href="Data.String.html#1258" class="Bound">n</a> <a id="1274" class="Symbol">→</a> <a id="1276" href="Agda.Builtin.String.html#318" class="Postulate">String</a>
<a id="1283" href="Data.String.html#1245" class="Function">fromVec</a> <a id="1291" class="Symbol">=</a> <a id="1293" href="Data.String.Base.html#1566" class="Primitive">fromList</a> <a id="1302" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1304" href="Data.Vec.Base.html#8273" class="Function">Vec.toList</a>


<a id="1317" class="Comment">-- enclose string with parens if it contains a space character</a>
<a id="parensIfSpace"></a><a id="1380" href="Data.String.html#1380" class="Function">parensIfSpace</a> <a id="1394" class="Symbol">:</a> <a id="1396" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="1403" class="Symbol">→</a> <a id="1405" href="Agda.Builtin.String.html#318" class="Postulate">String</a>
<a id="1412" href="Data.String.html#1380" class="Function">parensIfSpace</a> <a id="1426" href="Data.String.html#1426" class="Bound">s</a> <a id="1428" class="Symbol">=</a> <a id="1430" href="Data.Bool.Base.html#1292" class="Function Operator">if</a> <a id="1433" href="Relation.Nullary.Decidable.Core.html#1544" class="Field">does</a> <a id="1438" class="Symbol">(</a><a id="1439" class="String">&#39; &#39;</a> <a id="1443" href="Data.List.Membership.DecSetoid.html#882" class="Function Operator">∈?</a> <a id="1446" href="Data.String.Base.html#1533" class="Primitive">toList</a> <a id="1453" href="Data.String.html#1426" class="Bound">s</a><a id="1454" class="Symbol">)</a> <a id="1456" href="Data.Bool.Base.html#1292" class="Function Operator">then</a> <a id="1461" href="Data.String.Base.html#2860" class="Function">parens</a> <a id="1468" href="Data.String.html#1426" class="Bound">s</a> <a id="1470" href="Data.Bool.Base.html#1292" class="Function Operator">else</a> <a id="1475" href="Data.String.html#1426" class="Bound">s</a>


<a id="1479" class="Comment">------------------------------------------------------------------------</a>
<a id="1552" class="Comment">-- Rectangle</a>

<a id="1566" class="Comment">-- Build a rectangular column by:</a>
<a id="1600" class="Comment">-- Given a vector of cells and a padding function for each one</a>
<a id="1663" class="Comment">-- Compute the max of the widths, and pad the strings accordingly.</a>

<a id="rectangle"></a><a id="1731" href="Data.String.html#1731" class="Function">rectangle</a> <a id="1741" class="Symbol">:</a> <a id="1743" class="Symbol">∀</a> <a id="1745" class="Symbol">{</a><a id="1746" href="Data.String.html#1746" class="Bound">n</a><a id="1747" class="Symbol">}</a> <a id="1749" class="Symbol">→</a> <a id="1751" href="Data.Vec.Base.html#1107" class="Datatype">Vec</a> <a id="1755" class="Symbol">(</a><a id="1756" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="1758" class="Symbol">→</a> <a id="1760" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="1767" class="Symbol">→</a> <a id="1769" href="Agda.Builtin.String.html#318" class="Postulate">String</a><a id="1775" class="Symbol">)</a> <a id="1777" href="Data.String.html#1746" class="Bound">n</a> <a id="1779" class="Symbol">→</a>
            <a id="1793" href="Data.Vec.Base.html#1107" class="Datatype">Vec</a> <a id="1797" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="1804" href="Data.String.html#1746" class="Bound">n</a> <a id="1806" class="Symbol">→</a> <a id="1808" href="Data.Vec.Base.html#1107" class="Datatype">Vec</a> <a id="1812" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="1819" href="Data.String.html#1746" class="Bound">n</a>
<a id="1821" href="Data.String.html#1731" class="Function">rectangle</a> <a id="1831" href="Data.String.html#1831" class="Bound">pads</a> <a id="1836" href="Data.String.html#1836" class="Bound">cells</a> <a id="1842" class="Symbol">=</a> <a id="1844" href="Data.Vec.Base.html#3623" class="Function">Vec.zipWith</a> <a id="1856" class="Symbol">(λ</a> <a id="1859" href="Data.String.html#1859" class="Bound">p</a> <a id="1861" href="Data.String.html#1861" class="Bound">c</a> <a id="1863" class="Symbol">→</a> <a id="1865" href="Data.String.html#1859" class="Bound">p</a> <a id="1867" href="Data.String.html#1941" class="Function">width</a> <a id="1873" href="Data.String.html#1861" class="Bound">c</a><a id="1874" class="Symbol">)</a> <a id="1876" href="Data.String.html#1831" class="Bound">pads</a> <a id="1881" href="Data.String.html#1836" class="Bound">cells</a> <a id="1887" class="Keyword">where</a>

  <a id="1896" href="Data.String.html#1896" class="Function">sizes</a> <a id="1902" class="Symbol">=</a> <a id="1904" href="Data.List.Base.html#1627" class="Function">List.map</a> <a id="1913" href="Data.String.Base.html#2464" class="Function">length</a> <a id="1920" class="Symbol">(</a><a id="1921" href="Data.Vec.Base.html#8273" class="Function">Vec.toList</a> <a id="1932" href="Data.String.html#1836" class="Bound">cells</a><a id="1937" class="Symbol">)</a>
  <a id="1941" href="Data.String.html#1941" class="Function">width</a> <a id="1947" class="Symbol">=</a> <a id="1949" href="Data.List.Extrema.html#1941" class="Function">max</a> <a id="1953" class="Number">0</a> <a id="1955" href="Data.String.html#1896" class="Function">sizes</a>

<a id="1962" class="Comment">-- Special cases for left, center, and right alignment</a>

<a id="rectangleˡ"></a><a id="2018" href="Data.String.html#2018" class="Function">rectangleˡ</a> <a id="2029" class="Symbol">:</a> <a id="2031" class="Symbol">∀</a> <a id="2033" class="Symbol">{</a><a id="2034" href="Data.String.html#2034" class="Bound">n</a><a id="2035" class="Symbol">}</a> <a id="2037" class="Symbol">→</a> <a id="2039" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="2044" class="Symbol">→</a> <a id="2046" href="Data.Vec.Base.html#1107" class="Datatype">Vec</a> <a id="2050" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2057" href="Data.String.html#2034" class="Bound">n</a> <a id="2059" class="Symbol">→</a> <a id="2061" href="Data.Vec.Base.html#1107" class="Datatype">Vec</a> <a id="2065" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2072" href="Data.String.html#2034" class="Bound">n</a>
<a id="2074" href="Data.String.html#2018" class="Function">rectangleˡ</a> <a id="2085" href="Data.String.html#2085" class="Bound">c</a> <a id="2087" class="Symbol">=</a> <a id="2089" href="Data.String.html#1731" class="Function">rectangle</a> <a id="2099" class="Symbol">(</a><a id="2100" href="Data.Vec.Base.html#6373" class="Function">Vec.replicate</a> <a id="2114" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="2116" href="Data.String.Base.html#3592" class="Function">padLeft</a> <a id="2124" href="Data.String.html#2085" class="Bound">c</a><a id="2125" class="Symbol">)</a>

<a id="rectangleʳ"></a><a id="2128" href="Data.String.html#2128" class="Function">rectangleʳ</a> <a id="2139" class="Symbol">:</a> <a id="2141" class="Symbol">∀</a> <a id="2143" class="Symbol">{</a><a id="2144" href="Data.String.html#2144" class="Bound">n</a><a id="2145" class="Symbol">}</a> <a id="2147" class="Symbol">→</a> <a id="2149" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="2154" class="Symbol">→</a> <a id="2156" href="Data.Vec.Base.html#1107" class="Datatype">Vec</a> <a id="2160" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2167" href="Data.String.html#2144" class="Bound">n</a> <a id="2169" class="Symbol">→</a> <a id="2171" href="Data.Vec.Base.html#1107" class="Datatype">Vec</a> <a id="2175" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2182" href="Data.String.html#2144" class="Bound">n</a>
<a id="2184" href="Data.String.html#2128" class="Function">rectangleʳ</a> <a id="2195" href="Data.String.html#2195" class="Bound">c</a> <a id="2197" class="Symbol">=</a> <a id="2199" href="Data.String.html#1731" class="Function">rectangle</a> <a id="2209" class="Symbol">(</a><a id="2210" href="Data.Vec.Base.html#6373" class="Function">Vec.replicate</a> <a id="2224" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="2226" href="Data.String.Base.html#3711" class="Function">padRight</a> <a id="2235" href="Data.String.html#2195" class="Bound">c</a><a id="2236" class="Symbol">)</a>

<a id="rectangleᶜ"></a><a id="2239" href="Data.String.html#2239" class="Function">rectangleᶜ</a> <a id="2250" class="Symbol">:</a> <a id="2252" class="Symbol">∀</a> <a id="2254" class="Symbol">{</a><a id="2255" href="Data.String.html#2255" class="Bound">n</a><a id="2256" class="Symbol">}</a> <a id="2258" class="Symbol">→</a> <a id="2260" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="2265" class="Symbol">→</a> <a id="2267" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="2272" class="Symbol">→</a> <a id="2274" href="Data.Vec.Base.html#1107" class="Datatype">Vec</a> <a id="2278" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2285" href="Data.String.html#2255" class="Bound">n</a> <a id="2287" class="Symbol">→</a> <a id="2289" href="Data.Vec.Base.html#1107" class="Datatype">Vec</a> <a id="2293" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2300" href="Data.String.html#2255" class="Bound">n</a>
<a id="2302" href="Data.String.html#2239" class="Function">rectangleᶜ</a> <a id="2313" href="Data.String.html#2313" class="Bound">cₗ</a> <a id="2316" href="Data.String.html#2316" class="Bound">cᵣ</a> <a id="2319" class="Symbol">=</a> <a id="2321" href="Data.String.html#1731" class="Function">rectangle</a> <a id="2331" class="Symbol">(</a><a id="2332" href="Data.Vec.Base.html#6373" class="Function">Vec.replicate</a> <a id="2346" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="2348" href="Data.String.Base.html#3832" class="Function">padBoth</a> <a id="2356" href="Data.String.html#2313" class="Bound">cₗ</a> <a id="2359" href="Data.String.html#2316" class="Bound">cᵣ</a><a id="2361" class="Symbol">)</a>
</pre></body></html>