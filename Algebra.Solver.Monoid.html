<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Algebra.Solver.Monoid</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Solver for monoid equalities</a>
<a id="138" class="Comment">------------------------------------------------------------------------</a>

<a id="212" class="Keyword">open</a> <a id="217" class="Keyword">import</a> <a id="224" href="Algebra.html" class="Module">Algebra</a>

<a id="233" class="Keyword">module</a> <a id="240" href="Algebra.Solver.Monoid.html" class="Module">Algebra.Solver.Monoid</a> <a id="262" class="Symbol">{</a><a id="263" href="Algebra.Solver.Monoid.html#263" class="Bound">m₁</a> <a id="266" href="Algebra.Solver.Monoid.html#266" class="Bound">m₂</a><a id="268" class="Symbol">}</a> <a id="270" class="Symbol">(</a><a id="271" href="Algebra.Solver.Monoid.html#271" class="Bound">M</a> <a id="273" class="Symbol">:</a> <a id="275" href="Algebra.html#1729" class="Record">Monoid</a> <a id="282" href="Algebra.Solver.Monoid.html#263" class="Bound">m₁</a> <a id="285" href="Algebra.Solver.Monoid.html#266" class="Bound">m₂</a><a id="287" class="Symbol">)</a> <a id="289" class="Keyword">where</a>

<a id="296" class="Keyword">open</a> <a id="301" class="Keyword">import</a> <a id="308" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="317" class="Symbol">as</a> <a id="320" class="Module">Fin</a> <a id="324" class="Keyword">hiding</a> <a id="331" class="Symbol">(</a><a id="332" href="Data.Fin.Properties.html#1694" class="Function Operator">_≟_</a><a id="335" class="Symbol">)</a>
<a id="337" class="Keyword">import</a> <a id="344" href="Data.Fin.Properties.html" class="Module">Data.Fin.Properties</a> <a id="364" class="Symbol">as</a> <a id="367" class="Module">Fin</a>
<a id="371" class="Keyword">open</a> <a id="376" class="Keyword">import</a> <a id="383" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="398" class="Keyword">hiding</a> <a id="405" class="Symbol">(</a><a id="406" href="Data.List.Base.html#5521" class="Function">lookup</a><a id="412" class="Symbol">)</a>
<a id="414" class="Keyword">import</a> <a id="421" href="Data.List.Relation.Equality.DecPropositional.html" class="Module">Data.List.Relation.Equality.DecPropositional</a> <a id="466" class="Symbol">as</a> <a id="469" class="Module">ListEq</a>
<a id="476" class="Keyword">open</a> <a id="481" class="Keyword">import</a> <a id="488" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="499" class="Symbol">as</a> <a id="502" class="Module">Maybe</a>
  <a id="510" class="Keyword">using</a> <a id="516" class="Symbol">(</a><a id="517" href="Data.Maybe.Base.html#674" class="Datatype">Maybe</a><a id="522" class="Symbol">;</a> <a id="524" href="Data.Maybe.Base.html#1249" class="Function">decToMaybe</a><a id="534" class="Symbol">;</a> <a id="536" href="Data.Maybe.Base.html#1900" class="Function">From-just</a><a id="545" class="Symbol">;</a> <a id="547" href="Data.Maybe.Base.html#1988" class="Function">from-just</a><a id="556" class="Symbol">)</a>
<a id="558" class="Keyword">open</a> <a id="563" class="Keyword">import</a> <a id="570" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="584" class="Keyword">using</a> <a id="590" class="Symbol">(</a><a id="591" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="592" class="Symbol">)</a>
<a id="594" class="Keyword">open</a> <a id="599" class="Keyword">import</a> <a id="606" href="Data.Product.html" class="Module">Data.Product</a>
<a id="619" class="Keyword">open</a> <a id="624" class="Keyword">import</a> <a id="631" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="640" class="Keyword">using</a> <a id="646" class="Symbol">(</a><a id="647" href="Data.Vec.html#737" class="Datatype">Vec</a><a id="650" class="Symbol">;</a> <a id="652" href="Data.Vec.html#1343" class="Function">lookup</a><a id="658" class="Symbol">)</a>
<a id="660" class="Keyword">open</a> <a id="665" class="Keyword">import</a> <a id="672" href="Function.html" class="Module">Function</a> <a id="681" class="Keyword">using</a> <a id="687" class="Symbol">(</a><a id="688" href="Function.html#769" class="Function Operator">_∘_</a><a id="691" class="Symbol">;</a> <a id="693" href="Function.html#1891" class="Function Operator">_$_</a><a id="696" class="Symbol">)</a>
<a id="698" class="Keyword">open</a> <a id="703" class="Keyword">import</a> <a id="710" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="726" class="Keyword">using</a> <a id="732" class="Symbol">(</a><a id="733" href="Relation.Binary.Core.html#4541" class="Function">Decidable</a><a id="742" class="Symbol">)</a>
<a id="744" class="Keyword">import</a> <a id="751" href="Relation.Binary.EqReasoning.html" class="Module">Relation.Binary.EqReasoning</a>
<a id="779" class="Keyword">open</a> <a id="784" class="Keyword">import</a> <a id="791" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="829" class="Symbol">as</a> <a id="832" class="Module">P</a> <a id="834" class="Keyword">using</a> <a id="840" class="Symbol">(</a><a id="841" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a><a id="844" class="Symbol">)</a>
<a id="846" class="Keyword">import</a> <a id="853" href="Relation.Binary.Reflection.html" class="Module">Relation.Binary.Reflection</a>
<a id="880" class="Keyword">open</a> <a id="885" class="Keyword">import</a> <a id="892" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>
<a id="909" class="Keyword">import</a> <a id="916" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="943" class="Symbol">as</a> <a id="946" class="Module">Dec</a>

<a id="951" class="Keyword">open</a> <a id="956" href="Algebra.html#1729" class="Module">Monoid</a> <a id="963" href="Algebra.Solver.Monoid.html#271" class="Bound">M</a>
<a id="965" class="Keyword">open</a> <a id="970" href="Relation.Binary.EqReasoning.html" class="Module">Relation.Binary.EqReasoning</a> <a id="998" href="Algebra.Structures.html#904" class="Function">setoid</a>

<a id="1006" class="Comment">------------------------------------------------------------------------</a>
<a id="1079" class="Comment">-- Monoid expressions</a>

<a id="1102" class="Comment">-- There is one constructor for every operation, plus one for</a>
<a id="1164" class="Comment">-- variables; there may be at most n variables.</a>

<a id="1213" class="Keyword">infixr</a> <a id="1220" class="Number">5</a> <a id="1222" href="Algebra.Solver.Monoid.html#1297" class="InductiveConstructor Operator">_⊕_</a>

<a id="1227" class="Keyword">data</a> <a id="Expr"></a><a id="1232" href="Algebra.Solver.Monoid.html#1232" class="Datatype">Expr</a> <a id="1237" class="Symbol">(</a><a id="1238" href="Algebra.Solver.Monoid.html#1238" class="Bound">n</a> <a id="1240" class="Symbol">:</a> <a id="1242" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="1243" class="Symbol">)</a> <a id="1245" class="Symbol">:</a> <a id="1247" class="PrimitiveType">Set</a> <a id="1251" class="Keyword">where</a>
  <a id="Expr.var"></a><a id="1259" href="Algebra.Solver.Monoid.html#1259" class="InductiveConstructor">var</a> <a id="1263" class="Symbol">:</a> <a id="1265" href="Data.Fin.Base.html#915" class="Datatype">Fin</a> <a id="1269" href="Algebra.Solver.Monoid.html#1238" class="Bound">n</a> <a id="1271" class="Symbol">→</a> <a id="1273" href="Algebra.Solver.Monoid.html#1232" class="Datatype">Expr</a> <a id="1278" href="Algebra.Solver.Monoid.html#1238" class="Bound">n</a>
  <a id="Expr.id"></a><a id="1282" href="Algebra.Solver.Monoid.html#1282" class="InductiveConstructor">id</a>  <a id="1286" class="Symbol">:</a> <a id="1288" href="Algebra.Solver.Monoid.html#1232" class="Datatype">Expr</a> <a id="1293" href="Algebra.Solver.Monoid.html#1238" class="Bound">n</a>
  <a id="Expr._⊕_"></a><a id="1297" href="Algebra.Solver.Monoid.html#1297" class="InductiveConstructor Operator">_⊕_</a> <a id="1301" class="Symbol">:</a> <a id="1303" href="Algebra.Solver.Monoid.html#1232" class="Datatype">Expr</a> <a id="1308" href="Algebra.Solver.Monoid.html#1238" class="Bound">n</a> <a id="1310" class="Symbol">→</a> <a id="1312" href="Algebra.Solver.Monoid.html#1232" class="Datatype">Expr</a> <a id="1317" href="Algebra.Solver.Monoid.html#1238" class="Bound">n</a> <a id="1319" class="Symbol">→</a> <a id="1321" href="Algebra.Solver.Monoid.html#1232" class="Datatype">Expr</a> <a id="1326" href="Algebra.Solver.Monoid.html#1238" class="Bound">n</a>

<a id="1329" class="Comment">-- An environment contains one value for every variable.</a>

<a id="Env"></a><a id="1387" href="Algebra.Solver.Monoid.html#1387" class="Function">Env</a> <a id="1391" class="Symbol">:</a> <a id="1393" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1395" class="Symbol">→</a> <a id="1397" class="PrimitiveType">Set</a> <a id="1401" class="Symbol">_</a>
<a id="1403" href="Algebra.Solver.Monoid.html#1387" class="Function">Env</a> <a id="1407" href="Algebra.Solver.Monoid.html#1407" class="Bound">n</a> <a id="1409" class="Symbol">=</a> <a id="1411" href="Data.Vec.html#737" class="Datatype">Vec</a> <a id="1415" href="Algebra.html#1808" class="Field">Carrier</a> <a id="1423" href="Algebra.Solver.Monoid.html#1407" class="Bound">n</a>

<a id="1426" class="Comment">-- The semantics of an expression is a function from an environment to</a>
<a id="1497" class="Comment">-- a value.</a>

<a id="⟦_⟧"></a><a id="1510" href="Algebra.Solver.Monoid.html#1510" class="Function Operator">⟦_⟧</a> <a id="1514" class="Symbol">:</a> <a id="1516" class="Symbol">∀</a> <a id="1518" class="Symbol">{</a><a id="1519" href="Algebra.Solver.Monoid.html#1519" class="Bound">n</a><a id="1520" class="Symbol">}</a> <a id="1522" class="Symbol">→</a> <a id="1524" href="Algebra.Solver.Monoid.html#1232" class="Datatype">Expr</a> <a id="1529" href="Algebra.Solver.Monoid.html#1519" class="Bound">n</a> <a id="1531" class="Symbol">→</a> <a id="1533" href="Algebra.Solver.Monoid.html#1387" class="Function">Env</a> <a id="1537" href="Algebra.Solver.Monoid.html#1519" class="Bound">n</a> <a id="1539" class="Symbol">→</a> <a id="1541" href="Algebra.html#1808" class="Field">Carrier</a>
<a id="1549" href="Algebra.Solver.Monoid.html#1510" class="Function Operator">⟦</a> <a id="1551" href="Algebra.Solver.Monoid.html#1259" class="InductiveConstructor">var</a> <a id="1555" href="Algebra.Solver.Monoid.html#1555" class="Bound">x</a>   <a id="1559" href="Algebra.Solver.Monoid.html#1510" class="Function Operator">⟧</a> <a id="1561" href="Algebra.Solver.Monoid.html#1561" class="Bound">ρ</a> <a id="1563" class="Symbol">=</a> <a id="1565" href="Data.Vec.html#1343" class="Function">lookup</a> <a id="1572" href="Algebra.Solver.Monoid.html#1555" class="Bound">x</a> <a id="1574" href="Algebra.Solver.Monoid.html#1561" class="Bound">ρ</a>
<a id="1576" href="Algebra.Solver.Monoid.html#1510" class="Function Operator">⟦</a> <a id="1578" href="Algebra.Solver.Monoid.html#1282" class="InductiveConstructor">id</a>      <a id="1586" href="Algebra.Solver.Monoid.html#1510" class="Function Operator">⟧</a> <a id="1588" href="Algebra.Solver.Monoid.html#1588" class="Bound">ρ</a> <a id="1590" class="Symbol">=</a> <a id="1592" href="Algebra.html#1885" class="Field">ε</a>
<a id="1594" href="Algebra.Solver.Monoid.html#1510" class="Function Operator">⟦</a> <a id="1596" href="Algebra.Solver.Monoid.html#1596" class="Bound">e₁</a> <a id="1599" href="Algebra.Solver.Monoid.html#1297" class="InductiveConstructor Operator">⊕</a> <a id="1601" href="Algebra.Solver.Monoid.html#1601" class="Bound">e₂</a> <a id="1604" href="Algebra.Solver.Monoid.html#1510" class="Function Operator">⟧</a> <a id="1606" href="Algebra.Solver.Monoid.html#1606" class="Bound">ρ</a> <a id="1608" class="Symbol">=</a> <a id="1610" href="Algebra.Solver.Monoid.html#1510" class="Function Operator">⟦</a> <a id="1612" href="Algebra.Solver.Monoid.html#1596" class="Bound">e₁</a> <a id="1615" href="Algebra.Solver.Monoid.html#1510" class="Function Operator">⟧</a> <a id="1617" href="Algebra.Solver.Monoid.html#1606" class="Bound">ρ</a> <a id="1619" href="Algebra.html#1858" class="Field Operator">∙</a> <a id="1621" href="Algebra.Solver.Monoid.html#1510" class="Function Operator">⟦</a> <a id="1623" href="Algebra.Solver.Monoid.html#1601" class="Bound">e₂</a> <a id="1626" href="Algebra.Solver.Monoid.html#1510" class="Function Operator">⟧</a> <a id="1628" href="Algebra.Solver.Monoid.html#1606" class="Bound">ρ</a>

<a id="1631" class="Comment">------------------------------------------------------------------------</a>
<a id="1704" class="Comment">-- Normal forms</a>

<a id="1721" class="Comment">-- A normal form is a list of variables.</a>

<a id="Normal"></a><a id="1763" href="Algebra.Solver.Monoid.html#1763" class="Function">Normal</a> <a id="1770" class="Symbol">:</a> <a id="1772" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1774" class="Symbol">→</a> <a id="1776" class="PrimitiveType">Set</a>
<a id="1780" href="Algebra.Solver.Monoid.html#1763" class="Function">Normal</a> <a id="1787" href="Algebra.Solver.Monoid.html#1787" class="Bound">n</a> <a id="1789" class="Symbol">=</a> <a id="1791" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1796" class="Symbol">(</a><a id="1797" href="Data.Fin.Base.html#915" class="Datatype">Fin</a> <a id="1801" href="Algebra.Solver.Monoid.html#1787" class="Bound">n</a><a id="1802" class="Symbol">)</a>

<a id="1805" class="Comment">-- The semantics of a normal form.</a>

<a id="⟦_⟧⇓"></a><a id="1841" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟦_⟧⇓</a> <a id="1846" class="Symbol">:</a> <a id="1848" class="Symbol">∀</a> <a id="1850" class="Symbol">{</a><a id="1851" href="Algebra.Solver.Monoid.html#1851" class="Bound">n</a><a id="1852" class="Symbol">}</a> <a id="1854" class="Symbol">→</a> <a id="1856" href="Algebra.Solver.Monoid.html#1763" class="Function">Normal</a> <a id="1863" href="Algebra.Solver.Monoid.html#1851" class="Bound">n</a> <a id="1865" class="Symbol">→</a> <a id="1867" href="Algebra.Solver.Monoid.html#1387" class="Function">Env</a> <a id="1871" href="Algebra.Solver.Monoid.html#1851" class="Bound">n</a> <a id="1873" class="Symbol">→</a> <a id="1875" href="Algebra.html#1808" class="Field">Carrier</a>
<a id="1883" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟦</a> <a id="1885" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>     <a id="1892" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟧⇓</a> <a id="1895" href="Algebra.Solver.Monoid.html#1895" class="Bound">ρ</a> <a id="1897" class="Symbol">=</a> <a id="1899" href="Algebra.html#1885" class="Field">ε</a>
<a id="1901" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟦</a> <a id="1903" href="Algebra.Solver.Monoid.html#1903" class="Bound">x</a> <a id="1905" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1907" href="Algebra.Solver.Monoid.html#1907" class="Bound">nf</a> <a id="1910" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟧⇓</a> <a id="1913" href="Algebra.Solver.Monoid.html#1913" class="Bound">ρ</a> <a id="1915" class="Symbol">=</a> <a id="1917" href="Data.Vec.html#1343" class="Function">lookup</a> <a id="1924" href="Algebra.Solver.Monoid.html#1903" class="Bound">x</a> <a id="1926" href="Algebra.Solver.Monoid.html#1913" class="Bound">ρ</a> <a id="1928" href="Algebra.html#1858" class="Field Operator">∙</a> <a id="1930" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟦</a> <a id="1932" href="Algebra.Solver.Monoid.html#1907" class="Bound">nf</a> <a id="1935" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟧⇓</a> <a id="1938" href="Algebra.Solver.Monoid.html#1913" class="Bound">ρ</a>

<a id="1941" class="Comment">-- A normaliser.</a>

<a id="normalise"></a><a id="1959" href="Algebra.Solver.Monoid.html#1959" class="Function">normalise</a> <a id="1969" class="Symbol">:</a> <a id="1971" class="Symbol">∀</a> <a id="1973" class="Symbol">{</a><a id="1974" href="Algebra.Solver.Monoid.html#1974" class="Bound">n</a><a id="1975" class="Symbol">}</a> <a id="1977" class="Symbol">→</a> <a id="1979" href="Algebra.Solver.Monoid.html#1232" class="Datatype">Expr</a> <a id="1984" href="Algebra.Solver.Monoid.html#1974" class="Bound">n</a> <a id="1986" class="Symbol">→</a> <a id="1988" href="Algebra.Solver.Monoid.html#1763" class="Function">Normal</a> <a id="1995" href="Algebra.Solver.Monoid.html#1974" class="Bound">n</a>
<a id="1997" href="Algebra.Solver.Monoid.html#1959" class="Function">normalise</a> <a id="2007" class="Symbol">(</a><a id="2008" href="Algebra.Solver.Monoid.html#1259" class="InductiveConstructor">var</a> <a id="2012" href="Algebra.Solver.Monoid.html#2012" class="Bound">x</a><a id="2013" class="Symbol">)</a>   <a id="2017" class="Symbol">=</a> <a id="2019" href="Algebra.Solver.Monoid.html#2012" class="Bound">x</a> <a id="2021" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2023" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
<a id="2026" href="Algebra.Solver.Monoid.html#1959" class="Function">normalise</a> <a id="2036" href="Algebra.Solver.Monoid.html#1282" class="InductiveConstructor">id</a>        <a id="2046" class="Symbol">=</a> <a id="2048" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
<a id="2051" href="Algebra.Solver.Monoid.html#1959" class="Function">normalise</a> <a id="2061" class="Symbol">(</a><a id="2062" href="Algebra.Solver.Monoid.html#2062" class="Bound">e₁</a> <a id="2065" href="Algebra.Solver.Monoid.html#1297" class="InductiveConstructor Operator">⊕</a> <a id="2067" href="Algebra.Solver.Monoid.html#2067" class="Bound">e₂</a><a id="2069" class="Symbol">)</a> <a id="2071" class="Symbol">=</a> <a id="2073" href="Algebra.Solver.Monoid.html#1959" class="Function">normalise</a> <a id="2083" href="Algebra.Solver.Monoid.html#2062" class="Bound">e₁</a> <a id="2086" href="Data.List.Base.html#1466" class="Function Operator">++</a> <a id="2089" href="Algebra.Solver.Monoid.html#1959" class="Function">normalise</a> <a id="2099" href="Algebra.Solver.Monoid.html#2067" class="Bound">e₂</a>

<a id="2103" class="Comment">-- The normaliser is homomorphic with respect to _++_/_∙_.</a>

<a id="homomorphic"></a><a id="2163" href="Algebra.Solver.Monoid.html#2163" class="Function">homomorphic</a> <a id="2175" class="Symbol">:</a> <a id="2177" class="Symbol">∀</a> <a id="2179" class="Symbol">{</a><a id="2180" href="Algebra.Solver.Monoid.html#2180" class="Bound">n</a><a id="2181" class="Symbol">}</a> <a id="2183" class="Symbol">(</a><a id="2184" href="Algebra.Solver.Monoid.html#2184" class="Bound">nf₁</a> <a id="2188" href="Algebra.Solver.Monoid.html#2188" class="Bound">nf₂</a> <a id="2192" class="Symbol">:</a> <a id="2194" href="Algebra.Solver.Monoid.html#1763" class="Function">Normal</a> <a id="2201" href="Algebra.Solver.Monoid.html#2180" class="Bound">n</a><a id="2202" class="Symbol">)</a> <a id="2204" class="Symbol">(</a><a id="2205" href="Algebra.Solver.Monoid.html#2205" class="Bound">ρ</a> <a id="2207" class="Symbol">:</a> <a id="2209" href="Algebra.Solver.Monoid.html#1387" class="Function">Env</a> <a id="2213" href="Algebra.Solver.Monoid.html#2180" class="Bound">n</a><a id="2214" class="Symbol">)</a> <a id="2216" class="Symbol">→</a>
              <a id="2232" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟦</a> <a id="2234" href="Algebra.Solver.Monoid.html#2184" class="Bound">nf₁</a> <a id="2238" href="Data.List.Base.html#1466" class="Function Operator">++</a> <a id="2241" href="Algebra.Solver.Monoid.html#2188" class="Bound">nf₂</a> <a id="2245" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟧⇓</a> <a id="2248" href="Algebra.Solver.Monoid.html#2205" class="Bound">ρ</a> <a id="2250" href="Algebra.html#1829" class="Field Operator">≈</a> <a id="2252" class="Symbol">(</a><a id="2253" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟦</a> <a id="2255" href="Algebra.Solver.Monoid.html#2184" class="Bound">nf₁</a> <a id="2259" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟧⇓</a> <a id="2262" href="Algebra.Solver.Monoid.html#2205" class="Bound">ρ</a> <a id="2264" href="Algebra.html#1858" class="Field Operator">∙</a> <a id="2266" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟦</a> <a id="2268" href="Algebra.Solver.Monoid.html#2188" class="Bound">nf₂</a> <a id="2272" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟧⇓</a> <a id="2275" href="Algebra.Solver.Monoid.html#2205" class="Bound">ρ</a><a id="2276" class="Symbol">)</a>
<a id="2278" href="Algebra.Solver.Monoid.html#2163" class="Function">homomorphic</a> <a id="2290" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="2293" href="Algebra.Solver.Monoid.html#2293" class="Bound">nf₂</a> <a id="2297" href="Algebra.Solver.Monoid.html#2297" class="Bound">ρ</a> <a id="2299" class="Symbol">=</a> <a id="2301" href="Relation.Binary.PreorderReasoning.html#1228" class="Function Operator">begin</a>
  <a id="2309" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟦</a> <a id="2311" href="Algebra.Solver.Monoid.html#2293" class="Bound">nf₂</a> <a id="2315" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟧⇓</a> <a id="2318" href="Algebra.Solver.Monoid.html#2297" class="Bound">ρ</a>      <a id="2325" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">≈⟨</a> <a id="2328" href="Relation.Binary.Core.html#5472" class="Function">sym</a> <a id="2332" href="Function.html#1891" class="Function Operator">$</a> <a id="2334" href="Algebra.Structures.html#1462" class="Function">identityˡ</a> <a id="2344" class="Symbol">_</a> <a id="2346" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">⟩</a>
  <a id="2350" href="Algebra.html#1885" class="Field">ε</a> <a id="2352" href="Algebra.html#1858" class="Field Operator">∙</a> <a id="2354" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟦</a> <a id="2356" href="Algebra.Solver.Monoid.html#2293" class="Bound">nf₂</a> <a id="2360" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟧⇓</a> <a id="2363" href="Algebra.Solver.Monoid.html#2297" class="Bound">ρ</a>  <a id="2366" href="Relation.Binary.PreorderReasoning.html#1681" class="Function Operator">∎</a>
<a id="2368" href="Algebra.Solver.Monoid.html#2163" class="Function">homomorphic</a> <a id="2380" class="Symbol">(</a><a id="2381" href="Algebra.Solver.Monoid.html#2381" class="Bound">x</a> <a id="2383" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2385" href="Algebra.Solver.Monoid.html#2385" class="Bound">nf₁</a><a id="2388" class="Symbol">)</a> <a id="2390" href="Algebra.Solver.Monoid.html#2390" class="Bound">nf₂</a> <a id="2394" href="Algebra.Solver.Monoid.html#2394" class="Bound">ρ</a> <a id="2396" class="Symbol">=</a> <a id="2398" href="Relation.Binary.PreorderReasoning.html#1228" class="Function Operator">begin</a>
  <a id="2406" href="Data.Vec.html#1343" class="Function">lookup</a> <a id="2413" href="Algebra.Solver.Monoid.html#2381" class="Bound">x</a> <a id="2415" href="Algebra.Solver.Monoid.html#2394" class="Bound">ρ</a> <a id="2417" href="Algebra.html#1858" class="Field Operator">∙</a> <a id="2419" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟦</a> <a id="2421" href="Algebra.Solver.Monoid.html#2385" class="Bound">nf₁</a> <a id="2425" href="Data.List.Base.html#1466" class="Function Operator">++</a> <a id="2428" href="Algebra.Solver.Monoid.html#2390" class="Bound">nf₂</a> <a id="2432" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟧⇓</a> <a id="2435" href="Algebra.Solver.Monoid.html#2394" class="Bound">ρ</a>          <a id="2446" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">≈⟨</a> <a id="2449" href="Algebra.Structures.html#872" class="Function">∙-cong</a> <a id="2456" href="Relation.Binary.Core.html#5446" class="Function">refl</a> <a id="2461" class="Symbol">(</a><a id="2462" href="Algebra.Solver.Monoid.html#2163" class="Function">homomorphic</a> <a id="2474" href="Algebra.Solver.Monoid.html#2385" class="Bound">nf₁</a> <a id="2478" href="Algebra.Solver.Monoid.html#2390" class="Bound">nf₂</a> <a id="2482" href="Algebra.Solver.Monoid.html#2394" class="Bound">ρ</a><a id="2483" class="Symbol">)</a> <a id="2485" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">⟩</a>
  <a id="2489" href="Data.Vec.html#1343" class="Function">lookup</a> <a id="2496" href="Algebra.Solver.Monoid.html#2381" class="Bound">x</a> <a id="2498" href="Algebra.Solver.Monoid.html#2394" class="Bound">ρ</a> <a id="2500" href="Algebra.html#1858" class="Field Operator">∙</a> <a id="2502" class="Symbol">(</a><a id="2503" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟦</a> <a id="2505" href="Algebra.Solver.Monoid.html#2385" class="Bound">nf₁</a> <a id="2509" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟧⇓</a> <a id="2512" href="Algebra.Solver.Monoid.html#2394" class="Bound">ρ</a> <a id="2514" href="Algebra.html#1858" class="Field Operator">∙</a> <a id="2516" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟦</a> <a id="2518" href="Algebra.Solver.Monoid.html#2390" class="Bound">nf₂</a> <a id="2522" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟧⇓</a> <a id="2525" href="Algebra.Solver.Monoid.html#2394" class="Bound">ρ</a><a id="2526" class="Symbol">)</a>  <a id="2529" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">≈⟨</a> <a id="2532" href="Relation.Binary.Core.html#5472" class="Function">sym</a> <a id="2536" href="Function.html#1891" class="Function Operator">$</a> <a id="2538" href="Algebra.Structures.html#838" class="Function">assoc</a> <a id="2544" class="Symbol">_</a> <a id="2546" class="Symbol">_</a> <a id="2548" class="Symbol">_</a> <a id="2550" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">⟩</a>
  <a id="2554" href="Data.Vec.html#1343" class="Function">lookup</a> <a id="2561" href="Algebra.Solver.Monoid.html#2381" class="Bound">x</a> <a id="2563" href="Algebra.Solver.Monoid.html#2394" class="Bound">ρ</a> <a id="2565" href="Algebra.html#1858" class="Field Operator">∙</a> <a id="2567" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟦</a> <a id="2569" href="Algebra.Solver.Monoid.html#2385" class="Bound">nf₁</a> <a id="2573" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟧⇓</a> <a id="2576" href="Algebra.Solver.Monoid.html#2394" class="Bound">ρ</a> <a id="2578" href="Algebra.html#1858" class="Field Operator">∙</a> <a id="2580" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟦</a> <a id="2582" href="Algebra.Solver.Monoid.html#2390" class="Bound">nf₂</a> <a id="2586" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟧⇓</a> <a id="2589" href="Algebra.Solver.Monoid.html#2394" class="Bound">ρ</a>    <a id="2594" href="Relation.Binary.PreorderReasoning.html#1681" class="Function Operator">∎</a>

<a id="2597" class="Comment">-- The normaliser preserves the semantics of the expression.</a>

<a id="normalise-correct"></a><a id="2659" href="Algebra.Solver.Monoid.html#2659" class="Function">normalise-correct</a> <a id="2677" class="Symbol">:</a>
  <a id="2681" class="Symbol">∀</a> <a id="2683" class="Symbol">{</a><a id="2684" href="Algebra.Solver.Monoid.html#2684" class="Bound">n</a><a id="2685" class="Symbol">}</a> <a id="2687" class="Symbol">(</a><a id="2688" href="Algebra.Solver.Monoid.html#2688" class="Bound">e</a> <a id="2690" class="Symbol">:</a> <a id="2692" href="Algebra.Solver.Monoid.html#1232" class="Datatype">Expr</a> <a id="2697" href="Algebra.Solver.Monoid.html#2684" class="Bound">n</a><a id="2698" class="Symbol">)</a> <a id="2700" class="Symbol">(</a><a id="2701" href="Algebra.Solver.Monoid.html#2701" class="Bound">ρ</a> <a id="2703" class="Symbol">:</a> <a id="2705" href="Algebra.Solver.Monoid.html#1387" class="Function">Env</a> <a id="2709" href="Algebra.Solver.Monoid.html#2684" class="Bound">n</a><a id="2710" class="Symbol">)</a> <a id="2712" class="Symbol">→</a> <a id="2714" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟦</a> <a id="2716" href="Algebra.Solver.Monoid.html#1959" class="Function">normalise</a> <a id="2726" href="Algebra.Solver.Monoid.html#2688" class="Bound">e</a> <a id="2728" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟧⇓</a> <a id="2731" href="Algebra.Solver.Monoid.html#2701" class="Bound">ρ</a> <a id="2733" href="Algebra.html#1829" class="Field Operator">≈</a> <a id="2735" href="Algebra.Solver.Monoid.html#1510" class="Function Operator">⟦</a> <a id="2737" href="Algebra.Solver.Monoid.html#2688" class="Bound">e</a> <a id="2739" href="Algebra.Solver.Monoid.html#1510" class="Function Operator">⟧</a> <a id="2741" href="Algebra.Solver.Monoid.html#2701" class="Bound">ρ</a>
<a id="2743" href="Algebra.Solver.Monoid.html#2659" class="Function">normalise-correct</a> <a id="2761" class="Symbol">(</a><a id="2762" href="Algebra.Solver.Monoid.html#1259" class="InductiveConstructor">var</a> <a id="2766" href="Algebra.Solver.Monoid.html#2766" class="Bound">x</a><a id="2767" class="Symbol">)</a> <a id="2769" href="Algebra.Solver.Monoid.html#2769" class="Bound">ρ</a> <a id="2771" class="Symbol">=</a> <a id="2773" href="Relation.Binary.PreorderReasoning.html#1228" class="Function Operator">begin</a>
  <a id="2781" href="Data.Vec.html#1343" class="Function">lookup</a> <a id="2788" href="Algebra.Solver.Monoid.html#2766" class="Bound">x</a> <a id="2790" href="Algebra.Solver.Monoid.html#2769" class="Bound">ρ</a> <a id="2792" href="Algebra.html#1858" class="Field Operator">∙</a> <a id="2794" href="Algebra.html#1885" class="Field">ε</a>  <a id="2797" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">≈⟨</a> <a id="2800" href="Algebra.Structures.html#1523" class="Function">identityʳ</a> <a id="2810" class="Symbol">_</a> <a id="2812" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">⟩</a>
  <a id="2816" href="Data.Vec.html#1343" class="Function">lookup</a> <a id="2823" href="Algebra.Solver.Monoid.html#2766" class="Bound">x</a> <a id="2825" href="Algebra.Solver.Monoid.html#2769" class="Bound">ρ</a>      <a id="2832" href="Relation.Binary.PreorderReasoning.html#1681" class="Function Operator">∎</a>
<a id="2834" href="Algebra.Solver.Monoid.html#2659" class="Function">normalise-correct</a> <a id="2852" href="Algebra.Solver.Monoid.html#1282" class="InductiveConstructor">id</a> <a id="2855" href="Algebra.Solver.Monoid.html#2855" class="Bound">ρ</a> <a id="2857" class="Symbol">=</a> <a id="2859" href="Relation.Binary.PreorderReasoning.html#1228" class="Function Operator">begin</a>
  <a id="2867" href="Algebra.html#1885" class="Field">ε</a>  <a id="2870" href="Relation.Binary.PreorderReasoning.html#1681" class="Function Operator">∎</a>
<a id="2872" href="Algebra.Solver.Monoid.html#2659" class="Function">normalise-correct</a> <a id="2890" class="Symbol">(</a><a id="2891" href="Algebra.Solver.Monoid.html#2891" class="Bound">e₁</a> <a id="2894" href="Algebra.Solver.Monoid.html#1297" class="InductiveConstructor Operator">⊕</a> <a id="2896" href="Algebra.Solver.Monoid.html#2896" class="Bound">e₂</a><a id="2898" class="Symbol">)</a> <a id="2900" href="Algebra.Solver.Monoid.html#2900" class="Bound">ρ</a> <a id="2902" class="Symbol">=</a> <a id="2904" href="Relation.Binary.PreorderReasoning.html#1228" class="Function Operator">begin</a>
  <a id="2912" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟦</a> <a id="2914" href="Algebra.Solver.Monoid.html#1959" class="Function">normalise</a> <a id="2924" href="Algebra.Solver.Monoid.html#2891" class="Bound">e₁</a> <a id="2927" href="Data.List.Base.html#1466" class="Function Operator">++</a> <a id="2930" href="Algebra.Solver.Monoid.html#1959" class="Function">normalise</a> <a id="2940" href="Algebra.Solver.Monoid.html#2896" class="Bound">e₂</a> <a id="2943" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟧⇓</a> <a id="2946" href="Algebra.Solver.Monoid.html#2900" class="Bound">ρ</a>        <a id="2955" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">≈⟨</a> <a id="2958" href="Algebra.Solver.Monoid.html#2163" class="Function">homomorphic</a> <a id="2970" class="Symbol">(</a><a id="2971" href="Algebra.Solver.Monoid.html#1959" class="Function">normalise</a> <a id="2981" href="Algebra.Solver.Monoid.html#2891" class="Bound">e₁</a><a id="2983" class="Symbol">)</a> <a id="2985" class="Symbol">(</a><a id="2986" href="Algebra.Solver.Monoid.html#1959" class="Function">normalise</a> <a id="2996" href="Algebra.Solver.Monoid.html#2896" class="Bound">e₂</a><a id="2998" class="Symbol">)</a> <a id="3000" href="Algebra.Solver.Monoid.html#2900" class="Bound">ρ</a> <a id="3002" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">⟩</a>
  <a id="3006" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟦</a> <a id="3008" href="Algebra.Solver.Monoid.html#1959" class="Function">normalise</a> <a id="3018" href="Algebra.Solver.Monoid.html#2891" class="Bound">e₁</a> <a id="3021" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟧⇓</a> <a id="3024" href="Algebra.Solver.Monoid.html#2900" class="Bound">ρ</a> <a id="3026" href="Algebra.html#1858" class="Field Operator">∙</a> <a id="3028" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟦</a> <a id="3030" href="Algebra.Solver.Monoid.html#1959" class="Function">normalise</a> <a id="3040" href="Algebra.Solver.Monoid.html#2896" class="Bound">e₂</a> <a id="3043" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟧⇓</a> <a id="3046" href="Algebra.Solver.Monoid.html#2900" class="Bound">ρ</a>  <a id="3049" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">≈⟨</a> <a id="3052" href="Algebra.Structures.html#872" class="Function">∙-cong</a> <a id="3059" class="Symbol">(</a><a id="3060" href="Algebra.Solver.Monoid.html#2659" class="Function">normalise-correct</a> <a id="3078" href="Algebra.Solver.Monoid.html#2891" class="Bound">e₁</a> <a id="3081" href="Algebra.Solver.Monoid.html#2900" class="Bound">ρ</a><a id="3082" class="Symbol">)</a> <a id="3084" class="Symbol">(</a><a id="3085" href="Algebra.Solver.Monoid.html#2659" class="Function">normalise-correct</a> <a id="3103" href="Algebra.Solver.Monoid.html#2896" class="Bound">e₂</a> <a id="3106" href="Algebra.Solver.Monoid.html#2900" class="Bound">ρ</a><a id="3107" class="Symbol">)</a> <a id="3109" href="Relation.Binary.PreorderReasoning.html#1294" class="Function Operator">⟩</a>
  <a id="3113" href="Algebra.Solver.Monoid.html#1510" class="Function Operator">⟦</a> <a id="3115" href="Algebra.Solver.Monoid.html#2891" class="Bound">e₁</a> <a id="3118" href="Algebra.Solver.Monoid.html#1510" class="Function Operator">⟧</a> <a id="3120" href="Algebra.Solver.Monoid.html#2900" class="Bound">ρ</a> <a id="3122" href="Algebra.html#1858" class="Field Operator">∙</a> <a id="3124" href="Algebra.Solver.Monoid.html#1510" class="Function Operator">⟦</a> <a id="3126" href="Algebra.Solver.Monoid.html#2896" class="Bound">e₂</a> <a id="3129" href="Algebra.Solver.Monoid.html#1510" class="Function Operator">⟧</a> <a id="3131" href="Algebra.Solver.Monoid.html#2900" class="Bound">ρ</a>                        <a id="3156" href="Relation.Binary.PreorderReasoning.html#1681" class="Function Operator">∎</a>

<a id="3159" class="Comment">------------------------------------------------------------------------</a>
<a id="3232" class="Comment">-- &quot;Tactics&quot;</a>

<a id="3246" class="Keyword">open</a> <a id="3251" class="Keyword">module</a> <a id="R"></a><a id="3258" href="Algebra.Solver.Monoid.html#3258" class="Module">R</a> <a id="3260" class="Symbol">=</a> <a id="3262" href="Relation.Binary.Reflection.html" class="Module">Relation.Binary.Reflection</a>
                  <a id="3307" href="Algebra.Structures.html#904" class="Function">setoid</a> <a id="3314" href="Algebra.Solver.Monoid.html#1259" class="InductiveConstructor">var</a> <a id="3318" href="Algebra.Solver.Monoid.html#1510" class="Function Operator">⟦_⟧</a> <a id="3322" class="Symbol">(</a><a id="3323" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟦_⟧⇓</a> <a id="3328" href="Function.html#769" class="Function Operator">∘</a> <a id="3330" href="Algebra.Solver.Monoid.html#1959" class="Function">normalise</a><a id="3339" class="Symbol">)</a> <a id="3341" href="Algebra.Solver.Monoid.html#2659" class="Function">normalise-correct</a>
  <a id="3361" class="Keyword">public</a> <a id="3368" class="Keyword">using</a> <a id="3374" class="Symbol">(</a><a id="3375" href="Relation.Binary.Reflection.html#2382" class="Function">solve</a><a id="3380" class="Symbol">;</a> <a id="3382" href="Relation.Binary.Reflection.html#3491" class="Function Operator">_⊜_</a><a id="3385" class="Symbol">)</a>

<a id="3388" class="Comment">-- We can decide if two normal forms are /syntactically/ equal.</a>

<a id="3453" class="Keyword">infix</a> <a id="3459" class="Number">5</a> <a id="3461" href="Algebra.Solver.Monoid.html#3466" class="Function Operator">_≟_</a>

<a id="_≟_"></a><a id="3466" href="Algebra.Solver.Monoid.html#3466" class="Function Operator">_≟_</a> <a id="3470" class="Symbol">:</a> <a id="3472" class="Symbol">∀</a> <a id="3474" class="Symbol">{</a><a id="3475" href="Algebra.Solver.Monoid.html#3475" class="Bound">n</a><a id="3476" class="Symbol">}</a> <a id="3478" class="Symbol">→</a> <a id="3480" href="Relation.Binary.Core.html#4541" class="Function">Decidable</a> <a id="3490" class="Symbol">{</a><a id="3491" class="Argument">A</a> <a id="3493" class="Symbol">=</a> <a id="3495" href="Algebra.Solver.Monoid.html#1763" class="Function">Normal</a> <a id="3502" href="Algebra.Solver.Monoid.html#3475" class="Bound">n</a><a id="3503" class="Symbol">}</a> <a id="3505" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a>
<a id="3509" href="Algebra.Solver.Monoid.html#3509" class="Bound">nf₁</a> <a id="3513" href="Algebra.Solver.Monoid.html#3466" class="Function Operator">≟</a> <a id="3515" href="Algebra.Solver.Monoid.html#3515" class="Bound">nf₂</a> <a id="3519" class="Symbol">=</a> <a id="3521" href="Relation.Nullary.Decidable.html#1801" class="Function">Dec.map′</a> <a id="3530" href="Data.List.Relation.Equality.Propositional.html#731" class="Function">≋⇒≡</a> <a id="3534" href="Data.List.Relation.Equality.Propositional.html#819" class="Function">≡⇒≋</a> <a id="3538" class="Symbol">(</a><a id="3539" href="Algebra.Solver.Monoid.html#3509" class="Bound">nf₁</a> <a id="3543" href="Data.List.Relation.Equality.DecSetoid.html#796" class="Function Operator">≋?</a> <a id="3546" href="Algebra.Solver.Monoid.html#3515" class="Bound">nf₂</a><a id="3549" class="Symbol">)</a>
  <a id="3553" class="Keyword">where</a> <a id="3559" class="Keyword">open</a> <a id="3564" href="Data.List.Relation.Equality.DecPropositional.html" class="Module">ListEq</a> <a id="3571" href="Data.Fin.Properties.html#1694" class="Function Operator">Fin._≟_</a>

<a id="3580" class="Comment">-- We can also give a sound, but not necessarily complete, procedure</a>
<a id="3649" class="Comment">-- for determining if two expressions have the same semantics.</a>

<a id="prove′"></a><a id="3713" href="Algebra.Solver.Monoid.html#3713" class="Function">prove′</a> <a id="3720" class="Symbol">:</a> <a id="3722" class="Symbol">∀</a> <a id="3724" class="Symbol">{</a><a id="3725" href="Algebra.Solver.Monoid.html#3725" class="Bound">n</a><a id="3726" class="Symbol">}</a> <a id="3728" class="Symbol">(</a><a id="3729" href="Algebra.Solver.Monoid.html#3729" class="Bound">e₁</a> <a id="3732" href="Algebra.Solver.Monoid.html#3732" class="Bound">e₂</a> <a id="3735" class="Symbol">:</a> <a id="3737" href="Algebra.Solver.Monoid.html#1232" class="Datatype">Expr</a> <a id="3742" href="Algebra.Solver.Monoid.html#3725" class="Bound">n</a><a id="3743" class="Symbol">)</a> <a id="3745" class="Symbol">→</a> <a id="3747" href="Data.Maybe.Base.html#674" class="Datatype">Maybe</a> <a id="3753" class="Symbol">(∀</a> <a id="3756" href="Algebra.Solver.Monoid.html#3756" class="Bound">ρ</a> <a id="3758" class="Symbol">→</a> <a id="3760" href="Algebra.Solver.Monoid.html#1510" class="Function Operator">⟦</a> <a id="3762" href="Algebra.Solver.Monoid.html#3729" class="Bound">e₁</a> <a id="3765" href="Algebra.Solver.Monoid.html#1510" class="Function Operator">⟧</a> <a id="3767" href="Algebra.Solver.Monoid.html#3756" class="Bound">ρ</a> <a id="3769" href="Algebra.html#1829" class="Field Operator">≈</a> <a id="3771" href="Algebra.Solver.Monoid.html#1510" class="Function Operator">⟦</a> <a id="3773" href="Algebra.Solver.Monoid.html#3732" class="Bound">e₂</a> <a id="3776" href="Algebra.Solver.Monoid.html#1510" class="Function Operator">⟧</a> <a id="3778" href="Algebra.Solver.Monoid.html#3756" class="Bound">ρ</a><a id="3779" class="Symbol">)</a>
<a id="3781" href="Algebra.Solver.Monoid.html#3713" class="Function">prove′</a> <a id="3788" href="Algebra.Solver.Monoid.html#3788" class="Bound">e₁</a> <a id="3791" href="Algebra.Solver.Monoid.html#3791" class="Bound">e₂</a> <a id="3794" class="Symbol">=</a>
  <a id="3798" href="Data.Maybe.Base.html#2103" class="Function">Maybe.map</a> <a id="3808" href="Algebra.Solver.Monoid.html#3867" class="Function">lemma</a> <a id="3814" href="Function.html#1891" class="Function Operator">$</a> <a id="3816" href="Data.Maybe.Base.html#1249" class="Function">decToMaybe</a> <a id="3827" class="Symbol">(</a><a id="3828" href="Algebra.Solver.Monoid.html#1959" class="Function">normalise</a> <a id="3838" href="Algebra.Solver.Monoid.html#3788" class="Bound">e₁</a> <a id="3841" href="Algebra.Solver.Monoid.html#3466" class="Function Operator">≟</a> <a id="3843" href="Algebra.Solver.Monoid.html#1959" class="Function">normalise</a> <a id="3853" href="Algebra.Solver.Monoid.html#3791" class="Bound">e₂</a><a id="3855" class="Symbol">)</a>
  <a id="3859" class="Keyword">where</a>
  <a id="3867" href="Algebra.Solver.Monoid.html#3867" class="Function">lemma</a> <a id="3873" class="Symbol">:</a> <a id="3875" href="Algebra.Solver.Monoid.html#1959" class="Function">normalise</a> <a id="3885" href="Algebra.Solver.Monoid.html#3788" class="Bound">e₁</a> <a id="3888" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="3890" href="Algebra.Solver.Monoid.html#1959" class="Function">normalise</a> <a id="3900" href="Algebra.Solver.Monoid.html#3791" class="Bound">e₂</a> <a id="3903" class="Symbol">→</a> <a id="3905" class="Symbol">∀</a> <a id="3907" href="Algebra.Solver.Monoid.html#3907" class="Bound">ρ</a> <a id="3909" class="Symbol">→</a> <a id="3911" href="Algebra.Solver.Monoid.html#1510" class="Function Operator">⟦</a> <a id="3913" href="Algebra.Solver.Monoid.html#3788" class="Bound">e₁</a> <a id="3916" href="Algebra.Solver.Monoid.html#1510" class="Function Operator">⟧</a> <a id="3918" href="Algebra.Solver.Monoid.html#3907" class="Bound">ρ</a> <a id="3920" href="Algebra.html#1829" class="Field Operator">≈</a> <a id="3922" href="Algebra.Solver.Monoid.html#1510" class="Function Operator">⟦</a> <a id="3924" href="Algebra.Solver.Monoid.html#3791" class="Bound">e₂</a> <a id="3927" href="Algebra.Solver.Monoid.html#1510" class="Function Operator">⟧</a> <a id="3929" href="Algebra.Solver.Monoid.html#3907" class="Bound">ρ</a>
  <a id="3933" href="Algebra.Solver.Monoid.html#3867" class="Function">lemma</a> <a id="3939" href="Algebra.Solver.Monoid.html#3939" class="Bound">eq</a> <a id="3942" href="Algebra.Solver.Monoid.html#3942" class="Bound">ρ</a> <a id="3944" class="Symbol">=</a>
    <a id="3950" href="Relation.Binary.Reflection.html#1696" class="Function">R.prove</a> <a id="3958" href="Algebra.Solver.Monoid.html#3942" class="Bound">ρ</a> <a id="3960" href="Algebra.Solver.Monoid.html#3788" class="Bound">e₁</a> <a id="3963" href="Algebra.Solver.Monoid.html#3791" class="Bound">e₂</a> <a id="3966" class="Symbol">(</a><a id="3967" href="Relation.Binary.PreorderReasoning.html#1228" class="Function Operator">begin</a>
      <a id="3979" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟦</a> <a id="3981" href="Algebra.Solver.Monoid.html#1959" class="Function">normalise</a> <a id="3991" href="Algebra.Solver.Monoid.html#3788" class="Bound">e₁</a> <a id="3994" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟧⇓</a> <a id="3997" href="Algebra.Solver.Monoid.html#3942" class="Bound">ρ</a>  <a id="4000" href="Relation.Binary.PreorderReasoning.html#1524" class="Function Operator">≡⟨</a> <a id="4003" href="Relation.Binary.PropositionalEquality.html#1170" class="Function">P.cong</a> <a id="4010" class="Symbol">(λ</a> <a id="4013" href="Algebra.Solver.Monoid.html#4013" class="Bound">e</a> <a id="4015" class="Symbol">→</a> <a id="4017" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟦</a> <a id="4019" href="Algebra.Solver.Monoid.html#4013" class="Bound">e</a> <a id="4021" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟧⇓</a> <a id="4024" href="Algebra.Solver.Monoid.html#3942" class="Bound">ρ</a><a id="4025" class="Symbol">)</a> <a id="4027" href="Algebra.Solver.Monoid.html#3939" class="Bound">eq</a> <a id="4030" href="Relation.Binary.PreorderReasoning.html#1524" class="Function Operator">⟩</a>
      <a id="4038" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟦</a> <a id="4040" href="Algebra.Solver.Monoid.html#1959" class="Function">normalise</a> <a id="4050" href="Algebra.Solver.Monoid.html#3791" class="Bound">e₂</a> <a id="4053" href="Algebra.Solver.Monoid.html#1841" class="Function Operator">⟧⇓</a> <a id="4056" href="Algebra.Solver.Monoid.html#3942" class="Bound">ρ</a>  <a id="4059" href="Relation.Binary.PreorderReasoning.html#1681" class="Function Operator">∎</a><a id="4060" class="Symbol">)</a>

<a id="4063" class="Comment">-- This procedure can be combined with from-just.</a>

<a id="prove"></a><a id="4114" href="Algebra.Solver.Monoid.html#4114" class="Function">prove</a> <a id="4120" class="Symbol">:</a> <a id="4122" class="Symbol">∀</a> <a id="4124" href="Algebra.Solver.Monoid.html#4124" class="Bound">n</a> <a id="4126" class="Symbol">(</a><a id="4127" href="Algebra.Solver.Monoid.html#4127" class="Bound">es</a> <a id="4130" class="Symbol">:</a> <a id="4132" href="Algebra.Solver.Monoid.html#1232" class="Datatype">Expr</a> <a id="4137" href="Algebra.Solver.Monoid.html#4124" class="Bound">n</a> <a id="4139" href="Data.Product.html#1353" class="Function Operator">×</a> <a id="4141" href="Algebra.Solver.Monoid.html#1232" class="Datatype">Expr</a> <a id="4146" href="Algebra.Solver.Monoid.html#4124" class="Bound">n</a><a id="4147" class="Symbol">)</a> <a id="4149" class="Symbol">→</a>
        <a id="4159" href="Data.Maybe.Base.html#1900" class="Function">From-just</a> <a id="4169" class="Symbol">(</a><a id="4170" href="Data.Product.html#3464" class="Function">uncurry</a> <a id="4178" href="Algebra.Solver.Monoid.html#3713" class="Function">prove′</a> <a id="4185" href="Algebra.Solver.Monoid.html#4127" class="Bound">es</a><a id="4187" class="Symbol">)</a>
<a id="4189" href="Algebra.Solver.Monoid.html#4114" class="Function">prove</a> <a id="4195" class="Symbol">_</a> <a id="4197" class="Symbol">=</a> <a id="4199" href="Data.Maybe.Base.html#1988" class="Function">from-just</a> <a id="4209" href="Function.html#769" class="Function Operator">∘</a> <a id="4211" href="Data.Product.html#3464" class="Function">uncurry</a> <a id="4219" href="Algebra.Solver.Monoid.html#3713" class="Function">prove′</a>
</pre></body></html>