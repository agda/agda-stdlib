<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Container.FreeMonad</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- The free monad construction on containers</a>
<a id="151" class="Comment">------------------------------------------------------------------------</a>

<a id="225" class="Symbol">{-#</a> <a id="229" class="Keyword">OPTIONS</a> <a id="237" class="Pragma">--without-K</a> <a id="249" class="Pragma">--safe</a> <a id="256" class="Pragma">--sized-types</a> <a id="270" class="Symbol">#-}</a>

<a id="275" class="Keyword">module</a> <a id="282" href="Data.Container.FreeMonad.html" class="Module">Data.Container.FreeMonad</a> <a id="307" class="Keyword">where</a>

<a id="314" class="Keyword">open</a> <a id="319" class="Keyword">import</a> <a id="326" href="Level.html" class="Module">Level</a>
<a id="332" class="Keyword">open</a> <a id="337" class="Keyword">import</a> <a id="344" href="Data.Sum.Base.html" class="Module">Data.Sum.Base</a> <a id="358" class="Keyword">using</a> <a id="364" class="Symbol">(</a><a id="365" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a><a id="369" class="Symbol">;</a> <a id="371" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="376" class="Symbol">;</a> <a id="378" href="Data.Sum.Base.html#1089" class="Function Operator">[_,_]′</a><a id="384" class="Symbol">)</a>
<a id="386" class="Keyword">open</a> <a id="391" class="Keyword">import</a> <a id="398" href="Data.Product.html" class="Module">Data.Product</a>
<a id="411" class="Keyword">open</a> <a id="416" class="Keyword">import</a> <a id="423" href="Data.Container.html" class="Module">Data.Container</a>
<a id="438" class="Keyword">open</a> <a id="443" class="Keyword">import</a> <a id="450" href="Data.Container.Combinator.html" class="Module">Data.Container.Combinator</a> <a id="476" class="Keyword">using</a> <a id="482" class="Symbol">(</a><a id="483" href="Data.Container.Combinator.html#835" class="Function">const</a><a id="488" class="Symbol">;</a> <a id="490" href="Data.Container.Combinator.html#1961" class="Function Operator">_⊎_</a><a id="493" class="Symbol">)</a>
<a id="495" class="Keyword">open</a> <a id="500" class="Keyword">import</a> <a id="507" href="Data.W.html" class="Module">Data.W</a>
<a id="514" class="Keyword">open</a> <a id="519" class="Keyword">import</a> <a id="526" href="Category.Monad.html" class="Module">Category.Monad</a>

<a id="542" class="Keyword">infixl</a> <a id="549" class="Number">1</a> <a id="551" href="Data.Container.FreeMonad.html#1439" class="Function Operator">_⋆C_</a>
<a id="556" class="Keyword">infix</a>  <a id="563" class="Number">1</a> <a id="565" href="Data.Container.FreeMonad.html#1524" class="Function Operator">_⋆_</a>

<a id="570" class="Comment">------------------------------------------------------------------------</a>
<a id="643" class="Comment">-- The free monad construction over a container and a set is, in</a>
<a id="708" class="Comment">-- universal algebra terminology, also known as the term algebra over a</a>
<a id="780" class="Comment">-- signature (a container) and a set (of variable symbols). The return</a>
<a id="851" class="Comment">-- of the free monad corresponds to variables and the bind operator</a>
<a id="919" class="Comment">-- corresponds to (parallel) substitution.</a>

<a id="963" class="Comment">-- A useful intuition is to think of containers describing single</a>
<a id="1029" class="Comment">-- operations and the free monad construction over a container and a set</a>
<a id="1102" class="Comment">-- describing a tree of operations as nodes and elements of the set as</a>
<a id="1173" class="Comment">-- leafs. If one starts at the root, then any path will pass finitely</a>
<a id="1243" class="Comment">-- many nodes (operations described by the container) and eventually end</a>
<a id="1316" class="Comment">-- up in a leaf (element of the set) -- hence the Kleene star notation</a>
<a id="1387" class="Comment">-- (the type can be read as a regular expression).</a>

<a id="_⋆C_"></a><a id="1439" href="Data.Container.FreeMonad.html#1439" class="Function Operator">_⋆C_</a> <a id="1444" class="Symbol">:</a> <a id="1446" class="Symbol">∀</a> <a id="1448" class="Symbol">{</a><a id="1449" href="Data.Container.FreeMonad.html#1449" class="Bound">x</a> <a id="1451" href="Data.Container.FreeMonad.html#1451" class="Bound">s</a> <a id="1453" href="Data.Container.FreeMonad.html#1453" class="Bound">p</a><a id="1454" class="Symbol">}</a> <a id="1456" class="Symbol">→</a> <a id="1458" href="Data.Container.Core.html#558" class="Record">Container</a> <a id="1468" href="Data.Container.FreeMonad.html#1451" class="Bound">s</a> <a id="1470" href="Data.Container.FreeMonad.html#1453" class="Bound">p</a> <a id="1472" class="Symbol">→</a> <a id="1474" class="PrimitiveType">Set</a> <a id="1478" href="Data.Container.FreeMonad.html#1449" class="Bound">x</a> <a id="1480" class="Symbol">→</a> <a id="1482" href="Data.Container.Core.html#558" class="Record">Container</a> <a id="1492" class="Symbol">(</a><a id="1493" href="Data.Container.FreeMonad.html#1451" class="Bound">s</a> <a id="1495" href="Agda.Primitive.html#636" class="Primitive Operator">⊔</a> <a id="1497" href="Data.Container.FreeMonad.html#1449" class="Bound">x</a><a id="1498" class="Symbol">)</a> <a id="1500" href="Data.Container.FreeMonad.html#1453" class="Bound">p</a>
<a id="1502" href="Data.Container.FreeMonad.html#1502" class="Bound">C</a> <a id="1504" href="Data.Container.FreeMonad.html#1439" class="Function Operator">⋆C</a> <a id="1507" href="Data.Container.FreeMonad.html#1507" class="Bound">X</a> <a id="1509" class="Symbol">=</a> <a id="1511" href="Data.Container.Combinator.html#835" class="Function">const</a> <a id="1517" href="Data.Container.FreeMonad.html#1507" class="Bound">X</a> <a id="1519" href="Data.Container.Combinator.html#1961" class="Function Operator">⊎</a> <a id="1521" href="Data.Container.FreeMonad.html#1502" class="Bound">C</a>

<a id="_⋆_"></a><a id="1524" href="Data.Container.FreeMonad.html#1524" class="Function Operator">_⋆_</a> <a id="1528" class="Symbol">:</a> <a id="1530" class="Symbol">∀</a> <a id="1532" class="Symbol">{</a><a id="1533" href="Data.Container.FreeMonad.html#1533" class="Bound">x</a> <a id="1535" href="Data.Container.FreeMonad.html#1535" class="Bound">s</a> <a id="1537" href="Data.Container.FreeMonad.html#1537" class="Bound">p</a><a id="1538" class="Symbol">}</a> <a id="1540" class="Symbol">→</a> <a id="1542" href="Data.Container.Core.html#558" class="Record">Container</a> <a id="1552" href="Data.Container.FreeMonad.html#1535" class="Bound">s</a> <a id="1554" href="Data.Container.FreeMonad.html#1537" class="Bound">p</a> <a id="1556" class="Symbol">→</a> <a id="1558" class="PrimitiveType">Set</a> <a id="1562" href="Data.Container.FreeMonad.html#1533" class="Bound">x</a> <a id="1564" class="Symbol">→</a> <a id="1566" class="PrimitiveType">Set</a> <a id="1570" class="Symbol">(</a><a id="1571" href="Data.Container.FreeMonad.html#1533" class="Bound">x</a> <a id="1573" href="Agda.Primitive.html#636" class="Primitive Operator">⊔</a> <a id="1575" href="Data.Container.FreeMonad.html#1535" class="Bound">s</a> <a id="1577" href="Agda.Primitive.html#636" class="Primitive Operator">⊔</a> <a id="1579" href="Data.Container.FreeMonad.html#1537" class="Bound">p</a><a id="1580" class="Symbol">)</a>
<a id="1582" href="Data.Container.FreeMonad.html#1582" class="Bound">C</a> <a id="1584" href="Data.Container.FreeMonad.html#1524" class="Function Operator">⋆</a> <a id="1586" href="Data.Container.FreeMonad.html#1586" class="Bound">X</a> <a id="1588" class="Symbol">=</a> <a id="1590" href="Data.Container.html#1546" class="Function">μ</a> <a id="1592" class="Symbol">(</a><a id="1593" href="Data.Container.FreeMonad.html#1582" class="Bound">C</a> <a id="1595" href="Data.Container.FreeMonad.html#1439" class="Function Operator">⋆C</a> <a id="1598" href="Data.Container.FreeMonad.html#1586" class="Bound">X</a><a id="1599" class="Symbol">)</a>

<a id="1602" class="Keyword">module</a> <a id="1609" href="Data.Container.FreeMonad.html#1609" class="Module">_</a> <a id="1611" class="Symbol">{</a><a id="1612" href="Data.Container.FreeMonad.html#1612" class="Bound">s</a> <a id="1614" href="Data.Container.FreeMonad.html#1614" class="Bound">p</a><a id="1615" class="Symbol">}</a> <a id="1617" class="Symbol">{</a><a id="1618" href="Data.Container.FreeMonad.html#1618" class="Bound">C</a> <a id="1620" class="Symbol">:</a> <a id="1622" href="Data.Container.Core.html#558" class="Record">Container</a> <a id="1632" href="Data.Container.FreeMonad.html#1612" class="Bound">s</a> <a id="1634" href="Data.Container.FreeMonad.html#1614" class="Bound">p</a><a id="1635" class="Symbol">}</a> <a id="1637" class="Keyword">where</a>

  <a id="1646" href="Data.Container.FreeMonad.html#1646" class="Function">inn</a> <a id="1650" class="Symbol">:</a> <a id="1652" class="Symbol">∀</a> <a id="1654" class="Symbol">{</a><a id="1655" href="Data.Container.FreeMonad.html#1655" class="Bound">x</a><a id="1656" class="Symbol">}</a> <a id="1658" class="Symbol">{</a><a id="1659" href="Data.Container.FreeMonad.html#1659" class="Bound">X</a> <a id="1661" class="Symbol">:</a> <a id="1663" class="PrimitiveType">Set</a> <a id="1667" href="Data.Container.FreeMonad.html#1655" class="Bound">x</a><a id="1668" class="Symbol">}</a> <a id="1670" class="Symbol">→</a> <a id="1672" href="Data.Container.Core.html#755" class="Function Operator">⟦</a> <a id="1674" href="Data.Container.FreeMonad.html#1618" class="Bound">C</a> <a id="1676" href="Data.Container.Core.html#755" class="Function Operator">⟧</a> <a id="1678" class="Symbol">(</a><a id="1679" href="Data.Container.FreeMonad.html#1618" class="Bound">C</a> <a id="1681" href="Data.Container.FreeMonad.html#1524" class="Function Operator">⋆</a> <a id="1683" href="Data.Container.FreeMonad.html#1659" class="Bound">X</a><a id="1684" class="Symbol">)</a> <a id="1686" class="Symbol">→</a> <a id="1688" href="Data.Container.FreeMonad.html#1618" class="Bound">C</a> <a id="1690" href="Data.Container.FreeMonad.html#1524" class="Function Operator">⋆</a> <a id="1692" href="Data.Container.FreeMonad.html#1659" class="Bound">X</a>
  <a id="1696" href="Data.Container.FreeMonad.html#1646" class="Function">inn</a> <a id="1700" class="Symbol">(</a><a id="1701" href="Data.Container.FreeMonad.html#1701" class="Bound">s</a> <a id="1703" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1705" href="Data.Container.FreeMonad.html#1705" class="Bound">f</a><a id="1706" class="Symbol">)</a> <a id="1708" class="Symbol">=</a> <a id="1710" href="Data.W.html#577" class="InductiveConstructor">sup</a> <a id="1714" class="Symbol">(</a><a id="1715" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="1720" href="Data.Container.FreeMonad.html#1701" class="Bound">s</a> <a id="1722" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1724" href="Data.Container.FreeMonad.html#1705" class="Bound">f</a><a id="1725" class="Symbol">)</a>

  <a id="1730" href="Data.Container.FreeMonad.html#1730" class="Function">rawMonad</a> <a id="1739" class="Symbol">:</a> <a id="1741" class="Symbol">∀</a> <a id="1743" class="Symbol">{</a><a id="1744" href="Data.Container.FreeMonad.html#1744" class="Bound">x</a><a id="1745" class="Symbol">}</a> <a id="1747" class="Symbol">→</a> <a id="1749" href="Category.Monad.html#448" class="Function">RawMonad</a> <a id="1758" class="Symbol">{</a><a id="1759" href="Data.Container.FreeMonad.html#1612" class="Bound">s</a> <a id="1761" href="Agda.Primitive.html#636" class="Primitive Operator">⊔</a> <a id="1763" href="Data.Container.FreeMonad.html#1614" class="Bound">p</a> <a id="1765" href="Agda.Primitive.html#636" class="Primitive Operator">⊔</a> <a id="1767" href="Data.Container.FreeMonad.html#1744" class="Bound">x</a><a id="1768" class="Symbol">}</a> <a id="1770" class="Symbol">(</a><a id="1771" href="Data.Container.FreeMonad.html#1618" class="Bound">C</a> <a id="1773" href="Data.Container.FreeMonad.html#1524" class="Function Operator">⋆_</a><a id="1775" class="Symbol">)</a>
  <a id="1779" href="Data.Container.FreeMonad.html#1730" class="Function">rawMonad</a> <a id="1788" class="Symbol">=</a> <a id="1790" class="Keyword">record</a> <a id="1797" class="Symbol">{</a> <a id="1799" href="Category.Monad.Indexed.html#644" class="Field">return</a> <a id="1806" class="Symbol">=</a> <a id="1808" href="Data.Container.FreeMonad.html#1846" class="Function">return</a><a id="1814" class="Symbol">;</a> <a id="1816" href="Category.Monad.Indexed.html#677" class="Field Operator">_&gt;&gt;=_</a> <a id="1822" class="Symbol">=</a> <a id="1824" href="Data.Container.FreeMonad.html#1913" class="Function Operator">_&gt;&gt;=_</a> <a id="1830" class="Symbol">}</a>
    <a id="1836" class="Keyword">where</a>
    <a id="1846" href="Data.Container.FreeMonad.html#1846" class="Function">return</a> <a id="1853" class="Symbol">:</a> <a id="1855" class="Symbol">∀</a> <a id="1857" class="Symbol">{</a><a id="1858" href="Data.Container.FreeMonad.html#1858" class="Bound">X</a><a id="1859" class="Symbol">}</a> <a id="1861" class="Symbol">→</a> <a id="1863" href="Data.Container.FreeMonad.html#1858" class="Bound">X</a> <a id="1865" class="Symbol">→</a> <a id="1867" href="Data.Container.FreeMonad.html#1618" class="Bound">C</a> <a id="1869" href="Data.Container.FreeMonad.html#1524" class="Function Operator">⋆</a> <a id="1871" href="Data.Container.FreeMonad.html#1858" class="Bound">X</a>
    <a id="1877" href="Data.Container.FreeMonad.html#1846" class="Function">return</a> <a id="1884" href="Data.Container.FreeMonad.html#1884" class="Bound">x</a> <a id="1886" class="Symbol">=</a> <a id="1888" href="Data.W.html#577" class="InductiveConstructor">sup</a> <a id="1892" class="Symbol">(</a><a id="1893" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="1898" href="Data.Container.FreeMonad.html#1884" class="Bound">x</a> <a id="1900" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1902" class="Symbol">λ</a> <a id="1904" class="Symbol">())</a>

    <a id="1913" href="Data.Container.FreeMonad.html#1913" class="Function Operator">_&gt;&gt;=_</a> <a id="1919" class="Symbol">:</a> <a id="1921" class="Symbol">∀</a> <a id="1923" class="Symbol">{</a><a id="1924" href="Data.Container.FreeMonad.html#1924" class="Bound">X</a> <a id="1926" href="Data.Container.FreeMonad.html#1926" class="Bound">Y</a><a id="1927" class="Symbol">}</a> <a id="1929" class="Symbol">→</a> <a id="1931" href="Data.Container.FreeMonad.html#1618" class="Bound">C</a> <a id="1933" href="Data.Container.FreeMonad.html#1524" class="Function Operator">⋆</a> <a id="1935" href="Data.Container.FreeMonad.html#1924" class="Bound">X</a> <a id="1937" class="Symbol">→</a> <a id="1939" class="Symbol">(</a><a id="1940" href="Data.Container.FreeMonad.html#1924" class="Bound">X</a> <a id="1942" class="Symbol">→</a> <a id="1944" href="Data.Container.FreeMonad.html#1618" class="Bound">C</a> <a id="1946" href="Data.Container.FreeMonad.html#1524" class="Function Operator">⋆</a> <a id="1948" href="Data.Container.FreeMonad.html#1926" class="Bound">Y</a><a id="1949" class="Symbol">)</a> <a id="1951" class="Symbol">→</a> <a id="1953" href="Data.Container.FreeMonad.html#1618" class="Bound">C</a> <a id="1955" href="Data.Container.FreeMonad.html#1524" class="Function Operator">⋆</a> <a id="1957" href="Data.Container.FreeMonad.html#1926" class="Bound">Y</a>
    <a id="1963" href="Data.W.html#577" class="InductiveConstructor">sup</a> <a id="1967" class="Symbol">(</a><a id="1968" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="1973" href="Data.Container.FreeMonad.html#1973" class="Bound">x</a> <a id="1975" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1977" class="Symbol">_)</a> <a id="1980" href="Data.Container.FreeMonad.html#1913" class="Function Operator">&gt;&gt;=</a> <a id="1984" href="Data.Container.FreeMonad.html#1984" class="Bound">k</a> <a id="1986" class="Symbol">=</a> <a id="1988" href="Data.Container.FreeMonad.html#1984" class="Bound">k</a> <a id="1990" href="Data.Container.FreeMonad.html#1973" class="Bound">x</a>
    <a id="1996" href="Data.W.html#577" class="InductiveConstructor">sup</a> <a id="2000" class="Symbol">(</a><a id="2001" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="2006" href="Data.Container.FreeMonad.html#2006" class="Bound">s</a> <a id="2008" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2010" href="Data.Container.FreeMonad.html#2010" class="Bound">f</a><a id="2011" class="Symbol">)</a> <a id="2013" href="Data.Container.FreeMonad.html#1913" class="Function Operator">&gt;&gt;=</a> <a id="2017" href="Data.Container.FreeMonad.html#2017" class="Bound">k</a> <a id="2019" class="Symbol">=</a> <a id="2021" href="Data.Container.FreeMonad.html#1646" class="Function">inn</a> <a id="2025" class="Symbol">(</a><a id="2026" href="Data.Container.FreeMonad.html#2006" class="Bound">s</a> <a id="2028" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2030" class="Symbol">λ</a> <a id="2032" href="Data.Container.FreeMonad.html#2032" class="Bound">p</a> <a id="2034" class="Symbol">→</a> <a id="2036" href="Data.Container.FreeMonad.html#2010" class="Bound">f</a> <a id="2038" href="Data.Container.FreeMonad.html#2032" class="Bound">p</a> <a id="2040" href="Data.Container.FreeMonad.html#1913" class="Function Operator">&gt;&gt;=</a> <a id="2044" href="Data.Container.FreeMonad.html#2017" class="Bound">k</a><a id="2045" class="Symbol">)</a>
</pre></body></html>