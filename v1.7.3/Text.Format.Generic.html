<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Text.Format.Generic</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Format strings for Printf and Scanf</a>
<a id="145" class="Comment">------------------------------------------------------------------------</a>

<a id="219" class="Symbol">{-#</a> <a id="223" class="Keyword">OPTIONS</a> <a id="231" class="Pragma">--cubical-compatible</a> <a id="252" class="Pragma">--safe</a> <a id="259" class="Symbol">#-}</a>

<a id="264" class="Keyword">open</a> <a id="269" class="Keyword">import</a> <a id="276" href="Data.Char.Base.html" class="Module">Data.Char.Base</a> <a id="291" class="Keyword">using</a> <a id="297" class="Symbol">(</a><a id="298" href="Agda.Builtin.Char.html#238" class="Postulate">Char</a><a id="302" class="Symbol">)</a>
<a id="304" class="Keyword">open</a> <a id="309" class="Keyword">import</a> <a id="316" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="332" class="Keyword">using</a> <a id="338" class="Symbol">(</a><a id="339" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a><a id="344" class="Symbol">)</a>

<a id="347" class="Keyword">module</a> <a id="354" href="Text.Format.Generic.html" class="Module">Text.Format.Generic</a> <a id="374" class="Keyword">where</a>

<a id="381" class="Keyword">open</a> <a id="386" class="Keyword">import</a> <a id="393" href="Level.html" class="Module">Level</a> <a id="399" class="Keyword">using</a> <a id="405" class="Symbol">(</a><a id="406" href="Level.html#521" class="Function">0ℓ</a><a id="408" class="Symbol">)</a>
<a id="410" class="Keyword">open</a> <a id="415" class="Keyword">import</a> <a id="422" href="Category.Applicative.html" class="Module">Category.Applicative</a>
<a id="443" class="Keyword">open</a> <a id="448" class="Keyword">import</a> <a id="455" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="470" class="Symbol">as</a> <a id="473" class="Module">List</a>
<a id="478" class="Keyword">open</a> <a id="483" class="Keyword">import</a> <a id="490" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="501" class="Symbol">as</a> <a id="504" class="Module">Maybe</a>
<a id="510" class="Keyword">open</a> <a id="515" class="Keyword">import</a> <a id="522" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="536" class="Keyword">open</a> <a id="541" class="Keyword">import</a> <a id="548" href="Data.Product.html" class="Module">Data.Product</a>
<a id="561" class="Keyword">open</a> <a id="566" class="Keyword">import</a> <a id="573" href="Data.Product.Nary.NonDependent.html" class="Module">Data.Product.Nary.NonDependent</a>
<a id="604" class="Keyword">open</a> <a id="609" class="Keyword">import</a> <a id="616" href="Data.Sum.Base.html" class="Module">Data.Sum.Base</a>
<a id="630" class="Keyword">open</a> <a id="635" class="Keyword">import</a> <a id="642" href="Data.String.Base.html" class="Module">Data.String.Base</a>
<a id="659" class="Keyword">import</a> <a id="666" href="Data.Sum.Categorical.Left.html" class="Module">Data.Sum.Categorical.Left</a> <a id="692" class="Symbol">as</a> <a id="695" class="Module">Sumₗ</a>
<a id="700" class="Keyword">open</a> <a id="705" class="Keyword">import</a> <a id="712" href="Function.html" class="Module">Function</a>
<a id="721" class="Keyword">open</a> <a id="726" class="Keyword">import</a> <a id="733" href="Function.Nary.NonDependent.html" class="Module">Function.Nary.NonDependent</a> <a id="760" class="Keyword">using</a> <a id="766" class="Symbol">(</a><a id="767" href="Function.Nary.NonDependent.html#1540" class="Function">0ℓs</a><a id="770" class="Symbol">;</a> <a id="772" href="Function.Nary.NonDependent.Base.html#2339" class="Function">Sets</a><a id="776" class="Symbol">)</a>
<a id="778" class="Keyword">open</a> <a id="783" class="Keyword">import</a> <a id="790" href="Strict.html" class="Module">Strict</a>

<a id="798" class="Comment">------------------------------------------------------------------------</a>
<a id="871" class="Comment">-- Format specifications.</a>
<a id="897" class="Comment">-- Defines the supported %-codes.</a>

<a id="932" class="Keyword">record</a> <a id="FormatSpec"></a><a id="939" href="Text.Format.Generic.html#939" class="Record">FormatSpec</a> <a id="950" class="Symbol">:</a> <a id="952" href="Agda.Primitive.html#388" class="Primitive">Set₁</a> <a id="957" class="Keyword">where</a>
  <a id="965" class="Keyword">field</a>
    <a id="FormatSpec.ArgChunk"></a><a id="975" href="Text.Format.Generic.html#975" class="Field">ArgChunk</a> <a id="984" class="Symbol">:</a> <a id="986" href="Agda.Primitive.html#388" class="Primitive">Set</a>
    <a id="FormatSpec.ArgType"></a><a id="994" href="Text.Format.Generic.html#994" class="Field">ArgType</a>  <a id="1003" class="Symbol">:</a> <a id="1005" href="Text.Format.Generic.html#975" class="Field">ArgChunk</a> <a id="1014" class="Symbol">→</a> <a id="1016" href="Agda.Primitive.html#388" class="Primitive">Set</a>
    <a id="FormatSpec.lexArg"></a><a id="1024" href="Text.Format.Generic.html#1024" class="Field">lexArg</a>   <a id="1033" class="Symbol">:</a> <a id="1035" href="Agda.Builtin.Char.html#238" class="Postulate">Char</a> <a id="1040" class="Symbol">→</a> <a id="1042" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1048" href="Text.Format.Generic.html#975" class="Field">ArgChunk</a>

<a id="1058" class="Keyword">module</a> <a id="1065" href="Text.Format.Generic.html#1065" class="Module">_</a> <a id="1067" class="Keyword">where</a>
  <a id="1075" class="Keyword">open</a> <a id="1080" href="Text.Format.Generic.html#939" class="Module">FormatSpec</a>

  <a id="1094" class="Comment">-- Left-biased union of format specs.</a>
  <a id="1134" href="Text.Format.Generic.html#1134" class="Function">unionSpec</a> <a id="1144" class="Symbol">:</a> <a id="1146" href="Text.Format.Generic.html#939" class="Record">FormatSpec</a> <a id="1157" class="Symbol">→</a> <a id="1159" href="Text.Format.Generic.html#939" class="Record">FormatSpec</a> <a id="1170" class="Symbol">→</a> <a id="1172" href="Text.Format.Generic.html#939" class="Record">FormatSpec</a>
  <a id="1185" href="Text.Format.Generic.html#1134" class="Function">unionSpec</a> <a id="1195" href="Text.Format.Generic.html#1195" class="Bound">spec₁</a> <a id="1201" href="Text.Format.Generic.html#1201" class="Bound">spec₂</a> <a id="1207" class="Symbol">.</a><a id="1208" href="Text.Format.Generic.html#975" class="Field">ArgChunk</a>  <a id="1218" class="Symbol">=</a> <a id="1220" href="Text.Format.Generic.html#1195" class="Bound">spec₁</a> <a id="1226" class="Symbol">.</a><a id="1227" href="Text.Format.Generic.html#975" class="Field">ArgChunk</a> <a id="1236" href="Data.Sum.Base.html#743" class="Datatype Operator">⊎</a> <a id="1238" href="Text.Format.Generic.html#1201" class="Bound">spec₂</a> <a id="1244" class="Symbol">.</a><a id="1245" href="Text.Format.Generic.html#975" class="Field">ArgChunk</a>
  <a id="1256" href="Text.Format.Generic.html#1134" class="Function">unionSpec</a> <a id="1266" href="Text.Format.Generic.html#1266" class="Bound">spec₁</a> <a id="1272" href="Text.Format.Generic.html#1272" class="Bound">spec₂</a> <a id="1278" class="Symbol">.</a><a id="1279" href="Text.Format.Generic.html#994" class="Field">ArgType</a> <a id="1287" class="Symbol">(</a><a id="1288" href="Data.Sum.Base.html#793" class="InductiveConstructor">inj₁</a> <a id="1293" href="Text.Format.Generic.html#1293" class="Bound">a</a><a id="1294" class="Symbol">)</a> <a id="1296" class="Symbol">=</a> <a id="1298" href="Text.Format.Generic.html#1266" class="Bound">spec₁</a> <a id="1304" class="Symbol">.</a><a id="1305" href="Text.Format.Generic.html#994" class="Field">ArgType</a> <a id="1313" href="Text.Format.Generic.html#1293" class="Bound">a</a>
  <a id="1317" href="Text.Format.Generic.html#1134" class="Function">unionSpec</a> <a id="1327" href="Text.Format.Generic.html#1327" class="Bound">spec₁</a> <a id="1333" href="Text.Format.Generic.html#1333" class="Bound">spec₂</a> <a id="1339" class="Symbol">.</a><a id="1340" href="Text.Format.Generic.html#994" class="Field">ArgType</a> <a id="1348" class="Symbol">(</a><a id="1349" href="Data.Sum.Base.html#818" class="InductiveConstructor">inj₂</a> <a id="1354" href="Text.Format.Generic.html#1354" class="Bound">a</a><a id="1355" class="Symbol">)</a> <a id="1357" class="Symbol">=</a> <a id="1359" href="Text.Format.Generic.html#1333" class="Bound">spec₂</a> <a id="1365" class="Symbol">.</a><a id="1366" href="Text.Format.Generic.html#994" class="Field">ArgType</a> <a id="1374" href="Text.Format.Generic.html#1354" class="Bound">a</a>
  <a id="1378" href="Text.Format.Generic.html#1134" class="Function">unionSpec</a> <a id="1388" href="Text.Format.Generic.html#1388" class="Bound">spec₁</a> <a id="1394" href="Text.Format.Generic.html#1394" class="Bound">spec₂</a> <a id="1400" class="Symbol">.</a><a id="1401" href="Text.Format.Generic.html#1024" class="Field">lexArg</a>  <a id="1409" href="Text.Format.Generic.html#1409" class="Bound">c</a> <a id="1411" class="Symbol">=</a>
    <a id="1417" href="Data.Maybe.Base.html#2029" class="Function">Maybe.map</a> <a id="1427" href="Data.Sum.Base.html#793" class="InductiveConstructor">inj₁</a> <a id="1432" class="Symbol">(</a><a id="1433" href="Text.Format.Generic.html#1388" class="Bound">spec₁</a> <a id="1439" class="Symbol">.</a><a id="1440" href="Text.Format.Generic.html#1024" class="Field">lexArg</a> <a id="1447" href="Text.Format.Generic.html#1409" class="Bound">c</a><a id="1448" class="Symbol">)</a> <a id="1450" href="Data.Maybe.Base.html#2344" class="Function Operator">&lt;∣&gt;</a>
    <a id="1458" href="Data.Maybe.Base.html#2029" class="Function">Maybe.map</a> <a id="1468" href="Data.Sum.Base.html#818" class="InductiveConstructor">inj₂</a> <a id="1473" class="Symbol">(</a><a id="1474" href="Text.Format.Generic.html#1394" class="Bound">spec₂</a> <a id="1480" class="Symbol">.</a><a id="1481" href="Text.Format.Generic.html#1024" class="Field">lexArg</a> <a id="1488" href="Text.Format.Generic.html#1409" class="Bound">c</a><a id="1489" class="Symbol">)</a>

<a id="1492" class="Keyword">module</a> <a id="Format"></a><a id="1499" href="Text.Format.Generic.html#1499" class="Module">Format</a> <a id="1506" class="Symbol">(</a><a id="1507" href="Text.Format.Generic.html#1507" class="Bound">spec</a> <a id="1512" class="Symbol">:</a> <a id="1514" href="Text.Format.Generic.html#939" class="Record">FormatSpec</a><a id="1524" class="Symbol">)</a> <a id="1526" class="Keyword">where</a>

  <a id="1535" class="Keyword">open</a> <a id="1540" href="Text.Format.Generic.html#939" class="Module">FormatSpec</a> <a id="1551" href="Text.Format.Generic.html#1507" class="Bound">spec</a>

  <a id="1559" class="Comment">------------------------------------------------------------------------</a>
  <a id="1634" class="Comment">-- Basic types</a>

  <a id="1652" class="Keyword">data</a> <a id="Format.Chunk"></a><a id="1657" href="Text.Format.Generic.html#1657" class="Datatype">Chunk</a> <a id="1663" class="Symbol">:</a> <a id="1665" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1669" class="Keyword">where</a>
    <a id="Format.Chunk.Arg"></a><a id="1679" href="Text.Format.Generic.html#1679" class="InductiveConstructor">Arg</a> <a id="1683" class="Symbol">:</a> <a id="1685" href="Text.Format.Generic.html#975" class="Field">ArgChunk</a> <a id="1694" class="Symbol">→</a> <a id="1696" href="Text.Format.Generic.html#1657" class="Datatype">Chunk</a>
    <a id="Format.Chunk.Raw"></a><a id="1706" href="Text.Format.Generic.html#1706" class="InductiveConstructor">Raw</a> <a id="1710" class="Symbol">:</a> <a id="1712" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1719" class="Symbol">→</a> <a id="1721" href="Text.Format.Generic.html#1657" class="Datatype">Chunk</a>

  <a id="Format.Format"></a><a id="1730" href="Text.Format.Generic.html#1730" class="Function">Format</a> <a id="1737" class="Symbol">:</a> <a id="1739" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="1745" href="Text.Format.Generic.html#1730" class="Function">Format</a> <a id="1752" class="Symbol">=</a> <a id="1754" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1759" href="Text.Format.Generic.html#1657" class="Datatype">Chunk</a>

  <a id="1768" class="Comment">------------------------------------------------------------------------</a>
  <a id="1843" class="Comment">-- Semantics</a>

  <a id="Format.size"></a><a id="1859" href="Text.Format.Generic.html#1859" class="Function">size</a> <a id="1864" class="Symbol">:</a> <a id="1866" href="Text.Format.Generic.html#1730" class="Function">Format</a> <a id="1873" class="Symbol">→</a> <a id="1875" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
  <a id="1879" href="Text.Format.Generic.html#1859" class="Function">size</a> <a id="1884" class="Symbol">=</a> <a id="1886" href="Data.List.Base.html#4793" class="Function">List.sum</a> <a id="1895" href="Function.Base.html#3715" class="Function Operator">∘′</a> <a id="1898" href="Data.List.Base.html#1553" class="Function">List.map</a> <a id="1907" class="Symbol">λ</a> <a id="1909" class="Symbol">{</a> <a id="1911" class="Symbol">(</a><a id="1912" href="Text.Format.Generic.html#1706" class="InductiveConstructor">Raw</a> <a id="1916" class="Symbol">_)</a> <a id="1919" class="Symbol">→</a> <a id="1921" class="Number">0</a><a id="1922" class="Symbol">;</a> <a id="1924" class="CatchallClause Symbol">_</a> <a id="1926" class="Symbol">→</a> <a id="1928" class="Number">1</a> <a id="1930" class="Symbol">}</a>

  <a id="1935" class="Comment">-- Meaning of a format as a list of value types</a>

  <a id="Format.⟦_⟧"></a><a id="1986" href="Text.Format.Generic.html#1986" class="Function Operator">⟦_⟧</a> <a id="1990" class="Symbol">:</a> <a id="1992" class="Symbol">(</a><a id="1993" href="Text.Format.Generic.html#1993" class="Bound">fmt</a> <a id="1997" class="Symbol">:</a> <a id="1999" href="Text.Format.Generic.html#1730" class="Function">Format</a><a id="2005" class="Symbol">)</a> <a id="2007" class="Symbol">→</a> <a id="2009" href="Function.Nary.NonDependent.Base.html#2339" class="Function">Sets</a> <a id="2014" class="Symbol">(</a><a id="2015" href="Text.Format.Generic.html#1859" class="Function">size</a> <a id="2020" href="Text.Format.Generic.html#1993" class="Bound">fmt</a><a id="2023" class="Symbol">)</a> <a id="2025" href="Function.Nary.NonDependent.html#1540" class="Function">0ℓs</a>
  <a id="2031" href="Text.Format.Generic.html#1986" class="Function Operator">⟦</a> <a id="2033" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>          <a id="2045" href="Text.Format.Generic.html#1986" class="Function Operator">⟧</a> <a id="2047" class="Symbol">=</a> <a id="2049" class="Symbol">_</a>
  <a id="2053" href="Text.Format.Generic.html#1986" class="Function Operator">⟦</a> <a id="2055" href="Text.Format.Generic.html#1679" class="InductiveConstructor">Arg</a> <a id="2059" href="Text.Format.Generic.html#2059" class="Bound">a</a>  <a id="2062" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2064" href="Text.Format.Generic.html#2064" class="Bound">cs</a> <a id="2067" href="Text.Format.Generic.html#1986" class="Function Operator">⟧</a> <a id="2069" class="Symbol">=</a> <a id="2071" href="Text.Format.Generic.html#994" class="Field">ArgType</a> <a id="2079" href="Text.Format.Generic.html#2059" class="Bound">a</a> <a id="2081" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2083" href="Text.Format.Generic.html#1986" class="Function Operator">⟦</a> <a id="2085" href="Text.Format.Generic.html#2064" class="Bound">cs</a> <a id="2088" href="Text.Format.Generic.html#1986" class="Function Operator">⟧</a>
  <a id="2092" href="Text.Format.Generic.html#1986" class="Function Operator">⟦</a> <a id="2094" href="Text.Format.Generic.html#1706" class="InductiveConstructor">Raw</a> <a id="2098" class="Symbol">_</a>  <a id="2101" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2103" href="Text.Format.Generic.html#2103" class="Bound">cs</a> <a id="2106" href="Text.Format.Generic.html#1986" class="Function Operator">⟧</a> <a id="2108" class="Symbol">=</a>             <a id="2122" href="Text.Format.Generic.html#1986" class="Function Operator">⟦</a> <a id="2124" href="Text.Format.Generic.html#2103" class="Bound">cs</a> <a id="2127" href="Text.Format.Generic.html#1986" class="Function Operator">⟧</a>

  <a id="2132" class="Comment">------------------------------------------------------------------------</a>
  <a id="2207" class="Comment">-- Lexer: from Strings to Formats</a>

  <a id="2244" class="Comment">-- Lexing may fail. To have a useful error message, we defined the following</a>
  <a id="2323" class="Comment">-- enumerated type</a>

  <a id="2345" class="Keyword">data</a> <a id="Format.Error"></a><a id="2350" href="Text.Format.Generic.html#2350" class="Datatype">Error</a> <a id="2356" class="Symbol">:</a> <a id="2358" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2362" class="Keyword">where</a>
    <a id="Format.Error.UnexpectedEndOfString"></a><a id="2372" href="Text.Format.Generic.html#2372" class="InductiveConstructor">UnexpectedEndOfString</a> <a id="2394" class="Symbol">:</a> <a id="2396" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2403" class="Symbol">→</a> <a id="2405" href="Text.Format.Generic.html#2350" class="Datatype">Error</a>
    <a id="2415" class="Comment">-- ^ expected a type declaration; found an empty string</a>
    <a id="Format.Error.InvalidType"></a><a id="2475" href="Text.Format.Generic.html#2475" class="InductiveConstructor">InvalidType</a> <a id="2487" class="Symbol">:</a> <a id="2489" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2496" class="Symbol">→</a> <a id="2498" href="Agda.Builtin.Char.html#238" class="Postulate">Char</a> <a id="2503" class="Symbol">→</a> <a id="2505" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2512" class="Symbol">→</a> <a id="2514" href="Text.Format.Generic.html#2350" class="Datatype">Error</a>
    <a id="2524" class="Comment">-- ^ invalid type declaration</a>
    <a id="2558" class="Comment">--   return a focus: prefix processed, character causing failure, rest</a>

  <a id="Format.lexer"></a><a id="2632" href="Text.Format.Generic.html#2632" class="Function">lexer</a> <a id="2638" class="Symbol">:</a> <a id="2640" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2647" class="Symbol">→</a> <a id="2649" href="Text.Format.Generic.html#2350" class="Datatype">Error</a> <a id="2655" href="Data.Sum.Base.html#743" class="Datatype Operator">⊎</a> <a id="2657" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2662" href="Text.Format.Generic.html#1657" class="Datatype">Chunk</a>
  <a id="2670" href="Text.Format.Generic.html#2632" class="Function">lexer</a> <a id="2676" href="Text.Format.Generic.html#2676" class="Bound">input</a> <a id="2682" class="Symbol">=</a> <a id="2684" href="Text.Format.Generic.html#3227" class="Function">loop</a> <a id="2689" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2692" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2695" class="Symbol">(</a><a id="2696" href="Data.String.Base.html#1502" class="Primitive">toList</a> <a id="2703" href="Text.Format.Generic.html#2676" class="Bound">input</a><a id="2708" class="Symbol">)</a> <a id="2710" class="Keyword">where</a>

    <a id="2721" class="Keyword">open</a> <a id="2726" href="Category.Applicative.html#611" class="Module">RawApplicative</a> <a id="2741" class="Symbol">(</a><a id="2742" href="Data.Sum.Categorical.Left.html#959" class="Function">Sumₗ.applicative</a> <a id="2759" href="Text.Format.Generic.html#2350" class="Datatype">Error</a> <a id="2765" href="Level.html#521" class="Function">0ℓ</a><a id="2767" class="Symbol">)</a>

    <a id="2774" class="Comment">-- Type synonyms used locally to document the code</a>
    <a id="2829" href="Text.Format.Generic.html#2829" class="Function">RevWord</a> <a id="2837" class="Symbol">=</a> <a id="2839" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2844" href="Agda.Builtin.Char.html#238" class="Postulate">Char</a> <a id="2849" class="Comment">-- Mere characters accumulated so far</a>
    <a id="2891" href="Text.Format.Generic.html#2891" class="Function">Prefix</a>  <a id="2899" class="Symbol">=</a> <a id="2901" href="Text.Format.Generic.html#2829" class="Function">RevWord</a>   <a id="2911" class="Comment">-- Prefix of the input String already read</a>

    <a id="2959" href="Text.Format.Generic.html#2959" class="Function">toRevString</a> <a id="2971" class="Symbol">:</a> <a id="2973" href="Text.Format.Generic.html#2829" class="Function">RevWord</a> <a id="2981" class="Symbol">→</a> <a id="2983" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
    <a id="2994" href="Text.Format.Generic.html#2959" class="Function">toRevString</a> <a id="3006" class="Symbol">=</a> <a id="3008" href="Data.String.Base.html#1535" class="Primitive">fromList</a> <a id="3017" href="Function.Base.html#3715" class="Function Operator">∘′</a> <a id="3020" href="Data.List.Base.html#9826" class="Function">reverse</a>

    <a id="3033" class="Comment">-- Push a Raw token if we have accumulated some mere characters</a>
    <a id="3101" href="Text.Format.Generic.html#3101" class="Function">push</a> <a id="3106" class="Symbol">:</a> <a id="3108" href="Text.Format.Generic.html#2829" class="Function">RevWord</a> <a id="3116" class="Symbol">→</a> <a id="3118" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3123" href="Text.Format.Generic.html#1657" class="Datatype">Chunk</a> <a id="3129" class="Symbol">→</a> <a id="3131" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3136" href="Text.Format.Generic.html#1657" class="Datatype">Chunk</a>
    <a id="3146" href="Text.Format.Generic.html#3101" class="Function">push</a> <a id="3151" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="3154" href="Text.Format.Generic.html#3154" class="Bound">ks</a> <a id="3157" class="Symbol">=</a> <a id="3159" href="Text.Format.Generic.html#3154" class="Bound">ks</a>
    <a id="3166" href="Text.Format.Generic.html#3101" class="CatchallClause Function">push</a><a id="3170" class="CatchallClause"> </a><a id="3171" href="Text.Format.Generic.html#3171" class="CatchallClause Bound">cs</a><a id="3173" class="CatchallClause"> </a><a id="3174" href="Text.Format.Generic.html#3174" class="CatchallClause Bound">ks</a> <a id="3177" class="Symbol">=</a> <a id="3179" href="Text.Format.Generic.html#1706" class="InductiveConstructor">Raw</a> <a id="3183" class="Symbol">(</a><a id="3184" href="Text.Format.Generic.html#2959" class="Function">toRevString</a> <a id="3196" href="Text.Format.Generic.html#3171" class="Bound">cs</a><a id="3198" class="Symbol">)</a> <a id="3200" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3202" href="Text.Format.Generic.html#3174" class="Bound">ks</a>

    <a id="3210" class="Comment">-- Main loop</a>
    <a id="3227" href="Text.Format.Generic.html#3227" class="Function">loop</a> <a id="3232" class="Symbol">:</a> <a id="3234" href="Text.Format.Generic.html#2829" class="Function">RevWord</a> <a id="3242" class="Symbol">→</a> <a id="3244" href="Text.Format.Generic.html#2891" class="Function">Prefix</a> <a id="3251" class="Symbol">→</a> <a id="3253" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3258" href="Agda.Builtin.Char.html#238" class="Postulate">Char</a> <a id="3263" class="Symbol">→</a> <a id="3265" href="Text.Format.Generic.html#2350" class="Datatype">Error</a> <a id="3271" href="Data.Sum.Base.html#743" class="Datatype Operator">⊎</a> <a id="3273" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3278" href="Text.Format.Generic.html#1657" class="Datatype">Chunk</a>
    <a id="3288" href="Text.Format.Generic.html#3288" class="Function">type</a> <a id="3293" class="Symbol">:</a>           <a id="3305" href="Text.Format.Generic.html#2891" class="Function">Prefix</a> <a id="3312" class="Symbol">→</a> <a id="3314" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3319" href="Agda.Builtin.Char.html#238" class="Postulate">Char</a> <a id="3324" class="Symbol">→</a> <a id="3326" href="Text.Format.Generic.html#2350" class="Datatype">Error</a> <a id="3332" href="Data.Sum.Base.html#743" class="Datatype Operator">⊎</a> <a id="3334" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3339" href="Text.Format.Generic.html#1657" class="Datatype">Chunk</a>

    <a id="3350" href="Text.Format.Generic.html#3227" class="Function">loop</a> <a id="3355" href="Text.Format.Generic.html#3355" class="Bound">acc</a> <a id="3359" href="Text.Format.Generic.html#3359" class="Bound">bef</a> <a id="3363" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>               <a id="3380" class="Symbol">=</a> <a id="3382" href="Category.Applicative.Indexed.html#1012" class="Function">pure</a> <a id="3387" class="Symbol">(</a><a id="3388" href="Text.Format.Generic.html#3101" class="Function">push</a> <a id="3393" href="Text.Format.Generic.html#3355" class="Bound">acc</a> <a id="3397" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3399" class="Symbol">)</a>
    <a id="3405" class="Comment">-- escaped &#39;%&#39; character: treat like a mere character</a>
    <a id="3463" href="Text.Format.Generic.html#3227" class="Function">loop</a> <a id="3468" href="Text.Format.Generic.html#3468" class="Bound">acc</a> <a id="3472" href="Text.Format.Generic.html#3472" class="Bound">bef</a> <a id="3476" class="Symbol">(</a><a id="3477" class="String">&#39;%&#39;</a> <a id="3481" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3483" class="String">&#39;%&#39;</a> <a id="3487" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3489" href="Text.Format.Generic.html#3489" class="Bound">cs</a><a id="3491" class="Symbol">)</a> <a id="3493" class="Symbol">=</a> <a id="3495" href="Text.Format.Generic.html#3227" class="Function">loop</a> <a id="3500" class="Symbol">(</a><a id="3501" class="String">&#39;%&#39;</a> <a id="3505" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3507" href="Text.Format.Generic.html#3468" class="Bound">acc</a><a id="3510" class="Symbol">)</a> <a id="3512" class="Symbol">(</a><a id="3513" class="String">&#39;%&#39;</a> <a id="3517" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3519" class="String">&#39;%&#39;</a> <a id="3523" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3525" href="Text.Format.Generic.html#3472" class="Bound">bef</a><a id="3528" class="Symbol">)</a> <a id="3530" href="Text.Format.Generic.html#3489" class="Bound">cs</a>
    <a id="3537" class="Comment">-- non escaped &#39;%&#39;: type declaration following</a>
    <a id="3588" href="Text.Format.Generic.html#3227" class="CatchallClause Function">loop</a><a id="3592" class="CatchallClause"> </a><a id="3593" href="Text.Format.Generic.html#3593" class="CatchallClause Bound">acc</a><a id="3596" class="CatchallClause"> </a><a id="3597" href="Text.Format.Generic.html#3597" class="CatchallClause Bound">bef</a><a id="3600" class="CatchallClause"> </a><a id="3601" class="CatchallClause Symbol">(</a><a id="3602" class="CatchallClause String">&#39;%&#39;</a><a id="3605" class="CatchallClause"> </a><a id="3606" href="Agda.Builtin.List.html#199" class="CatchallClause InductiveConstructor Operator">∷</a><a id="3607" class="CatchallClause"> </a><a id="3608" href="Text.Format.Generic.html#3608" class="CatchallClause Bound">cs</a><a id="3610" class="CatchallClause Symbol">)</a>       <a id="3618" class="Symbol">=</a> <a id="3620" href="Text.Format.Generic.html#3101" class="Function">push</a> <a id="3625" href="Text.Format.Generic.html#3593" class="Bound">acc</a> <a id="3629" href="Category.Functor.html#617" class="Function Operator">&lt;$&gt;</a> <a id="3633" href="Text.Format.Generic.html#3288" class="Function">type</a> <a id="3638" class="Symbol">(</a><a id="3639" class="String">&#39;%&#39;</a> <a id="3643" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3645" href="Text.Format.Generic.html#3597" class="Bound">bef</a><a id="3648" class="Symbol">)</a> <a id="3650" href="Text.Format.Generic.html#3608" class="Bound">cs</a>
    <a id="3657" class="Comment">-- mere character: push onto the accumulator</a>
    <a id="3706" href="Text.Format.Generic.html#3227" class="Function">loop</a> <a id="3711" href="Text.Format.Generic.html#3711" class="Bound">acc</a> <a id="3715" href="Text.Format.Generic.html#3715" class="Bound">bef</a> <a id="3719" class="Symbol">(</a><a id="3720" href="Text.Format.Generic.html#3720" class="Bound">c</a> <a id="3722" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3724" href="Text.Format.Generic.html#3724" class="Bound">cs</a><a id="3726" class="Symbol">)</a>         <a id="3736" class="Symbol">=</a> <a id="3738" href="Text.Format.Generic.html#3227" class="Function">loop</a> <a id="3743" class="Symbol">(</a><a id="3744" href="Text.Format.Generic.html#3720" class="Bound">c</a> <a id="3746" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3748" href="Text.Format.Generic.html#3711" class="Bound">acc</a><a id="3751" class="Symbol">)</a> <a id="3753" class="Symbol">(</a><a id="3754" href="Text.Format.Generic.html#3720" class="Bound">c</a> <a id="3756" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3758" href="Text.Format.Generic.html#3715" class="Bound">bef</a><a id="3761" class="Symbol">)</a> <a id="3763" href="Text.Format.Generic.html#3724" class="Bound">cs</a>

    <a id="3771" href="Text.Format.Generic.html#3288" class="Function">type</a> <a id="3776" href="Text.Format.Generic.html#3776" class="Bound">bef</a> <a id="3780" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>       <a id="3789" class="Symbol">=</a> <a id="3791" href="Data.Sum.Base.html#793" class="InductiveConstructor">inj₁</a> <a id="3796" class="Symbol">(</a><a id="3797" href="Text.Format.Generic.html#2372" class="InductiveConstructor">UnexpectedEndOfString</a> <a id="3819" href="Text.Format.Generic.html#2676" class="Bound">input</a><a id="3824" class="Symbol">)</a>
    <a id="3830" href="Text.Format.Generic.html#3288" class="Function">type</a> <a id="3835" href="Text.Format.Generic.html#3835" class="Bound">bef</a> <a id="3839" class="Symbol">(</a><a id="3840" href="Text.Format.Generic.html#3840" class="Bound">c</a> <a id="3842" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3844" href="Text.Format.Generic.html#3844" class="Bound">cs</a><a id="3846" class="Symbol">)</a> <a id="3848" class="Symbol">=</a> <a id="3850" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">_∷_</a> <a id="3854" href="Category.Functor.html#617" class="Function Operator">&lt;$&gt;</a> <a id="3858" href="Text.Format.Generic.html#3902" class="Function">chunk</a> <a id="3864" href="Text.Format.Generic.html#3840" class="Bound">c</a> <a id="3866" href="Category.Applicative.Indexed.html#1043" class="Function Operator">⊛</a> <a id="3868" href="Text.Format.Generic.html#3227" class="Function">loop</a> <a id="3873" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="3876" class="Symbol">(</a><a id="3877" href="Text.Format.Generic.html#3840" class="Bound">c</a> <a id="3879" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3881" href="Text.Format.Generic.html#3835" class="Bound">bef</a><a id="3884" class="Symbol">)</a> <a id="3886" href="Text.Format.Generic.html#3844" class="Bound">cs</a> <a id="3889" class="Keyword">where</a>

      <a id="3902" href="Text.Format.Generic.html#3902" class="Function">chunk</a> <a id="3908" class="Symbol">:</a> <a id="3910" href="Agda.Builtin.Char.html#238" class="Postulate">Char</a> <a id="3915" class="Symbol">→</a> <a id="3917" href="Text.Format.Generic.html#2350" class="Datatype">Error</a> <a id="3923" href="Data.Sum.Base.html#743" class="Datatype Operator">⊎</a> <a id="3925" href="Text.Format.Generic.html#1657" class="Datatype">Chunk</a>
      <a id="3937" href="Text.Format.Generic.html#3902" class="Function">chunk</a> <a id="3943" href="Text.Format.Generic.html#3943" class="Bound">c</a> <a id="3945" class="Symbol">=</a>
        <a id="3955" href="Function.Base.html#4130" class="Function Operator">case</a> <a id="3960" href="Text.Format.Generic.html#1024" class="Field">lexArg</a> <a id="3967" href="Text.Format.Generic.html#3943" class="Bound">c</a> <a id="3969" href="Function.Base.html#4130" class="Function Operator">of</a> <a id="3972" class="Symbol">λ</a> <a id="3974" class="Keyword">where</a>
          <a id="3990" class="Symbol">(</a><a id="3991" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3996" href="Text.Format.Generic.html#3996" class="Bound">ch</a><a id="3998" class="Symbol">)</a> <a id="4000" class="Symbol">→</a> <a id="4002" href="Category.Applicative.Indexed.html#1012" class="Function">pure</a> <a id="4007" class="Symbol">(</a><a id="4008" href="Text.Format.Generic.html#1679" class="InductiveConstructor">Arg</a> <a id="4012" href="Text.Format.Generic.html#3996" class="Bound">ch</a><a id="4014" class="Symbol">)</a>
          <a id="4026" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>   <a id="4036" class="Symbol">→</a>
            <a id="4050" href="Strict.html#524" class="Function">force′</a> <a id="4057" class="Symbol">(</a><a id="4058" href="Text.Format.Generic.html#2959" class="Function">toRevString</a> <a id="4070" href="Text.Format.Generic.html#3835" class="Bound">bef</a><a id="4073" class="Symbol">)</a> <a id="4075" class="Symbol">λ</a> <a id="4077" href="Text.Format.Generic.html#4077" class="Bound">prefix</a> <a id="4084" class="Symbol">→</a>
            <a id="4098" href="Strict.html#524" class="Function">force′</a> <a id="4105" class="Symbol">(</a><a id="4106" href="Data.String.Base.html#1535" class="Primitive">fromList</a> <a id="4115" href="Text.Format.Generic.html#3844" class="Bound">cs</a><a id="4117" class="Symbol">)</a>     <a id="4123" class="Symbol">λ</a> <a id="4125" href="Text.Format.Generic.html#4125" class="Bound">suffix</a> <a id="4132" class="Symbol">→</a>
            <a id="4146" href="Data.Sum.Base.html#793" class="InductiveConstructor">inj₁</a> <a id="4151" class="Symbol">(</a><a id="4152" href="Text.Format.Generic.html#2475" class="InductiveConstructor">InvalidType</a> <a id="4164" href="Text.Format.Generic.html#4077" class="Bound">prefix</a> <a id="4171" href="Text.Format.Generic.html#3943" class="Bound">c</a> <a id="4173" href="Text.Format.Generic.html#4125" class="Bound">suffix</a><a id="4179" class="Symbol">)</a>
</pre></body></html>