<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Text.Regex.String.Unsafe</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Regular expressions acting on strings, using unsafe features</a>
<a id="170" class="Comment">------------------------------------------------------------------------</a>

<a id="244" class="Symbol">{-#</a> <a id="248" class="Keyword">OPTIONS</a> <a id="256" class="Pragma">--with-K</a> <a id="265" class="Symbol">#-}</a>

<a id="270" class="Keyword">module</a> <a id="277" href="Text.Regex.String.Unsafe.html" class="Module">Text.Regex.String.Unsafe</a> <a id="302" class="Keyword">where</a>

<a id="309" class="Keyword">open</a> <a id="314" class="Keyword">import</a> <a id="321" href="Data.String.Base.html" class="Module">Data.String.Base</a> <a id="338" class="Keyword">using</a> <a id="344" class="Symbol">(</a><a id="345" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="351" class="Symbol">;</a> <a id="353" href="Data.String.Base.html#1502" class="Primitive">toList</a><a id="359" class="Symbol">;</a> <a id="361" href="Data.String.Base.html#1535" class="Primitive">fromList</a><a id="369" class="Symbol">)</a>
<a id="371" class="Keyword">import</a> <a id="378" href="Data.String.Unsafe.html" class="Module">Data.String.Unsafe</a> <a id="397" class="Symbol">as</a> <a id="400" class="Module">Stringₚ</a>
<a id="408" class="Keyword">open</a> <a id="413" class="Keyword">import</a> <a id="420" href="Function.Base.html" class="Module">Function.Base</a> <a id="434" class="Keyword">using</a> <a id="440" class="Symbol">(</a><a id="441" href="Function.Base.html#6294" class="Function Operator">_on_</a><a id="445" class="Symbol">;</a> <a id="447" href="Function.Base.html#624" class="Function">id</a><a id="449" class="Symbol">)</a>
<a id="451" class="Keyword">open</a> <a id="456" class="Keyword">import</a> <a id="463" href="Level.html" class="Module">Level</a> <a id="469" class="Keyword">using</a> <a id="475" class="Symbol">(</a><a id="476" href="Level.html#521" class="Function">0ℓ</a><a id="478" class="Symbol">)</a>
<a id="480" class="Keyword">open</a> <a id="485" class="Keyword">import</a> <a id="492" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="508" class="Keyword">using</a> <a id="514" class="Symbol">(</a><a id="515" href="Relation.Binary.Core.html#891" class="Function">Rel</a><a id="518" class="Symbol">;</a> <a id="520" href="Relation.Binary.Definitions.html#4584" class="Function">Decidable</a><a id="529" class="Symbol">)</a>
<a id="531" class="Keyword">open</a> <a id="536" class="Keyword">import</a> <a id="543" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="581" class="Keyword">using</a> <a id="587" class="Symbol">(</a><a id="588" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="591" class="Symbol">;</a> <a id="593" href="Relation.Binary.PropositionalEquality.Core.html#1693" class="Function">sym</a><a id="596" class="Symbol">;</a> <a id="598" href="Relation.Binary.PropositionalEquality.Core.html#1789" class="Function">subst</a><a id="603" class="Symbol">)</a>
<a id="605" class="Keyword">open</a> <a id="610" class="Keyword">import</a> <a id="617" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="644" class="Keyword">using</a> <a id="650" class="Symbol">(</a><a id="651" href="Relation.Nullary.Decidable.Core.html#3645" class="Function">map′</a><a id="655" class="Symbol">)</a>

<a id="658" class="Comment">------------------------------------------------------------------------</a>
<a id="731" class="Comment">-- Re-exporting safe definitions</a>

<a id="765" class="Keyword">open</a> <a id="770" class="Keyword">import</a> <a id="777" href="Text.Regex.String.html" class="Module">Text.Regex.String</a> <a id="795" class="Symbol">as</a> <a id="798" class="Module">Regex</a> <a id="804" class="Keyword">public</a>
  <a id="813" class="Keyword">hiding</a> <a id="820" class="Symbol">(</a><a id="821" href="Text.Regex.Base.html#2371" class="Datatype Operator">_∈_</a><a id="824" class="Symbol">;</a> <a id="826" href="Text.Regex.Base.html#2892" class="Function Operator">_∉_</a><a id="829" class="Symbol">;</a> <a id="831" href="Text.Regex.Derivative.Brzozowski.html#4515" class="Function Operator">_∈?_</a><a id="835" class="Symbol">;</a> <a id="837" href="Text.Regex.Derivative.Brzozowski.html#4632" class="Function Operator">_∉?_</a><a id="841" class="Symbol">;</a> <a id="843" href="Text.Regex.Search.html#1876" class="Function">Span</a><a id="847" class="Symbol">;</a> <a id="849" href="Text.Regex.Search.html#2515" class="Record">Match</a><a id="854" class="Symbol">;</a> <a id="856" href="Text.Regex.Search.html#9075" class="Function">search</a><a id="862" class="Symbol">)</a>

<a id="865" class="Comment">------------------------------------------------------------------------</a>
<a id="938" class="Comment">-- Specialised definitions</a>

<a id="_∈_"></a><a id="966" href="Text.Regex.String.Unsafe.html#966" class="Function Operator">_∈_</a> <a id="970" class="Symbol">:</a> <a id="972" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="979" class="Symbol">→</a> <a id="981" href="Text.Regex.Base.html#1261" class="Datatype">Exp</a> <a id="985" class="Symbol">→</a> <a id="987" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="991" href="Text.Regex.String.Unsafe.html#991" class="Bound">str</a> <a id="995" href="Text.Regex.String.Unsafe.html#966" class="Function Operator">∈</a> <a id="997" href="Text.Regex.String.Unsafe.html#997" class="Bound">e</a> <a id="999" class="Symbol">=</a> <a id="1001" href="Data.String.Base.html#1502" class="Primitive">toList</a> <a id="1008" href="Text.Regex.String.Unsafe.html#991" class="Bound">str</a> <a id="1012" href="Text.Regex.Base.html#2371" class="Datatype Operator">Regex.∈</a> <a id="1020" href="Text.Regex.String.Unsafe.html#997" class="Bound">e</a>

<a id="_∉_"></a><a id="1023" href="Text.Regex.String.Unsafe.html#1023" class="Function Operator">_∉_</a> <a id="1027" class="Symbol">:</a> <a id="1029" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1036" class="Symbol">→</a> <a id="1038" href="Text.Regex.Base.html#1261" class="Datatype">Exp</a> <a id="1042" class="Symbol">→</a> <a id="1044" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="1048" href="Text.Regex.String.Unsafe.html#1048" class="Bound">str</a> <a id="1052" href="Text.Regex.String.Unsafe.html#1023" class="Function Operator">∉</a> <a id="1054" href="Text.Regex.String.Unsafe.html#1054" class="Bound">e</a> <a id="1056" class="Symbol">=</a> <a id="1058" href="Data.String.Base.html#1502" class="Primitive">toList</a> <a id="1065" href="Text.Regex.String.Unsafe.html#1048" class="Bound">str</a> <a id="1069" href="Text.Regex.Base.html#2892" class="Function Operator">Regex.∉</a> <a id="1077" href="Text.Regex.String.Unsafe.html#1054" class="Bound">e</a>

<a id="_∈?_"></a><a id="1080" href="Text.Regex.String.Unsafe.html#1080" class="Function Operator">_∈?_</a> <a id="1085" class="Symbol">:</a> <a id="1087" href="Relation.Binary.Definitions.html#4584" class="Function">Decidable</a> <a id="1097" href="Text.Regex.String.Unsafe.html#966" class="Function Operator">_∈_</a>
<a id="1101" href="Text.Regex.String.Unsafe.html#1101" class="Bound">str</a> <a id="1105" href="Text.Regex.String.Unsafe.html#1080" class="Function Operator">∈?</a> <a id="1108" href="Text.Regex.String.Unsafe.html#1108" class="Bound">e</a> <a id="1110" class="Symbol">=</a> <a id="1112" href="Data.String.Base.html#1502" class="Primitive">toList</a> <a id="1119" href="Text.Regex.String.Unsafe.html#1101" class="Bound">str</a> <a id="1123" href="Text.Regex.Derivative.Brzozowski.html#4515" class="Function Operator">Regex.∈?</a> <a id="1132" href="Text.Regex.String.Unsafe.html#1108" class="Bound">e</a>

<a id="_∉?_"></a><a id="1135" href="Text.Regex.String.Unsafe.html#1135" class="Function Operator">_∉?_</a> <a id="1140" class="Symbol">:</a> <a id="1142" href="Relation.Binary.Definitions.html#4584" class="Function">Decidable</a> <a id="1152" href="Text.Regex.String.Unsafe.html#1023" class="Function Operator">_∉_</a>
<a id="1156" href="Text.Regex.String.Unsafe.html#1156" class="Bound">str</a> <a id="1160" href="Text.Regex.String.Unsafe.html#1135" class="Function Operator">∉?</a> <a id="1163" href="Text.Regex.String.Unsafe.html#1163" class="Bound">e</a> <a id="1165" class="Symbol">=</a> <a id="1167" href="Data.String.Base.html#1502" class="Primitive">toList</a> <a id="1174" href="Text.Regex.String.Unsafe.html#1156" class="Bound">str</a> <a id="1178" href="Text.Regex.Derivative.Brzozowski.html#4632" class="Function Operator">Regex.∉?</a> <a id="1187" href="Text.Regex.String.Unsafe.html#1163" class="Bound">e</a>

<a id="Span"></a><a id="1190" href="Text.Regex.String.Unsafe.html#1190" class="Function">Span</a> <a id="1195" class="Symbol">:</a> <a id="1197" href="Text.Regex.Base.html#1597" class="Record">Regex</a> <a id="1203" class="Symbol">→</a> <a id="1205" href="Relation.Binary.Core.html#891" class="Function">Rel</a> <a id="1209" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1216" href="Level.html#521" class="Function">0ℓ</a>
<a id="1219" href="Text.Regex.String.Unsafe.html#1190" class="Function">Span</a> <a id="1224" href="Text.Regex.String.Unsafe.html#1224" class="Bound">e</a> <a id="1226" class="Symbol">=</a> <a id="1228" href="Text.Regex.Search.html#1876" class="Function">Regex.Span</a> <a id="1239" href="Text.Regex.String.Unsafe.html#1224" class="Bound">e</a> <a id="1241" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a> <a id="1245" href="Function.Base.html#6294" class="Function Operator">on</a> <a id="1248" href="Data.String.Base.html#1502" class="Primitive">toList</a>

<a id="1256" class="Comment">-- A match is a string, a proof it matches the regular expression,</a>
<a id="1323" class="Comment">-- and a proof it appears as the right sort of substring.</a>
<a id="1381" class="Keyword">record</a> <a id="Match"></a><a id="1388" href="Text.Regex.String.Unsafe.html#1388" class="Record">Match</a> <a id="1394" class="Symbol">(</a><a id="1395" href="Text.Regex.String.Unsafe.html#1395" class="Bound">str</a> <a id="1399" class="Symbol">:</a> <a id="1401" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="1407" class="Symbol">)</a> <a id="1409" class="Symbol">(</a><a id="1410" href="Text.Regex.String.Unsafe.html#1410" class="Bound">e</a> <a id="1412" class="Symbol">:</a> <a id="1414" href="Text.Regex.Base.html#1597" class="Record">Regex</a><a id="1419" class="Symbol">)</a> <a id="1421" class="Symbol">:</a> <a id="1423" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1427" class="Keyword">where</a>
  <a id="1435" class="Keyword">constructor</a> <a id="mkMatch"></a><a id="1447" href="Text.Regex.String.Unsafe.html#1447" class="InductiveConstructor">mkMatch</a>
  <a id="1457" class="Keyword">field</a>
    <a id="Match.string"></a><a id="1467" href="Text.Regex.String.Unsafe.html#1467" class="Field">string</a>  <a id="1475" class="Symbol">:</a> <a id="1477" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
    <a id="Match.match"></a><a id="1488" href="Text.Regex.String.Unsafe.html#1488" class="Field">match</a>   <a id="1496" class="Symbol">:</a> <a id="1498" href="Text.Regex.String.Unsafe.html#1467" class="Field">string</a> <a id="1505" href="Text.Regex.String.Unsafe.html#966" class="Function Operator">∈</a> <a id="1507" href="Text.Regex.Base.html#1673" class="Field">Regex.expression</a> <a id="1524" href="Text.Regex.String.Unsafe.html#1410" class="Bound">e</a>
    <a id="Match.related"></a><a id="1530" href="Text.Regex.String.Unsafe.html#1530" class="Field">related</a> <a id="1538" class="Symbol">:</a> <a id="1540" href="Text.Regex.String.Unsafe.html#1190" class="Function">Span</a> <a id="1545" href="Text.Regex.String.Unsafe.html#1410" class="Bound">e</a> <a id="1547" href="Text.Regex.String.Unsafe.html#1467" class="Field">string</a> <a id="1554" href="Text.Regex.String.Unsafe.html#1395" class="Bound">str</a>
<a id="1558" class="Keyword">open</a> <a id="1563" href="Text.Regex.String.Unsafe.html#1388" class="Module">Match</a> <a id="1569" class="Keyword">public</a>

<a id="search"></a><a id="1577" href="Text.Regex.String.Unsafe.html#1577" class="Function">search</a> <a id="1584" class="Symbol">:</a> <a id="1586" href="Relation.Binary.Definitions.html#4584" class="Function">Decidable</a> <a id="1596" href="Text.Regex.String.Unsafe.html#1388" class="Record">Match</a>
<a id="1602" href="Text.Regex.String.Unsafe.html#1577" class="Function">search</a> <a id="1609" href="Text.Regex.String.Unsafe.html#1609" class="Bound">str</a> <a id="1613" href="Text.Regex.String.Unsafe.html#1613" class="Bound">e</a> <a id="1615" class="Symbol">=</a> <a id="1617" href="Relation.Nullary.Decidable.Core.html#3645" class="Function">map′</a> <a id="1622" href="Text.Regex.String.Unsafe.html#1711" class="Function">from</a> <a id="1627" href="Text.Regex.String.Unsafe.html#2011" class="Function">to</a> <a id="1630" class="Symbol">(</a><a id="1631" href="Text.Regex.Search.html#9075" class="Function">Regex.search</a> <a id="1644" href="Text.Regex.String.Unsafe.html#1662" class="Function">input</a> <a id="1650" href="Text.Regex.String.Unsafe.html#1613" class="Bound">e</a><a id="1651" class="Symbol">)</a> <a id="1653" class="Keyword">where</a>

  <a id="1662" href="Text.Regex.String.Unsafe.html#1662" class="Function">input</a> <a id="1668" class="Symbol">=</a> <a id="1670" href="Data.String.Base.html#1502" class="Primitive">toList</a> <a id="1677" href="Text.Regex.String.Unsafe.html#1609" class="Bound">str</a>
  <a id="1683" href="Text.Regex.String.Unsafe.html#1683" class="Function">exp</a> <a id="1687" class="Symbol">=</a> <a id="1689" href="Text.Regex.Base.html#1673" class="Field">Regex.expression</a> <a id="1706" href="Text.Regex.String.Unsafe.html#1613" class="Bound">e</a>

  <a id="1711" href="Text.Regex.String.Unsafe.html#1711" class="Function">from</a> <a id="1716" class="Symbol">:</a> <a id="1718" href="Text.Regex.Search.html#2515" class="Record">Regex.Match</a> <a id="1730" class="Symbol">(</a><a id="1731" href="Text.Regex.Search.html#1876" class="Function">Regex.Span</a> <a id="1742" href="Text.Regex.String.Unsafe.html#1613" class="Bound">e</a> <a id="1744" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="1747" class="Symbol">)</a> <a id="1749" href="Text.Regex.String.Unsafe.html#1662" class="Function">input</a> <a id="1755" href="Text.Regex.String.Unsafe.html#1683" class="Function">exp</a> <a id="1759" class="Symbol">→</a> <a id="1761" href="Text.Regex.String.Unsafe.html#1388" class="Record">Match</a> <a id="1767" href="Text.Regex.String.Unsafe.html#1609" class="Bound">str</a> <a id="1771" href="Text.Regex.String.Unsafe.html#1613" class="Bound">e</a>
  <a id="1775" href="Text.Regex.String.Unsafe.html#1711" class="Function">from</a> <a id="1780" class="Symbol">(</a><a id="1781" href="Text.Regex.Search.html#2621" class="InductiveConstructor">Regex.mkMatch</a> <a id="1795" href="Text.Regex.String.Unsafe.html#1795" class="Bound">list</a> <a id="1800" href="Text.Regex.String.Unsafe.html#1800" class="Bound">match</a> <a id="1806" href="Text.Regex.String.Unsafe.html#1806" class="Bound">related</a><a id="1813" class="Symbol">)</a> <a id="1815" class="Symbol">=</a>
    <a id="1821" class="Keyword">let</a> <a id="1825" href="Text.Regex.String.Unsafe.html#1825" class="Bound">eq</a> <a id="1828" class="Symbol">=</a> <a id="1830" href="Relation.Binary.PropositionalEquality.Core.html#1693" class="Function">sym</a> <a id="1834" class="Symbol">(</a><a id="1835" href="Data.String.Unsafe.html#989" class="Function">Stringₚ.toList∘fromList</a> <a id="1859" href="Text.Regex.String.Unsafe.html#1795" class="Bound">list</a><a id="1863" class="Symbol">)</a> <a id="1865" class="Keyword">in</a>
    <a id="1872" href="Text.Regex.String.Unsafe.html#1447" class="InductiveConstructor">mkMatch</a> <a id="1880" class="Symbol">(</a><a id="1881" href="Data.String.Base.html#1535" class="Primitive">fromList</a> <a id="1890" href="Text.Regex.String.Unsafe.html#1795" class="Bound">list</a><a id="1894" class="Symbol">)</a>
            <a id="1908" class="Symbol">(</a><a id="1909" href="Relation.Binary.PropositionalEquality.Core.html#1789" class="Function">subst</a> <a id="1915" class="Symbol">(</a><a id="1916" href="Text.Regex.Base.html#2371" class="Datatype Operator">Regex._∈</a> <a id="1925" href="Text.Regex.String.Unsafe.html#1683" class="Function">exp</a><a id="1928" class="Symbol">)</a> <a id="1930" href="Text.Regex.String.Unsafe.html#1825" class="Bound">eq</a> <a id="1933" href="Text.Regex.String.Unsafe.html#1800" class="Bound">match</a><a id="1938" class="Symbol">)</a>
            <a id="1952" class="Symbol">(</a><a id="1953" href="Relation.Binary.PropositionalEquality.Core.html#1789" class="Function">subst</a> <a id="1959" class="Symbol">(λ</a> <a id="1962" href="Text.Regex.String.Unsafe.html#1962" class="Bound">str</a> <a id="1966" class="Symbol">→</a> <a id="1968" href="Text.Regex.Search.html#1876" class="Function">Regex.Span</a> <a id="1979" href="Text.Regex.String.Unsafe.html#1613" class="Bound">e</a> <a id="1981" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a> <a id="1985" href="Text.Regex.String.Unsafe.html#1962" class="Bound">str</a> <a id="1989" href="Text.Regex.String.Unsafe.html#1662" class="Function">input</a><a id="1994" class="Symbol">)</a> <a id="1996" href="Text.Regex.String.Unsafe.html#1825" class="Bound">eq</a> <a id="1999" href="Text.Regex.String.Unsafe.html#1806" class="Bound">related</a><a id="2006" class="Symbol">)</a>

  <a id="2011" href="Text.Regex.String.Unsafe.html#2011" class="Function">to</a> <a id="2014" class="Symbol">:</a> <a id="2016" href="Text.Regex.String.Unsafe.html#1388" class="Record">Match</a> <a id="2022" href="Text.Regex.String.Unsafe.html#1609" class="Bound">str</a> <a id="2026" href="Text.Regex.String.Unsafe.html#1613" class="Bound">e</a> <a id="2028" class="Symbol">→</a> <a id="2030" href="Text.Regex.Search.html#2515" class="Record">Regex.Match</a> <a id="2042" class="Symbol">(</a><a id="2043" href="Text.Regex.Search.html#1876" class="Function">Regex.Span</a> <a id="2054" href="Text.Regex.String.Unsafe.html#1613" class="Bound">e</a> <a id="2056" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="2059" class="Symbol">)</a> <a id="2061" href="Text.Regex.String.Unsafe.html#1662" class="Function">input</a> <a id="2067" href="Text.Regex.String.Unsafe.html#1683" class="Function">exp</a>
  <a id="2073" href="Text.Regex.String.Unsafe.html#2011" class="Function">to</a> <a id="2076" class="Symbol">(</a><a id="2077" href="Text.Regex.String.Unsafe.html#1447" class="InductiveConstructor">mkMatch</a> <a id="2085" href="Text.Regex.String.Unsafe.html#2085" class="Bound">string</a> <a id="2092" href="Text.Regex.String.Unsafe.html#2092" class="Bound">match</a> <a id="2098" href="Text.Regex.String.Unsafe.html#2098" class="Bound">related</a><a id="2105" class="Symbol">)</a> <a id="2107" class="Symbol">=</a>
    <a id="2113" href="Text.Regex.Search.html#2621" class="InductiveConstructor">Regex.mkMatch</a> <a id="2127" class="Symbol">(</a><a id="2128" href="Data.String.Base.html#1502" class="Primitive">toList</a> <a id="2135" href="Text.Regex.String.Unsafe.html#2085" class="Bound">string</a><a id="2141" class="Symbol">)</a> <a id="2143" href="Text.Regex.String.Unsafe.html#2092" class="Bound">match</a> <a id="2149" href="Text.Regex.String.Unsafe.html#2098" class="Bound">related</a>
</pre></body></html>