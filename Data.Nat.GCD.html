<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Nat.GCD</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Greatest common divisor</a>
<a id="133" class="Comment">------------------------------------------------------------------------</a>

<a id="207" class="Symbol">{-#</a> <a id="211" class="Keyword">OPTIONS</a> <a id="219" class="Pragma">--cubical-compatible</a> <a id="240" class="Pragma">--safe</a> <a id="247" class="Symbol">#-}</a>

<a id="252" class="Keyword">module</a> <a id="259" href="Data.Nat.GCD.html" class="Module">Data.Nat.GCD</a> <a id="272" class="Keyword">where</a>

<a id="279" class="Keyword">open</a> <a id="284" class="Keyword">import</a> <a id="291" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="305" class="Keyword">open</a> <a id="310" class="Keyword">import</a> <a id="317" href="Data.Nat.Divisibility.html" class="Module">Data.Nat.Divisibility</a>
<a id="339" class="Keyword">open</a> <a id="344" class="Keyword">import</a> <a id="351" href="Data.Nat.DivMod.html" class="Module">Data.Nat.DivMod</a>
<a id="367" class="Keyword">open</a> <a id="372" class="Keyword">import</a> <a id="379" href="Data.Nat.GCD.Lemmas.html" class="Module">Data.Nat.GCD.Lemmas</a>
<a id="399" class="Keyword">open</a> <a id="404" class="Keyword">import</a> <a id="411" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a>
<a id="431" class="Keyword">open</a> <a id="436" class="Keyword">import</a> <a id="443" href="Data.Nat.Induction.html" class="Module">Data.Nat.Induction</a>
  <a id="464" class="Keyword">using</a> <a id="470" class="Symbol">(</a><a id="471" href="Induction.WellFounded.html#1182" class="Datatype">Acc</a><a id="474" class="Symbol">;</a> <a id="476" href="Induction.WellFounded.html#1244" class="InductiveConstructor">acc</a><a id="479" class="Symbol">;</a> <a id="481" href="Data.Nat.Induction.html#1536" class="Function">&lt;′-Rec</a><a id="487" class="Symbol">;</a> <a id="489" href="Data.Nat.Induction.html#1949" class="Function">&lt;′-recBuilder</a><a id="502" class="Symbol">;</a> <a id="504" href="Data.Nat.Induction.html#2734" class="Function">&lt;-wellFounded-fast</a><a id="522" class="Symbol">)</a>
<a id="524" class="Keyword">open</a> <a id="529" class="Keyword">import</a> <a id="536" href="Data.Product.Base.html" class="Module">Data.Product.Base</a>
  <a id="556" class="Keyword">using</a> <a id="562" class="Symbol">(</a><a id="563" href="Data.Product.Base.html#1618" class="Function Operator">_×_</a><a id="566" class="Symbol">;</a> <a id="568" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">_,_</a><a id="571" class="Symbol">;</a> <a id="573" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="578" class="Symbol">;</a> <a id="580" href="Data.Product.Base.html#636" class="Field">proj₁</a><a id="585" class="Symbol">;</a> <a id="587" href="Data.Product.Base.html#5054" class="Function">swap</a><a id="591" class="Symbol">;</a> <a id="593" href="Data.Product.Base.html#4571" class="Function">uncurry′</a><a id="601" class="Symbol">;</a> <a id="603" href="Data.Product.Base.html#852" class="Function">∃</a><a id="604" class="Symbol">;</a> <a id="606" href="Data.Product.Base.html#2173" class="Function">map</a><a id="609" class="Symbol">)</a>
<a id="611" class="Keyword">open</a> <a id="616" class="Keyword">import</a> <a id="623" href="Data.Sum.Base.html" class="Module">Data.Sum.Base</a> <a id="637" class="Symbol">as</a> <a id="640" class="Module">Sum</a> <a id="644" class="Keyword">using</a> <a id="650" class="Symbol">(</a><a id="651" href="Data.Sum.Base.html#625" class="Datatype Operator">_⊎_</a><a id="654" class="Symbol">;</a> <a id="656" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a><a id="660" class="Symbol">;</a> <a id="662" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a><a id="666" class="Symbol">)</a>
<a id="668" class="Keyword">open</a> <a id="673" class="Keyword">import</a> <a id="680" href="Function.Base.html" class="Module">Function.Base</a> <a id="694" class="Keyword">using</a> <a id="700" class="Symbol">(</a><a id="701" href="Function.Base.html#1974" class="Function Operator">_$_</a><a id="704" class="Symbol">;</a> <a id="706" href="Function.Base.html#1115" class="Function Operator">_∘_</a><a id="709" class="Symbol">)</a>
<a id="711" class="Keyword">open</a> <a id="716" class="Keyword">import</a> <a id="723" href="Induction.html" class="Module">Induction</a> <a id="733" class="Keyword">using</a> <a id="739" class="Symbol">(</a><a id="740" href="Induction.html#1337" class="Function">build</a><a id="745" class="Symbol">)</a>
<a id="747" class="Keyword">open</a> <a id="752" class="Keyword">import</a> <a id="759" href="Induction.Lexicographic.html" class="Module">Induction.Lexicographic</a> <a id="783" class="Keyword">using</a> <a id="789" class="Symbol">(</a><a id="790" href="Induction.Lexicographic.html#791" class="Function Operator">_⊗_</a><a id="793" class="Symbol">;</a> <a id="795" href="Induction.Lexicographic.html#1764" class="Function Operator">[_⊗_]</a><a id="800" class="Symbol">)</a>
<a id="802" class="Keyword">open</a> <a id="807" class="Keyword">import</a> <a id="814" href="Relation.Binary.html" class="Module">Relation.Binary</a>
<a id="830" class="Keyword">open</a> <a id="835" class="Keyword">import</a> <a id="842" href="Relation.Binary.PropositionalEquality.Core.html" class="Module">Relation.Binary.PropositionalEquality.Core</a> <a id="885" class="Symbol">as</a> <a id="888" class="Module">P</a>
  <a id="892" class="Keyword">using</a> <a id="898" class="Symbol">(</a><a id="899" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">_≡_</a><a id="902" class="Symbol">;</a> <a id="904" href="Relation.Binary.PropositionalEquality.Core.html#858" class="Function Operator">_≢_</a><a id="907" class="Symbol">;</a> <a id="909" href="Relation.Binary.PropositionalEquality.Core.html#1808" class="Function">subst</a><a id="914" class="Symbol">;</a> <a id="916" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a><a id="920" class="Symbol">)</a>
<a id="922" class="Keyword">open</a> <a id="927" class="Keyword">import</a> <a id="934" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="961" class="Keyword">using</a> <a id="967" class="Symbol">(</a><a id="968" href="Relation.Nullary.Decidable.Core.html#1490" class="Record">Dec</a><a id="971" class="Symbol">)</a>
<a id="973" class="Keyword">open</a> <a id="978" class="Keyword">import</a> <a id="985" href="Relation.Nullary.Negation.html" class="Module">Relation.Nullary.Negation</a> <a id="1011" class="Keyword">using</a> <a id="1017" class="Symbol">(</a><a id="1018" href="Relation.Nullary.Negation.Core.html#1276" class="Function">contradiction</a><a id="1031" class="Symbol">)</a>
<a id="1033" class="Keyword">import</a> <a id="1040" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="1067" class="Symbol">as</a> <a id="1070" class="Module">Dec</a>

<a id="1075" class="Keyword">open</a> <a id="1080" class="Keyword">import</a> <a id="1087" href="Algebra.Definitions.html" class="Module">Algebra.Definitions</a> <a id="1107" class="Symbol">{</a><a id="1108" class="Argument">A</a> <a id="1110" class="Symbol">=</a> <a id="1112" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="1113" class="Symbol">}</a> <a id="1115" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">_≡_</a> as <a id="Algebra"></a><a id="1122" href="Data.Nat.GCD.html#1122" class="Module">Algebra</a>
  <a id="1132" class="Keyword">using</a> <a id="1138" class="Symbol">(</a><a id="1139" href="Algebra.Definitions.html#1548" class="Function">Associative</a><a id="1150" class="Symbol">;</a> <a id="1152" href="Algebra.Definitions.html#1635" class="Function">Commutative</a><a id="1163" class="Symbol">;</a> <a id="1165" href="Algebra.Definitions.html#1708" class="Function">LeftIdentity</a><a id="1177" class="Symbol">;</a> <a id="1179" href="Algebra.Definitions.html#1781" class="Function">RightIdentity</a><a id="1192" class="Symbol">;</a> <a id="1194" href="Algebra.Definitions.html#1942" class="Function">LeftZero</a><a id="1202" class="Symbol">;</a> <a id="1204" href="Algebra.Definitions.html#2007" class="Function">RightZero</a><a id="1213" class="Symbol">;</a> <a id="1215" href="Algebra.Definitions.html#2074" class="Function">Zero</a><a id="1219" class="Symbol">)</a>

<a id="1222" class="Comment">------------------------------------------------------------------------</a>
<a id="1295" class="Comment">-- Definition</a>

<a id="1310" class="Comment">-- Calculated via Euclid&#39;s algorithm. In order to show progress,</a>
<a id="1375" class="Comment">-- avoiding the initial step where the first argument may increase, it</a>
<a id="1446" class="Comment">-- is necessary to first define a version `gcd′` which assumes that the</a>
<a id="1518" class="Comment">-- second argument is strictly smaller than the first. The full `gcd`</a>
<a id="1588" class="Comment">-- function then compares the two arguments and applies `gcd′`</a>
<a id="1651" class="Comment">-- accordingly.</a>

<a id="gcd′"></a><a id="1668" href="Data.Nat.GCD.html#1668" class="Function">gcd′</a> <a id="1673" class="Symbol">:</a> <a id="1675" class="Symbol">∀</a> <a id="1677" href="Data.Nat.GCD.html#1677" class="Bound">m</a> <a id="1679" href="Data.Nat.GCD.html#1679" class="Bound">n</a> <a id="1681" class="Symbol">→</a> <a id="1683" href="Induction.WellFounded.html#1182" class="Datatype">Acc</a> <a id="1687" href="Data.Nat.Base.html#1654" class="Function Operator">_&lt;_</a> <a id="1691" href="Data.Nat.GCD.html#1677" class="Bound">m</a> <a id="1693" class="Symbol">→</a> <a id="1695" href="Data.Nat.GCD.html#1679" class="Bound">n</a> <a id="1697" href="Data.Nat.Base.html#1654" class="Function Operator">&lt;</a> <a id="1699" href="Data.Nat.GCD.html#1677" class="Bound">m</a> <a id="1701" class="Symbol">→</a> <a id="1703" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
<a id="1705" href="Data.Nat.GCD.html#1668" class="Function">gcd′</a> <a id="1710" href="Data.Nat.GCD.html#1710" class="Bound">m</a> <a id="1712" href="Agda.Builtin.Nat.html#204" class="InductiveConstructor">zero</a>      <a id="1722" class="Symbol">_</a>         <a id="1732" class="Symbol">_</a>   <a id="1736" class="Symbol">=</a> <a id="1738" href="Data.Nat.GCD.html#1710" class="Bound">m</a>
<a id="1740" href="Data.Nat.GCD.html#1668" class="Function">gcd′</a> <a id="1745" href="Data.Nat.GCD.html#1745" class="Bound">m</a> <a id="1747" href="Data.Nat.GCD.html#1747" class="Bound">n</a><a id="1748" class="Symbol">@(</a><a id="1750" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="1754" class="Symbol">_)</a> <a id="1757" class="Symbol">(</a><a id="1758" href="Induction.WellFounded.html#1244" class="InductiveConstructor">acc</a> <a id="1762" href="Data.Nat.GCD.html#1762" class="Bound">rec</a><a id="1765" class="Symbol">)</a> <a id="1767" href="Data.Nat.GCD.html#1767" class="Bound">n&lt;m</a> <a id="1771" class="Symbol">=</a> <a id="1773" href="Data.Nat.GCD.html#1668" class="Function">gcd′</a> <a id="1778" href="Data.Nat.GCD.html#1747" class="Bound">n</a> <a id="1780" class="Symbol">(</a><a id="1781" href="Data.Nat.GCD.html#1745" class="Bound">m</a> <a id="1783" href="Data.Nat.Base.html#5293" class="Function Operator">%</a> <a id="1785" href="Data.Nat.GCD.html#1747" class="Bound">n</a><a id="1786" class="Symbol">)</a> <a id="1788" class="Symbol">(</a><a id="1789" href="Data.Nat.GCD.html#1762" class="Bound">rec</a> <a id="1793" class="Symbol">_</a> <a id="1795" href="Data.Nat.GCD.html#1767" class="Bound">n&lt;m</a><a id="1798" class="Symbol">)</a> <a id="1800" class="Symbol">(</a><a id="1801" href="Data.Nat.DivMod.html#3955" class="Function">m%n&lt;n</a> <a id="1807" href="Data.Nat.GCD.html#1745" class="Bound">m</a> <a id="1809" href="Data.Nat.GCD.html#1747" class="Bound">n</a><a id="1810" class="Symbol">)</a>

<a id="gcd"></a><a id="1813" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="1817" class="Symbol">:</a> <a id="1819" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="1821" class="Symbol">→</a> <a id="1823" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="1825" class="Symbol">→</a> <a id="1827" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
<a id="1829" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="1833" href="Data.Nat.GCD.html#1833" class="Bound">m</a> <a id="1835" href="Data.Nat.GCD.html#1835" class="Bound">n</a> <a id="1837" class="Keyword">with</a> <a id="1842" href="Data.Nat.Properties.html#10339" class="Function">&lt;-cmp</a> <a id="1848" href="Data.Nat.GCD.html#1833" class="Bound">m</a> <a id="1850" href="Data.Nat.GCD.html#1835" class="Bound">n</a>
<a id="1852" class="Symbol">...</a> <a id="1856" class="Symbol">|</a> <a id="1858" href="Relation.Binary.Definitions.html#2857" class="InductiveConstructor">tri&lt;</a> <a id="1863" href="Data.Nat.GCD.html#1863" class="Bound">m&lt;n</a> <a id="1867" class="Symbol">_</a> <a id="1869" class="Symbol">_</a> <a id="1871" class="Symbol">=</a> <a id="1873" href="Data.Nat.GCD.html#1668" class="Function">gcd′</a> <a id="1878" class="Bound">n</a> <a id="1880" class="Bound">m</a> <a id="1882" class="Symbol">(</a><a id="1883" href="Data.Nat.Induction.html#2734" class="Function">&lt;-wellFounded-fast</a> <a id="1902" class="Bound">n</a><a id="1903" class="Symbol">)</a> <a id="1905" href="Data.Nat.GCD.html#1863" class="Bound">m&lt;n</a>
<a id="1909" class="Symbol">...</a> <a id="1913" class="Symbol">|</a> <a id="1915" href="Relation.Binary.Definitions.html#2911" class="InductiveConstructor">tri≈</a> <a id="1920" class="Symbol">_</a> <a id="1922" class="Symbol">_</a> <a id="1924" class="Symbol">_</a>   <a id="1928" class="Symbol">=</a> <a id="1930" class="Bound">m</a>
<a id="1932" class="Symbol">...</a> <a id="1936" class="Symbol">|</a> <a id="1938" href="Relation.Binary.Definitions.html#2965" class="InductiveConstructor">tri&gt;</a> <a id="1943" class="Symbol">_</a> <a id="1945" class="Symbol">_</a> <a id="1947" href="Data.Nat.GCD.html#1947" class="Bound">n&lt;m</a> <a id="1951" class="Symbol">=</a> <a id="1953" href="Data.Nat.GCD.html#1668" class="Function">gcd′</a> <a id="1958" class="Bound">m</a> <a id="1960" class="Bound">n</a> <a id="1962" class="Symbol">(</a><a id="1963" href="Data.Nat.Induction.html#2734" class="Function">&lt;-wellFounded-fast</a> <a id="1982" class="Bound">m</a><a id="1983" class="Symbol">)</a> <a id="1985" href="Data.Nat.GCD.html#1947" class="Bound">n&lt;m</a>

<a id="1990" class="Comment">------------------------------------------------------------------------</a>
<a id="2063" class="Comment">-- Core properties of gcd′</a>

<a id="gcd′[m,n]∣m,n"></a><a id="2091" href="Data.Nat.GCD.html#2091" class="Function">gcd′[m,n]∣m,n</a> <a id="2105" class="Symbol">:</a> <a id="2107" class="Symbol">∀</a> <a id="2109" class="Symbol">{</a><a id="2110" href="Data.Nat.GCD.html#2110" class="Bound">m</a> <a id="2112" href="Data.Nat.GCD.html#2112" class="Bound">n</a><a id="2113" class="Symbol">}</a> <a id="2115" href="Data.Nat.GCD.html#2115" class="Bound">rec</a> <a id="2119" href="Data.Nat.GCD.html#2119" class="Bound">n&lt;m</a> <a id="2123" class="Symbol">→</a> <a id="2125" href="Data.Nat.GCD.html#1668" class="Function">gcd′</a> <a id="2130" href="Data.Nat.GCD.html#2110" class="Bound">m</a> <a id="2132" href="Data.Nat.GCD.html#2112" class="Bound">n</a> <a id="2134" href="Data.Nat.GCD.html#2115" class="Bound">rec</a> <a id="2138" href="Data.Nat.GCD.html#2119" class="Bound">n&lt;m</a> <a id="2142" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="2144" href="Data.Nat.GCD.html#2110" class="Bound">m</a> <a id="2146" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2148" href="Data.Nat.GCD.html#1668" class="Function">gcd′</a> <a id="2153" href="Data.Nat.GCD.html#2110" class="Bound">m</a> <a id="2155" href="Data.Nat.GCD.html#2112" class="Bound">n</a> <a id="2157" href="Data.Nat.GCD.html#2115" class="Bound">rec</a> <a id="2161" href="Data.Nat.GCD.html#2119" class="Bound">n&lt;m</a> <a id="2165" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="2167" href="Data.Nat.GCD.html#2112" class="Bound">n</a>
<a id="2169" href="Data.Nat.GCD.html#2091" class="Function">gcd′[m,n]∣m,n</a> <a id="2183" class="Symbol">{</a><a id="2184" href="Data.Nat.GCD.html#2184" class="Bound">m</a><a id="2185" class="Symbol">}</a> <a id="2187" class="Symbol">{</a><a id="2188" href="Agda.Builtin.Nat.html#204" class="InductiveConstructor">zero</a><a id="2192" class="Symbol">}</a>  <a id="2195" href="Data.Nat.GCD.html#2195" class="Bound">rec</a>       <a id="2205" href="Data.Nat.GCD.html#2205" class="Bound">n&lt;m</a> <a id="2209" class="Symbol">=</a> <a id="2211" href="Data.Nat.Divisibility.html#2304" class="Function">∣-refl</a> <a id="2218" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2220" href="Data.Nat.GCD.html#2184" class="Bound">m</a> <a id="2222" href="Data.Nat.Divisibility.html#3889" class="Function Operator">∣0</a>
<a id="2225" href="Data.Nat.GCD.html#2091" class="Function">gcd′[m,n]∣m,n</a> <a id="2239" class="Symbol">{</a><a id="2240" href="Data.Nat.GCD.html#2240" class="Bound">m</a><a id="2241" class="Symbol">}</a> <a id="2243" class="Symbol">{</a><a id="2244" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="2248" href="Data.Nat.GCD.html#2248" class="Bound">n</a><a id="2249" class="Symbol">}</a> <a id="2251" class="Symbol">(</a><a id="2252" href="Induction.WellFounded.html#1244" class="InductiveConstructor">acc</a> <a id="2256" href="Data.Nat.GCD.html#2256" class="Bound">rec</a><a id="2259" class="Symbol">)</a> <a id="2261" href="Data.Nat.GCD.html#2261" class="Bound">n&lt;m</a>
  <a id="2267" class="Keyword">with</a> <a id="2272" href="Data.Nat.GCD.html#2272" class="Bound">gcd∣n</a> <a id="2278" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2280" href="Data.Nat.GCD.html#2280" class="Bound">gcd∣m%n</a> ← <a id="2290" href="Data.Nat.GCD.html#2091" class="Function">gcd′[m,n]∣m,n</a> <a id="2304" class="Symbol">(</a><a id="2305" href="Data.Nat.GCD.html#2256" class="Bound">rec</a> <a id="2309" class="Symbol">_</a> <a id="2311" href="Data.Nat.GCD.html#2261" class="Bound">n&lt;m</a><a id="2314" class="Symbol">)</a> <a id="2316" class="Symbol">(</a><a id="2317" href="Data.Nat.DivMod.html#3955" class="Function">m%n&lt;n</a> <a id="2323" href="Data.Nat.GCD.html#2240" class="Bound">m</a> <a id="2325" class="Symbol">(</a><a id="2326" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="2330" href="Data.Nat.GCD.html#2248" class="Bound">n</a><a id="2331" class="Symbol">))</a>
  <a id="2336" class="Symbol">=</a> <a id="2338" href="Data.Nat.Divisibility.html#8655" class="Function">∣n∣m%n⇒∣m</a> <a id="2348" href="Data.Nat.GCD.html#2272" class="Bound">gcd∣n</a> <a id="2354" href="Data.Nat.GCD.html#2280" class="Bound">gcd∣m%n</a> <a id="2362" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2364" href="Data.Nat.GCD.html#2272" class="Bound">gcd∣n</a>

<a id="gcd′-greatest"></a><a id="2371" href="Data.Nat.GCD.html#2371" class="Function">gcd′-greatest</a> <a id="2385" class="Symbol">:</a> <a id="2387" class="Symbol">∀</a> <a id="2389" class="Symbol">{</a><a id="2390" href="Data.Nat.GCD.html#2390" class="Bound">m</a> <a id="2392" href="Data.Nat.GCD.html#2392" class="Bound">n</a> <a id="2394" href="Data.Nat.GCD.html#2394" class="Bound">c</a><a id="2395" class="Symbol">}</a> <a id="2397" href="Data.Nat.GCD.html#2397" class="Bound">rec</a> <a id="2401" href="Data.Nat.GCD.html#2401" class="Bound">n&lt;m</a> <a id="2405" class="Symbol">→</a> <a id="2407" href="Data.Nat.GCD.html#2394" class="Bound">c</a> <a id="2409" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="2411" href="Data.Nat.GCD.html#2390" class="Bound">m</a> <a id="2413" class="Symbol">→</a> <a id="2415" href="Data.Nat.GCD.html#2394" class="Bound">c</a> <a id="2417" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="2419" href="Data.Nat.GCD.html#2392" class="Bound">n</a> <a id="2421" class="Symbol">→</a> <a id="2423" href="Data.Nat.GCD.html#2394" class="Bound">c</a> <a id="2425" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="2427" href="Data.Nat.GCD.html#1668" class="Function">gcd′</a> <a id="2432" href="Data.Nat.GCD.html#2390" class="Bound">m</a> <a id="2434" href="Data.Nat.GCD.html#2392" class="Bound">n</a> <a id="2436" href="Data.Nat.GCD.html#2397" class="Bound">rec</a> <a id="2440" href="Data.Nat.GCD.html#2401" class="Bound">n&lt;m</a>
<a id="2444" href="Data.Nat.GCD.html#2371" class="Function">gcd′-greatest</a> <a id="2458" class="Symbol">{</a><a id="2459" href="Data.Nat.GCD.html#2459" class="Bound">m</a><a id="2460" class="Symbol">}</a> <a id="2462" class="Symbol">{</a><a id="2463" href="Agda.Builtin.Nat.html#204" class="InductiveConstructor">zero</a><a id="2467" class="Symbol">}</a>  <a id="2470" href="Data.Nat.GCD.html#2470" class="Bound">rec</a>       <a id="2480" href="Data.Nat.GCD.html#2480" class="Bound">n&lt;m</a> <a id="2484" href="Data.Nat.GCD.html#2484" class="Bound">c∣m</a> <a id="2488" href="Data.Nat.GCD.html#2488" class="Bound">c∣n</a> <a id="2492" class="Symbol">=</a> <a id="2494" href="Data.Nat.GCD.html#2484" class="Bound">c∣m</a>
<a id="2498" href="Data.Nat.GCD.html#2371" class="Function">gcd′-greatest</a> <a id="2512" class="Symbol">{</a><a id="2513" href="Data.Nat.GCD.html#2513" class="Bound">m</a><a id="2514" class="Symbol">}</a> <a id="2516" class="Symbol">{</a><a id="2517" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="2521" href="Data.Nat.GCD.html#2521" class="Bound">n</a><a id="2522" class="Symbol">}</a> <a id="2524" class="Symbol">(</a><a id="2525" href="Induction.WellFounded.html#1244" class="InductiveConstructor">acc</a> <a id="2529" href="Data.Nat.GCD.html#2529" class="Bound">rec</a><a id="2532" class="Symbol">)</a> <a id="2534" href="Data.Nat.GCD.html#2534" class="Bound">n&lt;m</a> <a id="2538" href="Data.Nat.GCD.html#2538" class="Bound">c∣m</a> <a id="2542" href="Data.Nat.GCD.html#2542" class="Bound">c∣n</a> <a id="2546" class="Symbol">=</a>
  <a id="2550" href="Data.Nat.GCD.html#2371" class="Function">gcd′-greatest</a> <a id="2564" class="Symbol">(</a><a id="2565" href="Data.Nat.GCD.html#2529" class="Bound">rec</a> <a id="2569" class="Symbol">_</a> <a id="2571" href="Data.Nat.GCD.html#2534" class="Bound">n&lt;m</a><a id="2574" class="Symbol">)</a> <a id="2576" class="Symbol">(</a><a id="2577" href="Data.Nat.DivMod.html#3955" class="Function">m%n&lt;n</a> <a id="2583" href="Data.Nat.GCD.html#2513" class="Bound">m</a> <a id="2585" class="Symbol">(</a><a id="2586" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="2590" href="Data.Nat.GCD.html#2521" class="Bound">n</a><a id="2591" class="Symbol">))</a> <a id="2594" href="Data.Nat.GCD.html#2542" class="Bound">c∣n</a> <a id="2598" class="Symbol">(</a><a id="2599" href="Data.Nat.Divisibility.html#9188" class="Function">%-presˡ-∣</a> <a id="2609" href="Data.Nat.GCD.html#2538" class="Bound">c∣m</a> <a id="2613" href="Data.Nat.GCD.html#2542" class="Bound">c∣n</a><a id="2616" class="Symbol">)</a>

<a id="2619" class="Comment">------------------------------------------------------------------------</a>
<a id="2692" class="Comment">-- Core properties of gcd</a>

<a id="gcd[m,n]∣m"></a><a id="2719" href="Data.Nat.GCD.html#2719" class="Function">gcd[m,n]∣m</a> <a id="2730" class="Symbol">:</a> <a id="2732" class="Symbol">∀</a> <a id="2734" href="Data.Nat.GCD.html#2734" class="Bound">m</a> <a id="2736" href="Data.Nat.GCD.html#2736" class="Bound">n</a> <a id="2738" class="Symbol">→</a> <a id="2740" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="2744" href="Data.Nat.GCD.html#2734" class="Bound">m</a> <a id="2746" href="Data.Nat.GCD.html#2736" class="Bound">n</a> <a id="2748" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="2750" href="Data.Nat.GCD.html#2734" class="Bound">m</a>
<a id="2752" href="Data.Nat.GCD.html#2719" class="Function">gcd[m,n]∣m</a> <a id="2763" href="Data.Nat.GCD.html#2763" class="Bound">m</a> <a id="2765" href="Data.Nat.GCD.html#2765" class="Bound">n</a> <a id="2767" class="Keyword">with</a> <a id="2772" href="Data.Nat.Properties.html#10339" class="Function">&lt;-cmp</a> <a id="2778" href="Data.Nat.GCD.html#2763" class="Bound">m</a> <a id="2780" href="Data.Nat.GCD.html#2765" class="Bound">n</a>
<a id="2782" class="Symbol">...</a> <a id="2786" class="Symbol">|</a> <a id="2788" href="Relation.Binary.Definitions.html#2857" class="InductiveConstructor">tri&lt;</a> <a id="2793" href="Data.Nat.GCD.html#2793" class="Bound">n&lt;m</a> <a id="2797" class="Symbol">_</a> <a id="2799" class="Symbol">_</a> <a id="2801" class="Symbol">=</a> <a id="2803" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="2809" class="Symbol">(</a><a id="2810" href="Data.Nat.GCD.html#2091" class="Function">gcd′[m,n]∣m,n</a> <a id="2824" class="Symbol">{</a><a id="2825" class="Bound">n</a><a id="2826" class="Symbol">}</a> <a id="2828" class="Symbol">{</a><a id="2829" class="Bound">m</a><a id="2830" class="Symbol">}</a> <a id="2832" class="Symbol">_</a> <a id="2834" class="Symbol">_)</a>
<a id="2837" class="Symbol">...</a> <a id="2841" class="Symbol">|</a> <a id="2843" href="Relation.Binary.Definitions.html#2911" class="InductiveConstructor">tri≈</a> <a id="2848" class="Symbol">_</a> <a id="2850" class="Symbol">_</a> <a id="2852" class="Symbol">_</a>   <a id="2856" class="Symbol">=</a> <a id="2858" href="Data.Nat.Divisibility.html#2304" class="Function">∣-refl</a>
<a id="2865" class="Symbol">...</a> <a id="2869" class="Symbol">|</a> <a id="2871" href="Relation.Binary.Definitions.html#2965" class="InductiveConstructor">tri&gt;</a> <a id="2876" class="Symbol">_</a> <a id="2878" class="Symbol">_</a> <a id="2880" href="Data.Nat.GCD.html#2880" class="Bound">m&lt;n</a> <a id="2884" class="Symbol">=</a> <a id="2886" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="2892" class="Symbol">(</a><a id="2893" href="Data.Nat.GCD.html#2091" class="Function">gcd′[m,n]∣m,n</a> <a id="2907" class="Symbol">{</a><a id="2908" class="Bound">m</a><a id="2909" class="Symbol">}</a> <a id="2911" class="Symbol">{</a><a id="2912" class="Bound">n</a><a id="2913" class="Symbol">}</a> <a id="2915" class="Symbol">_</a> <a id="2917" class="Symbol">_)</a>

<a id="gcd[m,n]∣n"></a><a id="2921" href="Data.Nat.GCD.html#2921" class="Function">gcd[m,n]∣n</a> <a id="2932" class="Symbol">:</a> <a id="2934" class="Symbol">∀</a> <a id="2936" href="Data.Nat.GCD.html#2936" class="Bound">m</a> <a id="2938" href="Data.Nat.GCD.html#2938" class="Bound">n</a> <a id="2940" class="Symbol">→</a> <a id="2942" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="2946" href="Data.Nat.GCD.html#2936" class="Bound">m</a> <a id="2948" href="Data.Nat.GCD.html#2938" class="Bound">n</a> <a id="2950" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="2952" href="Data.Nat.GCD.html#2938" class="Bound">n</a>
<a id="2954" href="Data.Nat.GCD.html#2921" class="Function">gcd[m,n]∣n</a> <a id="2965" href="Data.Nat.GCD.html#2965" class="Bound">m</a> <a id="2967" href="Data.Nat.GCD.html#2967" class="Bound">n</a> <a id="2969" class="Keyword">with</a> <a id="2974" href="Data.Nat.Properties.html#10339" class="Function">&lt;-cmp</a> <a id="2980" href="Data.Nat.GCD.html#2965" class="Bound">m</a> <a id="2982" href="Data.Nat.GCD.html#2967" class="Bound">n</a>
<a id="2984" class="Symbol">...</a> <a id="2988" class="Symbol">|</a> <a id="2990" href="Relation.Binary.Definitions.html#2857" class="InductiveConstructor">tri&lt;</a> <a id="2995" href="Data.Nat.GCD.html#2995" class="Bound">n&lt;m</a> <a id="2999" class="Symbol">_</a>    <a id="3004" class="Symbol">_</a> <a id="3006" class="Symbol">=</a> <a id="3008" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="3014" class="Symbol">(</a><a id="3015" href="Data.Nat.GCD.html#2091" class="Function">gcd′[m,n]∣m,n</a> <a id="3029" class="Symbol">{</a><a id="3030" class="Bound">n</a><a id="3031" class="Symbol">}</a> <a id="3033" class="Symbol">{</a><a id="3034" class="Bound">m</a><a id="3035" class="Symbol">}</a> <a id="3037" class="Symbol">_</a> <a id="3039" class="Symbol">_)</a>
<a id="3042" class="Symbol">...</a> <a id="3046" class="Symbol">|</a> <a id="3048" href="Relation.Binary.Definitions.html#2911" class="InductiveConstructor">tri≈</a> <a id="3053" class="Symbol">_</a> <a id="3055" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">P.refl</a> <a id="3062" class="Symbol">_</a> <a id="3064" class="Symbol">=</a> <a id="3066" href="Data.Nat.Divisibility.html#2304" class="Function">∣-refl</a>
<a id="3073" class="Symbol">...</a> <a id="3077" class="Symbol">|</a> <a id="3079" href="Relation.Binary.Definitions.html#2965" class="InductiveConstructor">tri&gt;</a> <a id="3084" class="Symbol">_</a> <a id="3086" class="Symbol">_</a>    <a id="3091" href="Data.Nat.GCD.html#3091" class="Bound">m&lt;n</a> <a id="3095" class="Symbol">=</a> <a id="3097" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="3103" class="Symbol">(</a><a id="3104" href="Data.Nat.GCD.html#2091" class="Function">gcd′[m,n]∣m,n</a> <a id="3118" class="Symbol">{</a><a id="3119" class="Bound">m</a><a id="3120" class="Symbol">}</a> <a id="3122" class="Symbol">{</a><a id="3123" class="Bound">n</a><a id="3124" class="Symbol">}</a> <a id="3126" class="Symbol">_</a> <a id="3128" class="Symbol">_)</a>

<a id="gcd-greatest"></a><a id="3132" href="Data.Nat.GCD.html#3132" class="Function">gcd-greatest</a> <a id="3145" class="Symbol">:</a> <a id="3147" class="Symbol">∀</a> <a id="3149" class="Symbol">{</a><a id="3150" href="Data.Nat.GCD.html#3150" class="Bound">m</a> <a id="3152" href="Data.Nat.GCD.html#3152" class="Bound">n</a> <a id="3154" href="Data.Nat.GCD.html#3154" class="Bound">c</a><a id="3155" class="Symbol">}</a> <a id="3157" class="Symbol">→</a> <a id="3159" href="Data.Nat.GCD.html#3154" class="Bound">c</a> <a id="3161" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="3163" href="Data.Nat.GCD.html#3150" class="Bound">m</a> <a id="3165" class="Symbol">→</a> <a id="3167" href="Data.Nat.GCD.html#3154" class="Bound">c</a> <a id="3169" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="3171" href="Data.Nat.GCD.html#3152" class="Bound">n</a> <a id="3173" class="Symbol">→</a> <a id="3175" href="Data.Nat.GCD.html#3154" class="Bound">c</a> <a id="3177" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="3179" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="3183" href="Data.Nat.GCD.html#3150" class="Bound">m</a> <a id="3185" href="Data.Nat.GCD.html#3152" class="Bound">n</a>
<a id="3187" href="Data.Nat.GCD.html#3132" class="Function">gcd-greatest</a> <a id="3200" class="Symbol">{</a><a id="3201" href="Data.Nat.GCD.html#3201" class="Bound">m</a><a id="3202" class="Symbol">}</a> <a id="3204" class="Symbol">{</a><a id="3205" href="Data.Nat.GCD.html#3205" class="Bound">n</a><a id="3206" class="Symbol">}</a> <a id="3208" href="Data.Nat.GCD.html#3208" class="Bound">c∣m</a> <a id="3212" href="Data.Nat.GCD.html#3212" class="Bound">c∣n</a> <a id="3216" class="Keyword">with</a> <a id="3221" href="Data.Nat.Properties.html#10339" class="Function">&lt;-cmp</a> <a id="3227" href="Data.Nat.GCD.html#3201" class="Bound">m</a> <a id="3229" href="Data.Nat.GCD.html#3205" class="Bound">n</a>
<a id="3231" class="Symbol">...</a> <a id="3235" class="Symbol">|</a> <a id="3237" href="Relation.Binary.Definitions.html#2857" class="InductiveConstructor">tri&lt;</a> <a id="3242" href="Data.Nat.GCD.html#3242" class="Bound">n&lt;m</a> <a id="3246" class="Symbol">_</a> <a id="3248" class="Symbol">_</a> <a id="3250" class="Symbol">=</a> <a id="3252" href="Data.Nat.GCD.html#2371" class="Function">gcd′-greatest</a> <a id="3266" class="Symbol">_</a> <a id="3268" class="Symbol">_</a> <a id="3270" class="Bound">c∣n</a> <a id="3274" class="Bound">c∣m</a>
<a id="3278" class="Symbol">...</a> <a id="3282" class="Symbol">|</a> <a id="3284" href="Relation.Binary.Definitions.html#2911" class="InductiveConstructor">tri≈</a> <a id="3289" class="Symbol">_</a> <a id="3291" class="Symbol">_</a> <a id="3293" class="Symbol">_</a>   <a id="3297" class="Symbol">=</a> <a id="3299" class="Bound">c∣m</a>
<a id="3303" class="Symbol">...</a> <a id="3307" class="Symbol">|</a> <a id="3309" href="Relation.Binary.Definitions.html#2965" class="InductiveConstructor">tri&gt;</a> <a id="3314" class="Symbol">_</a> <a id="3316" class="Symbol">_</a> <a id="3318" href="Data.Nat.GCD.html#3318" class="Bound">m&lt;n</a> <a id="3322" class="Symbol">=</a> <a id="3324" href="Data.Nat.GCD.html#2371" class="Function">gcd′-greatest</a> <a id="3338" class="Symbol">_</a> <a id="3340" class="Symbol">_</a> <a id="3342" class="Bound">c∣m</a> <a id="3346" class="Bound">c∣n</a>

<a id="3351" class="Comment">------------------------------------------------------------------------</a>
<a id="3424" class="Comment">-- Other properties</a>

<a id="3445" class="Comment">-- Note that all other properties of `gcd` should be inferable from the</a>
<a id="3517" class="Comment">-- 3 core properties above.</a>

<a id="gcd[0,0]≡0"></a><a id="3546" href="Data.Nat.GCD.html#3546" class="Function">gcd[0,0]≡0</a> <a id="3557" class="Symbol">:</a> <a id="3559" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="3563" class="Number">0</a> <a id="3565" class="Number">0</a> <a id="3567" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="3569" class="Number">0</a>
<a id="3571" href="Data.Nat.GCD.html#3546" class="Function">gcd[0,0]≡0</a> <a id="3582" class="Symbol">=</a> <a id="3584" href="Data.Nat.Divisibility.html#2464" class="Function">∣-antisym</a> <a id="3594" class="Symbol">(</a><a id="3595" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="3599" class="Number">0</a> <a id="3601" class="Number">0</a> <a id="3603" href="Data.Nat.Divisibility.html#3889" class="Function Operator">∣0</a><a id="3605" class="Symbol">)</a> <a id="3607" class="Symbol">(</a><a id="3608" href="Data.Nat.GCD.html#3132" class="Function">gcd-greatest</a> <a id="3621" class="Symbol">(</a><a id="3622" class="Number">0</a> <a id="3624" href="Data.Nat.Divisibility.html#3889" class="Function Operator">∣0</a><a id="3626" class="Symbol">)</a> <a id="3628" class="Symbol">(</a><a id="3629" class="Number">0</a> <a id="3631" href="Data.Nat.Divisibility.html#3889" class="Function Operator">∣0</a><a id="3633" class="Symbol">))</a>

<a id="gcd[m,n]≢0"></a><a id="3637" href="Data.Nat.GCD.html#3637" class="Function">gcd[m,n]≢0</a> <a id="3648" class="Symbol">:</a> <a id="3650" class="Symbol">∀</a> <a id="3652" href="Data.Nat.GCD.html#3652" class="Bound">m</a> <a id="3654" href="Data.Nat.GCD.html#3654" class="Bound">n</a> <a id="3656" class="Symbol">→</a> <a id="3658" href="Data.Nat.GCD.html#3652" class="Bound">m</a> <a id="3660" href="Relation.Binary.PropositionalEquality.Core.html#858" class="Function Operator">≢</a> <a id="3662" class="Number">0</a> <a id="3664" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="3666" href="Data.Nat.GCD.html#3654" class="Bound">n</a> <a id="3668" href="Relation.Binary.PropositionalEquality.Core.html#858" class="Function Operator">≢</a> <a id="3670" class="Number">0</a> <a id="3672" class="Symbol">→</a> <a id="3674" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="3678" href="Data.Nat.GCD.html#3652" class="Bound">m</a> <a id="3680" href="Data.Nat.GCD.html#3654" class="Bound">n</a> <a id="3682" href="Relation.Binary.PropositionalEquality.Core.html#858" class="Function Operator">≢</a> <a id="3684" class="Number">0</a>
<a id="3686" href="Data.Nat.GCD.html#3637" class="Function">gcd[m,n]≢0</a> <a id="3697" href="Data.Nat.GCD.html#3697" class="Bound">m</a> <a id="3699" href="Data.Nat.GCD.html#3699" class="Bound">n</a> <a id="3701" class="Symbol">(</a><a id="3702" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="3707" href="Data.Nat.GCD.html#3707" class="Bound">m≢0</a><a id="3710" class="Symbol">)</a> <a id="3712" href="Data.Nat.GCD.html#3712" class="Bound">eq</a> <a id="3715" class="Symbol">=</a> <a id="3717" href="Data.Nat.GCD.html#3707" class="Bound">m≢0</a> <a id="3721" class="Symbol">(</a><a id="3722" href="Data.Nat.Divisibility.html#3930" class="Function">0∣⇒≡0</a> <a id="3728" class="Symbol">(</a><a id="3729" href="Relation.Binary.PropositionalEquality.Core.html#1808" class="Function">subst</a> <a id="3735" class="Symbol">(</a><a id="3736" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">_∣</a> <a id="3739" href="Data.Nat.GCD.html#3697" class="Bound">m</a><a id="3740" class="Symbol">)</a> <a id="3742" href="Data.Nat.GCD.html#3712" class="Bound">eq</a> <a id="3745" class="Symbol">(</a><a id="3746" href="Data.Nat.GCD.html#2719" class="Function">gcd[m,n]∣m</a> <a id="3757" href="Data.Nat.GCD.html#3697" class="Bound">m</a> <a id="3759" href="Data.Nat.GCD.html#3699" class="Bound">n</a><a id="3760" class="Symbol">)))</a>
<a id="3764" href="Data.Nat.GCD.html#3637" class="Function">gcd[m,n]≢0</a> <a id="3775" href="Data.Nat.GCD.html#3775" class="Bound">m</a> <a id="3777" href="Data.Nat.GCD.html#3777" class="Bound">n</a> <a id="3779" class="Symbol">(</a><a id="3780" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="3785" href="Data.Nat.GCD.html#3785" class="Bound">n≢0</a><a id="3788" class="Symbol">)</a> <a id="3790" href="Data.Nat.GCD.html#3790" class="Bound">eq</a> <a id="3793" class="Symbol">=</a> <a id="3795" href="Data.Nat.GCD.html#3785" class="Bound">n≢0</a> <a id="3799" class="Symbol">(</a><a id="3800" href="Data.Nat.Divisibility.html#3930" class="Function">0∣⇒≡0</a> <a id="3806" class="Symbol">(</a><a id="3807" href="Relation.Binary.PropositionalEquality.Core.html#1808" class="Function">subst</a> <a id="3813" class="Symbol">(</a><a id="3814" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">_∣</a> <a id="3817" href="Data.Nat.GCD.html#3777" class="Bound">n</a><a id="3818" class="Symbol">)</a> <a id="3820" href="Data.Nat.GCD.html#3790" class="Bound">eq</a> <a id="3823" class="Symbol">(</a><a id="3824" href="Data.Nat.GCD.html#2921" class="Function">gcd[m,n]∣n</a> <a id="3835" href="Data.Nat.GCD.html#3775" class="Bound">m</a> <a id="3837" href="Data.Nat.GCD.html#3777" class="Bound">n</a><a id="3838" class="Symbol">)))</a>

<a id="gcd[m,n]≡0⇒m≡0"></a><a id="3843" href="Data.Nat.GCD.html#3843" class="Function">gcd[m,n]≡0⇒m≡0</a> <a id="3858" class="Symbol">:</a> <a id="3860" class="Symbol">∀</a> <a id="3862" class="Symbol">{</a><a id="3863" href="Data.Nat.GCD.html#3863" class="Bound">m</a> <a id="3865" href="Data.Nat.GCD.html#3865" class="Bound">n</a><a id="3866" class="Symbol">}</a> <a id="3868" class="Symbol">→</a> <a id="3870" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="3874" href="Data.Nat.GCD.html#3863" class="Bound">m</a> <a id="3876" href="Data.Nat.GCD.html#3865" class="Bound">n</a> <a id="3878" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="3880" class="Number">0</a> <a id="3882" class="Symbol">→</a> <a id="3884" href="Data.Nat.GCD.html#3863" class="Bound">m</a> <a id="3886" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="3888" class="Number">0</a>
<a id="3890" href="Data.Nat.GCD.html#3843" class="Function">gcd[m,n]≡0⇒m≡0</a> <a id="3905" class="Symbol">{</a><a id="3906" href="Agda.Builtin.Nat.html#204" class="InductiveConstructor">zero</a><a id="3910" class="Symbol">}</a>  <a id="3913" class="Symbol">{</a><a id="3914" href="Data.Nat.GCD.html#3914" class="Bound">n</a><a id="3915" class="Symbol">}</a> <a id="3917" href="Data.Nat.GCD.html#3917" class="Bound">eq</a> <a id="3920" class="Symbol">=</a> <a id="3922" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">P.refl</a>
<a id="3929" href="Data.Nat.GCD.html#3843" class="Function">gcd[m,n]≡0⇒m≡0</a> <a id="3944" class="Symbol">{</a><a id="3945" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="3949" href="Data.Nat.GCD.html#3949" class="Bound">m</a><a id="3950" class="Symbol">}</a> <a id="3952" class="Symbol">{</a><a id="3953" href="Data.Nat.GCD.html#3953" class="Bound">n</a><a id="3954" class="Symbol">}</a> <a id="3956" href="Data.Nat.GCD.html#3956" class="Bound">eq</a> <a id="3959" class="Symbol">=</a> <a id="3961" href="Relation.Nullary.Negation.Core.html#1276" class="Function">contradiction</a> <a id="3975" href="Data.Nat.GCD.html#3956" class="Bound">eq</a> <a id="3978" class="Symbol">(</a><a id="3979" href="Data.Nat.GCD.html#3637" class="Function">gcd[m,n]≢0</a> <a id="3990" class="Symbol">(</a><a id="3991" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="3995" href="Data.Nat.GCD.html#3949" class="Bound">m</a><a id="3996" class="Symbol">)</a> <a id="3998" href="Data.Nat.GCD.html#3953" class="Bound">n</a> <a id="4000" class="Symbol">(</a><a id="4001" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="4006" class="Symbol">λ()))</a>

<a id="gcd[m,n]≡0⇒n≡0"></a><a id="4013" href="Data.Nat.GCD.html#4013" class="Function">gcd[m,n]≡0⇒n≡0</a> <a id="4028" class="Symbol">:</a> <a id="4030" class="Symbol">∀</a> <a id="4032" href="Data.Nat.GCD.html#4032" class="Bound">m</a> <a id="4034" class="Symbol">{</a><a id="4035" href="Data.Nat.GCD.html#4035" class="Bound">n</a><a id="4036" class="Symbol">}</a> <a id="4038" class="Symbol">→</a> <a id="4040" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="4044" href="Data.Nat.GCD.html#4032" class="Bound">m</a> <a id="4046" href="Data.Nat.GCD.html#4035" class="Bound">n</a> <a id="4048" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="4050" class="Number">0</a> <a id="4052" class="Symbol">→</a> <a id="4054" href="Data.Nat.GCD.html#4035" class="Bound">n</a> <a id="4056" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="4058" class="Number">0</a>
<a id="4060" href="Data.Nat.GCD.html#4013" class="Function">gcd[m,n]≡0⇒n≡0</a> <a id="4075" href="Data.Nat.GCD.html#4075" class="Bound">m</a> <a id="4077" class="Symbol">{</a><a id="4078" href="Agda.Builtin.Nat.html#204" class="InductiveConstructor">zero</a><a id="4082" class="Symbol">}</a>  <a id="4085" href="Data.Nat.GCD.html#4085" class="Bound">eq</a> <a id="4088" class="Symbol">=</a> <a id="4090" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">P.refl</a>
<a id="4097" href="Data.Nat.GCD.html#4013" class="Function">gcd[m,n]≡0⇒n≡0</a> <a id="4112" href="Data.Nat.GCD.html#4112" class="Bound">m</a> <a id="4114" class="Symbol">{</a><a id="4115" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="4119" href="Data.Nat.GCD.html#4119" class="Bound">n</a><a id="4120" class="Symbol">}</a> <a id="4122" href="Data.Nat.GCD.html#4122" class="Bound">eq</a> <a id="4125" class="Symbol">=</a> <a id="4127" href="Relation.Nullary.Negation.Core.html#1276" class="Function">contradiction</a> <a id="4141" href="Data.Nat.GCD.html#4122" class="Bound">eq</a> <a id="4144" class="Symbol">(</a><a id="4145" href="Data.Nat.GCD.html#3637" class="Function">gcd[m,n]≢0</a> <a id="4156" href="Data.Nat.GCD.html#4112" class="Bound">m</a> <a id="4158" class="Symbol">(</a><a id="4159" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="4163" href="Data.Nat.GCD.html#4119" class="Bound">n</a><a id="4164" class="Symbol">)</a> <a id="4166" class="Symbol">(</a><a id="4167" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="4172" class="Symbol">λ()))</a>

<a id="gcd-comm"></a><a id="4179" href="Data.Nat.GCD.html#4179" class="Function">gcd-comm</a> <a id="4188" class="Symbol">:</a> <a id="4190" href="Algebra.Definitions.html#1635" class="Function">Commutative</a> <a id="4202" href="Data.Nat.GCD.html#1813" class="Function">gcd</a>
<a id="4206" href="Data.Nat.GCD.html#4179" class="Function">gcd-comm</a> <a id="4215" href="Data.Nat.GCD.html#4215" class="Bound">m</a> <a id="4217" href="Data.Nat.GCD.html#4217" class="Bound">n</a> <a id="4219" class="Symbol">=</a> <a id="4221" href="Data.Nat.Divisibility.html#2464" class="Function">∣-antisym</a>
  <a id="4233" class="Symbol">(</a><a id="4234" href="Data.Nat.GCD.html#3132" class="Function">gcd-greatest</a> <a id="4247" class="Symbol">(</a><a id="4248" href="Data.Nat.GCD.html#2921" class="Function">gcd[m,n]∣n</a> <a id="4259" href="Data.Nat.GCD.html#4215" class="Bound">m</a> <a id="4261" href="Data.Nat.GCD.html#4217" class="Bound">n</a><a id="4262" class="Symbol">)</a> <a id="4264" class="Symbol">(</a><a id="4265" href="Data.Nat.GCD.html#2719" class="Function">gcd[m,n]∣m</a> <a id="4276" href="Data.Nat.GCD.html#4215" class="Bound">m</a> <a id="4278" href="Data.Nat.GCD.html#4217" class="Bound">n</a><a id="4279" class="Symbol">))</a>
  <a id="4284" class="Symbol">(</a><a id="4285" href="Data.Nat.GCD.html#3132" class="Function">gcd-greatest</a> <a id="4298" class="Symbol">(</a><a id="4299" href="Data.Nat.GCD.html#2921" class="Function">gcd[m,n]∣n</a> <a id="4310" href="Data.Nat.GCD.html#4217" class="Bound">n</a> <a id="4312" href="Data.Nat.GCD.html#4215" class="Bound">m</a><a id="4313" class="Symbol">)</a> <a id="4315" class="Symbol">(</a><a id="4316" href="Data.Nat.GCD.html#2719" class="Function">gcd[m,n]∣m</a> <a id="4327" href="Data.Nat.GCD.html#4217" class="Bound">n</a> <a id="4329" href="Data.Nat.GCD.html#4215" class="Bound">m</a><a id="4330" class="Symbol">))</a>

<a id="gcd-assoc"></a><a id="4334" href="Data.Nat.GCD.html#4334" class="Function">gcd-assoc</a> <a id="4344" class="Symbol">:</a> <a id="4346" href="Algebra.Definitions.html#1548" class="Function">Associative</a> <a id="4358" href="Data.Nat.GCD.html#1813" class="Function">gcd</a>
<a id="4362" href="Data.Nat.GCD.html#4334" class="Function">gcd-assoc</a> <a id="4372" href="Data.Nat.GCD.html#4372" class="Bound">m</a> <a id="4374" href="Data.Nat.GCD.html#4374" class="Bound">n</a> <a id="4376" href="Data.Nat.GCD.html#4376" class="Bound">p</a> <a id="4378" class="Symbol">=</a> <a id="4380" href="Data.Nat.Divisibility.html#2464" class="Function">∣-antisym</a>
  <a id="4392" class="Symbol">(</a><a id="4393" href="Data.Nat.GCD.html#3132" class="Function">gcd-greatest</a> <a id="4406" href="Data.Nat.GCD.html#4595" class="Function">gcd[gcd[m,n],p]|m</a> <a id="4424" class="Symbol">(</a><a id="4425" href="Data.Nat.GCD.html#3132" class="Function">gcd-greatest</a> <a id="4438" href="Data.Nat.GCD.html#4741" class="Function">gcd[gcd[m,n],p]∣n</a> <a id="4456" href="Data.Nat.GCD.html#4887" class="Function">gcd[gcd[m,n],p]∣p</a><a id="4473" class="Symbol">))</a>
  <a id="4478" class="Symbol">(</a><a id="4479" href="Data.Nat.GCD.html#3132" class="Function">gcd-greatest</a> <a id="4492" class="Symbol">(</a><a id="4493" href="Data.Nat.GCD.html#3132" class="Function">gcd-greatest</a> <a id="4506" href="Data.Nat.GCD.html#4934" class="Function">gcd[m,gcd[n,p]]∣m</a> <a id="4524" href="Data.Nat.GCD.html#4981" class="Function">gcd[m,gcd[n,p]]∣n</a><a id="4541" class="Symbol">)</a> <a id="4543" href="Data.Nat.GCD.html#5127" class="Function">gcd[m,gcd[n,p]]∣p</a><a id="4560" class="Symbol">)</a>
  <a id="4564" class="Keyword">where</a>
    <a id="4574" class="Keyword">open</a> <a id="4579" href="Data.Nat.Divisibility.html#3493" class="Module">∣-Reasoning</a>
    <a id="4595" href="Data.Nat.GCD.html#4595" class="Function">gcd[gcd[m,n],p]|m</a> <a id="4613" class="Symbol">=</a> <a id="4615" href="Relation.Binary.Reasoning.Base.Double.html#2198" class="Function Operator">begin</a>
      <a id="4627" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="4631" class="Symbol">(</a><a id="4632" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="4636" href="Data.Nat.GCD.html#4372" class="Bound">m</a> <a id="4638" href="Data.Nat.GCD.html#4374" class="Bound">n</a><a id="4639" class="Symbol">)</a> <a id="4641" href="Data.Nat.GCD.html#4376" class="Bound">p</a> <a id="4643" href="Data.Nat.Divisibility.html#3646" class="Function">∣⟨</a> <a id="4646" href="Data.Nat.GCD.html#2719" class="Function">gcd[m,n]∣m</a> <a id="4657" class="Symbol">(</a><a id="4658" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="4662" href="Data.Nat.GCD.html#4372" class="Bound">m</a> <a id="4664" href="Data.Nat.GCD.html#4374" class="Bound">n</a><a id="4665" class="Symbol">)</a> <a id="4667" href="Data.Nat.GCD.html#4376" class="Bound">p</a> <a id="4669" href="Data.Nat.Divisibility.html#3646" class="Function">⟩</a>
      <a id="4677" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="4681" href="Data.Nat.GCD.html#4372" class="Bound">m</a> <a id="4683" href="Data.Nat.GCD.html#4374" class="Bound">n</a>         <a id="4693" href="Data.Nat.Divisibility.html#3646" class="Function">∣⟨</a> <a id="4696" href="Data.Nat.GCD.html#2719" class="Function">gcd[m,n]∣m</a> <a id="4707" href="Data.Nat.GCD.html#4372" class="Bound">m</a> <a id="4709" href="Data.Nat.GCD.html#4374" class="Bound">n</a> <a id="4711" href="Data.Nat.Divisibility.html#3646" class="Function">⟩</a>
      <a id="4719" href="Data.Nat.GCD.html#4372" class="Bound">m</a>               <a id="4735" href="Relation.Binary.Reasoning.Base.Double.html#3632" class="Function Operator">∎</a>
    <a id="4741" href="Data.Nat.GCD.html#4741" class="Function">gcd[gcd[m,n],p]∣n</a> <a id="4759" class="Symbol">=</a> <a id="4761" href="Relation.Binary.Reasoning.Base.Double.html#2198" class="Function Operator">begin</a>
      <a id="4773" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="4777" class="Symbol">(</a><a id="4778" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="4782" href="Data.Nat.GCD.html#4372" class="Bound">m</a> <a id="4784" href="Data.Nat.GCD.html#4374" class="Bound">n</a><a id="4785" class="Symbol">)</a> <a id="4787" href="Data.Nat.GCD.html#4376" class="Bound">p</a> <a id="4789" href="Data.Nat.Divisibility.html#3646" class="Function">∣⟨</a> <a id="4792" href="Data.Nat.GCD.html#2719" class="Function">gcd[m,n]∣m</a> <a id="4803" class="Symbol">(</a><a id="4804" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="4808" href="Data.Nat.GCD.html#4372" class="Bound">m</a> <a id="4810" href="Data.Nat.GCD.html#4374" class="Bound">n</a><a id="4811" class="Symbol">)</a> <a id="4813" href="Data.Nat.GCD.html#4376" class="Bound">p</a> <a id="4815" href="Data.Nat.Divisibility.html#3646" class="Function">⟩</a>
      <a id="4823" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="4827" href="Data.Nat.GCD.html#4372" class="Bound">m</a> <a id="4829" href="Data.Nat.GCD.html#4374" class="Bound">n</a>         <a id="4839" href="Data.Nat.Divisibility.html#3646" class="Function">∣⟨</a> <a id="4842" href="Data.Nat.GCD.html#2921" class="Function">gcd[m,n]∣n</a> <a id="4853" href="Data.Nat.GCD.html#4372" class="Bound">m</a> <a id="4855" href="Data.Nat.GCD.html#4374" class="Bound">n</a> <a id="4857" href="Data.Nat.Divisibility.html#3646" class="Function">⟩</a>
      <a id="4865" href="Data.Nat.GCD.html#4374" class="Bound">n</a>               <a id="4881" href="Relation.Binary.Reasoning.Base.Double.html#3632" class="Function Operator">∎</a>
    <a id="4887" href="Data.Nat.GCD.html#4887" class="Function">gcd[gcd[m,n],p]∣p</a> <a id="4905" class="Symbol">=</a> <a id="4907" href="Data.Nat.GCD.html#2921" class="Function">gcd[m,n]∣n</a> <a id="4918" class="Symbol">(</a><a id="4919" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="4923" href="Data.Nat.GCD.html#4372" class="Bound">m</a> <a id="4925" href="Data.Nat.GCD.html#4374" class="Bound">n</a><a id="4926" class="Symbol">)</a> <a id="4928" href="Data.Nat.GCD.html#4376" class="Bound">p</a>
    <a id="4934" href="Data.Nat.GCD.html#4934" class="Function">gcd[m,gcd[n,p]]∣m</a> <a id="4952" class="Symbol">=</a> <a id="4954" href="Data.Nat.GCD.html#2719" class="Function">gcd[m,n]∣m</a> <a id="4965" href="Data.Nat.GCD.html#4372" class="Bound">m</a> <a id="4967" class="Symbol">(</a><a id="4968" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="4972" href="Data.Nat.GCD.html#4374" class="Bound">n</a> <a id="4974" href="Data.Nat.GCD.html#4376" class="Bound">p</a><a id="4975" class="Symbol">)</a>
    <a id="4981" href="Data.Nat.GCD.html#4981" class="Function">gcd[m,gcd[n,p]]∣n</a> <a id="4999" class="Symbol">=</a> <a id="5001" href="Relation.Binary.Reasoning.Base.Double.html#2198" class="Function Operator">begin</a>
      <a id="5013" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="5017" href="Data.Nat.GCD.html#4372" class="Bound">m</a> <a id="5019" class="Symbol">(</a><a id="5020" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="5024" href="Data.Nat.GCD.html#4374" class="Bound">n</a> <a id="5026" href="Data.Nat.GCD.html#4376" class="Bound">p</a><a id="5027" class="Symbol">)</a> <a id="5029" href="Data.Nat.Divisibility.html#3646" class="Function">∣⟨</a> <a id="5032" href="Data.Nat.GCD.html#2921" class="Function">gcd[m,n]∣n</a> <a id="5043" href="Data.Nat.GCD.html#4372" class="Bound">m</a> <a id="5045" class="Symbol">(</a><a id="5046" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="5050" href="Data.Nat.GCD.html#4374" class="Bound">n</a> <a id="5052" href="Data.Nat.GCD.html#4376" class="Bound">p</a><a id="5053" class="Symbol">)</a> <a id="5055" href="Data.Nat.Divisibility.html#3646" class="Function">⟩</a>
      <a id="5063" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="5067" href="Data.Nat.GCD.html#4374" class="Bound">n</a> <a id="5069" href="Data.Nat.GCD.html#4376" class="Bound">p</a>         <a id="5079" href="Data.Nat.Divisibility.html#3646" class="Function">∣⟨</a> <a id="5082" href="Data.Nat.GCD.html#2719" class="Function">gcd[m,n]∣m</a> <a id="5093" href="Data.Nat.GCD.html#4374" class="Bound">n</a> <a id="5095" href="Data.Nat.GCD.html#4376" class="Bound">p</a> <a id="5097" href="Data.Nat.Divisibility.html#3646" class="Function">⟩</a>
      <a id="5105" href="Data.Nat.GCD.html#4374" class="Bound">n</a>               <a id="5121" href="Relation.Binary.Reasoning.Base.Double.html#3632" class="Function Operator">∎</a>
    <a id="5127" href="Data.Nat.GCD.html#5127" class="Function">gcd[m,gcd[n,p]]∣p</a> <a id="5145" class="Symbol">=</a> <a id="5147" href="Relation.Binary.Reasoning.Base.Double.html#2198" class="Function Operator">begin</a>
      <a id="5159" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="5163" href="Data.Nat.GCD.html#4372" class="Bound">m</a> <a id="5165" class="Symbol">(</a><a id="5166" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="5170" href="Data.Nat.GCD.html#4374" class="Bound">n</a> <a id="5172" href="Data.Nat.GCD.html#4376" class="Bound">p</a><a id="5173" class="Symbol">)</a> <a id="5175" href="Data.Nat.Divisibility.html#3646" class="Function">∣⟨</a> <a id="5178" href="Data.Nat.GCD.html#2921" class="Function">gcd[m,n]∣n</a> <a id="5189" href="Data.Nat.GCD.html#4372" class="Bound">m</a> <a id="5191" class="Symbol">(</a><a id="5192" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="5196" href="Data.Nat.GCD.html#4374" class="Bound">n</a> <a id="5198" href="Data.Nat.GCD.html#4376" class="Bound">p</a><a id="5199" class="Symbol">)</a> <a id="5201" href="Data.Nat.Divisibility.html#3646" class="Function">⟩</a>
      <a id="5209" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="5213" href="Data.Nat.GCD.html#4374" class="Bound">n</a> <a id="5215" href="Data.Nat.GCD.html#4376" class="Bound">p</a>         <a id="5225" href="Data.Nat.Divisibility.html#3646" class="Function">∣⟨</a> <a id="5228" href="Data.Nat.GCD.html#2921" class="Function">gcd[m,n]∣n</a> <a id="5239" href="Data.Nat.GCD.html#4374" class="Bound">n</a> <a id="5241" href="Data.Nat.GCD.html#4376" class="Bound">p</a> <a id="5243" href="Data.Nat.Divisibility.html#3646" class="Function">⟩</a>
      <a id="5251" href="Data.Nat.GCD.html#4376" class="Bound">p</a>               <a id="5267" href="Relation.Binary.Reasoning.Base.Double.html#3632" class="Function Operator">∎</a>

<a id="gcd-identityˡ"></a><a id="5270" href="Data.Nat.GCD.html#5270" class="Function">gcd-identityˡ</a> <a id="5284" class="Symbol">:</a> <a id="5286" href="Algebra.Definitions.html#1708" class="Function">LeftIdentity</a> <a id="5299" class="Number">0</a> <a id="5301" href="Data.Nat.GCD.html#1813" class="Function">gcd</a>
<a id="5305" href="Data.Nat.GCD.html#5270" class="Function">gcd-identityˡ</a> <a id="5319" href="Agda.Builtin.Nat.html#204" class="InductiveConstructor">zero</a> <a id="5324" class="Symbol">=</a> <a id="5326" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">P.refl</a>
<a id="5333" href="Data.Nat.GCD.html#5270" class="Function">gcd-identityˡ</a> <a id="5347" class="Symbol">(</a><a id="5348" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="5352" class="Symbol">_)</a> <a id="5355" class="Symbol">=</a> <a id="5357" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">P.refl</a>

<a id="gcd-identityʳ"></a><a id="5365" href="Data.Nat.GCD.html#5365" class="Function">gcd-identityʳ</a> <a id="5379" class="Symbol">:</a> <a id="5381" href="Algebra.Definitions.html#1781" class="Function">RightIdentity</a> <a id="5395" class="Number">0</a> <a id="5397" href="Data.Nat.GCD.html#1813" class="Function">gcd</a>
<a id="5401" href="Data.Nat.GCD.html#5365" class="Function">gcd-identityʳ</a> <a id="5415" href="Agda.Builtin.Nat.html#204" class="InductiveConstructor">zero</a> <a id="5420" class="Symbol">=</a> <a id="5422" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">P.refl</a>
<a id="5429" href="Data.Nat.GCD.html#5365" class="Function">gcd-identityʳ</a> <a id="5443" class="Symbol">(</a><a id="5444" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="5448" class="Symbol">_)</a> <a id="5451" class="Symbol">=</a> <a id="5453" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">P.refl</a>

<a id="gcd-identity"></a><a id="5461" href="Data.Nat.GCD.html#5461" class="Function">gcd-identity</a> <a id="5474" class="Symbol">:</a> <a id="5476" href="Algebra.Definitions.html#1856" class="Function">Algebra.Identity</a> <a id="5493" class="Number">0</a> <a id="5495" href="Data.Nat.GCD.html#1813" class="Function">gcd</a>
<a id="5499" href="Data.Nat.GCD.html#5461" class="Function">gcd-identity</a> <a id="5512" class="Symbol">=</a> <a id="5514" href="Data.Nat.GCD.html#5270" class="Function">gcd-identityˡ</a> <a id="5528" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5530" href="Data.Nat.GCD.html#5365" class="Function">gcd-identityʳ</a>

<a id="gcd-zeroˡ"></a><a id="5545" href="Data.Nat.GCD.html#5545" class="Function">gcd-zeroˡ</a> <a id="5555" class="Symbol">:</a> <a id="5557" href="Algebra.Definitions.html#1942" class="Function">LeftZero</a> <a id="5566" class="Number">1</a> <a id="5568" href="Data.Nat.GCD.html#1813" class="Function">gcd</a>
<a id="5572" href="Data.Nat.GCD.html#5545" class="Function">gcd-zeroˡ</a> <a id="5582" href="Data.Nat.GCD.html#5582" class="Bound">n</a> <a id="5584" class="Symbol">=</a> <a id="5586" href="Data.Nat.Divisibility.html#2464" class="Function">∣-antisym</a> <a id="5596" href="Data.Nat.GCD.html#5630" class="Function">gcd[1,n]∣1</a> <a id="5607" href="Data.Nat.GCD.html#5662" class="Function">1∣gcd[1,n]</a>
  <a id="5620" class="Keyword">where</a>
    <a id="5630" href="Data.Nat.GCD.html#5630" class="Function">gcd[1,n]∣1</a> <a id="5641" class="Symbol">=</a> <a id="5643" href="Data.Nat.GCD.html#2719" class="Function">gcd[m,n]∣m</a> <a id="5654" class="Number">1</a> <a id="5656" href="Data.Nat.GCD.html#5582" class="Bound">n</a>
    <a id="5662" href="Data.Nat.GCD.html#5662" class="Function">1∣gcd[1,n]</a> <a id="5673" class="Symbol">=</a> <a id="5675" href="Data.Nat.Divisibility.html#3831" class="Function Operator">1∣</a> <a id="5678" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="5682" class="Number">1</a> <a id="5684" href="Data.Nat.GCD.html#5582" class="Bound">n</a>

<a id="gcd-zeroʳ"></a><a id="5687" href="Data.Nat.GCD.html#5687" class="Function">gcd-zeroʳ</a> <a id="5697" class="Symbol">:</a> <a id="5699" href="Algebra.Definitions.html#2007" class="Function">RightZero</a> <a id="5709" class="Number">1</a> <a id="5711" href="Data.Nat.GCD.html#1813" class="Function">gcd</a>
<a id="5715" href="Data.Nat.GCD.html#5687" class="Function">gcd-zeroʳ</a> <a id="5725" href="Data.Nat.GCD.html#5725" class="Bound">n</a> <a id="5727" class="Symbol">=</a> <a id="5729" href="Data.Nat.Divisibility.html#2464" class="Function">∣-antisym</a> <a id="5739" href="Data.Nat.GCD.html#5773" class="Function">gcd[n,1]∣1</a> <a id="5750" href="Data.Nat.GCD.html#5805" class="Function">1∣gcd[n,1]</a>
  <a id="5763" class="Keyword">where</a>
    <a id="5773" href="Data.Nat.GCD.html#5773" class="Function">gcd[n,1]∣1</a> <a id="5784" class="Symbol">=</a> <a id="5786" href="Data.Nat.GCD.html#2921" class="Function">gcd[m,n]∣n</a> <a id="5797" href="Data.Nat.GCD.html#5725" class="Bound">n</a> <a id="5799" class="Number">1</a>
    <a id="5805" href="Data.Nat.GCD.html#5805" class="Function">1∣gcd[n,1]</a> <a id="5816" class="Symbol">=</a> <a id="5818" href="Data.Nat.Divisibility.html#3831" class="Function Operator">1∣</a> <a id="5821" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="5825" href="Data.Nat.GCD.html#5725" class="Bound">n</a> <a id="5827" class="Number">1</a>

<a id="gcd-zero"></a><a id="5830" href="Data.Nat.GCD.html#5830" class="Function">gcd-zero</a> <a id="5839" class="Symbol">:</a> <a id="5841" href="Algebra.Definitions.html#2074" class="Function">Zero</a> <a id="5846" class="Number">1</a> <a id="5848" href="Data.Nat.GCD.html#1813" class="Function">gcd</a>
<a id="5852" href="Data.Nat.GCD.html#5830" class="Function">gcd-zero</a> <a id="5861" class="Symbol">=</a> <a id="5863" href="Data.Nat.GCD.html#5545" class="Function">gcd-zeroˡ</a> <a id="5873" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5875" href="Data.Nat.GCD.html#5687" class="Function">gcd-zeroʳ</a>

<a id="gcd-universality"></a><a id="5886" href="Data.Nat.GCD.html#5886" class="Function">gcd-universality</a> <a id="5903" class="Symbol">:</a> <a id="5905" class="Symbol">∀</a> <a id="5907" class="Symbol">{</a><a id="5908" href="Data.Nat.GCD.html#5908" class="Bound">m</a> <a id="5910" href="Data.Nat.GCD.html#5910" class="Bound">n</a> <a id="5912" href="Data.Nat.GCD.html#5912" class="Bound">g</a><a id="5913" class="Symbol">}</a> <a id="5915" class="Symbol">→</a>
                   <a id="5936" class="Symbol">(∀</a> <a id="5939" class="Symbol">{</a><a id="5940" href="Data.Nat.GCD.html#5940" class="Bound">d</a><a id="5941" class="Symbol">}</a> <a id="5943" class="Symbol">→</a> <a id="5945" href="Data.Nat.GCD.html#5940" class="Bound">d</a> <a id="5947" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="5949" href="Data.Nat.GCD.html#5908" class="Bound">m</a> <a id="5951" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5953" href="Data.Nat.GCD.html#5940" class="Bound">d</a> <a id="5955" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="5957" href="Data.Nat.GCD.html#5910" class="Bound">n</a> <a id="5959" class="Symbol">→</a> <a id="5961" href="Data.Nat.GCD.html#5940" class="Bound">d</a> <a id="5963" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="5965" href="Data.Nat.GCD.html#5912" class="Bound">g</a><a id="5966" class="Symbol">)</a> <a id="5968" class="Symbol">→</a>
                   <a id="5989" class="Symbol">(∀</a> <a id="5992" class="Symbol">{</a><a id="5993" href="Data.Nat.GCD.html#5993" class="Bound">d</a><a id="5994" class="Symbol">}</a> <a id="5996" class="Symbol">→</a> <a id="5998" href="Data.Nat.GCD.html#5993" class="Bound">d</a> <a id="6000" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="6002" href="Data.Nat.GCD.html#5912" class="Bound">g</a> <a id="6004" class="Symbol">→</a> <a id="6006" href="Data.Nat.GCD.html#5993" class="Bound">d</a> <a id="6008" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="6010" href="Data.Nat.GCD.html#5908" class="Bound">m</a> <a id="6012" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="6014" href="Data.Nat.GCD.html#5993" class="Bound">d</a> <a id="6016" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="6018" href="Data.Nat.GCD.html#5910" class="Bound">n</a><a id="6019" class="Symbol">)</a> <a id="6021" class="Symbol">→</a>
                   <a id="6042" href="Data.Nat.GCD.html#5912" class="Bound">g</a> <a id="6044" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="6046" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="6050" href="Data.Nat.GCD.html#5908" class="Bound">m</a> <a id="6052" href="Data.Nat.GCD.html#5910" class="Bound">n</a>
<a id="6054" href="Data.Nat.GCD.html#5886" class="Function">gcd-universality</a> <a id="6071" class="Symbol">{</a><a id="6072" href="Data.Nat.GCD.html#6072" class="Bound">m</a><a id="6073" class="Symbol">}</a> <a id="6075" class="Symbol">{</a><a id="6076" href="Data.Nat.GCD.html#6076" class="Bound">n</a><a id="6077" class="Symbol">}</a> <a id="6079" href="Data.Nat.GCD.html#6079" class="Bound">forwards</a> <a id="6088" href="Data.Nat.GCD.html#6088" class="Bound">backwards</a> <a id="6098" class="Keyword">with</a> <a id="6103" href="Data.Nat.GCD.html#6103" class="Bound">back₁</a> <a id="6109" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="6111" href="Data.Nat.GCD.html#6111" class="Bound">back₂</a> ← <a id="6119" href="Data.Nat.GCD.html#6088" class="Bound">backwards</a> <a id="6129" href="Data.Nat.Divisibility.html#2304" class="Function">∣-refl</a>
  <a id="6138" class="Symbol">=</a> <a id="6140" href="Data.Nat.Divisibility.html#2464" class="Function">∣-antisym</a> <a id="6150" class="Symbol">(</a><a id="6151" href="Data.Nat.GCD.html#3132" class="Function">gcd-greatest</a> <a id="6164" href="Data.Nat.GCD.html#6103" class="Bound">back₁</a> <a id="6170" href="Data.Nat.GCD.html#6111" class="Bound">back₂</a><a id="6175" class="Symbol">)</a> <a id="6177" class="Symbol">(</a><a id="6178" href="Data.Nat.GCD.html#6079" class="Bound">forwards</a> <a id="6187" class="Symbol">(</a><a id="6188" href="Data.Nat.GCD.html#2719" class="Function">gcd[m,n]∣m</a> <a id="6199" href="Data.Nat.GCD.html#6072" class="Bound">m</a> <a id="6201" href="Data.Nat.GCD.html#6076" class="Bound">n</a> <a id="6203" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="6205" href="Data.Nat.GCD.html#2921" class="Function">gcd[m,n]∣n</a> <a id="6216" href="Data.Nat.GCD.html#6072" class="Bound">m</a> <a id="6218" href="Data.Nat.GCD.html#6076" class="Bound">n</a><a id="6219" class="Symbol">))</a>

<a id="6223" class="Comment">-- This could be simplified with some nice backwards/forwards reasoning</a>
<a id="6295" class="Comment">-- after the new function hierarchy is up and running.</a>
<a id="gcd[cm,cn]/c≡gcd[m,n]"></a><a id="6350" href="Data.Nat.GCD.html#6350" class="Function">gcd[cm,cn]/c≡gcd[m,n]</a> <a id="6372" class="Symbol">:</a> <a id="6374" class="Symbol">∀</a> <a id="6376" href="Data.Nat.GCD.html#6376" class="Bound">c</a> <a id="6378" href="Data.Nat.GCD.html#6378" class="Bound">m</a> <a id="6380" href="Data.Nat.GCD.html#6380" class="Bound">n</a> <a id="6382" class="Symbol">.{{</a><a id="6385" href="Data.Nat.GCD.html#6385" class="Bound">_</a> <a id="6387" class="Symbol">:</a> <a id="6389" href="Data.Nat.Base.html#2570" class="Record">NonZero</a> <a id="6397" href="Data.Nat.GCD.html#6376" class="Bound">c</a><a id="6398" class="Symbol">}}</a> <a id="6401" class="Symbol">→</a> <a id="6403" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="6407" class="Symbol">(</a><a id="6408" href="Data.Nat.GCD.html#6376" class="Bound">c</a> <a id="6410" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="6412" href="Data.Nat.GCD.html#6378" class="Bound">m</a><a id="6413" class="Symbol">)</a> <a id="6415" class="Symbol">(</a><a id="6416" href="Data.Nat.GCD.html#6376" class="Bound">c</a> <a id="6418" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="6420" href="Data.Nat.GCD.html#6380" class="Bound">n</a><a id="6421" class="Symbol">)</a> <a id="6423" href="Data.Nat.Base.html#5110" class="Function Operator">/</a> <a id="6425" href="Data.Nat.GCD.html#6376" class="Bound">c</a> <a id="6427" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="6429" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="6433" href="Data.Nat.GCD.html#6378" class="Bound">m</a> <a id="6435" href="Data.Nat.GCD.html#6380" class="Bound">n</a>
<a id="6437" href="Data.Nat.GCD.html#6350" class="Function">gcd[cm,cn]/c≡gcd[m,n]</a> <a id="6459" href="Data.Nat.GCD.html#6459" class="Bound">c</a> <a id="6461" href="Data.Nat.GCD.html#6461" class="Bound">m</a> <a id="6463" href="Data.Nat.GCD.html#6463" class="Bound">n</a> <a id="6465" class="Symbol">=</a> <a id="6467" href="Data.Nat.GCD.html#5886" class="Function">gcd-universality</a> <a id="6484" href="Data.Nat.GCD.html#6513" class="Function">forwards</a> <a id="6493" href="Data.Nat.GCD.html#6679" class="Function">backwards</a>
  <a id="6505" class="Keyword">where</a>
  <a id="6513" href="Data.Nat.GCD.html#6513" class="Function">forwards</a> <a id="6522" class="Symbol">:</a> <a id="6524" class="Symbol">∀</a> <a id="6526" class="Symbol">{</a><a id="6527" href="Data.Nat.GCD.html#6527" class="Bound">d</a> <a id="6529" class="Symbol">:</a> <a id="6531" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="6532" class="Symbol">}</a> <a id="6534" class="Symbol">→</a> <a id="6536" href="Data.Nat.GCD.html#6527" class="Bound">d</a> <a id="6538" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="6540" href="Data.Nat.GCD.html#6461" class="Bound">m</a> <a id="6542" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="6544" href="Data.Nat.GCD.html#6527" class="Bound">d</a> <a id="6546" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="6548" href="Data.Nat.GCD.html#6463" class="Bound">n</a> <a id="6550" class="Symbol">→</a> <a id="6552" href="Data.Nat.GCD.html#6527" class="Bound">d</a> <a id="6554" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="6556" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="6560" class="Symbol">(</a><a id="6561" href="Data.Nat.GCD.html#6459" class="Bound">c</a> <a id="6563" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="6565" href="Data.Nat.GCD.html#6461" class="Bound">m</a><a id="6566" class="Symbol">)</a> <a id="6568" class="Symbol">(</a><a id="6569" href="Data.Nat.GCD.html#6459" class="Bound">c</a> <a id="6571" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="6573" href="Data.Nat.GCD.html#6463" class="Bound">n</a><a id="6574" class="Symbol">)</a> <a id="6576" href="Data.Nat.Base.html#5110" class="Function Operator">/</a> <a id="6578" href="Data.Nat.GCD.html#6459" class="Bound">c</a>
  <a id="6582" href="Data.Nat.GCD.html#6513" class="Function">forwards</a> <a id="6591" class="Symbol">{</a><a id="6592" href="Data.Nat.GCD.html#6592" class="Bound">d</a><a id="6593" class="Symbol">}</a> <a id="6595" class="Symbol">(</a><a id="6596" href="Data.Nat.GCD.html#6596" class="Bound">d∣m</a> <a id="6600" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="6602" href="Data.Nat.GCD.html#6602" class="Bound">d∣n</a><a id="6605" class="Symbol">)</a> <a id="6607" class="Symbol">=</a> <a id="6609" href="Data.Nat.Divisibility.html#7567" class="Function">m*n∣o⇒n∣o/m</a> <a id="6621" href="Data.Nat.GCD.html#6459" class="Bound">c</a> <a id="6623" href="Data.Nat.GCD.html#6592" class="Bound">d</a> <a id="6625" class="Symbol">(</a><a id="6626" href="Data.Nat.GCD.html#3132" class="Function">gcd-greatest</a> <a id="6639" class="Symbol">(</a><a id="6640" href="Data.Nat.Divisibility.html#5396" class="Function">*-monoʳ-∣</a> <a id="6650" href="Data.Nat.GCD.html#6459" class="Bound">c</a> <a id="6652" href="Data.Nat.GCD.html#6596" class="Bound">d∣m</a><a id="6655" class="Symbol">)</a> <a id="6657" class="Symbol">(</a><a id="6658" href="Data.Nat.Divisibility.html#5396" class="Function">*-monoʳ-∣</a> <a id="6668" href="Data.Nat.GCD.html#6459" class="Bound">c</a> <a id="6670" href="Data.Nat.GCD.html#6602" class="Bound">d∣n</a><a id="6673" class="Symbol">))</a>

  <a id="6679" href="Data.Nat.GCD.html#6679" class="Function">backwards</a> <a id="6689" class="Symbol">:</a> <a id="6691" class="Symbol">∀</a> <a id="6693" class="Symbol">{</a><a id="6694" href="Data.Nat.GCD.html#6694" class="Bound">d</a> <a id="6696" class="Symbol">:</a> <a id="6698" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="6699" class="Symbol">}</a> <a id="6701" class="Symbol">→</a> <a id="6703" href="Data.Nat.GCD.html#6694" class="Bound">d</a> <a id="6705" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="6707" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="6711" class="Symbol">(</a><a id="6712" href="Data.Nat.GCD.html#6459" class="Bound">c</a> <a id="6714" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="6716" href="Data.Nat.GCD.html#6461" class="Bound">m</a><a id="6717" class="Symbol">)</a> <a id="6719" class="Symbol">(</a><a id="6720" href="Data.Nat.GCD.html#6459" class="Bound">c</a> <a id="6722" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="6724" href="Data.Nat.GCD.html#6463" class="Bound">n</a><a id="6725" class="Symbol">)</a> <a id="6727" href="Data.Nat.Base.html#5110" class="Function Operator">/</a> <a id="6729" href="Data.Nat.GCD.html#6459" class="Bound">c</a> <a id="6731" class="Symbol">→</a> <a id="6733" href="Data.Nat.GCD.html#6694" class="Bound">d</a> <a id="6735" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="6737" href="Data.Nat.GCD.html#6461" class="Bound">m</a> <a id="6739" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="6741" href="Data.Nat.GCD.html#6694" class="Bound">d</a> <a id="6743" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="6745" href="Data.Nat.GCD.html#6463" class="Bound">n</a>
  <a id="6749" href="Data.Nat.GCD.html#6679" class="Function">backwards</a> <a id="6759" class="Symbol">{</a><a id="6760" href="Data.Nat.GCD.html#6760" class="Bound">d</a><a id="6761" class="Symbol">}</a> <a id="6763" href="Data.Nat.GCD.html#6763" class="Bound">d∣gcd[cm,cn]/c</a>
    <a id="6782" class="Keyword">with</a> <a id="6787" href="Data.Nat.GCD.html#6787" class="Bound">cd∣gcd[cm,n]</a> ← <a id="6802" href="Data.Nat.Divisibility.html#7920" class="Function">m∣n/o⇒o*m∣n</a> <a id="6814" class="Symbol">(</a><a id="6815" href="Data.Nat.GCD.html#3132" class="Function">gcd-greatest</a> <a id="6828" class="Symbol">(</a><a id="6829" href="Data.Nat.Divisibility.html#4883" class="Function">m∣m*n</a> <a id="6835" href="Data.Nat.GCD.html#6461" class="Bound">m</a><a id="6836" class="Symbol">)</a> <a id="6838" class="Symbol">(</a><a id="6839" href="Data.Nat.Divisibility.html#4883" class="Function">m∣m*n</a> <a id="6845" href="Data.Nat.GCD.html#6463" class="Bound">n</a><a id="6846" class="Symbol">))</a> <a id="6849" href="Data.Nat.GCD.html#6763" class="Bound">d∣gcd[cm,cn]/c</a>
    <a id="6868" class="Symbol">=</a> <a id="6870" href="Data.Nat.Divisibility.html#5811" class="Function">*-cancelˡ-∣</a> <a id="6882" href="Data.Nat.GCD.html#6459" class="Bound">c</a> <a id="6884" class="Symbol">(</a><a id="6885" href="Data.Nat.Divisibility.html#2354" class="Function">∣-trans</a> <a id="6893" href="Data.Nat.GCD.html#6787" class="Bound">cd∣gcd[cm,n]</a> <a id="6906" class="Symbol">(</a><a id="6907" href="Data.Nat.GCD.html#2719" class="Function">gcd[m,n]∣m</a> <a id="6918" class="Symbol">(</a><a id="6919" href="Data.Nat.GCD.html#6459" class="Bound">c</a> <a id="6921" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="6923" href="Data.Nat.GCD.html#6461" class="Bound">m</a><a id="6924" class="Symbol">)</a> <a id="6926" class="Symbol">_))</a> <a id="6930" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a>
      <a id="6938" href="Data.Nat.Divisibility.html#5811" class="Function">*-cancelˡ-∣</a> <a id="6950" href="Data.Nat.GCD.html#6459" class="Bound">c</a> <a id="6952" class="Symbol">(</a><a id="6953" href="Data.Nat.Divisibility.html#2354" class="Function">∣-trans</a> <a id="6961" href="Data.Nat.GCD.html#6787" class="Bound">cd∣gcd[cm,n]</a> <a id="6974" class="Symbol">(</a><a id="6975" href="Data.Nat.GCD.html#2921" class="Function">gcd[m,n]∣n</a> <a id="6986" class="Symbol">(</a><a id="6987" href="Data.Nat.GCD.html#6459" class="Bound">c</a> <a id="6989" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="6991" href="Data.Nat.GCD.html#6461" class="Bound">m</a><a id="6992" class="Symbol">)</a> <a id="6994" class="Symbol">_))</a>

<a id="c*gcd[m,n]≡gcd[cm,cn]"></a><a id="6999" href="Data.Nat.GCD.html#6999" class="Function">c*gcd[m,n]≡gcd[cm,cn]</a> <a id="7021" class="Symbol">:</a> <a id="7023" class="Symbol">∀</a> <a id="7025" href="Data.Nat.GCD.html#7025" class="Bound">c</a> <a id="7027" href="Data.Nat.GCD.html#7027" class="Bound">m</a> <a id="7029" href="Data.Nat.GCD.html#7029" class="Bound">n</a> <a id="7031" class="Symbol">→</a> <a id="7033" href="Data.Nat.GCD.html#7025" class="Bound">c</a> <a id="7035" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="7037" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="7041" href="Data.Nat.GCD.html#7027" class="Bound">m</a> <a id="7043" href="Data.Nat.GCD.html#7029" class="Bound">n</a> <a id="7045" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="7047" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="7051" class="Symbol">(</a><a id="7052" href="Data.Nat.GCD.html#7025" class="Bound">c</a> <a id="7054" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="7056" href="Data.Nat.GCD.html#7027" class="Bound">m</a><a id="7057" class="Symbol">)</a> <a id="7059" class="Symbol">(</a><a id="7060" href="Data.Nat.GCD.html#7025" class="Bound">c</a> <a id="7062" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="7064" href="Data.Nat.GCD.html#7029" class="Bound">n</a><a id="7065" class="Symbol">)</a>
<a id="7067" href="Data.Nat.GCD.html#6999" class="Function">c*gcd[m,n]≡gcd[cm,cn]</a> <a id="7089" href="Agda.Builtin.Nat.html#204" class="InductiveConstructor">zero</a>      <a id="7099" href="Data.Nat.GCD.html#7099" class="Bound">m</a> <a id="7101" href="Data.Nat.GCD.html#7101" class="Bound">n</a> <a id="7103" class="Symbol">=</a> <a id="7105" href="Relation.Binary.PropositionalEquality.Core.html#1712" class="Function">P.sym</a> <a id="7111" href="Data.Nat.GCD.html#3546" class="Function">gcd[0,0]≡0</a>
<a id="7122" href="Data.Nat.GCD.html#6999" class="Function">c*gcd[m,n]≡gcd[cm,cn]</a> <a id="7144" href="Data.Nat.GCD.html#7144" class="Bound">c</a><a id="7145" class="Symbol">@(</a><a id="7147" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="7151" class="Symbol">_)</a> <a id="7154" href="Data.Nat.GCD.html#7154" class="Bound">m</a> <a id="7156" href="Data.Nat.GCD.html#7156" class="Bound">n</a> <a id="7158" class="Symbol">=</a> <a id="7160" href="Relation.Binary.PropositionalEquality.Core.html#2834" class="Function Operator">begin</a>
  <a id="7168" href="Data.Nat.GCD.html#7144" class="Bound">c</a> <a id="7170" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="7172" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="7176" href="Data.Nat.GCD.html#7154" class="Bound">m</a> <a id="7178" href="Data.Nat.GCD.html#7156" class="Bound">n</a>                   <a id="7198" href="Relation.Binary.PropositionalEquality.Core.html#2951" class="Function">≡⟨</a> <a id="7201" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a> <a id="7206" class="Symbol">(</a><a id="7207" href="Data.Nat.GCD.html#7144" class="Bound">c</a> <a id="7209" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*_</a><a id="7211" class="Symbol">)</a> <a id="7213" class="Symbol">(</a><a id="7214" href="Relation.Binary.PropositionalEquality.Core.html#1712" class="Function">P.sym</a> <a id="7220" class="Symbol">(</a><a id="7221" href="Data.Nat.GCD.html#6350" class="Function">gcd[cm,cn]/c≡gcd[m,n]</a> <a id="7243" href="Data.Nat.GCD.html#7144" class="Bound">c</a> <a id="7245" href="Data.Nat.GCD.html#7154" class="Bound">m</a> <a id="7247" href="Data.Nat.GCD.html#7156" class="Bound">n</a><a id="7248" class="Symbol">))</a> <a id="7251" href="Relation.Binary.PropositionalEquality.Core.html#2951" class="Function">⟩</a>
  <a id="7255" href="Data.Nat.GCD.html#7144" class="Bound">c</a> <a id="7257" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="7259" class="Symbol">(</a><a id="7260" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="7264" class="Symbol">(</a><a id="7265" href="Data.Nat.GCD.html#7144" class="Bound">c</a> <a id="7267" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="7269" href="Data.Nat.GCD.html#7154" class="Bound">m</a><a id="7270" class="Symbol">)</a> <a id="7272" class="Symbol">(</a><a id="7273" href="Data.Nat.GCD.html#7144" class="Bound">c</a> <a id="7275" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="7277" href="Data.Nat.GCD.html#7156" class="Bound">n</a><a id="7278" class="Symbol">)</a> <a id="7280" href="Data.Nat.Base.html#5110" class="Function Operator">/</a> <a id="7282" href="Data.Nat.GCD.html#7144" class="Bound">c</a><a id="7283" class="Symbol">)</a> <a id="7285" href="Relation.Binary.PropositionalEquality.Core.html#2951" class="Function">≡⟨</a> <a id="7288" href="Data.Nat.DivMod.html#8402" class="Function">m*[n/m]≡n</a> <a id="7298" class="Symbol">(</a><a id="7299" href="Data.Nat.GCD.html#3132" class="Function">gcd-greatest</a> <a id="7312" class="Symbol">(</a><a id="7313" href="Data.Nat.Divisibility.html#4883" class="Function">m∣m*n</a> <a id="7319" href="Data.Nat.GCD.html#7154" class="Bound">m</a><a id="7320" class="Symbol">)</a> <a id="7322" class="Symbol">(</a><a id="7323" href="Data.Nat.Divisibility.html#4883" class="Function">m∣m*n</a> <a id="7329" href="Data.Nat.GCD.html#7156" class="Bound">n</a><a id="7330" class="Symbol">))</a> <a id="7333" href="Relation.Binary.PropositionalEquality.Core.html#2951" class="Function">⟩</a>
  <a id="7337" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="7341" class="Symbol">(</a><a id="7342" href="Data.Nat.GCD.html#7144" class="Bound">c</a> <a id="7344" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="7346" href="Data.Nat.GCD.html#7154" class="Bound">m</a><a id="7347" class="Symbol">)</a> <a id="7349" class="Symbol">(</a><a id="7350" href="Data.Nat.GCD.html#7144" class="Bound">c</a> <a id="7352" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="7354" href="Data.Nat.GCD.html#7156" class="Bound">n</a><a id="7355" class="Symbol">)</a>           <a id="7367" href="Relation.Binary.PropositionalEquality.Core.html#3133" class="Function Operator">∎</a>
  <a id="7371" class="Keyword">where</a> <a id="7377" class="Keyword">open</a> <a id="7382" href="Relation.Binary.PropositionalEquality.Core.html#2736" class="Module">P.≡-Reasoning</a>

<a id="gcd[m,n]≤n"></a><a id="7397" href="Data.Nat.GCD.html#7397" class="Function">gcd[m,n]≤n</a> <a id="7408" class="Symbol">:</a> <a id="7410" class="Symbol">∀</a> <a id="7412" href="Data.Nat.GCD.html#7412" class="Bound">m</a> <a id="7414" href="Data.Nat.GCD.html#7414" class="Bound">n</a> <a id="7416" class="Symbol">.{{</a><a id="7419" href="Data.Nat.GCD.html#7419" class="Bound">_</a> <a id="7421" class="Symbol">:</a> <a id="7423" href="Data.Nat.Base.html#2570" class="Record">NonZero</a> <a id="7431" href="Data.Nat.GCD.html#7414" class="Bound">n</a><a id="7432" class="Symbol">}}</a> <a id="7435" class="Symbol">→</a> <a id="7437" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="7441" href="Data.Nat.GCD.html#7412" class="Bound">m</a> <a id="7443" href="Data.Nat.GCD.html#7414" class="Bound">n</a> <a id="7445" href="Data.Nat.Base.html#1544" class="Datatype Operator">≤</a> <a id="7447" href="Data.Nat.GCD.html#7414" class="Bound">n</a>
<a id="7449" href="Data.Nat.GCD.html#7397" class="Function">gcd[m,n]≤n</a> <a id="7460" href="Data.Nat.GCD.html#7460" class="Bound">m</a> <a id="7462" href="Data.Nat.GCD.html#7462" class="Bound">n</a> <a id="7464" class="Symbol">=</a> <a id="7466" href="Data.Nat.Divisibility.html#1747" class="Function">∣⇒≤</a> <a id="7470" class="Symbol">(</a><a id="7471" href="Data.Nat.GCD.html#2921" class="Function">gcd[m,n]∣n</a> <a id="7482" href="Data.Nat.GCD.html#7460" class="Bound">m</a> <a id="7484" href="Data.Nat.GCD.html#7462" class="Bound">n</a><a id="7485" class="Symbol">)</a>

<a id="n/gcd[m,n]≢0"></a><a id="7488" href="Data.Nat.GCD.html#7488" class="Function">n/gcd[m,n]≢0</a> <a id="7501" class="Symbol">:</a> <a id="7503" class="Symbol">∀</a> <a id="7505" href="Data.Nat.GCD.html#7505" class="Bound">m</a> <a id="7507" href="Data.Nat.GCD.html#7507" class="Bound">n</a> <a id="7509" class="Symbol">.{{</a><a id="7512" href="Data.Nat.GCD.html#7512" class="Bound">_</a> <a id="7514" class="Symbol">:</a> <a id="7516" href="Data.Nat.Base.html#2570" class="Record">NonZero</a> <a id="7524" href="Data.Nat.GCD.html#7507" class="Bound">n</a><a id="7525" class="Symbol">}}</a> <a id="7528" class="Symbol">.{{</a><a id="7531" href="Data.Nat.GCD.html#7531" class="Bound">gcd≢0</a> <a id="7537" class="Symbol">:</a> <a id="7539" href="Data.Nat.Base.html#2570" class="Record">NonZero</a> <a id="7547" class="Symbol">(</a><a id="7548" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="7552" href="Data.Nat.GCD.html#7505" class="Bound">m</a> <a id="7554" href="Data.Nat.GCD.html#7507" class="Bound">n</a><a id="7555" class="Symbol">)}}</a> <a id="7559" class="Symbol">→</a>
               <a id="7576" href="Data.Nat.GCD.html#7507" class="Bound">n</a> <a id="7578" href="Data.Nat.Base.html#5110" class="Function Operator">/</a> <a id="7580" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="7584" href="Data.Nat.GCD.html#7505" class="Bound">m</a> <a id="7586" href="Data.Nat.GCD.html#7507" class="Bound">n</a> <a id="7588" href="Relation.Binary.PropositionalEquality.Core.html#858" class="Function Operator">≢</a> <a id="7590" class="Number">0</a>
<a id="7592" href="Data.Nat.GCD.html#7488" class="Function">n/gcd[m,n]≢0</a> <a id="7605" href="Data.Nat.GCD.html#7605" class="Bound">m</a> <a id="7607" href="Data.Nat.GCD.html#7607" class="Bound">n</a> <a id="7609" class="Symbol">=</a> <a id="7611" href="Data.Nat.Properties.html#12423" class="Function">m&lt;n⇒n≢0</a> <a id="7619" class="Symbol">(</a><a id="7620" href="Data.Nat.DivMod.html#9979" class="Function">m≥n⇒m/n&gt;0</a> <a id="7630" class="Symbol">{</a><a id="7631" href="Data.Nat.GCD.html#7607" class="Bound">n</a><a id="7632" class="Symbol">}</a> <a id="7634" class="Symbol">{</a><a id="7635" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="7639" href="Data.Nat.GCD.html#7605" class="Bound">m</a> <a id="7641" href="Data.Nat.GCD.html#7607" class="Bound">n</a><a id="7642" class="Symbol">}</a> <a id="7644" class="Symbol">(</a><a id="7645" href="Data.Nat.GCD.html#7397" class="Function">gcd[m,n]≤n</a> <a id="7656" href="Data.Nat.GCD.html#7605" class="Bound">m</a> <a id="7658" href="Data.Nat.GCD.html#7607" class="Bound">n</a><a id="7659" class="Symbol">))</a>

<a id="m/gcd[m,n]≢0"></a><a id="7663" href="Data.Nat.GCD.html#7663" class="Function">m/gcd[m,n]≢0</a> <a id="7676" class="Symbol">:</a> <a id="7678" class="Symbol">∀</a> <a id="7680" href="Data.Nat.GCD.html#7680" class="Bound">m</a> <a id="7682" href="Data.Nat.GCD.html#7682" class="Bound">n</a> <a id="7684" class="Symbol">.{{</a><a id="7687" href="Data.Nat.GCD.html#7687" class="Bound">_</a> <a id="7689" class="Symbol">:</a> <a id="7691" href="Data.Nat.Base.html#2570" class="Record">NonZero</a> <a id="7699" href="Data.Nat.GCD.html#7680" class="Bound">m</a><a id="7700" class="Symbol">}}</a> <a id="7703" class="Symbol">.{{</a><a id="7706" href="Data.Nat.GCD.html#7706" class="Bound">gcd≢0</a> <a id="7712" class="Symbol">:</a> <a id="7714" href="Data.Nat.Base.html#2570" class="Record">NonZero</a> <a id="7722" class="Symbol">(</a><a id="7723" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="7727" href="Data.Nat.GCD.html#7680" class="Bound">m</a> <a id="7729" href="Data.Nat.GCD.html#7682" class="Bound">n</a><a id="7730" class="Symbol">)}}</a> <a id="7734" class="Symbol">→</a>
               <a id="7751" href="Data.Nat.GCD.html#7680" class="Bound">m</a> <a id="7753" href="Data.Nat.Base.html#5110" class="Function Operator">/</a> <a id="7755" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="7759" href="Data.Nat.GCD.html#7680" class="Bound">m</a> <a id="7761" href="Data.Nat.GCD.html#7682" class="Bound">n</a> <a id="7763" href="Relation.Binary.PropositionalEquality.Core.html#858" class="Function Operator">≢</a> <a id="7765" class="Number">0</a>
<a id="7767" href="Data.Nat.GCD.html#7663" class="Function">m/gcd[m,n]≢0</a> <a id="7780" href="Data.Nat.GCD.html#7780" class="Bound">m</a> <a id="7782" href="Data.Nat.GCD.html#7782" class="Bound">n</a> <a id="7784" class="Keyword">rewrite</a> <a id="7792" href="Data.Nat.GCD.html#4179" class="Function">gcd-comm</a> <a id="7801" href="Data.Nat.GCD.html#7780" class="Bound">m</a> <a id="7803" href="Data.Nat.GCD.html#7782" class="Bound">n</a> <a id="7805" class="Symbol">=</a> <a id="7807" href="Data.Nat.GCD.html#7488" class="Function">n/gcd[m,n]≢0</a> <a id="7820" href="Data.Nat.GCD.html#7782" class="Bound">n</a> <a id="7822" href="Data.Nat.GCD.html#7780" class="Bound">m</a>

<a id="7825" class="Comment">------------------------------------------------------------------------</a>
<a id="7898" class="Comment">-- A formal specification of GCD</a>

<a id="7932" class="Keyword">module</a> <a id="GCD"></a><a id="7939" href="Data.Nat.GCD.html#7939" class="Module">GCD</a> <a id="7943" class="Keyword">where</a>

  <a id="7952" class="Comment">-- Specification of the greatest common divisor (gcd) of two natural</a>
  <a id="8023" class="Comment">-- numbers.</a>

  <a id="8038" class="Keyword">record</a> <a id="GCD.GCD"></a><a id="8045" href="Data.Nat.GCD.html#8045" class="Record">GCD</a> <a id="8049" class="Symbol">(</a><a id="8050" href="Data.Nat.GCD.html#8050" class="Bound">m</a> <a id="8052" href="Data.Nat.GCD.html#8052" class="Bound">n</a> <a id="8054" href="Data.Nat.GCD.html#8054" class="Bound">gcd</a> <a id="8058" class="Symbol">:</a> <a id="8060" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="8061" class="Symbol">)</a> <a id="8063" class="Symbol">:</a> <a id="8065" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="8069" class="Keyword">where</a>
    <a id="8079" class="Keyword">constructor</a> <a id="GCD.is"></a><a id="8091" href="Data.Nat.GCD.html#8091" class="InductiveConstructor">is</a>
    <a id="8098" class="Keyword">field</a>
      <a id="8110" class="Comment">-- The gcd is a common divisor.</a>
      <a id="GCD.GCD.commonDivisor"></a><a id="8148" href="Data.Nat.GCD.html#8148" class="Field">commonDivisor</a> <a id="8162" class="Symbol">:</a> <a id="8164" href="Data.Nat.GCD.html#8054" class="Bound">gcd</a> <a id="8168" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="8170" href="Data.Nat.GCD.html#8050" class="Bound">m</a> <a id="8172" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="8174" href="Data.Nat.GCD.html#8054" class="Bound">gcd</a> <a id="8178" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="8180" href="Data.Nat.GCD.html#8052" class="Bound">n</a>

      <a id="8189" class="Comment">-- All common divisors divide the gcd, i.e. the gcd is the</a>
      <a id="8254" class="Comment">-- greatest common divisor according to the partial order _∣_.</a>
      <a id="GCD.GCD.greatest"></a><a id="8323" href="Data.Nat.GCD.html#8323" class="Field">greatest</a> <a id="8332" class="Symbol">:</a> <a id="8334" class="Symbol">∀</a> <a id="8336" class="Symbol">{</a><a id="8337" href="Data.Nat.GCD.html#8337" class="Bound">d</a><a id="8338" class="Symbol">}</a> <a id="8340" class="Symbol">→</a> <a id="8342" href="Data.Nat.GCD.html#8337" class="Bound">d</a> <a id="8344" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="8346" href="Data.Nat.GCD.html#8050" class="Bound">m</a> <a id="8348" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="8350" href="Data.Nat.GCD.html#8337" class="Bound">d</a> <a id="8352" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="8354" href="Data.Nat.GCD.html#8052" class="Bound">n</a> <a id="8356" class="Symbol">→</a> <a id="8358" href="Data.Nat.GCD.html#8337" class="Bound">d</a> <a id="8360" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="8362" href="Data.Nat.GCD.html#8054" class="Bound">gcd</a>

    <a id="GCD.GCD.gcd∣m"></a><a id="8371" href="Data.Nat.GCD.html#8371" class="Function">gcd∣m</a> <a id="8377" class="Symbol">:</a> <a id="8379" href="Data.Nat.GCD.html#8054" class="Bound">gcd</a> <a id="8383" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="8385" href="Data.Nat.GCD.html#8050" class="Bound">m</a>
    <a id="8391" href="Data.Nat.GCD.html#8371" class="Function">gcd∣m</a> <a id="8397" class="Symbol">=</a> <a id="8399" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="8405" href="Data.Nat.GCD.html#8148" class="Field">commonDivisor</a>

    <a id="GCD.GCD.gcd∣n"></a><a id="8424" href="Data.Nat.GCD.html#8424" class="Function">gcd∣n</a> <a id="8430" class="Symbol">:</a> <a id="8432" href="Data.Nat.GCD.html#8054" class="Bound">gcd</a> <a id="8436" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="8438" href="Data.Nat.GCD.html#8052" class="Bound">n</a>
    <a id="8444" href="Data.Nat.GCD.html#8424" class="Function">gcd∣n</a> <a id="8450" class="Symbol">=</a> <a id="8452" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="8458" href="Data.Nat.GCD.html#8148" class="Field">commonDivisor</a>

  <a id="8475" class="Keyword">open</a> <a id="8480" href="Data.Nat.GCD.html#8045" class="Module">GCD</a> <a id="8484" class="Keyword">public</a>


  <a id="8495" class="Comment">-- The gcd is unique.</a>

  <a id="GCD.unique"></a><a id="8520" href="Data.Nat.GCD.html#8520" class="Function">unique</a> <a id="8527" class="Symbol">:</a> <a id="8529" class="Symbol">∀</a> <a id="8531" class="Symbol">{</a><a id="8532" href="Data.Nat.GCD.html#8532" class="Bound">d₁</a> <a id="8535" href="Data.Nat.GCD.html#8535" class="Bound">d₂</a> <a id="8538" href="Data.Nat.GCD.html#8538" class="Bound">m</a> <a id="8540" href="Data.Nat.GCD.html#8540" class="Bound">n</a><a id="8541" class="Symbol">}</a> <a id="8543" class="Symbol">→</a> <a id="8545" href="Data.Nat.GCD.html#8045" class="Record">GCD</a> <a id="8549" href="Data.Nat.GCD.html#8538" class="Bound">m</a> <a id="8551" href="Data.Nat.GCD.html#8540" class="Bound">n</a> <a id="8553" href="Data.Nat.GCD.html#8532" class="Bound">d₁</a> <a id="8556" class="Symbol">→</a> <a id="8558" href="Data.Nat.GCD.html#8045" class="Record">GCD</a> <a id="8562" href="Data.Nat.GCD.html#8538" class="Bound">m</a> <a id="8564" href="Data.Nat.GCD.html#8540" class="Bound">n</a> <a id="8566" href="Data.Nat.GCD.html#8535" class="Bound">d₂</a> <a id="8569" class="Symbol">→</a> <a id="8571" href="Data.Nat.GCD.html#8532" class="Bound">d₁</a> <a id="8574" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="8576" href="Data.Nat.GCD.html#8535" class="Bound">d₂</a>
  <a id="8581" href="Data.Nat.GCD.html#8520" class="Function">unique</a> <a id="8588" href="Data.Nat.GCD.html#8588" class="Bound">d₁</a> <a id="8591" href="Data.Nat.GCD.html#8591" class="Bound">d₂</a> <a id="8594" class="Symbol">=</a> <a id="8596" href="Data.Nat.Divisibility.html#2464" class="Function">∣-antisym</a> <a id="8606" class="Symbol">(</a><a id="8607" href="Data.Nat.GCD.html#8323" class="Field">GCD.greatest</a> <a id="8620" href="Data.Nat.GCD.html#8591" class="Bound">d₂</a> <a id="8623" class="Symbol">(</a><a id="8624" href="Data.Nat.GCD.html#8148" class="Field">GCD.commonDivisor</a> <a id="8642" href="Data.Nat.GCD.html#8588" class="Bound">d₁</a><a id="8644" class="Symbol">))</a>
                           <a id="8674" class="Symbol">(</a><a id="8675" href="Data.Nat.GCD.html#8323" class="Field">GCD.greatest</a> <a id="8688" href="Data.Nat.GCD.html#8588" class="Bound">d₁</a> <a id="8691" class="Symbol">(</a><a id="8692" href="Data.Nat.GCD.html#8148" class="Field">GCD.commonDivisor</a> <a id="8710" href="Data.Nat.GCD.html#8591" class="Bound">d₂</a><a id="8712" class="Symbol">))</a>

  <a id="8718" class="Comment">-- The gcd relation is &quot;symmetric&quot;.</a>

  <a id="GCD.sym"></a><a id="8757" href="Data.Nat.GCD.html#8757" class="Function">sym</a> <a id="8761" class="Symbol">:</a> <a id="8763" class="Symbol">∀</a> <a id="8765" class="Symbol">{</a><a id="8766" href="Data.Nat.GCD.html#8766" class="Bound">d</a> <a id="8768" href="Data.Nat.GCD.html#8768" class="Bound">m</a> <a id="8770" href="Data.Nat.GCD.html#8770" class="Bound">n</a><a id="8771" class="Symbol">}</a> <a id="8773" class="Symbol">→</a> <a id="8775" href="Data.Nat.GCD.html#8045" class="Record">GCD</a> <a id="8779" href="Data.Nat.GCD.html#8768" class="Bound">m</a> <a id="8781" href="Data.Nat.GCD.html#8770" class="Bound">n</a> <a id="8783" href="Data.Nat.GCD.html#8766" class="Bound">d</a> <a id="8785" class="Symbol">→</a> <a id="8787" href="Data.Nat.GCD.html#8045" class="Record">GCD</a> <a id="8791" href="Data.Nat.GCD.html#8770" class="Bound">n</a> <a id="8793" href="Data.Nat.GCD.html#8768" class="Bound">m</a> <a id="8795" href="Data.Nat.GCD.html#8766" class="Bound">d</a>
  <a id="8799" href="Data.Nat.GCD.html#8757" class="Function">sym</a> <a id="8803" href="Data.Nat.GCD.html#8803" class="Bound">g</a> <a id="8805" class="Symbol">=</a> <a id="8807" href="Data.Nat.GCD.html#8091" class="InductiveConstructor">is</a> <a id="8810" class="Symbol">(</a><a id="8811" href="Data.Product.Base.html#5054" class="Function">swap</a> <a id="8816" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="8818" href="Data.Nat.GCD.html#8148" class="Field">GCD.commonDivisor</a> <a id="8836" href="Data.Nat.GCD.html#8803" class="Bound">g</a><a id="8837" class="Symbol">)</a> <a id="8839" class="Symbol">(</a><a id="8840" href="Data.Nat.GCD.html#8323" class="Field">GCD.greatest</a> <a id="8853" href="Data.Nat.GCD.html#8803" class="Bound">g</a> <a id="8855" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="8857" href="Data.Product.Base.html#5054" class="Function">swap</a><a id="8861" class="Symbol">)</a>

  <a id="8866" class="Comment">-- The gcd relation is &quot;reflexive&quot;.</a>

  <a id="GCD.refl"></a><a id="8905" href="Data.Nat.GCD.html#8905" class="Function">refl</a> <a id="8910" class="Symbol">:</a> <a id="8912" class="Symbol">∀</a> <a id="8914" class="Symbol">{</a><a id="8915" href="Data.Nat.GCD.html#8915" class="Bound">n</a><a id="8916" class="Symbol">}</a> <a id="8918" class="Symbol">→</a> <a id="8920" href="Data.Nat.GCD.html#8045" class="Record">GCD</a> <a id="8924" href="Data.Nat.GCD.html#8915" class="Bound">n</a> <a id="8926" href="Data.Nat.GCD.html#8915" class="Bound">n</a> <a id="8928" href="Data.Nat.GCD.html#8915" class="Bound">n</a>
  <a id="8932" href="Data.Nat.GCD.html#8905" class="Function">refl</a> <a id="8937" class="Symbol">=</a> <a id="8939" href="Data.Nat.GCD.html#8091" class="InductiveConstructor">is</a> <a id="8942" class="Symbol">(</a><a id="8943" href="Data.Nat.Divisibility.html#2304" class="Function">∣-refl</a> <a id="8950" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="8952" href="Data.Nat.Divisibility.html#2304" class="Function">∣-refl</a><a id="8958" class="Symbol">)</a> <a id="8960" href="Data.Product.Base.html#636" class="Field">proj₁</a>

  <a id="8969" class="Comment">-- The GCD of 0 and n is n.</a>

  <a id="GCD.base"></a><a id="9000" href="Data.Nat.GCD.html#9000" class="Function">base</a> <a id="9005" class="Symbol">:</a> <a id="9007" class="Symbol">∀</a> <a id="9009" class="Symbol">{</a><a id="9010" href="Data.Nat.GCD.html#9010" class="Bound">n</a><a id="9011" class="Symbol">}</a> <a id="9013" class="Symbol">→</a> <a id="9015" href="Data.Nat.GCD.html#8045" class="Record">GCD</a> <a id="9019" class="Number">0</a> <a id="9021" href="Data.Nat.GCD.html#9010" class="Bound">n</a> <a id="9023" href="Data.Nat.GCD.html#9010" class="Bound">n</a>
  <a id="9027" href="Data.Nat.GCD.html#9000" class="Function">base</a> <a id="9032" class="Symbol">{</a><a id="9033" href="Data.Nat.GCD.html#9033" class="Bound">n</a><a id="9034" class="Symbol">}</a> <a id="9036" class="Symbol">=</a> <a id="9038" href="Data.Nat.GCD.html#8091" class="InductiveConstructor">is</a> <a id="9041" class="Symbol">(</a><a id="9042" href="Data.Nat.GCD.html#9033" class="Bound">n</a> <a id="9044" href="Data.Nat.Divisibility.html#3889" class="Function Operator">∣0</a> <a id="9047" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="9049" href="Data.Nat.Divisibility.html#2304" class="Function">∣-refl</a><a id="9055" class="Symbol">)</a> <a id="9057" href="Data.Product.Base.html#650" class="Field">proj₂</a>

  <a id="9066" class="Comment">-- If d is the gcd of n and k, then it is also the gcd of n and</a>
  <a id="9132" class="Comment">-- n + k.</a>

  <a id="GCD.step"></a><a id="9145" href="Data.Nat.GCD.html#9145" class="Function">step</a> <a id="9150" class="Symbol">:</a> <a id="9152" class="Symbol">∀</a> <a id="9154" class="Symbol">{</a><a id="9155" href="Data.Nat.GCD.html#9155" class="Bound">n</a> <a id="9157" href="Data.Nat.GCD.html#9157" class="Bound">k</a> <a id="9159" href="Data.Nat.GCD.html#9159" class="Bound">d</a><a id="9160" class="Symbol">}</a> <a id="9162" class="Symbol">→</a> <a id="9164" href="Data.Nat.GCD.html#8045" class="Record">GCD</a> <a id="9168" href="Data.Nat.GCD.html#9155" class="Bound">n</a> <a id="9170" href="Data.Nat.GCD.html#9157" class="Bound">k</a> <a id="9172" href="Data.Nat.GCD.html#9159" class="Bound">d</a> <a id="9174" class="Symbol">→</a> <a id="9176" href="Data.Nat.GCD.html#8045" class="Record">GCD</a> <a id="9180" href="Data.Nat.GCD.html#9155" class="Bound">n</a> <a id="9182" class="Symbol">(</a><a id="9183" href="Data.Nat.GCD.html#9155" class="Bound">n</a> <a id="9185" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="9187" href="Data.Nat.GCD.html#9157" class="Bound">k</a><a id="9188" class="Symbol">)</a> <a id="9190" href="Data.Nat.GCD.html#9159" class="Bound">d</a>
  <a id="9194" href="Data.Nat.GCD.html#9145" class="Function">step</a> <a id="9199" class="Symbol">{</a><a id="9200" href="Data.Nat.GCD.html#9200" class="Bound">n</a><a id="9201" class="Symbol">}</a> <a id="9203" class="Symbol">{</a><a id="9204" href="Data.Nat.GCD.html#9204" class="Bound">k</a><a id="9205" class="Symbol">}</a> <a id="9207" class="Symbol">{</a><a id="9208" href="Data.Nat.GCD.html#9208" class="Bound">d</a><a id="9209" class="Symbol">}</a> <a id="9211" href="Data.Nat.GCD.html#9211" class="Bound">g</a> <a id="9213" class="Keyword">with</a> <a id="9218" href="Data.Nat.GCD.html#9218" class="Bound">d₁</a> <a id="9221" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="9223" href="Data.Nat.GCD.html#9223" class="Bound">d₂</a> ← <a id="9228" href="Data.Nat.GCD.html#8148" class="Field">GCD.commonDivisor</a> <a id="9246" href="Data.Nat.GCD.html#9211" class="Bound">g</a>
    <a id="9252" class="Symbol">=</a> <a id="9254" href="Data.Nat.GCD.html#8091" class="InductiveConstructor">is</a> <a id="9257" class="Symbol">(</a><a id="9258" href="Data.Nat.GCD.html#9218" class="Bound">d₁</a> <a id="9261" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="9263" href="Data.Nat.Divisibility.html#4207" class="Function">∣m∣n⇒∣m+n</a> <a id="9273" href="Data.Nat.GCD.html#9218" class="Bound">d₁</a> <a id="9276" href="Data.Nat.GCD.html#9223" class="Bound">d₂</a><a id="9278" class="Symbol">)</a> <a id="9280" href="Data.Nat.GCD.html#9304" class="Function">greatest′</a>
    <a id="9294" class="Keyword">where</a>
    <a id="9304" href="Data.Nat.GCD.html#9304" class="Function">greatest′</a> <a id="9314" class="Symbol">:</a> <a id="9316" class="Symbol">∀</a> <a id="9318" class="Symbol">{</a><a id="9319" href="Data.Nat.GCD.html#9319" class="Bound">d′</a><a id="9321" class="Symbol">}</a> <a id="9323" class="Symbol">→</a> <a id="9325" href="Data.Nat.GCD.html#9319" class="Bound">d′</a> <a id="9328" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="9330" href="Data.Nat.GCD.html#9200" class="Bound">n</a> <a id="9332" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="9334" href="Data.Nat.GCD.html#9319" class="Bound">d′</a> <a id="9337" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="9339" href="Data.Nat.GCD.html#9200" class="Bound">n</a> <a id="9341" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="9343" href="Data.Nat.GCD.html#9204" class="Bound">k</a> <a id="9345" class="Symbol">→</a> <a id="9347" href="Data.Nat.GCD.html#9319" class="Bound">d′</a> <a id="9350" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="9352" href="Data.Nat.GCD.html#9208" class="Bound">d</a>
    <a id="9358" href="Data.Nat.GCD.html#9304" class="Function">greatest′</a> <a id="9368" class="Symbol">(</a><a id="9369" href="Data.Nat.GCD.html#9369" class="Bound">d₁</a> <a id="9372" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="9374" href="Data.Nat.GCD.html#9374" class="Bound">d₂</a><a id="9376" class="Symbol">)</a> <a id="9378" class="Symbol">=</a> <a id="9380" href="Data.Nat.GCD.html#8323" class="Field">GCD.greatest</a> <a id="9393" href="Data.Nat.GCD.html#9211" class="Bound">g</a> <a id="9395" class="Symbol">(</a><a id="9396" href="Data.Nat.GCD.html#9369" class="Bound">d₁</a> <a id="9399" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="9401" href="Data.Nat.Divisibility.html#4349" class="Function">∣m+n∣m⇒∣n</a> <a id="9411" href="Data.Nat.GCD.html#9374" class="Bound">d₂</a> <a id="9414" href="Data.Nat.GCD.html#9369" class="Bound">d₁</a><a id="9416" class="Symbol">)</a>

<a id="9419" class="Keyword">open</a> <a id="9424" href="Data.Nat.GCD.html#7939" class="Module">GCD</a> <a id="9428" class="Keyword">public</a> <a id="9435" class="Keyword">using</a> <a id="9441" class="Symbol">(</a><a id="9442" href="Data.Nat.GCD.html#8045" class="Record">GCD</a><a id="9445" class="Symbol">)</a> <a id="9447" class="Keyword">hiding</a> <a id="9454" class="Symbol">(</a><a id="9455" class="Keyword">module</a> <a id="9462" href="Data.Nat.GCD.html#8045" class="Module">GCD</a><a id="9465" class="Symbol">)</a>

<a id="9468" class="Comment">-- The function gcd fulfils the conditions required of GCD</a>

<a id="gcd-GCD"></a><a id="9528" href="Data.Nat.GCD.html#9528" class="Function">gcd-GCD</a> <a id="9536" class="Symbol">:</a> <a id="9538" class="Symbol">∀</a> <a id="9540" href="Data.Nat.GCD.html#9540" class="Bound">m</a> <a id="9542" href="Data.Nat.GCD.html#9542" class="Bound">n</a> <a id="9544" class="Symbol">→</a> <a id="9546" href="Data.Nat.GCD.html#8045" class="Record">GCD</a> <a id="9550" href="Data.Nat.GCD.html#9540" class="Bound">m</a> <a id="9552" href="Data.Nat.GCD.html#9542" class="Bound">n</a> <a id="9554" class="Symbol">(</a><a id="9555" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="9559" href="Data.Nat.GCD.html#9540" class="Bound">m</a> <a id="9561" href="Data.Nat.GCD.html#9542" class="Bound">n</a><a id="9562" class="Symbol">)</a>
<a id="9564" href="Data.Nat.GCD.html#9528" class="Function">gcd-GCD</a> <a id="9572" href="Data.Nat.GCD.html#9572" class="Bound">m</a> <a id="9574" href="Data.Nat.GCD.html#9574" class="Bound">n</a> <a id="9576" class="Symbol">=</a> <a id="9578" class="Keyword">record</a>
  <a id="9587" class="Symbol">{</a> <a id="9589" href="Data.Nat.GCD.html#8148" class="Field">commonDivisor</a> <a id="9603" class="Symbol">=</a> <a id="9605" href="Data.Nat.GCD.html#2719" class="Function">gcd[m,n]∣m</a> <a id="9616" href="Data.Nat.GCD.html#9572" class="Bound">m</a> <a id="9618" href="Data.Nat.GCD.html#9574" class="Bound">n</a> <a id="9620" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="9622" href="Data.Nat.GCD.html#2921" class="Function">gcd[m,n]∣n</a> <a id="9633" href="Data.Nat.GCD.html#9572" class="Bound">m</a> <a id="9635" href="Data.Nat.GCD.html#9574" class="Bound">n</a>
  <a id="9639" class="Symbol">;</a> <a id="9641" href="Data.Nat.GCD.html#8323" class="Field">greatest</a>      <a id="9655" class="Symbol">=</a> <a id="9657" href="Data.Product.Base.html#4571" class="Function">uncurry′</a> <a id="9666" href="Data.Nat.GCD.html#3132" class="Function">gcd-greatest</a>
  <a id="9681" class="Symbol">}</a>

<a id="9684" class="Comment">-- Calculates the gcd of the arguments.</a>

<a id="mkGCD"></a><a id="9725" href="Data.Nat.GCD.html#9725" class="Function">mkGCD</a> <a id="9731" class="Symbol">:</a> <a id="9733" class="Symbol">∀</a> <a id="9735" href="Data.Nat.GCD.html#9735" class="Bound">m</a> <a id="9737" href="Data.Nat.GCD.html#9737" class="Bound">n</a> <a id="9739" class="Symbol">→</a> <a id="9741" href="Data.Product.Base.html#852" class="Function">∃</a> <a id="9743" class="Symbol">λ</a> <a id="9745" href="Data.Nat.GCD.html#9745" class="Bound">d</a> <a id="9747" class="Symbol">→</a> <a id="9749" href="Data.Nat.GCD.html#8045" class="Record">GCD</a> <a id="9753" href="Data.Nat.GCD.html#9735" class="Bound">m</a> <a id="9755" href="Data.Nat.GCD.html#9737" class="Bound">n</a> <a id="9757" href="Data.Nat.GCD.html#9745" class="Bound">d</a>
<a id="9759" href="Data.Nat.GCD.html#9725" class="Function">mkGCD</a> <a id="9765" href="Data.Nat.GCD.html#9765" class="Bound">m</a> <a id="9767" href="Data.Nat.GCD.html#9767" class="Bound">n</a> <a id="9769" class="Symbol">=</a> <a id="9771" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="9775" href="Data.Nat.GCD.html#9765" class="Bound">m</a> <a id="9777" href="Data.Nat.GCD.html#9767" class="Bound">n</a> <a id="9779" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="9781" href="Data.Nat.GCD.html#9528" class="Function">gcd-GCD</a> <a id="9789" href="Data.Nat.GCD.html#9765" class="Bound">m</a> <a id="9791" href="Data.Nat.GCD.html#9767" class="Bound">n</a>

<a id="9794" class="Comment">-- gcd as a proposition is decidable</a>

<a id="gcd?"></a><a id="9832" href="Data.Nat.GCD.html#9832" class="Function">gcd?</a> <a id="9837" class="Symbol">:</a> <a id="9839" class="Symbol">(</a><a id="9840" href="Data.Nat.GCD.html#9840" class="Bound">m</a> <a id="9842" href="Data.Nat.GCD.html#9842" class="Bound">n</a> <a id="9844" href="Data.Nat.GCD.html#9844" class="Bound">d</a> <a id="9846" class="Symbol">:</a> <a id="9848" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="9849" class="Symbol">)</a> <a id="9851" class="Symbol">→</a> <a id="9853" href="Relation.Nullary.Decidable.Core.html#1490" class="Record">Dec</a> <a id="9857" class="Symbol">(</a><a id="9858" href="Data.Nat.GCD.html#8045" class="Record">GCD</a> <a id="9862" href="Data.Nat.GCD.html#9840" class="Bound">m</a> <a id="9864" href="Data.Nat.GCD.html#9842" class="Bound">n</a> <a id="9866" href="Data.Nat.GCD.html#9844" class="Bound">d</a><a id="9867" class="Symbol">)</a>
<a id="9869" href="Data.Nat.GCD.html#9832" class="Function">gcd?</a> <a id="9874" href="Data.Nat.GCD.html#9874" class="Bound">m</a> <a id="9876" href="Data.Nat.GCD.html#9876" class="Bound">n</a> <a id="9878" href="Data.Nat.GCD.html#9878" class="Bound">d</a> <a id="9880" class="Symbol">=</a>
  <a id="9884" href="Relation.Nullary.Decidable.Core.html#4796" class="Function">Dec.map′</a> <a id="9893" class="Symbol">(λ</a> <a id="9896" class="Symbol">{</a> <a id="9898" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">P.refl</a> <a id="9905" class="Symbol">→</a> <a id="9907" href="Data.Nat.GCD.html#9528" class="Function">gcd-GCD</a> <a id="9915" href="Data.Nat.GCD.html#9874" class="Bound">m</a> <a id="9917" href="Data.Nat.GCD.html#9876" class="Bound">n</a> <a id="9919" class="Symbol">})</a> <a id="9922" class="Symbol">(</a><a id="9923" href="Data.Nat.GCD.html#8520" class="Function">GCD.unique</a> <a id="9934" class="Symbol">(</a><a id="9935" href="Data.Nat.GCD.html#9528" class="Function">gcd-GCD</a> <a id="9943" href="Data.Nat.GCD.html#9874" class="Bound">m</a> <a id="9945" href="Data.Nat.GCD.html#9876" class="Bound">n</a><a id="9946" class="Symbol">))</a>
           <a id="9960" class="Symbol">(</a><a id="9961" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="9965" href="Data.Nat.GCD.html#9874" class="Bound">m</a> <a id="9967" href="Data.Nat.GCD.html#9876" class="Bound">n</a> <a id="9969" href="Data.Nat.Properties.html#2947" class="Function Operator">≟</a> <a id="9971" href="Data.Nat.GCD.html#9878" class="Bound">d</a><a id="9972" class="Symbol">)</a>

<a id="GCD-*"></a><a id="9975" href="Data.Nat.GCD.html#9975" class="Function">GCD-*</a> <a id="9981" class="Symbol">:</a> <a id="9983" class="Symbol">∀</a> <a id="9985" class="Symbol">{</a><a id="9986" href="Data.Nat.GCD.html#9986" class="Bound">m</a> <a id="9988" href="Data.Nat.GCD.html#9988" class="Bound">n</a> <a id="9990" href="Data.Nat.GCD.html#9990" class="Bound">d</a> <a id="9992" href="Data.Nat.GCD.html#9992" class="Bound">c</a><a id="9993" class="Symbol">}</a> <a id="9995" class="Symbol">.{{</a><a id="9998" href="Data.Nat.GCD.html#9998" class="Bound">_</a> <a id="10000" class="Symbol">:</a> <a id="10002" href="Data.Nat.Base.html#2570" class="Record">NonZero</a> <a id="10010" href="Data.Nat.GCD.html#9992" class="Bound">c</a><a id="10011" class="Symbol">}}</a> <a id="10014" class="Symbol">→</a> <a id="10016" href="Data.Nat.GCD.html#8045" class="Record">GCD</a> <a id="10020" class="Symbol">(</a><a id="10021" href="Data.Nat.GCD.html#9986" class="Bound">m</a> <a id="10023" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="10025" href="Data.Nat.GCD.html#9992" class="Bound">c</a><a id="10026" class="Symbol">)</a> <a id="10028" class="Symbol">(</a><a id="10029" href="Data.Nat.GCD.html#9988" class="Bound">n</a> <a id="10031" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="10033" href="Data.Nat.GCD.html#9992" class="Bound">c</a><a id="10034" class="Symbol">)</a> <a id="10036" class="Symbol">(</a><a id="10037" href="Data.Nat.GCD.html#9990" class="Bound">d</a> <a id="10039" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="10041" href="Data.Nat.GCD.html#9992" class="Bound">c</a><a id="10042" class="Symbol">)</a> <a id="10044" class="Symbol">→</a> <a id="10046" href="Data.Nat.GCD.html#8045" class="Record">GCD</a> <a id="10050" href="Data.Nat.GCD.html#9986" class="Bound">m</a> <a id="10052" href="Data.Nat.GCD.html#9988" class="Bound">n</a> <a id="10054" href="Data.Nat.GCD.html#9990" class="Bound">d</a>
<a id="10056" href="Data.Nat.GCD.html#9975" class="Function">GCD-*</a> <a id="10062" class="Symbol">{</a><a id="10063" class="Argument">c</a> <a id="10065" class="Symbol">=</a> <a id="10067" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="10071" class="Symbol">_}</a> <a id="10074" class="Symbol">(</a><a id="10075" href="Data.Nat.GCD.html#8091" class="InductiveConstructor">GCD.is</a> <a id="10082" class="Symbol">(</a><a id="10083" href="Data.Nat.GCD.html#10083" class="Bound">dc∣nc</a> <a id="10089" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="10091" href="Data.Nat.GCD.html#10091" class="Bound">dc∣mc</a><a id="10096" class="Symbol">)</a> <a id="10098" href="Data.Nat.GCD.html#10098" class="Bound">dc-greatest</a><a id="10109" class="Symbol">)</a> <a id="10111" class="Symbol">=</a>
  <a id="10115" href="Data.Nat.GCD.html#8091" class="InductiveConstructor">GCD.is</a> <a id="10122" class="Symbol">(</a><a id="10123" href="Data.Nat.Divisibility.html#6174" class="Function">*-cancelʳ-∣</a> <a id="10135" class="Symbol">_</a> <a id="10137" href="Data.Nat.GCD.html#10083" class="Bound">dc∣nc</a> <a id="10143" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="10145" href="Data.Nat.Divisibility.html#6174" class="Function">*-cancelʳ-∣</a> <a id="10157" class="Symbol">_</a> <a id="10159" href="Data.Nat.GCD.html#10091" class="Bound">dc∣mc</a><a id="10164" class="Symbol">)</a>
  <a id="10168" class="Symbol">λ</a> <a id="10170" class="Symbol">{</a><a id="10171" href="Data.Nat.GCD.html#10171" class="Bound">_</a><a id="10172" class="Symbol">}</a> <a id="10174" class="Symbol">→</a> <a id="10176" href="Data.Nat.Divisibility.html#6174" class="Function">*-cancelʳ-∣</a> <a id="10188" class="Symbol">_</a> <a id="10190" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="10192" href="Data.Nat.GCD.html#10098" class="Bound">dc-greatest</a> <a id="10204" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="10206" href="Data.Product.Base.html#2173" class="Function">map</a> <a id="10210" class="Symbol">(</a><a id="10211" href="Data.Nat.Divisibility.html#5698" class="Function">*-monoˡ-∣</a> <a id="10221" class="Symbol">_)</a> <a id="10224" class="Symbol">(</a><a id="10225" href="Data.Nat.Divisibility.html#5698" class="Function">*-monoˡ-∣</a> <a id="10235" class="Symbol">_)</a>

<a id="GCD-/"></a><a id="10239" href="Data.Nat.GCD.html#10239" class="Function">GCD-/</a> <a id="10245" class="Symbol">:</a> <a id="10247" class="Symbol">∀</a> <a id="10249" class="Symbol">{</a><a id="10250" href="Data.Nat.GCD.html#10250" class="Bound">m</a> <a id="10252" href="Data.Nat.GCD.html#10252" class="Bound">n</a> <a id="10254" href="Data.Nat.GCD.html#10254" class="Bound">d</a> <a id="10256" href="Data.Nat.GCD.html#10256" class="Bound">c</a><a id="10257" class="Symbol">}</a> <a id="10259" class="Symbol">.{{</a><a id="10262" href="Data.Nat.GCD.html#10262" class="Bound">_</a> <a id="10264" class="Symbol">:</a> <a id="10266" href="Data.Nat.Base.html#2570" class="Record">NonZero</a> <a id="10274" href="Data.Nat.GCD.html#10256" class="Bound">c</a><a id="10275" class="Symbol">}}</a> <a id="10278" class="Symbol">→</a> <a id="10280" href="Data.Nat.GCD.html#10256" class="Bound">c</a> <a id="10282" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="10284" href="Data.Nat.GCD.html#10250" class="Bound">m</a> <a id="10286" class="Symbol">→</a> <a id="10288" href="Data.Nat.GCD.html#10256" class="Bound">c</a> <a id="10290" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="10292" href="Data.Nat.GCD.html#10252" class="Bound">n</a> <a id="10294" class="Symbol">→</a> <a id="10296" href="Data.Nat.GCD.html#10256" class="Bound">c</a> <a id="10298" href="Data.Nat.Divisibility.Core.html#1160" class="Record Operator">∣</a> <a id="10300" href="Data.Nat.GCD.html#10254" class="Bound">d</a> <a id="10302" class="Symbol">→</a>
        <a id="10312" href="Data.Nat.GCD.html#8045" class="Record">GCD</a> <a id="10316" href="Data.Nat.GCD.html#10250" class="Bound">m</a> <a id="10318" href="Data.Nat.GCD.html#10252" class="Bound">n</a> <a id="10320" href="Data.Nat.GCD.html#10254" class="Bound">d</a> <a id="10322" class="Symbol">→</a> <a id="10324" href="Data.Nat.GCD.html#8045" class="Record">GCD</a> <a id="10328" class="Symbol">(</a><a id="10329" href="Data.Nat.GCD.html#10250" class="Bound">m</a> <a id="10331" href="Data.Nat.Base.html#5110" class="Function Operator">/</a> <a id="10333" href="Data.Nat.GCD.html#10256" class="Bound">c</a><a id="10334" class="Symbol">)</a> <a id="10336" class="Symbol">(</a><a id="10337" href="Data.Nat.GCD.html#10252" class="Bound">n</a> <a id="10339" href="Data.Nat.Base.html#5110" class="Function Operator">/</a> <a id="10341" href="Data.Nat.GCD.html#10256" class="Bound">c</a><a id="10342" class="Symbol">)</a> <a id="10344" class="Symbol">(</a><a id="10345" href="Data.Nat.GCD.html#10254" class="Bound">d</a> <a id="10347" href="Data.Nat.Base.html#5110" class="Function Operator">/</a> <a id="10349" href="Data.Nat.GCD.html#10256" class="Bound">c</a><a id="10350" class="Symbol">)</a>
<a id="10352" href="Data.Nat.GCD.html#10239" class="Function">GCD-/</a> <a id="10358" class="Symbol">{</a><a id="10359" href="Data.Nat.GCD.html#10359" class="Bound">m</a><a id="10360" class="Symbol">}</a> <a id="10362" class="Symbol">{</a><a id="10363" href="Data.Nat.GCD.html#10363" class="Bound">n</a><a id="10364" class="Symbol">}</a> <a id="10366" class="Symbol">{</a><a id="10367" href="Data.Nat.GCD.html#10367" class="Bound">d</a><a id="10368" class="Symbol">}</a> <a id="10370" class="Symbol">{</a><a id="10371" href="Data.Nat.GCD.html#10371" class="Bound">c</a><a id="10372" class="Symbol">}</a> <a id="10374" class="Symbol">{{</a><a id="10376" href="Data.Nat.GCD.html#10376" class="Bound">x</a><a id="10377" class="Symbol">}}</a>
  <a id="10382" class="Symbol">(</a><a id="10383" href="Data.Nat.Divisibility.Core.html#1363" class="InductiveConstructor">divides-refl</a> <a id="10396" href="Data.Nat.GCD.html#10396" class="Bound">p</a><a id="10397" class="Symbol">)</a> <a id="10399" class="Symbol">(</a><a id="10400" href="Data.Nat.Divisibility.Core.html#1363" class="InductiveConstructor">divides-refl</a> <a id="10413" href="Data.Nat.GCD.html#10413" class="Bound">q</a><a id="10414" class="Symbol">)</a> <a id="10416" class="Symbol">(</a><a id="10417" href="Data.Nat.Divisibility.Core.html#1363" class="InductiveConstructor">divides-refl</a> <a id="10430" href="Data.Nat.GCD.html#10430" class="Bound">r</a><a id="10431" class="Symbol">)</a> <a id="10433" href="Data.Nat.GCD.html#10433" class="Bound">gcd</a>
  <a id="10439" class="Keyword">rewrite</a> <a id="10447" href="Data.Nat.DivMod.html#8176" class="Function">m*n/n≡m</a> <a id="10455" href="Data.Nat.GCD.html#10396" class="Bound">p</a> <a id="10457" href="Data.Nat.GCD.html#10371" class="Bound">c</a> <a id="10459" class="Symbol">{{</a><a id="10461" href="Data.Nat.GCD.html#10376" class="Bound">x</a><a id="10462" class="Symbol">}}</a> <a id="10465" class="Symbol">|</a> <a id="10467" href="Data.Nat.DivMod.html#8176" class="Function">m*n/n≡m</a> <a id="10475" href="Data.Nat.GCD.html#10413" class="Bound">q</a> <a id="10477" href="Data.Nat.GCD.html#10371" class="Bound">c</a> <a id="10479" class="Symbol">{{</a><a id="10481" href="Data.Nat.GCD.html#10376" class="Bound">x</a><a id="10482" class="Symbol">}}</a> <a id="10485" class="Symbol">|</a> <a id="10487" href="Data.Nat.DivMod.html#8176" class="Function">m*n/n≡m</a> <a id="10495" href="Data.Nat.GCD.html#10430" class="Bound">r</a> <a id="10497" href="Data.Nat.GCD.html#10371" class="Bound">c</a> <a id="10499" class="Symbol">{{</a><a id="10501" href="Data.Nat.GCD.html#10376" class="Bound">x</a><a id="10502" class="Symbol">}}</a> <a id="10505" class="Symbol">=</a> <a id="10507" href="Data.Nat.GCD.html#9975" class="Function">GCD-*</a> <a id="10513" href="Data.Nat.GCD.html#10433" class="Bound">gcd</a>

<a id="GCD-/gcd"></a><a id="10518" href="Data.Nat.GCD.html#10518" class="Function">GCD-/gcd</a> <a id="10527" class="Symbol">:</a> <a id="10529" class="Symbol">∀</a> <a id="10531" href="Data.Nat.GCD.html#10531" class="Bound">m</a> <a id="10533" href="Data.Nat.GCD.html#10533" class="Bound">n</a> <a id="10535" class="Symbol">.{{</a><a id="10538" href="Data.Nat.GCD.html#10538" class="Bound">_</a> <a id="10540" class="Symbol">:</a> <a id="10542" href="Data.Nat.Base.html#2570" class="Record">NonZero</a> <a id="10550" class="Symbol">(</a><a id="10551" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="10555" href="Data.Nat.GCD.html#10531" class="Bound">m</a> <a id="10557" href="Data.Nat.GCD.html#10533" class="Bound">n</a><a id="10558" class="Symbol">)}}</a> <a id="10562" class="Symbol">→</a> <a id="10564" href="Data.Nat.GCD.html#8045" class="Record">GCD</a> <a id="10568" class="Symbol">(</a><a id="10569" href="Data.Nat.GCD.html#10531" class="Bound">m</a> <a id="10571" href="Data.Nat.Base.html#5110" class="Function Operator">/</a> <a id="10573" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="10577" href="Data.Nat.GCD.html#10531" class="Bound">m</a> <a id="10579" href="Data.Nat.GCD.html#10533" class="Bound">n</a><a id="10580" class="Symbol">)</a> <a id="10582" class="Symbol">(</a><a id="10583" href="Data.Nat.GCD.html#10533" class="Bound">n</a> <a id="10585" href="Data.Nat.Base.html#5110" class="Function Operator">/</a> <a id="10587" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="10591" href="Data.Nat.GCD.html#10531" class="Bound">m</a> <a id="10593" href="Data.Nat.GCD.html#10533" class="Bound">n</a><a id="10594" class="Symbol">)</a> <a id="10596" class="Number">1</a>
<a id="10598" href="Data.Nat.GCD.html#10518" class="Function">GCD-/gcd</a> <a id="10607" href="Data.Nat.GCD.html#10607" class="Bound">m</a> <a id="10609" href="Data.Nat.GCD.html#10609" class="Bound">n</a> <a id="10611" class="Keyword">rewrite</a> <a id="10619" href="Relation.Binary.PropositionalEquality.Core.html#1712" class="Function">P.sym</a> <a id="10625" class="Symbol">(</a><a id="10626" href="Data.Nat.DivMod.html#8095" class="Function">n/n≡1</a> <a id="10632" class="Symbol">(</a><a id="10633" href="Data.Nat.GCD.html#1813" class="Function">gcd</a> <a id="10637" href="Data.Nat.GCD.html#10607" class="Bound">m</a> <a id="10639" href="Data.Nat.GCD.html#10609" class="Bound">n</a><a id="10640" class="Symbol">))</a> <a id="10643" class="Symbol">=</a>
  <a id="10647" href="Data.Nat.GCD.html#10239" class="Function">GCD-/</a> <a id="10653" class="Symbol">(</a><a id="10654" href="Data.Nat.GCD.html#2719" class="Function">gcd[m,n]∣m</a> <a id="10665" href="Data.Nat.GCD.html#10607" class="Bound">m</a> <a id="10667" href="Data.Nat.GCD.html#10609" class="Bound">n</a><a id="10668" class="Symbol">)</a> <a id="10670" class="Symbol">(</a><a id="10671" href="Data.Nat.GCD.html#2921" class="Function">gcd[m,n]∣n</a> <a id="10682" href="Data.Nat.GCD.html#10607" class="Bound">m</a> <a id="10684" href="Data.Nat.GCD.html#10609" class="Bound">n</a><a id="10685" class="Symbol">)</a> <a id="10687" href="Data.Nat.Divisibility.html#2304" class="Function">∣-refl</a> <a id="10694" class="Symbol">(</a><a id="10695" href="Data.Nat.GCD.html#9528" class="Function">gcd-GCD</a> <a id="10703" href="Data.Nat.GCD.html#10607" class="Bound">m</a> <a id="10705" href="Data.Nat.GCD.html#10609" class="Bound">n</a><a id="10706" class="Symbol">)</a>

<a id="10709" class="Comment">------------------------------------------------------------------------</a>
<a id="10782" class="Comment">-- Calculating the gcd</a>

<a id="10806" class="Comment">-- The calculation also proves Bézout&#39;s lemma.</a>

<a id="10854" class="Keyword">module</a> <a id="Bézout"></a><a id="10861" href="Data.Nat.GCD.html#10861" class="Module">Bézout</a> <a id="10868" class="Keyword">where</a>

  <a id="10877" class="Keyword">module</a> <a id="Bézout.Identity"></a><a id="10884" href="Data.Nat.GCD.html#10884" class="Module">Identity</a> <a id="10893" class="Keyword">where</a>

    <a id="10904" class="Comment">-- If m and n have greatest common divisor d, then one of the</a>
    <a id="10970" class="Comment">-- following two equations is satisfied, for some numbers x and y.</a>
    <a id="11041" class="Comment">-- The proof is &quot;lemma&quot; below (Bézout&#39;s lemma).</a>
    <a id="11093" class="Comment">--</a>
    <a id="11100" class="Comment">-- (If this identity was stated using integers instead of natural</a>
    <a id="11170" class="Comment">-- numbers, then it would not be necessary to have two equations.)</a>

    <a id="11242" class="Keyword">data</a> <a id="Bézout.Identity.Identity"></a><a id="11247" href="Data.Nat.GCD.html#11247" class="Datatype">Identity</a> <a id="11256" class="Symbol">(</a><a id="11257" href="Data.Nat.GCD.html#11257" class="Bound">d</a> <a id="11259" href="Data.Nat.GCD.html#11259" class="Bound">m</a> <a id="11261" href="Data.Nat.GCD.html#11261" class="Bound">n</a> <a id="11263" class="Symbol">:</a> <a id="11265" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="11266" class="Symbol">)</a> <a id="11268" class="Symbol">:</a> <a id="11270" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="11274" class="Keyword">where</a>
      <a id="Bézout.Identity.Identity.+-"></a><a id="11286" href="Data.Nat.GCD.html#11286" class="InductiveConstructor">+-</a> <a id="11289" class="Symbol">:</a> <a id="11291" class="Symbol">(</a><a id="11292" href="Data.Nat.GCD.html#11292" class="Bound">x</a> <a id="11294" href="Data.Nat.GCD.html#11294" class="Bound">y</a> <a id="11296" class="Symbol">:</a> <a id="11298" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="11299" class="Symbol">)</a> <a id="11301" class="Symbol">(</a><a id="11302" href="Data.Nat.GCD.html#11302" class="Bound">eq</a> <a id="11305" class="Symbol">:</a> <a id="11307" href="Data.Nat.GCD.html#11257" class="Bound">d</a> <a id="11309" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="11311" href="Data.Nat.GCD.html#11294" class="Bound">y</a> <a id="11313" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="11315" href="Data.Nat.GCD.html#11261" class="Bound">n</a> <a id="11317" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="11319" href="Data.Nat.GCD.html#11292" class="Bound">x</a> <a id="11321" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="11323" href="Data.Nat.GCD.html#11259" class="Bound">m</a><a id="11324" class="Symbol">)</a> <a id="11326" class="Symbol">→</a> <a id="11328" href="Data.Nat.GCD.html#11247" class="Datatype">Identity</a> <a id="11337" href="Data.Nat.GCD.html#11257" class="Bound">d</a> <a id="11339" href="Data.Nat.GCD.html#11259" class="Bound">m</a> <a id="11341" href="Data.Nat.GCD.html#11261" class="Bound">n</a>
      <a id="Bézout.Identity.Identity.-+"></a><a id="11349" href="Data.Nat.GCD.html#11349" class="InductiveConstructor">-+</a> <a id="11352" class="Symbol">:</a> <a id="11354" class="Symbol">(</a><a id="11355" href="Data.Nat.GCD.html#11355" class="Bound">x</a> <a id="11357" href="Data.Nat.GCD.html#11357" class="Bound">y</a> <a id="11359" class="Symbol">:</a> <a id="11361" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="11362" class="Symbol">)</a> <a id="11364" class="Symbol">(</a><a id="11365" href="Data.Nat.GCD.html#11365" class="Bound">eq</a> <a id="11368" class="Symbol">:</a> <a id="11370" href="Data.Nat.GCD.html#11257" class="Bound">d</a> <a id="11372" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="11374" href="Data.Nat.GCD.html#11355" class="Bound">x</a> <a id="11376" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="11378" href="Data.Nat.GCD.html#11259" class="Bound">m</a> <a id="11380" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="11382" href="Data.Nat.GCD.html#11357" class="Bound">y</a> <a id="11384" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="11386" href="Data.Nat.GCD.html#11261" class="Bound">n</a><a id="11387" class="Symbol">)</a> <a id="11389" class="Symbol">→</a> <a id="11391" href="Data.Nat.GCD.html#11247" class="Datatype">Identity</a> <a id="11400" href="Data.Nat.GCD.html#11257" class="Bound">d</a> <a id="11402" href="Data.Nat.GCD.html#11259" class="Bound">m</a> <a id="11404" href="Data.Nat.GCD.html#11261" class="Bound">n</a>

    <a id="11411" class="Comment">-- Various properties about Identity.</a>

    <a id="Bézout.Identity.sym"></a><a id="11454" href="Data.Nat.GCD.html#11454" class="Function">sym</a> <a id="11458" class="Symbol">:</a> <a id="11460" class="Symbol">∀</a> <a id="11462" class="Symbol">{</a><a id="11463" href="Data.Nat.GCD.html#11463" class="Bound">d</a><a id="11464" class="Symbol">}</a> <a id="11466" class="Symbol">→</a> <a id="11468" href="Relation.Binary.Definitions.html#1577" class="Function">Symmetric</a> <a id="11478" class="Symbol">(</a><a id="11479" href="Data.Nat.GCD.html#11247" class="Datatype">Identity</a> <a id="11488" href="Data.Nat.GCD.html#11463" class="Bound">d</a><a id="11489" class="Symbol">)</a>
    <a id="11495" href="Data.Nat.GCD.html#11454" class="Function">sym</a> <a id="11499" class="Symbol">(</a><a id="11500" href="Data.Nat.GCD.html#11286" class="InductiveConstructor">+-</a> <a id="11503" href="Data.Nat.GCD.html#11503" class="Bound">x</a> <a id="11505" href="Data.Nat.GCD.html#11505" class="Bound">y</a> <a id="11507" href="Data.Nat.GCD.html#11507" class="Bound">eq</a><a id="11509" class="Symbol">)</a> <a id="11511" class="Symbol">=</a> <a id="11513" href="Data.Nat.GCD.html#11349" class="InductiveConstructor">-+</a> <a id="11516" href="Data.Nat.GCD.html#11505" class="Bound">y</a> <a id="11518" href="Data.Nat.GCD.html#11503" class="Bound">x</a> <a id="11520" href="Data.Nat.GCD.html#11507" class="Bound">eq</a>
    <a id="11527" href="Data.Nat.GCD.html#11454" class="Function">sym</a> <a id="11531" class="Symbol">(</a><a id="11532" href="Data.Nat.GCD.html#11349" class="InductiveConstructor">-+</a> <a id="11535" href="Data.Nat.GCD.html#11535" class="Bound">x</a> <a id="11537" href="Data.Nat.GCD.html#11537" class="Bound">y</a> <a id="11539" href="Data.Nat.GCD.html#11539" class="Bound">eq</a><a id="11541" class="Symbol">)</a> <a id="11543" class="Symbol">=</a> <a id="11545" href="Data.Nat.GCD.html#11286" class="InductiveConstructor">+-</a> <a id="11548" href="Data.Nat.GCD.html#11537" class="Bound">y</a> <a id="11550" href="Data.Nat.GCD.html#11535" class="Bound">x</a> <a id="11552" href="Data.Nat.GCD.html#11539" class="Bound">eq</a>

    <a id="Bézout.Identity.refl"></a><a id="11560" href="Data.Nat.GCD.html#11560" class="Function">refl</a> <a id="11565" class="Symbol">:</a> <a id="11567" class="Symbol">∀</a> <a id="11569" class="Symbol">{</a><a id="11570" href="Data.Nat.GCD.html#11570" class="Bound">d</a><a id="11571" class="Symbol">}</a> <a id="11573" class="Symbol">→</a> <a id="11575" href="Data.Nat.GCD.html#11247" class="Datatype">Identity</a> <a id="11584" href="Data.Nat.GCD.html#11570" class="Bound">d</a> <a id="11586" href="Data.Nat.GCD.html#11570" class="Bound">d</a> <a id="11588" href="Data.Nat.GCD.html#11570" class="Bound">d</a>
    <a id="11594" href="Data.Nat.GCD.html#11560" class="Function">refl</a> <a id="11599" class="Symbol">=</a> <a id="11601" href="Data.Nat.GCD.html#11349" class="InductiveConstructor">-+</a> <a id="11604" class="Number">0</a> <a id="11606" class="Number">1</a> <a id="11608" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">P.refl</a>

    <a id="Bézout.Identity.base"></a><a id="11620" href="Data.Nat.GCD.html#11620" class="Function">base</a> <a id="11625" class="Symbol">:</a> <a id="11627" class="Symbol">∀</a> <a id="11629" class="Symbol">{</a><a id="11630" href="Data.Nat.GCD.html#11630" class="Bound">d</a><a id="11631" class="Symbol">}</a> <a id="11633" class="Symbol">→</a> <a id="11635" href="Data.Nat.GCD.html#11247" class="Datatype">Identity</a> <a id="11644" href="Data.Nat.GCD.html#11630" class="Bound">d</a> <a id="11646" class="Number">0</a> <a id="11648" href="Data.Nat.GCD.html#11630" class="Bound">d</a>
    <a id="11654" href="Data.Nat.GCD.html#11620" class="Function">base</a> <a id="11659" class="Symbol">=</a> <a id="11661" href="Data.Nat.GCD.html#11349" class="InductiveConstructor">-+</a> <a id="11664" class="Number">0</a> <a id="11666" class="Number">1</a> <a id="11668" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">P.refl</a>

    <a id="11680" class="Keyword">private</a>
      <a id="11694" class="Keyword">infixl</a> <a id="11701" class="Number">7</a> <a id="11703" href="Data.Nat.GCD.html#11714" class="Function Operator">_⊕_</a>

      <a id="Bézout.Identity._⊕_"></a><a id="11714" href="Data.Nat.GCD.html#11714" class="Function Operator">_⊕_</a> <a id="11718" class="Symbol">:</a> <a id="11720" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="11722" class="Symbol">→</a> <a id="11724" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="11726" class="Symbol">→</a> <a id="11728" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
      <a id="11736" href="Data.Nat.GCD.html#11736" class="Bound">m</a> <a id="11738" href="Data.Nat.GCD.html#11714" class="Function Operator">⊕</a> <a id="11740" href="Data.Nat.GCD.html#11740" class="Bound">n</a> <a id="11742" class="Symbol">=</a> <a id="11744" class="Number">1</a> <a id="11746" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="11748" href="Data.Nat.GCD.html#11736" class="Bound">m</a> <a id="11750" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="11752" href="Data.Nat.GCD.html#11740" class="Bound">n</a>

    <a id="Bézout.Identity.step"></a><a id="11759" href="Data.Nat.GCD.html#11759" class="Function">step</a> <a id="11764" class="Symbol">:</a> <a id="11766" class="Symbol">∀</a> <a id="11768" class="Symbol">{</a><a id="11769" href="Data.Nat.GCD.html#11769" class="Bound">d</a> <a id="11771" href="Data.Nat.GCD.html#11771" class="Bound">n</a> <a id="11773" href="Data.Nat.GCD.html#11773" class="Bound">k</a><a id="11774" class="Symbol">}</a> <a id="11776" class="Symbol">→</a> <a id="11778" href="Data.Nat.GCD.html#11247" class="Datatype">Identity</a> <a id="11787" href="Data.Nat.GCD.html#11769" class="Bound">d</a> <a id="11789" href="Data.Nat.GCD.html#11771" class="Bound">n</a> <a id="11791" href="Data.Nat.GCD.html#11773" class="Bound">k</a> <a id="11793" class="Symbol">→</a> <a id="11795" href="Data.Nat.GCD.html#11247" class="Datatype">Identity</a> <a id="11804" href="Data.Nat.GCD.html#11769" class="Bound">d</a> <a id="11806" href="Data.Nat.GCD.html#11771" class="Bound">n</a> <a id="11808" class="Symbol">(</a><a id="11809" href="Data.Nat.GCD.html#11771" class="Bound">n</a> <a id="11811" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="11813" href="Data.Nat.GCD.html#11773" class="Bound">k</a><a id="11814" class="Symbol">)</a>
    <a id="11820" href="Data.Nat.GCD.html#11759" class="Function">step</a> <a id="11825" class="Symbol">{</a><a id="11826" href="Data.Nat.GCD.html#11826" class="Bound">d</a><a id="11827" class="Symbol">}</a> <a id="11829" class="Symbol">{</a><a id="11830" href="Data.Nat.GCD.html#11830" class="Bound">n</a><a id="11831" class="Symbol">}</a> <a id="11833" class="Symbol">(</a><a id="11834" href="Data.Nat.GCD.html#11286" class="InductiveConstructor">+-</a>  <a id="11838" href="Data.Nat.GCD.html#11838" class="Bound">x</a>  <a id="11841" href="Data.Nat.GCD.html#11841" class="Bound">y</a>       <a id="11849" href="Data.Nat.GCD.html#11849" class="Bound">eq</a><a id="11851" class="Symbol">)</a> <a id="11853" class="Keyword">with</a> <a id="11858" href="Data.Nat.Base.html#7112" class="Function">compare</a> <a id="11866" href="Data.Nat.GCD.html#11838" class="Bound">x</a> <a id="11868" href="Data.Nat.GCD.html#11841" class="Bound">y</a>
    <a id="11874" class="Symbol">...</a> <a id="11878" class="Symbol">|</a> <a id="11880" href="Data.Nat.Base.html#7035" class="InductiveConstructor">equal</a> <a id="11886" href="Data.Nat.GCD.html#11886" class="Bound">x</a>     <a id="11892" class="Symbol">=</a> <a id="11894" href="Data.Nat.GCD.html#11286" class="InductiveConstructor">+-</a> <a id="11897" class="Symbol">(</a><a id="11898" class="Number">2</a> <a id="11900" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="11902" href="Data.Nat.GCD.html#11886" class="Bound">x</a><a id="11903" class="Symbol">)</a>     <a id="11909" href="Data.Nat.GCD.html#11886" class="Bound">x</a>       <a id="11917" class="Symbol">(</a><a id="11918" href="Data.Nat.GCD.Lemmas.html#1349" class="Function">lem₂</a> <a id="11923" class="Bound">d</a> <a id="11925" href="Data.Nat.GCD.html#11886" class="Bound">x</a>   <a id="11929" class="Bound">eq</a><a id="11931" class="Symbol">)</a>
    <a id="11937" class="Symbol">...</a> <a id="11941" class="Symbol">|</a> <a id="11943" href="Data.Nat.Base.html#6990" class="InductiveConstructor">less</a> <a id="11948" href="Data.Nat.GCD.html#11948" class="Bound">x</a> <a id="11950" href="Data.Nat.GCD.html#11950" class="Bound">i</a>    <a id="11955" class="Symbol">=</a> <a id="11957" href="Data.Nat.GCD.html#11286" class="InductiveConstructor">+-</a> <a id="11960" class="Symbol">(</a><a id="11961" class="Number">2</a> <a id="11963" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="11965" href="Data.Nat.GCD.html#11948" class="Bound">x</a> <a id="11967" href="Data.Nat.GCD.html#11714" class="Function Operator">⊕</a> <a id="11969" href="Data.Nat.GCD.html#11950" class="Bound">i</a><a id="11970" class="Symbol">)</a> <a id="11972" class="Symbol">(</a><a id="11973" href="Data.Nat.GCD.html#11948" class="Bound">x</a> <a id="11975" href="Data.Nat.GCD.html#11714" class="Function Operator">⊕</a> <a id="11977" href="Data.Nat.GCD.html#11950" class="Bound">i</a><a id="11978" class="Symbol">)</a> <a id="11980" class="Symbol">(</a><a id="11981" href="Data.Nat.GCD.Lemmas.html#1735" class="Function">lem₃</a> <a id="11986" class="Bound">d</a> <a id="11988" href="Data.Nat.GCD.html#11948" class="Bound">x</a>   <a id="11992" class="Bound">eq</a><a id="11994" class="Symbol">)</a>
    <a id="12000" class="Symbol">...</a> <a id="12004" class="Symbol">|</a> <a id="12006" href="Data.Nat.Base.html#7068" class="InductiveConstructor">greater</a> <a id="12014" href="Data.Nat.GCD.html#12014" class="Bound">y</a> <a id="12016" href="Data.Nat.GCD.html#12016" class="Bound">i</a> <a id="12018" class="Symbol">=</a> <a id="12020" href="Data.Nat.GCD.html#11286" class="InductiveConstructor">+-</a> <a id="12023" class="Symbol">(</a><a id="12024" class="Number">2</a> <a id="12026" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="12028" href="Data.Nat.GCD.html#12014" class="Bound">y</a> <a id="12030" href="Data.Nat.GCD.html#11714" class="Function Operator">⊕</a> <a id="12032" href="Data.Nat.GCD.html#12016" class="Bound">i</a><a id="12033" class="Symbol">)</a> <a id="12035" href="Data.Nat.GCD.html#12014" class="Bound">y</a>       <a id="12043" class="Symbol">(</a><a id="12044" href="Data.Nat.GCD.Lemmas.html#2229" class="Function">lem₄</a> <a id="12049" class="Bound">d</a> <a id="12051" href="Data.Nat.GCD.html#12014" class="Bound">y</a> <a id="12053" class="Bound">n</a> <a id="12055" class="Bound">eq</a><a id="12057" class="Symbol">)</a>
    <a id="12063" href="Data.Nat.GCD.html#11759" class="Function">step</a> <a id="12068" class="Symbol">{</a><a id="12069" href="Data.Nat.GCD.html#12069" class="Bound">d</a><a id="12070" class="Symbol">}</a> <a id="12072" class="Symbol">{</a><a id="12073" href="Data.Nat.GCD.html#12073" class="Bound">n</a><a id="12074" class="Symbol">}</a> <a id="12076" class="Symbol">(</a><a id="12077" href="Data.Nat.GCD.html#11349" class="InductiveConstructor">-+</a>  <a id="12081" href="Data.Nat.GCD.html#12081" class="Bound">x</a>  <a id="12084" href="Data.Nat.GCD.html#12084" class="Bound">y</a>       <a id="12092" href="Data.Nat.GCD.html#12092" class="Bound">eq</a><a id="12094" class="Symbol">)</a> <a id="12096" class="Keyword">with</a> <a id="12101" href="Data.Nat.Base.html#7112" class="Function">compare</a> <a id="12109" href="Data.Nat.GCD.html#12081" class="Bound">x</a> <a id="12111" href="Data.Nat.GCD.html#12084" class="Bound">y</a>
    <a id="12117" class="Symbol">...</a> <a id="12121" class="Symbol">|</a> <a id="12123" href="Data.Nat.Base.html#7035" class="InductiveConstructor">equal</a> <a id="12129" href="Data.Nat.GCD.html#12129" class="Bound">x</a>     <a id="12135" class="Symbol">=</a> <a id="12137" href="Data.Nat.GCD.html#11349" class="InductiveConstructor">-+</a> <a id="12140" class="Symbol">(</a><a id="12141" class="Number">2</a> <a id="12143" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="12145" href="Data.Nat.GCD.html#12129" class="Bound">x</a><a id="12146" class="Symbol">)</a>     <a id="12152" href="Data.Nat.GCD.html#12129" class="Bound">x</a>       <a id="12160" class="Symbol">(</a><a id="12161" href="Data.Nat.GCD.Lemmas.html#2713" class="Function">lem₅</a> <a id="12166" class="Bound">d</a> <a id="12168" href="Data.Nat.GCD.html#12129" class="Bound">x</a>   <a id="12172" class="Bound">eq</a><a id="12174" class="Symbol">)</a>
    <a id="12180" class="Symbol">...</a> <a id="12184" class="Symbol">|</a> <a id="12186" href="Data.Nat.Base.html#6990" class="InductiveConstructor">less</a> <a id="12191" href="Data.Nat.GCD.html#12191" class="Bound">x</a> <a id="12193" href="Data.Nat.GCD.html#12193" class="Bound">i</a>    <a id="12198" class="Symbol">=</a> <a id="12200" href="Data.Nat.GCD.html#11349" class="InductiveConstructor">-+</a> <a id="12203" class="Symbol">(</a><a id="12204" class="Number">2</a> <a id="12206" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="12208" href="Data.Nat.GCD.html#12191" class="Bound">x</a> <a id="12210" href="Data.Nat.GCD.html#11714" class="Function Operator">⊕</a> <a id="12212" href="Data.Nat.GCD.html#12193" class="Bound">i</a><a id="12213" class="Symbol">)</a> <a id="12215" class="Symbol">(</a><a id="12216" href="Data.Nat.GCD.html#12191" class="Bound">x</a> <a id="12218" href="Data.Nat.GCD.html#11714" class="Function Operator">⊕</a> <a id="12220" href="Data.Nat.GCD.html#12193" class="Bound">i</a><a id="12221" class="Symbol">)</a> <a id="12223" class="Symbol">(</a><a id="12224" href="Data.Nat.GCD.Lemmas.html#3112" class="Function">lem₆</a> <a id="12229" class="Bound">d</a> <a id="12231" href="Data.Nat.GCD.html#12191" class="Bound">x</a>   <a id="12235" class="Bound">eq</a><a id="12237" class="Symbol">)</a>
    <a id="12243" class="Symbol">...</a> <a id="12247" class="Symbol">|</a> <a id="12249" href="Data.Nat.Base.html#7068" class="InductiveConstructor">greater</a> <a id="12257" href="Data.Nat.GCD.html#12257" class="Bound">y</a> <a id="12259" href="Data.Nat.GCD.html#12259" class="Bound">i</a> <a id="12261" class="Symbol">=</a> <a id="12263" href="Data.Nat.GCD.html#11349" class="InductiveConstructor">-+</a> <a id="12266" class="Symbol">(</a><a id="12267" class="Number">2</a> <a id="12269" href="Agda.Builtin.Nat.html#522" class="Primitive Operator">*</a> <a id="12271" href="Data.Nat.GCD.html#12257" class="Bound">y</a> <a id="12273" href="Data.Nat.GCD.html#11714" class="Function Operator">⊕</a> <a id="12275" href="Data.Nat.GCD.html#12259" class="Bound">i</a><a id="12276" class="Symbol">)</a> <a id="12278" href="Data.Nat.GCD.html#12257" class="Bound">y</a>       <a id="12286" class="Symbol">(</a><a id="12287" href="Data.Nat.GCD.Lemmas.html#3643" class="Function">lem₇</a> <a id="12292" class="Bound">d</a> <a id="12294" href="Data.Nat.GCD.html#12257" class="Bound">y</a> <a id="12296" class="Bound">n</a> <a id="12298" class="Bound">eq</a><a id="12300" class="Symbol">)</a>

  <a id="12305" class="Keyword">open</a> <a id="12310" href="Data.Nat.GCD.html#10884" class="Module">Identity</a> <a id="12319" class="Keyword">public</a> <a id="12326" class="Keyword">using</a> <a id="12332" class="Symbol">(</a><a id="12333" href="Data.Nat.GCD.html#11247" class="Datatype">Identity</a><a id="12341" class="Symbol">;</a> <a id="12343" href="Data.Nat.GCD.html#11286" class="InductiveConstructor">+-</a><a id="12345" class="Symbol">;</a> <a id="12347" href="Data.Nat.GCD.html#11349" class="InductiveConstructor">-+</a><a id="12349" class="Symbol">)</a> <a id="12351" class="Keyword">hiding</a> <a id="12358" class="Symbol">(</a><a id="12359" class="Keyword">module</a> <a id="12366" href="Data.Nat.GCD.html#11247" class="Module">Identity</a><a id="12374" class="Symbol">)</a>

  <a id="12379" class="Keyword">module</a> <a id="Bézout.Lemma"></a><a id="12386" href="Data.Nat.GCD.html#12386" class="Module">Lemma</a> <a id="12392" class="Keyword">where</a>

    <a id="12403" class="Comment">-- This type packs up the gcd, the proof that it is a gcd, and the</a>
    <a id="12474" class="Comment">-- proof that it satisfies Bézout&#39;s identity.</a>

    <a id="12525" class="Keyword">data</a> <a id="Bézout.Lemma.Lemma"></a><a id="12530" href="Data.Nat.GCD.html#12530" class="Datatype">Lemma</a> <a id="12536" class="Symbol">(</a><a id="12537" href="Data.Nat.GCD.html#12537" class="Bound">m</a> <a id="12539" href="Data.Nat.GCD.html#12539" class="Bound">n</a> <a id="12541" class="Symbol">:</a> <a id="12543" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="12544" class="Symbol">)</a> <a id="12546" class="Symbol">:</a> <a id="12548" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="12552" class="Keyword">where</a>
      <a id="Bézout.Lemma.Lemma.result"></a><a id="12564" href="Data.Nat.GCD.html#12564" class="InductiveConstructor">result</a> <a id="12571" class="Symbol">:</a> <a id="12573" class="Symbol">(</a><a id="12574" href="Data.Nat.GCD.html#12574" class="Bound">d</a> <a id="12576" class="Symbol">:</a> <a id="12578" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="12579" class="Symbol">)</a> <a id="12581" class="Symbol">(</a><a id="12582" href="Data.Nat.GCD.html#12582" class="Bound">g</a> <a id="12584" class="Symbol">:</a> <a id="12586" href="Data.Nat.GCD.html#8045" class="Record">GCD</a> <a id="12590" href="Data.Nat.GCD.html#12537" class="Bound">m</a> <a id="12592" href="Data.Nat.GCD.html#12539" class="Bound">n</a> <a id="12594" href="Data.Nat.GCD.html#12574" class="Bound">d</a><a id="12595" class="Symbol">)</a> <a id="12597" class="Symbol">(</a><a id="12598" href="Data.Nat.GCD.html#12598" class="Bound">b</a> <a id="12600" class="Symbol">:</a> <a id="12602" href="Data.Nat.GCD.html#11247" class="Datatype">Identity</a> <a id="12611" href="Data.Nat.GCD.html#12574" class="Bound">d</a> <a id="12613" href="Data.Nat.GCD.html#12537" class="Bound">m</a> <a id="12615" href="Data.Nat.GCD.html#12539" class="Bound">n</a><a id="12616" class="Symbol">)</a> <a id="12618" class="Symbol">→</a> <a id="12620" href="Data.Nat.GCD.html#12530" class="Datatype">Lemma</a> <a id="12626" href="Data.Nat.GCD.html#12537" class="Bound">m</a> <a id="12628" href="Data.Nat.GCD.html#12539" class="Bound">n</a>

    <a id="12635" class="Comment">-- Various properties about Lemma.</a>

    <a id="Bézout.Lemma.sym"></a><a id="12675" href="Data.Nat.GCD.html#12675" class="Function">sym</a> <a id="12679" class="Symbol">:</a> <a id="12681" href="Relation.Binary.Definitions.html#1577" class="Function">Symmetric</a> <a id="12691" href="Data.Nat.GCD.html#12530" class="Datatype">Lemma</a>
    <a id="12701" href="Data.Nat.GCD.html#12675" class="Function">sym</a> <a id="12705" class="Symbol">(</a><a id="12706" href="Data.Nat.GCD.html#12564" class="InductiveConstructor">result</a> <a id="12713" href="Data.Nat.GCD.html#12713" class="Bound">d</a> <a id="12715" href="Data.Nat.GCD.html#12715" class="Bound">g</a> <a id="12717" href="Data.Nat.GCD.html#12717" class="Bound">b</a><a id="12718" class="Symbol">)</a> <a id="12720" class="Symbol">=</a> <a id="12722" href="Data.Nat.GCD.html#12564" class="InductiveConstructor">result</a> <a id="12729" href="Data.Nat.GCD.html#12713" class="Bound">d</a> <a id="12731" class="Symbol">(</a><a id="12732" href="Data.Nat.GCD.html#8757" class="Function">GCD.sym</a> <a id="12740" href="Data.Nat.GCD.html#12715" class="Bound">g</a><a id="12741" class="Symbol">)</a> <a id="12743" class="Symbol">(</a><a id="12744" href="Data.Nat.GCD.html#11454" class="Function">Identity.sym</a> <a id="12757" href="Data.Nat.GCD.html#12717" class="Bound">b</a><a id="12758" class="Symbol">)</a>

    <a id="Bézout.Lemma.base"></a><a id="12765" href="Data.Nat.GCD.html#12765" class="Function">base</a> <a id="12770" class="Symbol">:</a> <a id="12772" class="Symbol">∀</a> <a id="12774" href="Data.Nat.GCD.html#12774" class="Bound">d</a> <a id="12776" class="Symbol">→</a> <a id="12778" href="Data.Nat.GCD.html#12530" class="Datatype">Lemma</a> <a id="12784" class="Number">0</a> <a id="12786" href="Data.Nat.GCD.html#12774" class="Bound">d</a>
    <a id="12792" href="Data.Nat.GCD.html#12765" class="Function">base</a> <a id="12797" href="Data.Nat.GCD.html#12797" class="Bound">d</a> <a id="12799" class="Symbol">=</a> <a id="12801" href="Data.Nat.GCD.html#12564" class="InductiveConstructor">result</a> <a id="12808" href="Data.Nat.GCD.html#12797" class="Bound">d</a> <a id="12810" href="Data.Nat.GCD.html#9000" class="Function">GCD.base</a> <a id="12819" href="Data.Nat.GCD.html#11620" class="Function">Identity.base</a>

    <a id="Bézout.Lemma.refl"></a><a id="12838" href="Data.Nat.GCD.html#12838" class="Function">refl</a> <a id="12843" class="Symbol">:</a> <a id="12845" class="Symbol">∀</a> <a id="12847" href="Data.Nat.GCD.html#12847" class="Bound">d</a> <a id="12849" class="Symbol">→</a> <a id="12851" href="Data.Nat.GCD.html#12530" class="Datatype">Lemma</a> <a id="12857" href="Data.Nat.GCD.html#12847" class="Bound">d</a> <a id="12859" href="Data.Nat.GCD.html#12847" class="Bound">d</a>
    <a id="12865" href="Data.Nat.GCD.html#12838" class="Function">refl</a> <a id="12870" href="Data.Nat.GCD.html#12870" class="Bound">d</a> <a id="12872" class="Symbol">=</a> <a id="12874" href="Data.Nat.GCD.html#12564" class="InductiveConstructor">result</a> <a id="12881" href="Data.Nat.GCD.html#12870" class="Bound">d</a> <a id="12883" href="Data.Nat.GCD.html#8905" class="Function">GCD.refl</a> <a id="12892" href="Data.Nat.GCD.html#11560" class="Function">Identity.refl</a>

    <a id="Bézout.Lemma.stepˡ"></a><a id="12911" href="Data.Nat.GCD.html#12911" class="Function">stepˡ</a> <a id="12917" class="Symbol">:</a> <a id="12919" class="Symbol">∀</a> <a id="12921" class="Symbol">{</a><a id="12922" href="Data.Nat.GCD.html#12922" class="Bound">n</a> <a id="12924" href="Data.Nat.GCD.html#12924" class="Bound">k</a><a id="12925" class="Symbol">}</a> <a id="12927" class="Symbol">→</a> <a id="12929" href="Data.Nat.GCD.html#12530" class="Datatype">Lemma</a> <a id="12935" href="Data.Nat.GCD.html#12922" class="Bound">n</a> <a id="12937" class="Symbol">(</a><a id="12938" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="12942" href="Data.Nat.GCD.html#12924" class="Bound">k</a><a id="12943" class="Symbol">)</a> <a id="12945" class="Symbol">→</a> <a id="12947" href="Data.Nat.GCD.html#12530" class="Datatype">Lemma</a> <a id="12953" href="Data.Nat.GCD.html#12922" class="Bound">n</a> <a id="12955" class="Symbol">(</a><a id="12956" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="12960" class="Symbol">(</a><a id="12961" href="Data.Nat.GCD.html#12922" class="Bound">n</a> <a id="12963" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="12965" href="Data.Nat.GCD.html#12924" class="Bound">k</a><a id="12966" class="Symbol">))</a>
    <a id="12973" href="Data.Nat.GCD.html#12911" class="Function">stepˡ</a> <a id="12979" class="Symbol">{</a><a id="12980" href="Data.Nat.GCD.html#12980" class="Bound">n</a><a id="12981" class="Symbol">}</a> <a id="12983" class="Symbol">{</a><a id="12984" href="Data.Nat.GCD.html#12984" class="Bound">k</a><a id="12985" class="Symbol">}</a> <a id="12987" class="Symbol">(</a><a id="12988" href="Data.Nat.GCD.html#12564" class="InductiveConstructor">result</a> <a id="12995" href="Data.Nat.GCD.html#12995" class="Bound">d</a> <a id="12997" href="Data.Nat.GCD.html#12997" class="Bound">g</a> <a id="12999" href="Data.Nat.GCD.html#12999" class="Bound">b</a><a id="13000" class="Symbol">)</a> <a id="13002" class="Symbol">=</a>
      <a id="13010" href="Relation.Binary.PropositionalEquality.Core.html#1808" class="Function">subst</a> <a id="13016" class="Symbol">(</a><a id="13017" href="Data.Nat.GCD.html#12530" class="Datatype">Lemma</a> <a id="13023" href="Data.Nat.GCD.html#12980" class="Bound">n</a><a id="13024" class="Symbol">)</a> <a id="13026" class="Symbol">(</a><a id="13027" href="Data.Nat.Properties.html#14247" class="Function">+-suc</a> <a id="13033" href="Data.Nat.GCD.html#12980" class="Bound">n</a> <a id="13035" href="Data.Nat.GCD.html#12984" class="Bound">k</a><a id="13036" class="Symbol">)</a> <a id="13038" href="Function.Base.html#1974" class="Function Operator">$</a>
        <a id="13048" href="Data.Nat.GCD.html#12564" class="InductiveConstructor">result</a> <a id="13055" href="Data.Nat.GCD.html#12995" class="Bound">d</a> <a id="13057" class="Symbol">(</a><a id="13058" href="Data.Nat.GCD.html#9145" class="Function">GCD.step</a> <a id="13067" href="Data.Nat.GCD.html#12997" class="Bound">g</a><a id="13068" class="Symbol">)</a> <a id="13070" class="Symbol">(</a><a id="13071" href="Data.Nat.GCD.html#11759" class="Function">Identity.step</a> <a id="13085" href="Data.Nat.GCD.html#12999" class="Bound">b</a><a id="13086" class="Symbol">)</a>

    <a id="Bézout.Lemma.stepʳ"></a><a id="13093" href="Data.Nat.GCD.html#13093" class="Function">stepʳ</a> <a id="13099" class="Symbol">:</a> <a id="13101" class="Symbol">∀</a> <a id="13103" class="Symbol">{</a><a id="13104" href="Data.Nat.GCD.html#13104" class="Bound">n</a> <a id="13106" href="Data.Nat.GCD.html#13106" class="Bound">k</a><a id="13107" class="Symbol">}</a> <a id="13109" class="Symbol">→</a> <a id="13111" href="Data.Nat.GCD.html#12530" class="Datatype">Lemma</a> <a id="13117" class="Symbol">(</a><a id="13118" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="13122" href="Data.Nat.GCD.html#13106" class="Bound">k</a><a id="13123" class="Symbol">)</a> <a id="13125" href="Data.Nat.GCD.html#13104" class="Bound">n</a> <a id="13127" class="Symbol">→</a> <a id="13129" href="Data.Nat.GCD.html#12530" class="Datatype">Lemma</a> <a id="13135" class="Symbol">(</a><a id="13136" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="13140" class="Symbol">(</a><a id="13141" href="Data.Nat.GCD.html#13104" class="Bound">n</a> <a id="13143" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="13145" href="Data.Nat.GCD.html#13106" class="Bound">k</a><a id="13146" class="Symbol">))</a> <a id="13149" href="Data.Nat.GCD.html#13104" class="Bound">n</a>
    <a id="13155" href="Data.Nat.GCD.html#13093" class="Function">stepʳ</a> <a id="13161" class="Symbol">=</a> <a id="13163" href="Data.Nat.GCD.html#12675" class="Function">sym</a> <a id="13167" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="13169" href="Data.Nat.GCD.html#12911" class="Function">stepˡ</a> <a id="13175" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="13177" href="Data.Nat.GCD.html#12675" class="Function">sym</a>

  <a id="13184" class="Keyword">open</a> <a id="13189" href="Data.Nat.GCD.html#12386" class="Module">Lemma</a> <a id="13195" class="Keyword">public</a> <a id="13202" class="Keyword">using</a> <a id="13208" class="Symbol">(</a><a id="13209" href="Data.Nat.GCD.html#12530" class="Datatype">Lemma</a><a id="13214" class="Symbol">;</a> <a id="13216" href="Data.Nat.GCD.html#12564" class="InductiveConstructor">result</a><a id="13222" class="Symbol">)</a> <a id="13224" class="Keyword">hiding</a> <a id="13231" class="Symbol">(</a><a id="13232" class="Keyword">module</a> <a id="13239" href="Data.Nat.GCD.html#12530" class="Module">Lemma</a><a id="13244" class="Symbol">)</a>

  <a id="13249" class="Comment">-- Bézout&#39;s lemma proved using some variant of the extended</a>
  <a id="13311" class="Comment">-- Euclidean algorithm.</a>

  <a id="Bézout.lemma"></a><a id="13338" href="Data.Nat.GCD.html#13338" class="Function">lemma</a> <a id="13344" class="Symbol">:</a> <a id="13346" class="Symbol">(</a><a id="13347" href="Data.Nat.GCD.html#13347" class="Bound">m</a> <a id="13349" href="Data.Nat.GCD.html#13349" class="Bound">n</a> <a id="13351" class="Symbol">:</a> <a id="13353" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="13354" class="Symbol">)</a> <a id="13356" class="Symbol">→</a> <a id="13358" href="Data.Nat.GCD.html#12530" class="Datatype">Lemma</a> <a id="13364" href="Data.Nat.GCD.html#13347" class="Bound">m</a> <a id="13366" href="Data.Nat.GCD.html#13349" class="Bound">n</a>
  <a id="13370" href="Data.Nat.GCD.html#13338" class="Function">lemma</a> <a id="13376" href="Data.Nat.GCD.html#13376" class="Bound">m</a> <a id="13378" href="Data.Nat.GCD.html#13378" class="Bound">n</a> <a id="13380" class="Symbol">=</a> <a id="13382" href="Induction.html#1337" class="Function">build</a> <a id="13388" href="Induction.Lexicographic.html#1764" class="Function Operator">[</a> <a id="13390" href="Data.Nat.Induction.html#1949" class="Function">&lt;′-recBuilder</a> <a id="13404" href="Induction.Lexicographic.html#1764" class="Function Operator">⊗</a> <a id="13406" href="Data.Nat.Induction.html#1949" class="Function">&lt;′-recBuilder</a> <a id="13420" href="Induction.Lexicographic.html#1764" class="Function Operator">]</a> <a id="13422" href="Data.Nat.GCD.html#13451" class="Function">P</a> <a id="13424" href="Data.Nat.GCD.html#13498" class="Function">gcd″</a> <a id="13429" class="Symbol">(</a><a id="13430" href="Data.Nat.GCD.html#13376" class="Bound">m</a> <a id="13432" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="13434" href="Data.Nat.GCD.html#13378" class="Bound">n</a><a id="13435" class="Symbol">)</a>
    <a id="13441" class="Keyword">where</a>
    <a id="13451" href="Data.Nat.GCD.html#13451" class="Function">P</a> <a id="13453" class="Symbol">:</a> <a id="13455" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="13457" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="13459" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="13461" class="Symbol">→</a> <a id="13463" href="Agda.Primitive.html#320" class="Primitive">Set</a>
    <a id="13471" href="Data.Nat.GCD.html#13451" class="Function">P</a> <a id="13473" class="Symbol">(</a><a id="13474" href="Data.Nat.GCD.html#13474" class="Bound">m</a> <a id="13476" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="13478" href="Data.Nat.GCD.html#13478" class="Bound">n</a><a id="13479" class="Symbol">)</a> <a id="13481" class="Symbol">=</a> <a id="13483" href="Data.Nat.GCD.html#12530" class="Datatype">Lemma</a> <a id="13489" href="Data.Nat.GCD.html#13474" class="Bound">m</a> <a id="13491" href="Data.Nat.GCD.html#13478" class="Bound">n</a>

    <a id="13498" href="Data.Nat.GCD.html#13498" class="Function">gcd″</a> <a id="13503" class="Symbol">:</a> <a id="13505" class="Symbol">∀</a> <a id="13507" href="Data.Nat.GCD.html#13507" class="Bound">p</a> <a id="13509" class="Symbol">→</a> <a id="13511" class="Symbol">(</a><a id="13512" href="Data.Nat.Induction.html#1536" class="Function">&lt;′-Rec</a> <a id="13519" href="Induction.Lexicographic.html#791" class="Function Operator">⊗</a> <a id="13521" href="Data.Nat.Induction.html#1536" class="Function">&lt;′-Rec</a><a id="13527" class="Symbol">)</a> <a id="13529" href="Data.Nat.GCD.html#13451" class="Function">P</a> <a id="13531" href="Data.Nat.GCD.html#13507" class="Bound">p</a> <a id="13533" class="Symbol">→</a> <a id="13535" href="Data.Nat.GCD.html#13451" class="Function">P</a> <a id="13537" href="Data.Nat.GCD.html#13507" class="Bound">p</a>
    <a id="13543" href="Data.Nat.GCD.html#13498" class="Function">gcd″</a> <a id="13548" class="Symbol">(</a><a id="13549" href="Agda.Builtin.Nat.html#204" class="InductiveConstructor">zero</a>  <a id="13555" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="13557" href="Data.Nat.GCD.html#13557" class="Bound">n</a><a id="13558" class="Symbol">)</a>     <a id="13564" href="Data.Nat.GCD.html#13564" class="Bound">rec</a> <a id="13568" class="Symbol">=</a> <a id="13570" href="Data.Nat.GCD.html#12765" class="Function">Lemma.base</a> <a id="13581" href="Data.Nat.GCD.html#13557" class="Bound">n</a>
    <a id="13587" href="Data.Nat.GCD.html#13498" class="Function">gcd″</a> <a id="13592" class="Symbol">(</a><a id="13593" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="13597" href="Data.Nat.GCD.html#13597" class="Bound">m</a> <a id="13599" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="13601" href="Agda.Builtin.Nat.html#204" class="InductiveConstructor">zero</a><a id="13605" class="Symbol">)</a>  <a id="13608" href="Data.Nat.GCD.html#13608" class="Bound">rec</a> <a id="13612" class="Symbol">=</a> <a id="13614" href="Data.Nat.GCD.html#12675" class="Function">Lemma.sym</a> <a id="13624" class="Symbol">(</a><a id="13625" href="Data.Nat.GCD.html#12765" class="Function">Lemma.base</a> <a id="13636" class="Symbol">(</a><a id="13637" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="13641" href="Data.Nat.GCD.html#13597" class="Bound">m</a><a id="13642" class="Symbol">))</a>
    <a id="13649" href="Data.Nat.GCD.html#13498" class="Function">gcd″</a> <a id="13654" class="Symbol">(</a><a id="13655" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="13659" href="Data.Nat.GCD.html#13659" class="Bound">m</a> <a id="13661" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="13663" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="13667" href="Data.Nat.GCD.html#13667" class="Bound">n</a><a id="13668" class="Symbol">)</a> <a id="13670" href="Data.Nat.GCD.html#13670" class="Bound">rec</a> <a id="13674" class="Keyword">with</a> <a id="13679" href="Data.Nat.Base.html#7112" class="Function">compare</a> <a id="13687" href="Data.Nat.GCD.html#13659" class="Bound">m</a> <a id="13689" href="Data.Nat.GCD.html#13667" class="Bound">n</a>
    <a id="13695" class="Symbol">...</a> <a id="13699" class="Symbol">|</a> <a id="13701" href="Data.Nat.Base.html#7035" class="InductiveConstructor">equal</a> <a id="13707" href="Data.Nat.GCD.html#13707" class="Bound">m</a>     <a id="13713" class="Symbol">=</a> <a id="13715" href="Data.Nat.GCD.html#12838" class="Function">Lemma.refl</a> <a id="13726" class="Symbol">(</a><a id="13727" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="13731" href="Data.Nat.GCD.html#13707" class="Bound">m</a><a id="13732" class="Symbol">)</a>
    <a id="13738" class="Symbol">...</a> <a id="13742" class="Symbol">|</a> <a id="13744" href="Data.Nat.Base.html#6990" class="InductiveConstructor">less</a> <a id="13749" href="Data.Nat.GCD.html#13749" class="Bound">m</a> <a id="13751" href="Data.Nat.GCD.html#13751" class="Bound">k</a>    <a id="13756" class="Symbol">=</a> <a id="13758" href="Data.Nat.GCD.html#12911" class="Function">Lemma.stepˡ</a> <a id="13770" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="13772" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="13778" class="Bound">rec</a> <a id="13782" class="Symbol">(</a><a id="13783" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="13787" href="Data.Nat.GCD.html#13751" class="Bound">k</a><a id="13788" class="Symbol">)</a> <a id="13790" class="Symbol">(</a><a id="13791" href="Data.Nat.GCD.Lemmas.html#1274" class="Function">lem₁</a> <a id="13796" href="Data.Nat.GCD.html#13751" class="Bound">k</a> <a id="13798" href="Data.Nat.GCD.html#13749" class="Bound">m</a><a id="13799" class="Symbol">)</a>
                      <a id="13823" class="Comment">-- &quot;gcd (suc m) (suc k)&quot;</a>
    <a id="13852" class="Symbol">...</a> <a id="13856" class="Symbol">|</a> <a id="13858" href="Data.Nat.Base.html#7068" class="InductiveConstructor">greater</a> <a id="13866" href="Data.Nat.GCD.html#13866" class="Bound">n</a> <a id="13868" href="Data.Nat.GCD.html#13868" class="Bound">k</a> <a id="13870" class="Symbol">=</a> <a id="13872" href="Data.Nat.GCD.html#13093" class="Function">Lemma.stepʳ</a> <a id="13884" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="13886" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="13892" class="Bound">rec</a> <a id="13896" class="Symbol">(</a><a id="13897" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="13901" href="Data.Nat.GCD.html#13868" class="Bound">k</a><a id="13902" class="Symbol">)</a> <a id="13904" class="Symbol">(</a><a id="13905" href="Data.Nat.GCD.Lemmas.html#1274" class="Function">lem₁</a> <a id="13910" href="Data.Nat.GCD.html#13868" class="Bound">k</a> <a id="13912" href="Data.Nat.GCD.html#13866" class="Bound">n</a><a id="13913" class="Symbol">)</a> <a id="13915" class="Symbol">(</a><a id="13916" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="13920" href="Data.Nat.GCD.html#13866" class="Bound">n</a><a id="13921" class="Symbol">)</a>
                      <a id="13945" class="Comment">-- &quot;gcd (suc k) (suc n)&quot;</a>

  <a id="13973" class="Comment">-- Bézout&#39;s identity can be recovered from the GCD.</a>

  <a id="Bézout.identity"></a><a id="14028" href="Data.Nat.GCD.html#14028" class="Function">identity</a> <a id="14037" class="Symbol">:</a> <a id="14039" class="Symbol">∀</a> <a id="14041" class="Symbol">{</a><a id="14042" href="Data.Nat.GCD.html#14042" class="Bound">m</a> <a id="14044" href="Data.Nat.GCD.html#14044" class="Bound">n</a> <a id="14046" href="Data.Nat.GCD.html#14046" class="Bound">d</a><a id="14047" class="Symbol">}</a> <a id="14049" class="Symbol">→</a> <a id="14051" href="Data.Nat.GCD.html#8045" class="Record">GCD</a> <a id="14055" href="Data.Nat.GCD.html#14042" class="Bound">m</a> <a id="14057" href="Data.Nat.GCD.html#14044" class="Bound">n</a> <a id="14059" href="Data.Nat.GCD.html#14046" class="Bound">d</a> <a id="14061" class="Symbol">→</a> <a id="14063" href="Data.Nat.GCD.html#11247" class="Datatype">Identity</a> <a id="14072" href="Data.Nat.GCD.html#14046" class="Bound">d</a> <a id="14074" href="Data.Nat.GCD.html#14042" class="Bound">m</a> <a id="14076" href="Data.Nat.GCD.html#14044" class="Bound">n</a>
  <a id="14080" href="Data.Nat.GCD.html#14028" class="Function">identity</a> <a id="14089" class="Symbol">{</a><a id="14090" href="Data.Nat.GCD.html#14090" class="Bound">m</a><a id="14091" class="Symbol">}</a> <a id="14093" class="Symbol">{</a><a id="14094" href="Data.Nat.GCD.html#14094" class="Bound">n</a><a id="14095" class="Symbol">}</a> <a id="14097" href="Data.Nat.GCD.html#14097" class="Bound">g</a> <a id="14099" class="Keyword">with</a> <a id="14104" href="Data.Nat.GCD.html#12564" class="InductiveConstructor">result</a> <a id="14111" href="Data.Nat.GCD.html#14111" class="Bound">d</a> <a id="14113" href="Data.Nat.GCD.html#14113" class="Bound">g′</a> <a id="14116" href="Data.Nat.GCD.html#14116" class="Bound">b</a> ← <a id="14120" href="Data.Nat.GCD.html#13338" class="Function">lemma</a> <a id="14126" href="Data.Nat.GCD.html#14090" class="Bound">m</a> <a id="14128" href="Data.Nat.GCD.html#14094" class="Bound">n</a> <a id="14130" class="Keyword">rewrite</a> <a id="14138" href="Data.Nat.GCD.html#8520" class="Function">GCD.unique</a> <a id="14149" href="Data.Nat.GCD.html#14097" class="Bound">g</a> <a id="14151" href="Data.Nat.GCD.html#14113" class="Bound">g′</a> <a id="14154" class="Symbol">=</a> <a id="14156" href="Data.Nat.GCD.html#14116" class="Bound">b</a>
</pre></body></html>